var O8=Object.defineProperty;var j8=(e,t,r)=>t in e?O8(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var mr=(e,t,r)=>j8(e,typeof t!="symbol"?t+"":t,r);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();var Di=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function kq(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function R8(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var a=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,a.get?a:{enumerable:!0,get:function(){return e[n]}})}),r}var Bb={exports:{}},kp={},Ub={exports:{}},Yt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Th=Symbol.for("react.element"),D8=Symbol.for("react.portal"),M8=Symbol.for("react.fragment"),B8=Symbol.for("react.strict_mode"),U8=Symbol.for("react.profiler"),z8=Symbol.for("react.provider"),$8=Symbol.for("react.context"),W8=Symbol.for("react.forward_ref"),H8=Symbol.for("react.suspense"),V8=Symbol.for("react.memo"),q8=Symbol.for("react.lazy"),E5=Symbol.iterator;function G8(e){return e===null||typeof e!="object"?null:(e=E5&&e[E5]||e["@@iterator"],typeof e=="function"?e:null)}var zb={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},$b=Object.assign,Wb={};function hu(e,t,r){this.props=e,this.context=t,this.refs=Wb,this.updater=r||zb}hu.prototype.isReactComponent={};hu.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};hu.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Hb(){}Hb.prototype=hu.prototype;function Ux(e,t,r){this.props=e,this.context=t,this.refs=Wb,this.updater=r||zb}var zx=Ux.prototype=new Hb;zx.constructor=Ux;$b(zx,hu.prototype);zx.isPureReactComponent=!0;var A5=Array.isArray,Vb=Object.prototype.hasOwnProperty,$x={current:null},qb={key:!0,ref:!0,__self:!0,__source:!0};function Gb(e,t,r){var n,a={},i=null,s=null;if(t!=null)for(n in t.ref!==void 0&&(s=t.ref),t.key!==void 0&&(i=""+t.key),t)Vb.call(t,n)&&!qb.hasOwnProperty(n)&&(a[n]=t[n]);var o=arguments.length-2;if(o===1)a.children=r;else if(1<o){for(var l=Array(o),c=0;c<o;c++)l[c]=arguments[c+2];a.children=l}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)a[n]===void 0&&(a[n]=o[n]);return{$$typeof:Th,type:e,key:i,ref:s,props:a,_owner:$x.current}}function X8(e,t){return{$$typeof:Th,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Wx(e){return typeof e=="object"&&e!==null&&e.$$typeof===Th}function K8(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var T5=/\/+/g;function jm(e,t){return typeof e=="object"&&e!==null&&e.key!=null?K8(""+e.key):t.toString(36)}function f1(e,t,r,n,a){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var s=!1;if(e===null)s=!0;else switch(i){case"string":case"number":s=!0;break;case"object":switch(e.$$typeof){case Th:case D8:s=!0}}if(s)return s=e,a=a(s),e=n===""?"."+jm(s,0):n,A5(a)?(r="",e!=null&&(r=e.replace(T5,"$&/")+"/"),f1(a,t,r,"",function(c){return c})):a!=null&&(Wx(a)&&(a=X8(a,r+(!a.key||s&&s.key===a.key?"":(""+a.key).replace(T5,"$&/")+"/")+e)),t.push(a)),1;if(s=0,n=n===""?".":n+":",A5(e))for(var o=0;o<e.length;o++){i=e[o];var l=n+jm(i,o);s+=f1(i,t,r,l,a)}else if(l=G8(e),typeof l=="function")for(e=l.call(e),o=0;!(i=e.next()).done;)i=i.value,l=n+jm(i,o++),s+=f1(i,t,r,l,a);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return s}function kd(e,t,r){if(e==null)return e;var n=[],a=0;return f1(e,n,"","",function(i){return t.call(r,i,a++)}),n}function Y8(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Pa={current:null},h1={transition:null},J8={ReactCurrentDispatcher:Pa,ReactCurrentBatchConfig:h1,ReactCurrentOwner:$x};function Xb(){throw Error("act(...) is not supported in production builds of React.")}Yt.Children={map:kd,forEach:function(e,t,r){kd(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return kd(e,function(){t++}),t},toArray:function(e){return kd(e,function(t){return t})||[]},only:function(e){if(!Wx(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Yt.Component=hu;Yt.Fragment=M8;Yt.Profiler=U8;Yt.PureComponent=Ux;Yt.StrictMode=B8;Yt.Suspense=H8;Yt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=J8;Yt.act=Xb;Yt.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=$b({},e.props),a=e.key,i=e.ref,s=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,s=$x.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(l in t)Vb.call(t,l)&&!qb.hasOwnProperty(l)&&(n[l]=t[l]===void 0&&o!==void 0?o[l]:t[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var c=0;c<l;c++)o[c]=arguments[c+2];n.children=o}return{$$typeof:Th,type:e.type,key:a,ref:i,props:n,_owner:s}};Yt.createContext=function(e){return e={$$typeof:$8,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:z8,_context:e},e.Consumer=e};Yt.createElement=Gb;Yt.createFactory=function(e){var t=Gb.bind(null,e);return t.type=e,t};Yt.createRef=function(){return{current:null}};Yt.forwardRef=function(e){return{$$typeof:W8,render:e}};Yt.isValidElement=Wx;Yt.lazy=function(e){return{$$typeof:q8,_payload:{_status:-1,_result:e},_init:Y8}};Yt.memo=function(e,t){return{$$typeof:V8,type:e,compare:t===void 0?null:t}};Yt.startTransition=function(e){var t=h1.transition;h1.transition={};try{e()}finally{h1.transition=t}};Yt.unstable_act=Xb;Yt.useCallback=function(e,t){return Pa.current.useCallback(e,t)};Yt.useContext=function(e){return Pa.current.useContext(e)};Yt.useDebugValue=function(){};Yt.useDeferredValue=function(e){return Pa.current.useDeferredValue(e)};Yt.useEffect=function(e,t){return Pa.current.useEffect(e,t)};Yt.useId=function(){return Pa.current.useId()};Yt.useImperativeHandle=function(e,t,r){return Pa.current.useImperativeHandle(e,t,r)};Yt.useInsertionEffect=function(e,t){return Pa.current.useInsertionEffect(e,t)};Yt.useLayoutEffect=function(e,t){return Pa.current.useLayoutEffect(e,t)};Yt.useMemo=function(e,t){return Pa.current.useMemo(e,t)};Yt.useReducer=function(e,t,r){return Pa.current.useReducer(e,t,r)};Yt.useRef=function(e){return Pa.current.useRef(e)};Yt.useState=function(e){return Pa.current.useState(e)};Yt.useSyncExternalStore=function(e,t,r){return Pa.current.useSyncExternalStore(e,t,r)};Yt.useTransition=function(){return Pa.current.useTransition()};Yt.version="18.3.1";Ub.exports=Yt;var nt=Ub.exports;/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Z8=nt,Q8=Symbol.for("react.element"),eA=Symbol.for("react.fragment"),tA=Object.prototype.hasOwnProperty,rA=Z8.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,nA={key:!0,ref:!0,__self:!0,__source:!0};function Kb(e,t,r){var n,a={},i=null,s=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(s=t.ref);for(n in t)tA.call(t,n)&&!nA.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)a[n]===void 0&&(a[n]=t[n]);return{$$typeof:Q8,type:e,key:i,ref:s,props:a,_owner:rA.current}}kp.Fragment=eA;kp.jsx=Kb;kp.jsxs=Kb;Bb.exports=kp;var d=Bb.exports,Yb={exports:{}},gi={},Jb={exports:{}},Zb={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(oe,G){var ve=oe.length;oe.push(G);e:for(;0<ve;){var _e=ve-1>>>1,E=oe[_e];if(0<a(E,G))oe[_e]=G,oe[ve]=E,ve=_e;else break e}}function r(oe){return oe.length===0?null:oe[0]}function n(oe){if(oe.length===0)return null;var G=oe[0],ve=oe.pop();if(ve!==G){oe[0]=ve;e:for(var _e=0,E=oe.length,j=E>>>1;_e<j;){var O=2*(_e+1)-1,B=oe[O],Y=O+1,le=oe[Y];if(0>a(B,ve))Y<E&&0>a(le,B)?(oe[_e]=le,oe[Y]=ve,_e=Y):(oe[_e]=B,oe[O]=ve,_e=O);else if(Y<E&&0>a(le,ve))oe[_e]=le,oe[Y]=ve,_e=Y;else break e}}return G}function a(oe,G){var ve=oe.sortIndex-G.sortIndex;return ve!==0?ve:oe.id-G.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var s=Date,o=s.now();e.unstable_now=function(){return s.now()-o}}var l=[],c=[],u=1,h=null,m=3,f=!1,v=!1,x=!1,w=typeof setTimeout=="function"?setTimeout:null,_=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(oe){for(var G=r(c);G!==null;){if(G.callback===null)n(c);else if(G.startTime<=oe)n(c),G.sortIndex=G.expirationTime,t(l,G);else break;G=r(c)}}function N(oe){if(x=!1,y(oe),!v)if(r(l)!==null)v=!0,me(R);else{var G=r(c);G!==null&&pe(N,G.startTime-oe)}}function R(oe,G){v=!1,x&&(x=!1,_(C),C=-1),f=!0;var ve=m;try{for(y(G),h=r(l);h!==null&&(!(h.expirationTime>G)||oe&&!L());){var _e=h.callback;if(typeof _e=="function"){h.callback=null,m=h.priorityLevel;var E=_e(h.expirationTime<=G);G=e.unstable_now(),typeof E=="function"?h.callback=E:h===r(l)&&n(l),y(G)}else n(l);h=r(l)}if(h!==null)var j=!0;else{var O=r(c);O!==null&&pe(N,O.startTime-G),j=!1}return j}finally{h=null,m=ve,f=!1}}var P=!1,F=null,C=-1,A=5,W=-1;function L(){return!(e.unstable_now()-W<A)}function I(){if(F!==null){var oe=e.unstable_now();W=oe;var G=!0;try{G=F(!0,oe)}finally{G?V():(P=!1,F=null)}}else P=!1}var V;if(typeof b=="function")V=function(){b(I)};else if(typeof MessageChannel<"u"){var Q=new MessageChannel,ue=Q.port2;Q.port1.onmessage=I,V=function(){ue.postMessage(null)}}else V=function(){w(I,0)};function me(oe){F=oe,P||(P=!0,V())}function pe(oe,G){C=w(function(){oe(e.unstable_now())},G)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(oe){oe.callback=null},e.unstable_continueExecution=function(){v||f||(v=!0,me(R))},e.unstable_forceFrameRate=function(oe){0>oe||125<oe?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<oe?Math.floor(1e3/oe):5},e.unstable_getCurrentPriorityLevel=function(){return m},e.unstable_getFirstCallbackNode=function(){return r(l)},e.unstable_next=function(oe){switch(m){case 1:case 2:case 3:var G=3;break;default:G=m}var ve=m;m=G;try{return oe()}finally{m=ve}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(oe,G){switch(oe){case 1:case 2:case 3:case 4:case 5:break;default:oe=3}var ve=m;m=oe;try{return G()}finally{m=ve}},e.unstable_scheduleCallback=function(oe,G,ve){var _e=e.unstable_now();switch(typeof ve=="object"&&ve!==null?(ve=ve.delay,ve=typeof ve=="number"&&0<ve?_e+ve:_e):ve=_e,oe){case 1:var E=-1;break;case 2:E=250;break;case 5:E=1073741823;break;case 4:E=1e4;break;default:E=5e3}return E=ve+E,oe={id:u++,callback:G,priorityLevel:oe,startTime:ve,expirationTime:E,sortIndex:-1},ve>_e?(oe.sortIndex=ve,t(c,oe),r(l)===null&&oe===r(c)&&(x?(_(C),C=-1):x=!0,pe(N,ve-_e))):(oe.sortIndex=E,t(l,oe),v||f||(v=!0,me(R))),oe},e.unstable_shouldYield=L,e.unstable_wrapCallback=function(oe){var G=m;return function(){var ve=m;m=G;try{return oe.apply(this,arguments)}finally{m=ve}}}})(Zb);Jb.exports=Zb;var aA=Jb.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var iA=nt,pi=aA;function He(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Qb=new Set,Wf={};function Dc(e,t){Y0(e,t),Y0(e+"Capture",t)}function Y0(e,t){for(Wf[e]=t,e=0;e<t.length;e++)Qb.add(t[e])}var go=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),a2=Object.prototype.hasOwnProperty,sA=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,C5={},F5={};function oA(e){return a2.call(F5,e)?!0:a2.call(C5,e)?!1:sA.test(e)?F5[e]=!0:(C5[e]=!0,!1)}function lA(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function cA(e,t,r,n){if(t===null||typeof t>"u"||lA(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Ia(e,t,r,n,a,i,s){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=s}var ta={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){ta[e]=new Ia(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];ta[t]=new Ia(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){ta[e]=new Ia(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){ta[e]=new Ia(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){ta[e]=new Ia(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){ta[e]=new Ia(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){ta[e]=new Ia(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){ta[e]=new Ia(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){ta[e]=new Ia(e,5,!1,e.toLowerCase(),null,!1,!1)});var Hx=/[\-:]([a-z])/g;function Vx(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Hx,Vx);ta[t]=new Ia(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Hx,Vx);ta[t]=new Ia(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Hx,Vx);ta[t]=new Ia(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){ta[e]=new Ia(e,1,!1,e.toLowerCase(),null,!1,!1)});ta.xlinkHref=new Ia("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){ta[e]=new Ia(e,1,!1,e.toLowerCase(),null,!0,!0)});function qx(e,t,r,n){var a=ta.hasOwnProperty(t)?ta[t]:null;(a!==null?a.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(cA(t,r,a,n)&&(r=null),n||a===null?oA(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):a.mustUseProperty?e[a.propertyName]=r===null?a.type===3?!1:"":r:(t=a.attributeName,n=a.attributeNamespace,r===null?e.removeAttribute(t):(a=a.type,r=a===3||a===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var yo=iA.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Sd=Symbol.for("react.element"),y0=Symbol.for("react.portal"),b0=Symbol.for("react.fragment"),Gx=Symbol.for("react.strict_mode"),i2=Symbol.for("react.profiler"),e3=Symbol.for("react.provider"),t3=Symbol.for("react.context"),Xx=Symbol.for("react.forward_ref"),s2=Symbol.for("react.suspense"),o2=Symbol.for("react.suspense_list"),Kx=Symbol.for("react.memo"),Ko=Symbol.for("react.lazy"),r3=Symbol.for("react.offscreen"),L5=Symbol.iterator;function Ku(e){return e===null||typeof e!="object"?null:(e=L5&&e[L5]||e["@@iterator"],typeof e=="function"?e:null)}var Xr=Object.assign,Rm;function cf(e){if(Rm===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);Rm=t&&t[1]||""}return`
`+Rm+e}var Dm=!1;function Mm(e,t){if(!e||Dm)return"";Dm=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var a=c.stack.split(`
`),i=n.stack.split(`
`),s=a.length-1,o=i.length-1;1<=s&&0<=o&&a[s]!==i[o];)o--;for(;1<=s&&0<=o;s--,o--)if(a[s]!==i[o]){if(s!==1||o!==1)do if(s--,o--,0>o||a[s]!==i[o]){var l=`
`+a[s].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=s&&0<=o);break}}}finally{Dm=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?cf(e):""}function uA(e){switch(e.tag){case 5:return cf(e.type);case 16:return cf("Lazy");case 13:return cf("Suspense");case 19:return cf("SuspenseList");case 0:case 2:case 15:return e=Mm(e.type,!1),e;case 11:return e=Mm(e.type.render,!1),e;case 1:return e=Mm(e.type,!0),e;default:return""}}function l2(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case b0:return"Fragment";case y0:return"Portal";case i2:return"Profiler";case Gx:return"StrictMode";case s2:return"Suspense";case o2:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case t3:return(e.displayName||"Context")+".Consumer";case e3:return(e._context.displayName||"Context")+".Provider";case Xx:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Kx:return t=e.displayName||null,t!==null?t:l2(e.type)||"Memo";case Ko:t=e._payload,e=e._init;try{return l2(e(t))}catch{}}return null}function fA(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return l2(t);case 8:return t===Gx?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function _l(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function n3(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function hA(e){var t=n3(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var a=r.get,i=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(s){n=""+s,i.call(this,s)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(s){n=""+s},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Nd(e){e._valueTracker||(e._valueTracker=hA(e))}function a3(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=n3(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function L1(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function c2(e,t){var r=t.checked;return Xr({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function P5(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=_l(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function i3(e,t){t=t.checked,t!=null&&qx(e,"checked",t,!1)}function u2(e,t){i3(e,t);var r=_l(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?f2(e,t.type,r):t.hasOwnProperty("defaultValue")&&f2(e,t.type,_l(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function I5(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function f2(e,t,r){(t!=="number"||L1(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var uf=Array.isArray;function j0(e,t,r,n){if(e=e.options,t){t={};for(var a=0;a<r.length;a++)t["$"+r[a]]=!0;for(r=0;r<e.length;r++)a=t.hasOwnProperty("$"+e[r].value),e[r].selected!==a&&(e[r].selected=a),a&&n&&(e[r].defaultSelected=!0)}else{for(r=""+_l(r),t=null,a=0;a<e.length;a++){if(e[a].value===r){e[a].selected=!0,n&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function h2(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(He(91));return Xr({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function O5(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(He(92));if(uf(r)){if(1<r.length)throw Error(He(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:_l(r)}}function s3(e,t){var r=_l(t.value),n=_l(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function j5(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function o3(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function d2(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?o3(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Ed,l3=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,a){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Ed=Ed||document.createElement("div"),Ed.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Ed.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Hf(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var _f={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},dA=["Webkit","ms","Moz","O"];Object.keys(_f).forEach(function(e){dA.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),_f[t]=_f[e]})});function c3(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||_f.hasOwnProperty(e)&&_f[e]?(""+t).trim():t+"px"}function u3(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,a=c3(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,a):e[r]=a}}var pA=Xr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function p2(e,t){if(t){if(pA[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(He(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(He(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(He(61))}if(t.style!=null&&typeof t.style!="object")throw Error(He(62))}}function m2(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var g2=null;function Yx(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var x2=null,R0=null,D0=null;function R5(e){if(e=Lh(e)){if(typeof x2!="function")throw Error(He(280));var t=e.stateNode;t&&(t=Tp(t),x2(e.stateNode,e.type,t))}}function f3(e){R0?D0?D0.push(e):D0=[e]:R0=e}function h3(){if(R0){var e=R0,t=D0;if(D0=R0=null,R5(e),t)for(e=0;e<t.length;e++)R5(t[e])}}function d3(e,t){return e(t)}function p3(){}var Bm=!1;function m3(e,t,r){if(Bm)return e(t,r);Bm=!0;try{return d3(e,t,r)}finally{Bm=!1,(R0!==null||D0!==null)&&(p3(),h3())}}function Vf(e,t){var r=e.stateNode;if(r===null)return null;var n=Tp(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(He(231,t,typeof r));return r}var v2=!1;if(go)try{var Yu={};Object.defineProperty(Yu,"passive",{get:function(){v2=!0}}),window.addEventListener("test",Yu,Yu),window.removeEventListener("test",Yu,Yu)}catch{v2=!1}function mA(e,t,r,n,a,i,s,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(u){this.onError(u)}}var wf=!1,P1=null,I1=!1,_2=null,gA={onError:function(e){wf=!0,P1=e}};function xA(e,t,r,n,a,i,s,o,l){wf=!1,P1=null,mA.apply(gA,arguments)}function vA(e,t,r,n,a,i,s,o,l){if(xA.apply(this,arguments),wf){if(wf){var c=P1;wf=!1,P1=null}else throw Error(He(198));I1||(I1=!0,_2=c)}}function Mc(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function g3(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function D5(e){if(Mc(e)!==e)throw Error(He(188))}function _A(e){var t=e.alternate;if(!t){if(t=Mc(e),t===null)throw Error(He(188));return t!==e?null:e}for(var r=e,n=t;;){var a=r.return;if(a===null)break;var i=a.alternate;if(i===null){if(n=a.return,n!==null){r=n;continue}break}if(a.child===i.child){for(i=a.child;i;){if(i===r)return D5(a),e;if(i===n)return D5(a),t;i=i.sibling}throw Error(He(188))}if(r.return!==n.return)r=a,n=i;else{for(var s=!1,o=a.child;o;){if(o===r){s=!0,r=a,n=i;break}if(o===n){s=!0,n=a,r=i;break}o=o.sibling}if(!s){for(o=i.child;o;){if(o===r){s=!0,r=i,n=a;break}if(o===n){s=!0,n=i,r=a;break}o=o.sibling}if(!s)throw Error(He(189))}}if(r.alternate!==n)throw Error(He(190))}if(r.tag!==3)throw Error(He(188));return r.stateNode.current===r?e:t}function x3(e){return e=_A(e),e!==null?v3(e):null}function v3(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=v3(e);if(t!==null)return t;e=e.sibling}return null}var _3=pi.unstable_scheduleCallback,M5=pi.unstable_cancelCallback,wA=pi.unstable_shouldYield,yA=pi.unstable_requestPaint,hn=pi.unstable_now,bA=pi.unstable_getCurrentPriorityLevel,Jx=pi.unstable_ImmediatePriority,w3=pi.unstable_UserBlockingPriority,O1=pi.unstable_NormalPriority,kA=pi.unstable_LowPriority,y3=pi.unstable_IdlePriority,Sp=null,Is=null;function SA(e){if(Is&&typeof Is.onCommitFiberRoot=="function")try{Is.onCommitFiberRoot(Sp,e,void 0,(e.current.flags&128)===128)}catch{}}var os=Math.clz32?Math.clz32:AA,NA=Math.log,EA=Math.LN2;function AA(e){return e>>>=0,e===0?32:31-(NA(e)/EA|0)|0}var Ad=64,Td=4194304;function ff(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function j1(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,a=e.suspendedLanes,i=e.pingedLanes,s=r&268435455;if(s!==0){var o=s&~a;o!==0?n=ff(o):(i&=s,i!==0&&(n=ff(i)))}else s=r&~a,s!==0?n=ff(s):i!==0&&(n=ff(i));if(n===0)return 0;if(t!==0&&t!==n&&!(t&a)&&(a=n&-n,i=t&-t,a>=i||a===16&&(i&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-os(t),a=1<<r,n|=e[r],t&=~a;return n}function TA(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function CA(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,a=e.expirationTimes,i=e.pendingLanes;0<i;){var s=31-os(i),o=1<<s,l=a[s];l===-1?(!(o&r)||o&n)&&(a[s]=TA(o,t)):l<=t&&(e.expiredLanes|=o),i&=~o}}function w2(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function b3(){var e=Ad;return Ad<<=1,!(Ad&4194240)&&(Ad=64),e}function Um(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Ch(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-os(t),e[t]=r}function FA(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var a=31-os(r),i=1<<a;t[a]=0,n[a]=-1,e[a]=-1,r&=~i}}function Zx(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-os(r),a=1<<n;a&t|e[n]&t&&(e[n]|=t),r&=~a}}var wr=0;function k3(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var S3,Qx,N3,E3,A3,y2=!1,Cd=[],ll=null,cl=null,ul=null,qf=new Map,Gf=new Map,Jo=[],LA="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function B5(e,t){switch(e){case"focusin":case"focusout":ll=null;break;case"dragenter":case"dragleave":cl=null;break;case"mouseover":case"mouseout":ul=null;break;case"pointerover":case"pointerout":qf.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Gf.delete(t.pointerId)}}function Ju(e,t,r,n,a,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[a]},t!==null&&(t=Lh(t),t!==null&&Qx(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function PA(e,t,r,n,a){switch(t){case"focusin":return ll=Ju(ll,e,t,r,n,a),!0;case"dragenter":return cl=Ju(cl,e,t,r,n,a),!0;case"mouseover":return ul=Ju(ul,e,t,r,n,a),!0;case"pointerover":var i=a.pointerId;return qf.set(i,Ju(qf.get(i)||null,e,t,r,n,a)),!0;case"gotpointercapture":return i=a.pointerId,Gf.set(i,Ju(Gf.get(i)||null,e,t,r,n,a)),!0}return!1}function T3(e){var t=lc(e.target);if(t!==null){var r=Mc(t);if(r!==null){if(t=r.tag,t===13){if(t=g3(r),t!==null){e.blockedOn=t,A3(e.priority,function(){N3(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function d1(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=b2(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);g2=n,r.target.dispatchEvent(n),g2=null}else return t=Lh(r),t!==null&&Qx(t),e.blockedOn=r,!1;t.shift()}return!0}function U5(e,t,r){d1(e)&&r.delete(t)}function IA(){y2=!1,ll!==null&&d1(ll)&&(ll=null),cl!==null&&d1(cl)&&(cl=null),ul!==null&&d1(ul)&&(ul=null),qf.forEach(U5),Gf.forEach(U5)}function Zu(e,t){e.blockedOn===t&&(e.blockedOn=null,y2||(y2=!0,pi.unstable_scheduleCallback(pi.unstable_NormalPriority,IA)))}function Xf(e){function t(a){return Zu(a,e)}if(0<Cd.length){Zu(Cd[0],e);for(var r=1;r<Cd.length;r++){var n=Cd[r];n.blockedOn===e&&(n.blockedOn=null)}}for(ll!==null&&Zu(ll,e),cl!==null&&Zu(cl,e),ul!==null&&Zu(ul,e),qf.forEach(t),Gf.forEach(t),r=0;r<Jo.length;r++)n=Jo[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Jo.length&&(r=Jo[0],r.blockedOn===null);)T3(r),r.blockedOn===null&&Jo.shift()}var M0=yo.ReactCurrentBatchConfig,R1=!0;function OA(e,t,r,n){var a=wr,i=M0.transition;M0.transition=null;try{wr=1,ev(e,t,r,n)}finally{wr=a,M0.transition=i}}function jA(e,t,r,n){var a=wr,i=M0.transition;M0.transition=null;try{wr=4,ev(e,t,r,n)}finally{wr=a,M0.transition=i}}function ev(e,t,r,n){if(R1){var a=b2(e,t,r,n);if(a===null)Ym(e,t,n,D1,r),B5(e,n);else if(PA(a,e,t,r,n))n.stopPropagation();else if(B5(e,n),t&4&&-1<LA.indexOf(e)){for(;a!==null;){var i=Lh(a);if(i!==null&&S3(i),i=b2(e,t,r,n),i===null&&Ym(e,t,n,D1,r),i===a)break;a=i}a!==null&&n.stopPropagation()}else Ym(e,t,n,null,r)}}var D1=null;function b2(e,t,r,n){if(D1=null,e=Yx(n),e=lc(e),e!==null)if(t=Mc(e),t===null)e=null;else if(r=t.tag,r===13){if(e=g3(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return D1=e,null}function C3(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(bA()){case Jx:return 1;case w3:return 4;case O1:case kA:return 16;case y3:return 536870912;default:return 16}default:return 16}}var rl=null,tv=null,p1=null;function F3(){if(p1)return p1;var e,t=tv,r=t.length,n,a="value"in rl?rl.value:rl.textContent,i=a.length;for(e=0;e<r&&t[e]===a[e];e++);var s=r-e;for(n=1;n<=s&&t[r-n]===a[i-n];n++);return p1=a.slice(e,1<n?1-n:void 0)}function m1(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Fd(){return!0}function z5(){return!1}function xi(e){function t(r,n,a,i,s){this._reactName=r,this._targetInst=a,this.type=n,this.nativeEvent=i,this.target=s,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(i):i[o]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Fd:z5,this.isPropagationStopped=z5,this}return Xr(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Fd)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Fd)},persist:function(){},isPersistent:Fd}),t}var du={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},rv=xi(du),Fh=Xr({},du,{view:0,detail:0}),RA=xi(Fh),zm,$m,Qu,Np=Xr({},Fh,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:nv,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Qu&&(Qu&&e.type==="mousemove"?(zm=e.screenX-Qu.screenX,$m=e.screenY-Qu.screenY):$m=zm=0,Qu=e),zm)},movementY:function(e){return"movementY"in e?e.movementY:$m}}),$5=xi(Np),DA=Xr({},Np,{dataTransfer:0}),MA=xi(DA),BA=Xr({},Fh,{relatedTarget:0}),Wm=xi(BA),UA=Xr({},du,{animationName:0,elapsedTime:0,pseudoElement:0}),zA=xi(UA),$A=Xr({},du,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),WA=xi($A),HA=Xr({},du,{data:0}),W5=xi(HA),VA={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},qA={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},GA={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function XA(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=GA[e])?!!t[e]:!1}function nv(){return XA}var KA=Xr({},Fh,{key:function(e){if(e.key){var t=VA[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=m1(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?qA[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:nv,charCode:function(e){return e.type==="keypress"?m1(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?m1(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),YA=xi(KA),JA=Xr({},Np,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),H5=xi(JA),ZA=Xr({},Fh,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:nv}),QA=xi(ZA),eT=Xr({},du,{propertyName:0,elapsedTime:0,pseudoElement:0}),tT=xi(eT),rT=Xr({},Np,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),nT=xi(rT),aT=[9,13,27,32],av=go&&"CompositionEvent"in window,yf=null;go&&"documentMode"in document&&(yf=document.documentMode);var iT=go&&"TextEvent"in window&&!yf,L3=go&&(!av||yf&&8<yf&&11>=yf),V5=" ",q5=!1;function P3(e,t){switch(e){case"keyup":return aT.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function I3(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var k0=!1;function sT(e,t){switch(e){case"compositionend":return I3(t);case"keypress":return t.which!==32?null:(q5=!0,V5);case"textInput":return e=t.data,e===V5&&q5?null:e;default:return null}}function oT(e,t){if(k0)return e==="compositionend"||!av&&P3(e,t)?(e=F3(),p1=tv=rl=null,k0=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return L3&&t.locale!=="ko"?null:t.data;default:return null}}var lT={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function G5(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!lT[e.type]:t==="textarea"}function O3(e,t,r,n){f3(n),t=M1(t,"onChange"),0<t.length&&(r=new rv("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var bf=null,Kf=null;function cT(e){V3(e,0)}function Ep(e){var t=E0(e);if(a3(t))return e}function uT(e,t){if(e==="change")return t}var j3=!1;if(go){var Hm;if(go){var Vm="oninput"in document;if(!Vm){var X5=document.createElement("div");X5.setAttribute("oninput","return;"),Vm=typeof X5.oninput=="function"}Hm=Vm}else Hm=!1;j3=Hm&&(!document.documentMode||9<document.documentMode)}function K5(){bf&&(bf.detachEvent("onpropertychange",R3),Kf=bf=null)}function R3(e){if(e.propertyName==="value"&&Ep(Kf)){var t=[];O3(t,Kf,e,Yx(e)),m3(cT,t)}}function fT(e,t,r){e==="focusin"?(K5(),bf=t,Kf=r,bf.attachEvent("onpropertychange",R3)):e==="focusout"&&K5()}function hT(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Ep(Kf)}function dT(e,t){if(e==="click")return Ep(t)}function pT(e,t){if(e==="input"||e==="change")return Ep(t)}function mT(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var fs=typeof Object.is=="function"?Object.is:mT;function Yf(e,t){if(fs(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!a2.call(t,a)||!fs(e[a],t[a]))return!1}return!0}function Y5(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function J5(e,t){var r=Y5(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Y5(r)}}function D3(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?D3(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function M3(){for(var e=window,t=L1();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=L1(e.document)}return t}function iv(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function gT(e){var t=M3(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&D3(r.ownerDocument.documentElement,r)){if(n!==null&&iv(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=r.textContent.length,i=Math.min(n.start,a);n=n.end===void 0?i:Math.min(n.end,a),!e.extend&&i>n&&(a=n,n=i,i=a),a=J5(r,i);var s=J5(r,n);a&&s&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),i>n?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var xT=go&&"documentMode"in document&&11>=document.documentMode,S0=null,k2=null,kf=null,S2=!1;function Z5(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;S2||S0==null||S0!==L1(n)||(n=S0,"selectionStart"in n&&iv(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),kf&&Yf(kf,n)||(kf=n,n=M1(k2,"onSelect"),0<n.length&&(t=new rv("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=S0)))}function Ld(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var N0={animationend:Ld("Animation","AnimationEnd"),animationiteration:Ld("Animation","AnimationIteration"),animationstart:Ld("Animation","AnimationStart"),transitionend:Ld("Transition","TransitionEnd")},qm={},B3={};go&&(B3=document.createElement("div").style,"AnimationEvent"in window||(delete N0.animationend.animation,delete N0.animationiteration.animation,delete N0.animationstart.animation),"TransitionEvent"in window||delete N0.transitionend.transition);function Ap(e){if(qm[e])return qm[e];if(!N0[e])return e;var t=N0[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in B3)return qm[e]=t[r];return e}var U3=Ap("animationend"),z3=Ap("animationiteration"),$3=Ap("animationstart"),W3=Ap("transitionend"),H3=new Map,Q5="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function El(e,t){H3.set(e,t),Dc(t,[e])}for(var Gm=0;Gm<Q5.length;Gm++){var Xm=Q5[Gm],vT=Xm.toLowerCase(),_T=Xm[0].toUpperCase()+Xm.slice(1);El(vT,"on"+_T)}El(U3,"onAnimationEnd");El(z3,"onAnimationIteration");El($3,"onAnimationStart");El("dblclick","onDoubleClick");El("focusin","onFocus");El("focusout","onBlur");El(W3,"onTransitionEnd");Y0("onMouseEnter",["mouseout","mouseover"]);Y0("onMouseLeave",["mouseout","mouseover"]);Y0("onPointerEnter",["pointerout","pointerover"]);Y0("onPointerLeave",["pointerout","pointerover"]);Dc("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Dc("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Dc("onBeforeInput",["compositionend","keypress","textInput","paste"]);Dc("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Dc("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Dc("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var hf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),wT=new Set("cancel close invalid load scroll toggle".split(" ").concat(hf));function ew(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,vA(n,t,void 0,e),e.currentTarget=null}function V3(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],a=n.event;n=n.listeners;e:{var i=void 0;if(t)for(var s=n.length-1;0<=s;s--){var o=n[s],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==i&&a.isPropagationStopped())break e;ew(a,o,c),i=l}else for(s=0;s<n.length;s++){if(o=n[s],l=o.instance,c=o.currentTarget,o=o.listener,l!==i&&a.isPropagationStopped())break e;ew(a,o,c),i=l}}}if(I1)throw e=_2,I1=!1,_2=null,e}function Pr(e,t){var r=t[C2];r===void 0&&(r=t[C2]=new Set);var n=e+"__bubble";r.has(n)||(q3(t,e,2,!1),r.add(n))}function Km(e,t,r){var n=0;t&&(n|=4),q3(r,e,n,t)}var Pd="_reactListening"+Math.random().toString(36).slice(2);function Jf(e){if(!e[Pd]){e[Pd]=!0,Qb.forEach(function(r){r!=="selectionchange"&&(wT.has(r)||Km(r,!1,e),Km(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Pd]||(t[Pd]=!0,Km("selectionchange",!1,t))}}function q3(e,t,r,n){switch(C3(t)){case 1:var a=OA;break;case 4:a=jA;break;default:a=ev}r=a.bind(null,t,r,e),a=void 0,!v2||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),n?a!==void 0?e.addEventListener(t,r,{capture:!0,passive:a}):e.addEventListener(t,r,!0):a!==void 0?e.addEventListener(t,r,{passive:a}):e.addEventListener(t,r,!1)}function Ym(e,t,r,n,a){var i=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var s=n.tag;if(s===3||s===4){var o=n.stateNode.containerInfo;if(o===a||o.nodeType===8&&o.parentNode===a)break;if(s===4)for(s=n.return;s!==null;){var l=s.tag;if((l===3||l===4)&&(l=s.stateNode.containerInfo,l===a||l.nodeType===8&&l.parentNode===a))return;s=s.return}for(;o!==null;){if(s=lc(o),s===null)return;if(l=s.tag,l===5||l===6){n=i=s;continue e}o=o.parentNode}}n=n.return}m3(function(){var c=i,u=Yx(r),h=[];e:{var m=H3.get(e);if(m!==void 0){var f=rv,v=e;switch(e){case"keypress":if(m1(r)===0)break e;case"keydown":case"keyup":f=YA;break;case"focusin":v="focus",f=Wm;break;case"focusout":v="blur",f=Wm;break;case"beforeblur":case"afterblur":f=Wm;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=$5;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=MA;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=QA;break;case U3:case z3:case $3:f=zA;break;case W3:f=tT;break;case"scroll":f=RA;break;case"wheel":f=nT;break;case"copy":case"cut":case"paste":f=WA;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=H5}var x=(t&4)!==0,w=!x&&e==="scroll",_=x?m!==null?m+"Capture":null:m;x=[];for(var b=c,y;b!==null;){y=b;var N=y.stateNode;if(y.tag===5&&N!==null&&(y=N,_!==null&&(N=Vf(b,_),N!=null&&x.push(Zf(b,N,y)))),w)break;b=b.return}0<x.length&&(m=new f(m,v,null,r,u),h.push({event:m,listeners:x}))}}if(!(t&7)){e:{if(m=e==="mouseover"||e==="pointerover",f=e==="mouseout"||e==="pointerout",m&&r!==g2&&(v=r.relatedTarget||r.fromElement)&&(lc(v)||v[xo]))break e;if((f||m)&&(m=u.window===u?u:(m=u.ownerDocument)?m.defaultView||m.parentWindow:window,f?(v=r.relatedTarget||r.toElement,f=c,v=v?lc(v):null,v!==null&&(w=Mc(v),v!==w||v.tag!==5&&v.tag!==6)&&(v=null)):(f=null,v=c),f!==v)){if(x=$5,N="onMouseLeave",_="onMouseEnter",b="mouse",(e==="pointerout"||e==="pointerover")&&(x=H5,N="onPointerLeave",_="onPointerEnter",b="pointer"),w=f==null?m:E0(f),y=v==null?m:E0(v),m=new x(N,b+"leave",f,r,u),m.target=w,m.relatedTarget=y,N=null,lc(u)===c&&(x=new x(_,b+"enter",v,r,u),x.target=y,x.relatedTarget=w,N=x),w=N,f&&v)t:{for(x=f,_=v,b=0,y=x;y;y=n0(y))b++;for(y=0,N=_;N;N=n0(N))y++;for(;0<b-y;)x=n0(x),b--;for(;0<y-b;)_=n0(_),y--;for(;b--;){if(x===_||_!==null&&x===_.alternate)break t;x=n0(x),_=n0(_)}x=null}else x=null;f!==null&&tw(h,m,f,x,!1),v!==null&&w!==null&&tw(h,w,v,x,!0)}}e:{if(m=c?E0(c):window,f=m.nodeName&&m.nodeName.toLowerCase(),f==="select"||f==="input"&&m.type==="file")var R=uT;else if(G5(m))if(j3)R=pT;else{R=hT;var P=fT}else(f=m.nodeName)&&f.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(R=dT);if(R&&(R=R(e,c))){O3(h,R,r,u);break e}P&&P(e,m,c),e==="focusout"&&(P=m._wrapperState)&&P.controlled&&m.type==="number"&&f2(m,"number",m.value)}switch(P=c?E0(c):window,e){case"focusin":(G5(P)||P.contentEditable==="true")&&(S0=P,k2=c,kf=null);break;case"focusout":kf=k2=S0=null;break;case"mousedown":S2=!0;break;case"contextmenu":case"mouseup":case"dragend":S2=!1,Z5(h,r,u);break;case"selectionchange":if(xT)break;case"keydown":case"keyup":Z5(h,r,u)}var F;if(av)e:{switch(e){case"compositionstart":var C="onCompositionStart";break e;case"compositionend":C="onCompositionEnd";break e;case"compositionupdate":C="onCompositionUpdate";break e}C=void 0}else k0?P3(e,r)&&(C="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(C="onCompositionStart");C&&(L3&&r.locale!=="ko"&&(k0||C!=="onCompositionStart"?C==="onCompositionEnd"&&k0&&(F=F3()):(rl=u,tv="value"in rl?rl.value:rl.textContent,k0=!0)),P=M1(c,C),0<P.length&&(C=new W5(C,e,null,r,u),h.push({event:C,listeners:P}),F?C.data=F:(F=I3(r),F!==null&&(C.data=F)))),(F=iT?sT(e,r):oT(e,r))&&(c=M1(c,"onBeforeInput"),0<c.length&&(u=new W5("onBeforeInput","beforeinput",null,r,u),h.push({event:u,listeners:c}),u.data=F))}V3(h,t)})}function Zf(e,t,r){return{instance:e,listener:t,currentTarget:r}}function M1(e,t){for(var r=t+"Capture",n=[];e!==null;){var a=e,i=a.stateNode;a.tag===5&&i!==null&&(a=i,i=Vf(e,r),i!=null&&n.unshift(Zf(e,i,a)),i=Vf(e,t),i!=null&&n.push(Zf(e,i,a))),e=e.return}return n}function n0(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function tw(e,t,r,n,a){for(var i=t._reactName,s=[];r!==null&&r!==n;){var o=r,l=o.alternate,c=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&c!==null&&(o=c,a?(l=Vf(r,i),l!=null&&s.unshift(Zf(r,l,o))):a||(l=Vf(r,i),l!=null&&s.push(Zf(r,l,o)))),r=r.return}s.length!==0&&e.push({event:t,listeners:s})}var yT=/\r\n?/g,bT=/\u0000|\uFFFD/g;function rw(e){return(typeof e=="string"?e:""+e).replace(yT,`
`).replace(bT,"")}function Id(e,t,r){if(t=rw(t),rw(e)!==t&&r)throw Error(He(425))}function B1(){}var N2=null,E2=null;function A2(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var T2=typeof setTimeout=="function"?setTimeout:void 0,kT=typeof clearTimeout=="function"?clearTimeout:void 0,nw=typeof Promise=="function"?Promise:void 0,ST=typeof queueMicrotask=="function"?queueMicrotask:typeof nw<"u"?function(e){return nw.resolve(null).then(e).catch(NT)}:T2;function NT(e){setTimeout(function(){throw e})}function Jm(e,t){var r=t,n=0;do{var a=r.nextSibling;if(e.removeChild(r),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(n===0){e.removeChild(a),Xf(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=a}while(r);Xf(t)}function fl(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function aw(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var pu=Math.random().toString(36).slice(2),Cs="__reactFiber$"+pu,Qf="__reactProps$"+pu,xo="__reactContainer$"+pu,C2="__reactEvents$"+pu,ET="__reactListeners$"+pu,AT="__reactHandles$"+pu;function lc(e){var t=e[Cs];if(t)return t;for(var r=e.parentNode;r;){if(t=r[xo]||r[Cs]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=aw(e);e!==null;){if(r=e[Cs])return r;e=aw(e)}return t}e=r,r=e.parentNode}return null}function Lh(e){return e=e[Cs]||e[xo],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function E0(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(He(33))}function Tp(e){return e[Qf]||null}var F2=[],A0=-1;function Al(e){return{current:e}}function Rr(e){0>A0||(e.current=F2[A0],F2[A0]=null,A0--)}function Fr(e,t){A0++,F2[A0]=e.current,e.current=t}var wl={},_a=Al(wl),Wa=Al(!1),kc=wl;function J0(e,t){var r=e.type.contextTypes;if(!r)return wl;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var a={},i;for(i in r)a[i]=t[i];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function Ha(e){return e=e.childContextTypes,e!=null}function U1(){Rr(Wa),Rr(_a)}function iw(e,t,r){if(_a.current!==wl)throw Error(He(168));Fr(_a,t),Fr(Wa,r)}function G3(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var a in n)if(!(a in t))throw Error(He(108,fA(e)||"Unknown",a));return Xr({},r,n)}function z1(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||wl,kc=_a.current,Fr(_a,e),Fr(Wa,Wa.current),!0}function sw(e,t,r){var n=e.stateNode;if(!n)throw Error(He(169));r?(e=G3(e,t,kc),n.__reactInternalMemoizedMergedChildContext=e,Rr(Wa),Rr(_a),Fr(_a,e)):Rr(Wa),Fr(Wa,r)}var no=null,Cp=!1,Zm=!1;function X3(e){no===null?no=[e]:no.push(e)}function TT(e){Cp=!0,X3(e)}function Tl(){if(!Zm&&no!==null){Zm=!0;var e=0,t=wr;try{var r=no;for(wr=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}no=null,Cp=!1}catch(a){throw no!==null&&(no=no.slice(e+1)),_3(Jx,Tl),a}finally{wr=t,Zm=!1}}return null}var T0=[],C0=0,$1=null,W1=0,Li=[],Pi=0,Sc=null,so=1,oo="";function tc(e,t){T0[C0++]=W1,T0[C0++]=$1,$1=e,W1=t}function K3(e,t,r){Li[Pi++]=so,Li[Pi++]=oo,Li[Pi++]=Sc,Sc=e;var n=so;e=oo;var a=32-os(n)-1;n&=~(1<<a),r+=1;var i=32-os(t)+a;if(30<i){var s=a-a%5;i=(n&(1<<s)-1).toString(32),n>>=s,a-=s,so=1<<32-os(t)+a|r<<a|n,oo=i+e}else so=1<<i|r<<a|n,oo=e}function sv(e){e.return!==null&&(tc(e,1),K3(e,1,0))}function ov(e){for(;e===$1;)$1=T0[--C0],T0[C0]=null,W1=T0[--C0],T0[C0]=null;for(;e===Sc;)Sc=Li[--Pi],Li[Pi]=null,oo=Li[--Pi],Li[Pi]=null,so=Li[--Pi],Li[Pi]=null}var di=null,ui=null,$r=!1,as=null;function Y3(e,t){var r=Oi(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function ow(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,di=e,ui=fl(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,di=e,ui=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Sc!==null?{id:so,overflow:oo}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Oi(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,di=e,ui=null,!0):!1;default:return!1}}function L2(e){return(e.mode&1)!==0&&(e.flags&128)===0}function P2(e){if($r){var t=ui;if(t){var r=t;if(!ow(e,t)){if(L2(e))throw Error(He(418));t=fl(r.nextSibling);var n=di;t&&ow(e,t)?Y3(n,r):(e.flags=e.flags&-4097|2,$r=!1,di=e)}}else{if(L2(e))throw Error(He(418));e.flags=e.flags&-4097|2,$r=!1,di=e}}}function lw(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;di=e}function Od(e){if(e!==di)return!1;if(!$r)return lw(e),$r=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!A2(e.type,e.memoizedProps)),t&&(t=ui)){if(L2(e))throw J3(),Error(He(418));for(;t;)Y3(e,t),t=fl(t.nextSibling)}if(lw(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(He(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){ui=fl(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}ui=null}}else ui=di?fl(e.stateNode.nextSibling):null;return!0}function J3(){for(var e=ui;e;)e=fl(e.nextSibling)}function Z0(){ui=di=null,$r=!1}function lv(e){as===null?as=[e]:as.push(e)}var CT=yo.ReactCurrentBatchConfig;function ef(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(He(309));var n=r.stateNode}if(!n)throw Error(He(147,e));var a=n,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(s){var o=a.refs;s===null?delete o[i]:o[i]=s},t._stringRef=i,t)}if(typeof e!="string")throw Error(He(284));if(!r._owner)throw Error(He(290,e))}return e}function jd(e,t){throw e=Object.prototype.toString.call(t),Error(He(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function cw(e){var t=e._init;return t(e._payload)}function Z3(e){function t(_,b){if(e){var y=_.deletions;y===null?(_.deletions=[b],_.flags|=16):y.push(b)}}function r(_,b){if(!e)return null;for(;b!==null;)t(_,b),b=b.sibling;return null}function n(_,b){for(_=new Map;b!==null;)b.key!==null?_.set(b.key,b):_.set(b.index,b),b=b.sibling;return _}function a(_,b){return _=ml(_,b),_.index=0,_.sibling=null,_}function i(_,b,y){return _.index=y,e?(y=_.alternate,y!==null?(y=y.index,y<b?(_.flags|=2,b):y):(_.flags|=2,b)):(_.flags|=1048576,b)}function s(_){return e&&_.alternate===null&&(_.flags|=2),_}function o(_,b,y,N){return b===null||b.tag!==6?(b=ig(y,_.mode,N),b.return=_,b):(b=a(b,y),b.return=_,b)}function l(_,b,y,N){var R=y.type;return R===b0?u(_,b,y.props.children,N,y.key):b!==null&&(b.elementType===R||typeof R=="object"&&R!==null&&R.$$typeof===Ko&&cw(R)===b.type)?(N=a(b,y.props),N.ref=ef(_,b,y),N.return=_,N):(N=b1(y.type,y.key,y.props,null,_.mode,N),N.ref=ef(_,b,y),N.return=_,N)}function c(_,b,y,N){return b===null||b.tag!==4||b.stateNode.containerInfo!==y.containerInfo||b.stateNode.implementation!==y.implementation?(b=sg(y,_.mode,N),b.return=_,b):(b=a(b,y.children||[]),b.return=_,b)}function u(_,b,y,N,R){return b===null||b.tag!==7?(b=gc(y,_.mode,N,R),b.return=_,b):(b=a(b,y),b.return=_,b)}function h(_,b,y){if(typeof b=="string"&&b!==""||typeof b=="number")return b=ig(""+b,_.mode,y),b.return=_,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Sd:return y=b1(b.type,b.key,b.props,null,_.mode,y),y.ref=ef(_,null,b),y.return=_,y;case y0:return b=sg(b,_.mode,y),b.return=_,b;case Ko:var N=b._init;return h(_,N(b._payload),y)}if(uf(b)||Ku(b))return b=gc(b,_.mode,y,null),b.return=_,b;jd(_,b)}return null}function m(_,b,y,N){var R=b!==null?b.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return R!==null?null:o(_,b,""+y,N);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Sd:return y.key===R?l(_,b,y,N):null;case y0:return y.key===R?c(_,b,y,N):null;case Ko:return R=y._init,m(_,b,R(y._payload),N)}if(uf(y)||Ku(y))return R!==null?null:u(_,b,y,N,null);jd(_,y)}return null}function f(_,b,y,N,R){if(typeof N=="string"&&N!==""||typeof N=="number")return _=_.get(y)||null,o(b,_,""+N,R);if(typeof N=="object"&&N!==null){switch(N.$$typeof){case Sd:return _=_.get(N.key===null?y:N.key)||null,l(b,_,N,R);case y0:return _=_.get(N.key===null?y:N.key)||null,c(b,_,N,R);case Ko:var P=N._init;return f(_,b,y,P(N._payload),R)}if(uf(N)||Ku(N))return _=_.get(y)||null,u(b,_,N,R,null);jd(b,N)}return null}function v(_,b,y,N){for(var R=null,P=null,F=b,C=b=0,A=null;F!==null&&C<y.length;C++){F.index>C?(A=F,F=null):A=F.sibling;var W=m(_,F,y[C],N);if(W===null){F===null&&(F=A);break}e&&F&&W.alternate===null&&t(_,F),b=i(W,b,C),P===null?R=W:P.sibling=W,P=W,F=A}if(C===y.length)return r(_,F),$r&&tc(_,C),R;if(F===null){for(;C<y.length;C++)F=h(_,y[C],N),F!==null&&(b=i(F,b,C),P===null?R=F:P.sibling=F,P=F);return $r&&tc(_,C),R}for(F=n(_,F);C<y.length;C++)A=f(F,_,C,y[C],N),A!==null&&(e&&A.alternate!==null&&F.delete(A.key===null?C:A.key),b=i(A,b,C),P===null?R=A:P.sibling=A,P=A);return e&&F.forEach(function(L){return t(_,L)}),$r&&tc(_,C),R}function x(_,b,y,N){var R=Ku(y);if(typeof R!="function")throw Error(He(150));if(y=R.call(y),y==null)throw Error(He(151));for(var P=R=null,F=b,C=b=0,A=null,W=y.next();F!==null&&!W.done;C++,W=y.next()){F.index>C?(A=F,F=null):A=F.sibling;var L=m(_,F,W.value,N);if(L===null){F===null&&(F=A);break}e&&F&&L.alternate===null&&t(_,F),b=i(L,b,C),P===null?R=L:P.sibling=L,P=L,F=A}if(W.done)return r(_,F),$r&&tc(_,C),R;if(F===null){for(;!W.done;C++,W=y.next())W=h(_,W.value,N),W!==null&&(b=i(W,b,C),P===null?R=W:P.sibling=W,P=W);return $r&&tc(_,C),R}for(F=n(_,F);!W.done;C++,W=y.next())W=f(F,_,C,W.value,N),W!==null&&(e&&W.alternate!==null&&F.delete(W.key===null?C:W.key),b=i(W,b,C),P===null?R=W:P.sibling=W,P=W);return e&&F.forEach(function(I){return t(_,I)}),$r&&tc(_,C),R}function w(_,b,y,N){if(typeof y=="object"&&y!==null&&y.type===b0&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case Sd:e:{for(var R=y.key,P=b;P!==null;){if(P.key===R){if(R=y.type,R===b0){if(P.tag===7){r(_,P.sibling),b=a(P,y.props.children),b.return=_,_=b;break e}}else if(P.elementType===R||typeof R=="object"&&R!==null&&R.$$typeof===Ko&&cw(R)===P.type){r(_,P.sibling),b=a(P,y.props),b.ref=ef(_,P,y),b.return=_,_=b;break e}r(_,P);break}else t(_,P);P=P.sibling}y.type===b0?(b=gc(y.props.children,_.mode,N,y.key),b.return=_,_=b):(N=b1(y.type,y.key,y.props,null,_.mode,N),N.ref=ef(_,b,y),N.return=_,_=N)}return s(_);case y0:e:{for(P=y.key;b!==null;){if(b.key===P)if(b.tag===4&&b.stateNode.containerInfo===y.containerInfo&&b.stateNode.implementation===y.implementation){r(_,b.sibling),b=a(b,y.children||[]),b.return=_,_=b;break e}else{r(_,b);break}else t(_,b);b=b.sibling}b=sg(y,_.mode,N),b.return=_,_=b}return s(_);case Ko:return P=y._init,w(_,b,P(y._payload),N)}if(uf(y))return v(_,b,y,N);if(Ku(y))return x(_,b,y,N);jd(_,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,b!==null&&b.tag===6?(r(_,b.sibling),b=a(b,y),b.return=_,_=b):(r(_,b),b=ig(y,_.mode,N),b.return=_,_=b),s(_)):r(_,b)}return w}var Q0=Z3(!0),Q3=Z3(!1),H1=Al(null),V1=null,F0=null,cv=null;function uv(){cv=F0=V1=null}function fv(e){var t=H1.current;Rr(H1),e._currentValue=t}function I2(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function B0(e,t){V1=e,cv=F0=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(za=!0),e.firstContext=null)}function Mi(e){var t=e._currentValue;if(cv!==e)if(e={context:e,memoizedValue:t,next:null},F0===null){if(V1===null)throw Error(He(308));F0=e,V1.dependencies={lanes:0,firstContext:e}}else F0=F0.next=e;return t}var cc=null;function hv(e){cc===null?cc=[e]:cc.push(e)}function ek(e,t,r,n){var a=t.interleaved;return a===null?(r.next=r,hv(t)):(r.next=a.next,a.next=r),t.interleaved=r,vo(e,n)}function vo(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Yo=!1;function dv(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function tk(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function co(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function hl(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,nr&2){var a=n.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),n.pending=t,vo(e,r)}return a=n.interleaved,a===null?(t.next=t,hv(n)):(t.next=a.next,a.next=t),n.interleaved=t,vo(e,r)}function g1(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Zx(e,r)}}function uw(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var a=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var s={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?a=i=s:i=i.next=s,r=r.next}while(r!==null);i===null?a=i=t:i=i.next=t}else a=i=t;r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function q1(e,t,r,n){var a=e.updateQueue;Yo=!1;var i=a.firstBaseUpdate,s=a.lastBaseUpdate,o=a.shared.pending;if(o!==null){a.shared.pending=null;var l=o,c=l.next;l.next=null,s===null?i=c:s.next=c,s=l;var u=e.alternate;u!==null&&(u=u.updateQueue,o=u.lastBaseUpdate,o!==s&&(o===null?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(i!==null){var h=a.baseState;s=0,u=c=l=null,o=i;do{var m=o.lane,f=o.eventTime;if((n&m)===m){u!==null&&(u=u.next={eventTime:f,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var v=e,x=o;switch(m=t,f=r,x.tag){case 1:if(v=x.payload,typeof v=="function"){h=v.call(f,h,m);break e}h=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=x.payload,m=typeof v=="function"?v.call(f,h,m):v,m==null)break e;h=Xr({},h,m);break e;case 2:Yo=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,m=a.effects,m===null?a.effects=[o]:m.push(o))}else f={eventTime:f,lane:m,tag:o.tag,payload:o.payload,callback:o.callback,next:null},u===null?(c=u=f,l=h):u=u.next=f,s|=m;if(o=o.next,o===null){if(o=a.shared.pending,o===null)break;m=o,o=m.next,m.next=null,a.lastBaseUpdate=m,a.shared.pending=null}}while(!0);if(u===null&&(l=h),a.baseState=l,a.firstBaseUpdate=c,a.lastBaseUpdate=u,t=a.shared.interleaved,t!==null){a=t;do s|=a.lane,a=a.next;while(a!==t)}else i===null&&(a.shared.lanes=0);Ec|=s,e.lanes=s,e.memoizedState=h}}function fw(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],a=n.callback;if(a!==null){if(n.callback=null,n=r,typeof a!="function")throw Error(He(191,a));a.call(n)}}}var Ph={},Os=Al(Ph),eh=Al(Ph),th=Al(Ph);function uc(e){if(e===Ph)throw Error(He(174));return e}function pv(e,t){switch(Fr(th,t),Fr(eh,e),Fr(Os,Ph),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:d2(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=d2(t,e)}Rr(Os),Fr(Os,t)}function eu(){Rr(Os),Rr(eh),Rr(th)}function rk(e){uc(th.current);var t=uc(Os.current),r=d2(t,e.type);t!==r&&(Fr(eh,e),Fr(Os,r))}function mv(e){eh.current===e&&(Rr(Os),Rr(eh))}var Hr=Al(0);function G1(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Qm=[];function gv(){for(var e=0;e<Qm.length;e++)Qm[e]._workInProgressVersionPrimary=null;Qm.length=0}var x1=yo.ReactCurrentDispatcher,eg=yo.ReactCurrentBatchConfig,Nc=0,Gr=null,In=null,Un=null,X1=!1,Sf=!1,rh=0,FT=0;function sa(){throw Error(He(321))}function xv(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!fs(e[r],t[r]))return!1;return!0}function vv(e,t,r,n,a,i){if(Nc=i,Gr=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,x1.current=e===null||e.memoizedState===null?OT:jT,e=r(n,a),Sf){i=0;do{if(Sf=!1,rh=0,25<=i)throw Error(He(301));i+=1,Un=In=null,t.updateQueue=null,x1.current=RT,e=r(n,a)}while(Sf)}if(x1.current=K1,t=In!==null&&In.next!==null,Nc=0,Un=In=Gr=null,X1=!1,t)throw Error(He(300));return e}function _v(){var e=rh!==0;return rh=0,e}function As(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Un===null?Gr.memoizedState=Un=e:Un=Un.next=e,Un}function Bi(){if(In===null){var e=Gr.alternate;e=e!==null?e.memoizedState:null}else e=In.next;var t=Un===null?Gr.memoizedState:Un.next;if(t!==null)Un=t,In=e;else{if(e===null)throw Error(He(310));In=e,e={memoizedState:In.memoizedState,baseState:In.baseState,baseQueue:In.baseQueue,queue:In.queue,next:null},Un===null?Gr.memoizedState=Un=e:Un=Un.next=e}return Un}function nh(e,t){return typeof t=="function"?t(e):t}function tg(e){var t=Bi(),r=t.queue;if(r===null)throw Error(He(311));r.lastRenderedReducer=e;var n=In,a=n.baseQueue,i=r.pending;if(i!==null){if(a!==null){var s=a.next;a.next=i.next,i.next=s}n.baseQueue=a=i,r.pending=null}if(a!==null){i=a.next,n=n.baseState;var o=s=null,l=null,c=i;do{var u=c.lane;if((Nc&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:e(n,c.action);else{var h={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(o=l=h,s=n):l=l.next=h,Gr.lanes|=u,Ec|=u}c=c.next}while(c!==null&&c!==i);l===null?s=n:l.next=o,fs(n,t.memoizedState)||(za=!0),t.memoizedState=n,t.baseState=s,t.baseQueue=l,r.lastRenderedState=n}if(e=r.interleaved,e!==null){a=e;do i=a.lane,Gr.lanes|=i,Ec|=i,a=a.next;while(a!==e)}else a===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function rg(e){var t=Bi(),r=t.queue;if(r===null)throw Error(He(311));r.lastRenderedReducer=e;var n=r.dispatch,a=r.pending,i=t.memoizedState;if(a!==null){r.pending=null;var s=a=a.next;do i=e(i,s.action),s=s.next;while(s!==a);fs(i,t.memoizedState)||(za=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),r.lastRenderedState=i}return[i,n]}function nk(){}function ak(e,t){var r=Gr,n=Bi(),a=t(),i=!fs(n.memoizedState,a);if(i&&(n.memoizedState=a,za=!0),n=n.queue,wv(ok.bind(null,r,n,e),[e]),n.getSnapshot!==t||i||Un!==null&&Un.memoizedState.tag&1){if(r.flags|=2048,ah(9,sk.bind(null,r,n,a,t),void 0,null),Hn===null)throw Error(He(349));Nc&30||ik(r,t,a)}return a}function ik(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Gr.updateQueue,t===null?(t={lastEffect:null,stores:null},Gr.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function sk(e,t,r,n){t.value=r,t.getSnapshot=n,lk(t)&&ck(e)}function ok(e,t,r){return r(function(){lk(t)&&ck(e)})}function lk(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!fs(e,r)}catch{return!0}}function ck(e){var t=vo(e,1);t!==null&&ls(t,e,1,-1)}function hw(e){var t=As();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:nh,lastRenderedState:e},t.queue=e,e=e.dispatch=IT.bind(null,Gr,e),[t.memoizedState,e]}function ah(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Gr.updateQueue,t===null?(t={lastEffect:null,stores:null},Gr.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function uk(){return Bi().memoizedState}function v1(e,t,r,n){var a=As();Gr.flags|=e,a.memoizedState=ah(1|t,r,void 0,n===void 0?null:n)}function Fp(e,t,r,n){var a=Bi();n=n===void 0?null:n;var i=void 0;if(In!==null){var s=In.memoizedState;if(i=s.destroy,n!==null&&xv(n,s.deps)){a.memoizedState=ah(t,r,i,n);return}}Gr.flags|=e,a.memoizedState=ah(1|t,r,i,n)}function dw(e,t){return v1(8390656,8,e,t)}function wv(e,t){return Fp(2048,8,e,t)}function fk(e,t){return Fp(4,2,e,t)}function hk(e,t){return Fp(4,4,e,t)}function dk(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function pk(e,t,r){return r=r!=null?r.concat([e]):null,Fp(4,4,dk.bind(null,t,e),r)}function yv(){}function mk(e,t){var r=Bi();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&xv(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function gk(e,t){var r=Bi();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&xv(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function xk(e,t,r){return Nc&21?(fs(r,t)||(r=b3(),Gr.lanes|=r,Ec|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,za=!0),e.memoizedState=r)}function LT(e,t){var r=wr;wr=r!==0&&4>r?r:4,e(!0);var n=eg.transition;eg.transition={};try{e(!1),t()}finally{wr=r,eg.transition=n}}function vk(){return Bi().memoizedState}function PT(e,t,r){var n=pl(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},_k(e))wk(t,r);else if(r=ek(e,t,r,n),r!==null){var a=Fa();ls(r,e,n,a),yk(r,t,n)}}function IT(e,t,r){var n=pl(e),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(_k(e))wk(t,a);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var s=t.lastRenderedState,o=i(s,r);if(a.hasEagerState=!0,a.eagerState=o,fs(o,s)){var l=t.interleaved;l===null?(a.next=a,hv(t)):(a.next=l.next,l.next=a),t.interleaved=a;return}}catch{}finally{}r=ek(e,t,a,n),r!==null&&(a=Fa(),ls(r,e,n,a),yk(r,t,n))}}function _k(e){var t=e.alternate;return e===Gr||t!==null&&t===Gr}function wk(e,t){Sf=X1=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function yk(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Zx(e,r)}}var K1={readContext:Mi,useCallback:sa,useContext:sa,useEffect:sa,useImperativeHandle:sa,useInsertionEffect:sa,useLayoutEffect:sa,useMemo:sa,useReducer:sa,useRef:sa,useState:sa,useDebugValue:sa,useDeferredValue:sa,useTransition:sa,useMutableSource:sa,useSyncExternalStore:sa,useId:sa,unstable_isNewReconciler:!1},OT={readContext:Mi,useCallback:function(e,t){return As().memoizedState=[e,t===void 0?null:t],e},useContext:Mi,useEffect:dw,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,v1(4194308,4,dk.bind(null,t,e),r)},useLayoutEffect:function(e,t){return v1(4194308,4,e,t)},useInsertionEffect:function(e,t){return v1(4,2,e,t)},useMemo:function(e,t){var r=As();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=As();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=PT.bind(null,Gr,e),[n.memoizedState,e]},useRef:function(e){var t=As();return e={current:e},t.memoizedState=e},useState:hw,useDebugValue:yv,useDeferredValue:function(e){return As().memoizedState=e},useTransition:function(){var e=hw(!1),t=e[0];return e=LT.bind(null,e[1]),As().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Gr,a=As();if($r){if(r===void 0)throw Error(He(407));r=r()}else{if(r=t(),Hn===null)throw Error(He(349));Nc&30||ik(n,t,r)}a.memoizedState=r;var i={value:r,getSnapshot:t};return a.queue=i,dw(ok.bind(null,n,i,e),[e]),n.flags|=2048,ah(9,sk.bind(null,n,i,r,t),void 0,null),r},useId:function(){var e=As(),t=Hn.identifierPrefix;if($r){var r=oo,n=so;r=(n&~(1<<32-os(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=rh++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=FT++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},jT={readContext:Mi,useCallback:mk,useContext:Mi,useEffect:wv,useImperativeHandle:pk,useInsertionEffect:fk,useLayoutEffect:hk,useMemo:gk,useReducer:tg,useRef:uk,useState:function(){return tg(nh)},useDebugValue:yv,useDeferredValue:function(e){var t=Bi();return xk(t,In.memoizedState,e)},useTransition:function(){var e=tg(nh)[0],t=Bi().memoizedState;return[e,t]},useMutableSource:nk,useSyncExternalStore:ak,useId:vk,unstable_isNewReconciler:!1},RT={readContext:Mi,useCallback:mk,useContext:Mi,useEffect:wv,useImperativeHandle:pk,useInsertionEffect:fk,useLayoutEffect:hk,useMemo:gk,useReducer:rg,useRef:uk,useState:function(){return rg(nh)},useDebugValue:yv,useDeferredValue:function(e){var t=Bi();return In===null?t.memoizedState=e:xk(t,In.memoizedState,e)},useTransition:function(){var e=rg(nh)[0],t=Bi().memoizedState;return[e,t]},useMutableSource:nk,useSyncExternalStore:ak,useId:vk,unstable_isNewReconciler:!1};function ts(e,t){if(e&&e.defaultProps){t=Xr({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function O2(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Xr({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var Lp={isMounted:function(e){return(e=e._reactInternals)?Mc(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Fa(),a=pl(e),i=co(n,a);i.payload=t,r!=null&&(i.callback=r),t=hl(e,i,a),t!==null&&(ls(t,e,a,n),g1(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Fa(),a=pl(e),i=co(n,a);i.tag=1,i.payload=t,r!=null&&(i.callback=r),t=hl(e,i,a),t!==null&&(ls(t,e,a,n),g1(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Fa(),n=pl(e),a=co(r,n);a.tag=2,t!=null&&(a.callback=t),t=hl(e,a,n),t!==null&&(ls(t,e,n,r),g1(t,e,n))}};function pw(e,t,r,n,a,i,s){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,i,s):t.prototype&&t.prototype.isPureReactComponent?!Yf(r,n)||!Yf(a,i):!0}function bk(e,t,r){var n=!1,a=wl,i=t.contextType;return typeof i=="object"&&i!==null?i=Mi(i):(a=Ha(t)?kc:_a.current,n=t.contextTypes,i=(n=n!=null)?J0(e,a):wl),t=new t(r,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Lp,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=i),t}function mw(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&Lp.enqueueReplaceState(t,t.state,null)}function j2(e,t,r,n){var a=e.stateNode;a.props=r,a.state=e.memoizedState,a.refs={},dv(e);var i=t.contextType;typeof i=="object"&&i!==null?a.context=Mi(i):(i=Ha(t)?kc:_a.current,a.context=J0(e,i)),a.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(O2(e,t,i,r),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&Lp.enqueueReplaceState(a,a.state,null),q1(e,r,a,n),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function tu(e,t){try{var r="",n=t;do r+=uA(n),n=n.return;while(n);var a=r}catch(i){a=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:a,digest:null}}function ng(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function R2(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var DT=typeof WeakMap=="function"?WeakMap:Map;function kk(e,t,r){r=co(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){J1||(J1=!0,q2=n),R2(e,t)},r}function Sk(e,t,r){r=co(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var a=t.value;r.payload=function(){return n(a)},r.callback=function(){R2(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){R2(e,t),typeof n!="function"&&(dl===null?dl=new Set([this]):dl.add(this));var s=t.stack;this.componentDidCatch(t.value,{componentStack:s!==null?s:""})}),r}function gw(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new DT;var a=new Set;n.set(t,a)}else a=n.get(t),a===void 0&&(a=new Set,n.set(t,a));a.has(r)||(a.add(r),e=JT.bind(null,e,t,r),t.then(e,e))}function xw(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function vw(e,t,r,n,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=co(-1,1),t.tag=2,hl(r,t,1))),r.lanes|=1),e)}var MT=yo.ReactCurrentOwner,za=!1;function Ea(e,t,r,n){t.child=e===null?Q3(t,null,r,n):Q0(t,e.child,r,n)}function _w(e,t,r,n,a){r=r.render;var i=t.ref;return B0(t,a),n=vv(e,t,r,n,i,a),r=_v(),e!==null&&!za?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,_o(e,t,a)):($r&&r&&sv(t),t.flags|=1,Ea(e,t,n,a),t.child)}function ww(e,t,r,n,a){if(e===null){var i=r.type;return typeof i=="function"&&!Cv(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=i,Nk(e,t,i,n,a)):(e=b1(r.type,null,n,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&a)){var s=i.memoizedProps;if(r=r.compare,r=r!==null?r:Yf,r(s,n)&&e.ref===t.ref)return _o(e,t,a)}return t.flags|=1,e=ml(i,n),e.ref=t.ref,e.return=t,t.child=e}function Nk(e,t,r,n,a){if(e!==null){var i=e.memoizedProps;if(Yf(i,n)&&e.ref===t.ref)if(za=!1,t.pendingProps=n=i,(e.lanes&a)!==0)e.flags&131072&&(za=!0);else return t.lanes=e.lanes,_o(e,t,a)}return D2(e,t,r,n,a)}function Ek(e,t,r){var n=t.pendingProps,a=n.children,i=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Fr(P0,ii),ii|=r;else{if(!(r&1073741824))return e=i!==null?i.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Fr(P0,ii),ii|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,Fr(P0,ii),ii|=n}else i!==null?(n=i.baseLanes|r,t.memoizedState=null):n=r,Fr(P0,ii),ii|=n;return Ea(e,t,a,r),t.child}function Ak(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function D2(e,t,r,n,a){var i=Ha(r)?kc:_a.current;return i=J0(t,i),B0(t,a),r=vv(e,t,r,n,i,a),n=_v(),e!==null&&!za?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,_o(e,t,a)):($r&&n&&sv(t),t.flags|=1,Ea(e,t,r,a),t.child)}function yw(e,t,r,n,a){if(Ha(r)){var i=!0;z1(t)}else i=!1;if(B0(t,a),t.stateNode===null)_1(e,t),bk(t,r,n),j2(t,r,n,a),n=!0;else if(e===null){var s=t.stateNode,o=t.memoizedProps;s.props=o;var l=s.context,c=r.contextType;typeof c=="object"&&c!==null?c=Mi(c):(c=Ha(r)?kc:_a.current,c=J0(t,c));var u=r.getDerivedStateFromProps,h=typeof u=="function"||typeof s.getSnapshotBeforeUpdate=="function";h||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(o!==n||l!==c)&&mw(t,s,n,c),Yo=!1;var m=t.memoizedState;s.state=m,q1(t,n,s,a),l=t.memoizedState,o!==n||m!==l||Wa.current||Yo?(typeof u=="function"&&(O2(t,r,u,n),l=t.memoizedState),(o=Yo||pw(t,r,o,n,m,l,c))?(h||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(t.flags|=4194308)):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),s.props=n,s.state=l,s.context=c,n=o):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{s=t.stateNode,tk(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:ts(t.type,o),s.props=c,h=t.pendingProps,m=s.context,l=r.contextType,typeof l=="object"&&l!==null?l=Mi(l):(l=Ha(r)?kc:_a.current,l=J0(t,l));var f=r.getDerivedStateFromProps;(u=typeof f=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(o!==h||m!==l)&&mw(t,s,n,l),Yo=!1,m=t.memoizedState,s.state=m,q1(t,n,s,a);var v=t.memoizedState;o!==h||m!==v||Wa.current||Yo?(typeof f=="function"&&(O2(t,r,f,n),v=t.memoizedState),(c=Yo||pw(t,r,c,n,m,v,l)||!1)?(u||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(n,v,l),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(n,v,l)),typeof s.componentDidUpdate=="function"&&(t.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof s.componentDidUpdate!="function"||o===e.memoizedProps&&m===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&m===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=v),s.props=n,s.state=v,s.context=l,n=c):(typeof s.componentDidUpdate!="function"||o===e.memoizedProps&&m===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&m===e.memoizedState||(t.flags|=1024),n=!1)}return M2(e,t,r,n,i,a)}function M2(e,t,r,n,a,i){Ak(e,t);var s=(t.flags&128)!==0;if(!n&&!s)return a&&sw(t,r,!1),_o(e,t,i);n=t.stateNode,MT.current=t;var o=s&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&s?(t.child=Q0(t,e.child,null,i),t.child=Q0(t,null,o,i)):Ea(e,t,o,i),t.memoizedState=n.state,a&&sw(t,r,!0),t.child}function Tk(e){var t=e.stateNode;t.pendingContext?iw(e,t.pendingContext,t.pendingContext!==t.context):t.context&&iw(e,t.context,!1),pv(e,t.containerInfo)}function bw(e,t,r,n,a){return Z0(),lv(a),t.flags|=256,Ea(e,t,r,n),t.child}var B2={dehydrated:null,treeContext:null,retryLane:0};function U2(e){return{baseLanes:e,cachePool:null,transitions:null}}function Ck(e,t,r){var n=t.pendingProps,a=Hr.current,i=!1,s=(t.flags&128)!==0,o;if((o=s)||(o=e!==null&&e.memoizedState===null?!1:(a&2)!==0),o?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),Fr(Hr,a&1),e===null)return P2(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(s=n.children,e=n.fallback,i?(n=t.mode,i=t.child,s={mode:"hidden",children:s},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=s):i=Op(s,n,0,null),e=gc(e,n,r,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=U2(r),t.memoizedState=B2,e):bv(t,s));if(a=e.memoizedState,a!==null&&(o=a.dehydrated,o!==null))return BT(e,t,s,n,o,a,r);if(i){i=n.fallback,s=t.mode,a=e.child,o=a.sibling;var l={mode:"hidden",children:n.children};return!(s&1)&&t.child!==a?(n=t.child,n.childLanes=0,n.pendingProps=l,t.deletions=null):(n=ml(a,l),n.subtreeFlags=a.subtreeFlags&14680064),o!==null?i=ml(o,i):(i=gc(i,s,r,null),i.flags|=2),i.return=t,n.return=t,n.sibling=i,t.child=n,n=i,i=t.child,s=e.child.memoizedState,s=s===null?U2(r):{baseLanes:s.baseLanes|r,cachePool:null,transitions:s.transitions},i.memoizedState=s,i.childLanes=e.childLanes&~r,t.memoizedState=B2,n}return i=e.child,e=i.sibling,n=ml(i,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function bv(e,t){return t=Op({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Rd(e,t,r,n){return n!==null&&lv(n),Q0(t,e.child,null,r),e=bv(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function BT(e,t,r,n,a,i,s){if(r)return t.flags&256?(t.flags&=-257,n=ng(Error(He(422))),Rd(e,t,s,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=n.fallback,a=t.mode,n=Op({mode:"visible",children:n.children},a,0,null),i=gc(i,a,s,null),i.flags|=2,n.return=t,i.return=t,n.sibling=i,t.child=n,t.mode&1&&Q0(t,e.child,null,s),t.child.memoizedState=U2(s),t.memoizedState=B2,i);if(!(t.mode&1))return Rd(e,t,s,null);if(a.data==="$!"){if(n=a.nextSibling&&a.nextSibling.dataset,n)var o=n.dgst;return n=o,i=Error(He(419)),n=ng(i,n,void 0),Rd(e,t,s,n)}if(o=(s&e.childLanes)!==0,za||o){if(n=Hn,n!==null){switch(s&-s){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(n.suspendedLanes|s)?0:a,a!==0&&a!==i.retryLane&&(i.retryLane=a,vo(e,a),ls(n,e,a,-1))}return Tv(),n=ng(Error(He(421))),Rd(e,t,s,n)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=ZT.bind(null,e),a._reactRetry=t,null):(e=i.treeContext,ui=fl(a.nextSibling),di=t,$r=!0,as=null,e!==null&&(Li[Pi++]=so,Li[Pi++]=oo,Li[Pi++]=Sc,so=e.id,oo=e.overflow,Sc=t),t=bv(t,n.children),t.flags|=4096,t)}function kw(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),I2(e.return,t,r)}function ag(e,t,r,n,a){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=a)}function Fk(e,t,r){var n=t.pendingProps,a=n.revealOrder,i=n.tail;if(Ea(e,t,n.children,r),n=Hr.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&kw(e,r,t);else if(e.tag===19)kw(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Fr(Hr,n),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(r=t.child,a=null;r!==null;)e=r.alternate,e!==null&&G1(e)===null&&(a=r),r=r.sibling;r=a,r===null?(a=t.child,t.child=null):(a=r.sibling,r.sibling=null),ag(t,!1,a,r,i);break;case"backwards":for(r=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&G1(e)===null){t.child=a;break}e=a.sibling,a.sibling=r,r=a,a=e}ag(t,!0,r,null,i);break;case"together":ag(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function _1(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function _o(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Ec|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(He(153));if(t.child!==null){for(e=t.child,r=ml(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=ml(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function UT(e,t,r){switch(t.tag){case 3:Tk(t),Z0();break;case 5:rk(t);break;case 1:Ha(t.type)&&z1(t);break;case 4:pv(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,a=t.memoizedProps.value;Fr(H1,n._currentValue),n._currentValue=a;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(Fr(Hr,Hr.current&1),t.flags|=128,null):r&t.child.childLanes?Ck(e,t,r):(Fr(Hr,Hr.current&1),e=_o(e,t,r),e!==null?e.sibling:null);Fr(Hr,Hr.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return Fk(e,t,r);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),Fr(Hr,Hr.current),n)break;return null;case 22:case 23:return t.lanes=0,Ek(e,t,r)}return _o(e,t,r)}var Lk,z2,Pk,Ik;Lk=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};z2=function(){};Pk=function(e,t,r,n){var a=e.memoizedProps;if(a!==n){e=t.stateNode,uc(Os.current);var i=null;switch(r){case"input":a=c2(e,a),n=c2(e,n),i=[];break;case"select":a=Xr({},a,{value:void 0}),n=Xr({},n,{value:void 0}),i=[];break;case"textarea":a=h2(e,a),n=h2(e,n),i=[];break;default:typeof a.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=B1)}p2(r,n);var s;r=null;for(c in a)if(!n.hasOwnProperty(c)&&a.hasOwnProperty(c)&&a[c]!=null)if(c==="style"){var o=a[c];for(s in o)o.hasOwnProperty(s)&&(r||(r={}),r[s]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Wf.hasOwnProperty(c)?i||(i=[]):(i=i||[]).push(c,null));for(c in n){var l=n[c];if(o=a!=null?a[c]:void 0,n.hasOwnProperty(c)&&l!==o&&(l!=null||o!=null))if(c==="style")if(o){for(s in o)!o.hasOwnProperty(s)||l&&l.hasOwnProperty(s)||(r||(r={}),r[s]="");for(s in l)l.hasOwnProperty(s)&&o[s]!==l[s]&&(r||(r={}),r[s]=l[s])}else r||(i||(i=[]),i.push(c,r)),r=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(i=i||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Wf.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&Pr("scroll",e),i||o===l||(i=[])):(i=i||[]).push(c,l))}r&&(i=i||[]).push("style",r);var c=i;(t.updateQueue=c)&&(t.flags|=4)}};Ik=function(e,t,r,n){r!==n&&(t.flags|=4)};function tf(e,t){if(!$r)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function oa(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags&14680064,n|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function zT(e,t,r){var n=t.pendingProps;switch(ov(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return oa(t),null;case 1:return Ha(t.type)&&U1(),oa(t),null;case 3:return n=t.stateNode,eu(),Rr(Wa),Rr(_a),gv(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Od(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,as!==null&&(K2(as),as=null))),z2(e,t),oa(t),null;case 5:mv(t);var a=uc(th.current);if(r=t.type,e!==null&&t.stateNode!=null)Pk(e,t,r,n,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(He(166));return oa(t),null}if(e=uc(Os.current),Od(t)){n=t.stateNode,r=t.type;var i=t.memoizedProps;switch(n[Cs]=t,n[Qf]=i,e=(t.mode&1)!==0,r){case"dialog":Pr("cancel",n),Pr("close",n);break;case"iframe":case"object":case"embed":Pr("load",n);break;case"video":case"audio":for(a=0;a<hf.length;a++)Pr(hf[a],n);break;case"source":Pr("error",n);break;case"img":case"image":case"link":Pr("error",n),Pr("load",n);break;case"details":Pr("toggle",n);break;case"input":P5(n,i),Pr("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},Pr("invalid",n);break;case"textarea":O5(n,i),Pr("invalid",n)}p2(r,i),a=null;for(var s in i)if(i.hasOwnProperty(s)){var o=i[s];s==="children"?typeof o=="string"?n.textContent!==o&&(i.suppressHydrationWarning!==!0&&Id(n.textContent,o,e),a=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(i.suppressHydrationWarning!==!0&&Id(n.textContent,o,e),a=["children",""+o]):Wf.hasOwnProperty(s)&&o!=null&&s==="onScroll"&&Pr("scroll",n)}switch(r){case"input":Nd(n),I5(n,i,!0);break;case"textarea":Nd(n),j5(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=B1)}n=a,t.updateQueue=n,n!==null&&(t.flags|=4)}else{s=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=o3(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=s.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=s.createElement(r,{is:n.is}):(e=s.createElement(r),r==="select"&&(s=e,n.multiple?s.multiple=!0:n.size&&(s.size=n.size))):e=s.createElementNS(e,r),e[Cs]=t,e[Qf]=n,Lk(e,t,!1,!1),t.stateNode=e;e:{switch(s=m2(r,n),r){case"dialog":Pr("cancel",e),Pr("close",e),a=n;break;case"iframe":case"object":case"embed":Pr("load",e),a=n;break;case"video":case"audio":for(a=0;a<hf.length;a++)Pr(hf[a],e);a=n;break;case"source":Pr("error",e),a=n;break;case"img":case"image":case"link":Pr("error",e),Pr("load",e),a=n;break;case"details":Pr("toggle",e),a=n;break;case"input":P5(e,n),a=c2(e,n),Pr("invalid",e);break;case"option":a=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},a=Xr({},n,{value:void 0}),Pr("invalid",e);break;case"textarea":O5(e,n),a=h2(e,n),Pr("invalid",e);break;default:a=n}p2(r,a),o=a;for(i in o)if(o.hasOwnProperty(i)){var l=o[i];i==="style"?u3(e,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&l3(e,l)):i==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&Hf(e,l):typeof l=="number"&&Hf(e,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Wf.hasOwnProperty(i)?l!=null&&i==="onScroll"&&Pr("scroll",e):l!=null&&qx(e,i,l,s))}switch(r){case"input":Nd(e),I5(e,n,!1);break;case"textarea":Nd(e),j5(e);break;case"option":n.value!=null&&e.setAttribute("value",""+_l(n.value));break;case"select":e.multiple=!!n.multiple,i=n.value,i!=null?j0(e,!!n.multiple,i,!1):n.defaultValue!=null&&j0(e,!!n.multiple,n.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=B1)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return oa(t),null;case 6:if(e&&t.stateNode!=null)Ik(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(He(166));if(r=uc(th.current),uc(Os.current),Od(t)){if(n=t.stateNode,r=t.memoizedProps,n[Cs]=t,(i=n.nodeValue!==r)&&(e=di,e!==null))switch(e.tag){case 3:Id(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Id(n.nodeValue,r,(e.mode&1)!==0)}i&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Cs]=t,t.stateNode=n}return oa(t),null;case 13:if(Rr(Hr),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if($r&&ui!==null&&t.mode&1&&!(t.flags&128))J3(),Z0(),t.flags|=98560,i=!1;else if(i=Od(t),n!==null&&n.dehydrated!==null){if(e===null){if(!i)throw Error(He(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(He(317));i[Cs]=t}else Z0(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;oa(t),i=!1}else as!==null&&(K2(as),as=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Hr.current&1?jn===0&&(jn=3):Tv())),t.updateQueue!==null&&(t.flags|=4),oa(t),null);case 4:return eu(),z2(e,t),e===null&&Jf(t.stateNode.containerInfo),oa(t),null;case 10:return fv(t.type._context),oa(t),null;case 17:return Ha(t.type)&&U1(),oa(t),null;case 19:if(Rr(Hr),i=t.memoizedState,i===null)return oa(t),null;if(n=(t.flags&128)!==0,s=i.rendering,s===null)if(n)tf(i,!1);else{if(jn!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(s=G1(e),s!==null){for(t.flags|=128,tf(i,!1),n=s.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)i=r,e=n,i.flags&=14680066,s=i.alternate,s===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=s.childLanes,i.lanes=s.lanes,i.child=s.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=s.memoizedProps,i.memoizedState=s.memoizedState,i.updateQueue=s.updateQueue,i.type=s.type,e=s.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Fr(Hr,Hr.current&1|2),t.child}e=e.sibling}i.tail!==null&&hn()>ru&&(t.flags|=128,n=!0,tf(i,!1),t.lanes=4194304)}else{if(!n)if(e=G1(s),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),tf(i,!0),i.tail===null&&i.tailMode==="hidden"&&!s.alternate&&!$r)return oa(t),null}else 2*hn()-i.renderingStartTime>ru&&r!==1073741824&&(t.flags|=128,n=!0,tf(i,!1),t.lanes=4194304);i.isBackwards?(s.sibling=t.child,t.child=s):(r=i.last,r!==null?r.sibling=s:t.child=s,i.last=s)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=hn(),t.sibling=null,r=Hr.current,Fr(Hr,n?r&1|2:r&1),t):(oa(t),null);case 22:case 23:return Av(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?ii&1073741824&&(oa(t),t.subtreeFlags&6&&(t.flags|=8192)):oa(t),null;case 24:return null;case 25:return null}throw Error(He(156,t.tag))}function $T(e,t){switch(ov(t),t.tag){case 1:return Ha(t.type)&&U1(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return eu(),Rr(Wa),Rr(_a),gv(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return mv(t),null;case 13:if(Rr(Hr),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(He(340));Z0()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Rr(Hr),null;case 4:return eu(),null;case 10:return fv(t.type._context),null;case 22:case 23:return Av(),null;case 24:return null;default:return null}}var Dd=!1,ma=!1,WT=typeof WeakSet=="function"?WeakSet:Set,ot=null;function L0(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){en(e,t,n)}else r.current=null}function $2(e,t,r){try{r()}catch(n){en(e,t,n)}}var Sw=!1;function HT(e,t){if(N2=R1,e=M3(),iv(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var a=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var s=0,o=-1,l=-1,c=0,u=0,h=e,m=null;t:for(;;){for(var f;h!==r||a!==0&&h.nodeType!==3||(o=s+a),h!==i||n!==0&&h.nodeType!==3||(l=s+n),h.nodeType===3&&(s+=h.nodeValue.length),(f=h.firstChild)!==null;)m=h,h=f;for(;;){if(h===e)break t;if(m===r&&++c===a&&(o=s),m===i&&++u===n&&(l=s),(f=h.nextSibling)!==null)break;h=m,m=h.parentNode}h=f}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(E2={focusedElem:e,selectionRange:r},R1=!1,ot=t;ot!==null;)if(t=ot,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ot=e;else for(;ot!==null;){t=ot;try{var v=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var x=v.memoizedProps,w=v.memoizedState,_=t.stateNode,b=_.getSnapshotBeforeUpdate(t.elementType===t.type?x:ts(t.type,x),w);_.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var y=t.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(He(163))}}catch(N){en(t,t.return,N)}if(e=t.sibling,e!==null){e.return=t.return,ot=e;break}ot=t.return}return v=Sw,Sw=!1,v}function Nf(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&e)===e){var i=a.destroy;a.destroy=void 0,i!==void 0&&$2(t,r,i)}a=a.next}while(a!==n)}}function Pp(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function W2(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function Ok(e){var t=e.alternate;t!==null&&(e.alternate=null,Ok(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Cs],delete t[Qf],delete t[C2],delete t[ET],delete t[AT])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function jk(e){return e.tag===5||e.tag===3||e.tag===4}function Nw(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||jk(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function H2(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=B1));else if(n!==4&&(e=e.child,e!==null))for(H2(e,t,r),e=e.sibling;e!==null;)H2(e,t,r),e=e.sibling}function V2(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(V2(e,t,r),e=e.sibling;e!==null;)V2(e,t,r),e=e.sibling}var Yn=null,rs=!1;function $o(e,t,r){for(r=r.child;r!==null;)Rk(e,t,r),r=r.sibling}function Rk(e,t,r){if(Is&&typeof Is.onCommitFiberUnmount=="function")try{Is.onCommitFiberUnmount(Sp,r)}catch{}switch(r.tag){case 5:ma||L0(r,t);case 6:var n=Yn,a=rs;Yn=null,$o(e,t,r),Yn=n,rs=a,Yn!==null&&(rs?(e=Yn,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Yn.removeChild(r.stateNode));break;case 18:Yn!==null&&(rs?(e=Yn,r=r.stateNode,e.nodeType===8?Jm(e.parentNode,r):e.nodeType===1&&Jm(e,r),Xf(e)):Jm(Yn,r.stateNode));break;case 4:n=Yn,a=rs,Yn=r.stateNode.containerInfo,rs=!0,$o(e,t,r),Yn=n,rs=a;break;case 0:case 11:case 14:case 15:if(!ma&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){a=n=n.next;do{var i=a,s=i.destroy;i=i.tag,s!==void 0&&(i&2||i&4)&&$2(r,t,s),a=a.next}while(a!==n)}$o(e,t,r);break;case 1:if(!ma&&(L0(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){en(r,t,o)}$o(e,t,r);break;case 21:$o(e,t,r);break;case 22:r.mode&1?(ma=(n=ma)||r.memoizedState!==null,$o(e,t,r),ma=n):$o(e,t,r);break;default:$o(e,t,r)}}function Ew(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new WT),t.forEach(function(n){var a=QT.bind(null,e,n);r.has(n)||(r.add(n),n.then(a,a))})}}function Ji(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var a=r[n];try{var i=e,s=t,o=s;e:for(;o!==null;){switch(o.tag){case 5:Yn=o.stateNode,rs=!1;break e;case 3:Yn=o.stateNode.containerInfo,rs=!0;break e;case 4:Yn=o.stateNode.containerInfo,rs=!0;break e}o=o.return}if(Yn===null)throw Error(He(160));Rk(i,s,a),Yn=null,rs=!1;var l=a.alternate;l!==null&&(l.return=null),a.return=null}catch(c){en(a,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Dk(t,e),t=t.sibling}function Dk(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Ji(t,e),ys(e),n&4){try{Nf(3,e,e.return),Pp(3,e)}catch(x){en(e,e.return,x)}try{Nf(5,e,e.return)}catch(x){en(e,e.return,x)}}break;case 1:Ji(t,e),ys(e),n&512&&r!==null&&L0(r,r.return);break;case 5:if(Ji(t,e),ys(e),n&512&&r!==null&&L0(r,r.return),e.flags&32){var a=e.stateNode;try{Hf(a,"")}catch(x){en(e,e.return,x)}}if(n&4&&(a=e.stateNode,a!=null)){var i=e.memoizedProps,s=r!==null?r.memoizedProps:i,o=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{o==="input"&&i.type==="radio"&&i.name!=null&&i3(a,i),m2(o,s);var c=m2(o,i);for(s=0;s<l.length;s+=2){var u=l[s],h=l[s+1];u==="style"?u3(a,h):u==="dangerouslySetInnerHTML"?l3(a,h):u==="children"?Hf(a,h):qx(a,u,h,c)}switch(o){case"input":u2(a,i);break;case"textarea":s3(a,i);break;case"select":var m=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!i.multiple;var f=i.value;f!=null?j0(a,!!i.multiple,f,!1):m!==!!i.multiple&&(i.defaultValue!=null?j0(a,!!i.multiple,i.defaultValue,!0):j0(a,!!i.multiple,i.multiple?[]:"",!1))}a[Qf]=i}catch(x){en(e,e.return,x)}}break;case 6:if(Ji(t,e),ys(e),n&4){if(e.stateNode===null)throw Error(He(162));a=e.stateNode,i=e.memoizedProps;try{a.nodeValue=i}catch(x){en(e,e.return,x)}}break;case 3:if(Ji(t,e),ys(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Xf(t.containerInfo)}catch(x){en(e,e.return,x)}break;case 4:Ji(t,e),ys(e);break;case 13:Ji(t,e),ys(e),a=e.child,a.flags&8192&&(i=a.memoizedState!==null,a.stateNode.isHidden=i,!i||a.alternate!==null&&a.alternate.memoizedState!==null||(Nv=hn())),n&4&&Ew(e);break;case 22:if(u=r!==null&&r.memoizedState!==null,e.mode&1?(ma=(c=ma)||u,Ji(t,e),ma=c):Ji(t,e),ys(e),n&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!u&&e.mode&1)for(ot=e,u=e.child;u!==null;){for(h=ot=u;ot!==null;){switch(m=ot,f=m.child,m.tag){case 0:case 11:case 14:case 15:Nf(4,m,m.return);break;case 1:L0(m,m.return);var v=m.stateNode;if(typeof v.componentWillUnmount=="function"){n=m,r=m.return;try{t=n,v.props=t.memoizedProps,v.state=t.memoizedState,v.componentWillUnmount()}catch(x){en(n,r,x)}}break;case 5:L0(m,m.return);break;case 22:if(m.memoizedState!==null){Tw(h);continue}}f!==null?(f.return=m,ot=f):Tw(h)}u=u.sibling}e:for(u=null,h=e;;){if(h.tag===5){if(u===null){u=h;try{a=h.stateNode,c?(i=a.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(o=h.stateNode,l=h.memoizedProps.style,s=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=c3("display",s))}catch(x){en(e,e.return,x)}}}else if(h.tag===6){if(u===null)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(x){en(e,e.return,x)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===e)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;h.sibling===null;){if(h.return===null||h.return===e)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Ji(t,e),ys(e),n&4&&Ew(e);break;case 21:break;default:Ji(t,e),ys(e)}}function ys(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(jk(r)){var n=r;break e}r=r.return}throw Error(He(160))}switch(n.tag){case 5:var a=n.stateNode;n.flags&32&&(Hf(a,""),n.flags&=-33);var i=Nw(e);V2(e,i,a);break;case 3:case 4:var s=n.stateNode.containerInfo,o=Nw(e);H2(e,o,s);break;default:throw Error(He(161))}}catch(l){en(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function VT(e,t,r){ot=e,Mk(e)}function Mk(e,t,r){for(var n=(e.mode&1)!==0;ot!==null;){var a=ot,i=a.child;if(a.tag===22&&n){var s=a.memoizedState!==null||Dd;if(!s){var o=a.alternate,l=o!==null&&o.memoizedState!==null||ma;o=Dd;var c=ma;if(Dd=s,(ma=l)&&!c)for(ot=a;ot!==null;)s=ot,l=s.child,s.tag===22&&s.memoizedState!==null?Cw(a):l!==null?(l.return=s,ot=l):Cw(a);for(;i!==null;)ot=i,Mk(i),i=i.sibling;ot=a,Dd=o,ma=c}Aw(e)}else a.subtreeFlags&8772&&i!==null?(i.return=a,ot=i):Aw(e)}}function Aw(e){for(;ot!==null;){var t=ot;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:ma||Pp(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!ma)if(r===null)n.componentDidMount();else{var a=t.elementType===t.type?r.memoizedProps:ts(t.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&fw(t,i,n);break;case 3:var s=t.updateQueue;if(s!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}fw(t,s,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var h=u.dehydrated;h!==null&&Xf(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(He(163))}ma||t.flags&512&&W2(t)}catch(m){en(t,t.return,m)}}if(t===e){ot=null;break}if(r=t.sibling,r!==null){r.return=t.return,ot=r;break}ot=t.return}}function Tw(e){for(;ot!==null;){var t=ot;if(t===e){ot=null;break}var r=t.sibling;if(r!==null){r.return=t.return,ot=r;break}ot=t.return}}function Cw(e){for(;ot!==null;){var t=ot;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{Pp(4,t)}catch(l){en(t,r,l)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var a=t.return;try{n.componentDidMount()}catch(l){en(t,a,l)}}var i=t.return;try{W2(t)}catch(l){en(t,i,l)}break;case 5:var s=t.return;try{W2(t)}catch(l){en(t,s,l)}}}catch(l){en(t,t.return,l)}if(t===e){ot=null;break}var o=t.sibling;if(o!==null){o.return=t.return,ot=o;break}ot=t.return}}var qT=Math.ceil,Y1=yo.ReactCurrentDispatcher,kv=yo.ReactCurrentOwner,ji=yo.ReactCurrentBatchConfig,nr=0,Hn=null,Nn=null,ea=0,ii=0,P0=Al(0),jn=0,ih=null,Ec=0,Ip=0,Sv=0,Ef=null,Ba=null,Nv=0,ru=1/0,to=null,J1=!1,q2=null,dl=null,Md=!1,nl=null,Z1=0,Af=0,G2=null,w1=-1,y1=0;function Fa(){return nr&6?hn():w1!==-1?w1:w1=hn()}function pl(e){return e.mode&1?nr&2&&ea!==0?ea&-ea:CT.transition!==null?(y1===0&&(y1=b3()),y1):(e=wr,e!==0||(e=window.event,e=e===void 0?16:C3(e.type)),e):1}function ls(e,t,r,n){if(50<Af)throw Af=0,G2=null,Error(He(185));Ch(e,r,n),(!(nr&2)||e!==Hn)&&(e===Hn&&(!(nr&2)&&(Ip|=r),jn===4&&Zo(e,ea)),Va(e,n),r===1&&nr===0&&!(t.mode&1)&&(ru=hn()+500,Cp&&Tl()))}function Va(e,t){var r=e.callbackNode;CA(e,t);var n=j1(e,e===Hn?ea:0);if(n===0)r!==null&&M5(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&M5(r),t===1)e.tag===0?TT(Fw.bind(null,e)):X3(Fw.bind(null,e)),ST(function(){!(nr&6)&&Tl()}),r=null;else{switch(k3(n)){case 1:r=Jx;break;case 4:r=w3;break;case 16:r=O1;break;case 536870912:r=y3;break;default:r=O1}r=qk(r,Bk.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function Bk(e,t){if(w1=-1,y1=0,nr&6)throw Error(He(327));var r=e.callbackNode;if(U0()&&e.callbackNode!==r)return null;var n=j1(e,e===Hn?ea:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=Q1(e,n);else{t=n;var a=nr;nr|=2;var i=zk();(Hn!==e||ea!==t)&&(to=null,ru=hn()+500,mc(e,t));do try{KT();break}catch(o){Uk(e,o)}while(!0);uv(),Y1.current=i,nr=a,Nn!==null?t=0:(Hn=null,ea=0,t=jn)}if(t!==0){if(t===2&&(a=w2(e),a!==0&&(n=a,t=X2(e,a))),t===1)throw r=ih,mc(e,0),Zo(e,n),Va(e,hn()),r;if(t===6)Zo(e,n);else{if(a=e.current.alternate,!(n&30)&&!GT(a)&&(t=Q1(e,n),t===2&&(i=w2(e),i!==0&&(n=i,t=X2(e,i))),t===1))throw r=ih,mc(e,0),Zo(e,n),Va(e,hn()),r;switch(e.finishedWork=a,e.finishedLanes=n,t){case 0:case 1:throw Error(He(345));case 2:rc(e,Ba,to);break;case 3:if(Zo(e,n),(n&130023424)===n&&(t=Nv+500-hn(),10<t)){if(j1(e,0)!==0)break;if(a=e.suspendedLanes,(a&n)!==n){Fa(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=T2(rc.bind(null,e,Ba,to),t);break}rc(e,Ba,to);break;case 4:if(Zo(e,n),(n&4194240)===n)break;for(t=e.eventTimes,a=-1;0<n;){var s=31-os(n);i=1<<s,s=t[s],s>a&&(a=s),n&=~i}if(n=a,n=hn()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*qT(n/1960))-n,10<n){e.timeoutHandle=T2(rc.bind(null,e,Ba,to),n);break}rc(e,Ba,to);break;case 5:rc(e,Ba,to);break;default:throw Error(He(329))}}}return Va(e,hn()),e.callbackNode===r?Bk.bind(null,e):null}function X2(e,t){var r=Ef;return e.current.memoizedState.isDehydrated&&(mc(e,t).flags|=256),e=Q1(e,t),e!==2&&(t=Ba,Ba=r,t!==null&&K2(t)),e}function K2(e){Ba===null?Ba=e:Ba.push.apply(Ba,e)}function GT(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var a=r[n],i=a.getSnapshot;a=a.value;try{if(!fs(i(),a))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Zo(e,t){for(t&=~Sv,t&=~Ip,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-os(t),n=1<<r;e[r]=-1,t&=~n}}function Fw(e){if(nr&6)throw Error(He(327));U0();var t=j1(e,0);if(!(t&1))return Va(e,hn()),null;var r=Q1(e,t);if(e.tag!==0&&r===2){var n=w2(e);n!==0&&(t=n,r=X2(e,n))}if(r===1)throw r=ih,mc(e,0),Zo(e,t),Va(e,hn()),r;if(r===6)throw Error(He(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,rc(e,Ba,to),Va(e,hn()),null}function Ev(e,t){var r=nr;nr|=1;try{return e(t)}finally{nr=r,nr===0&&(ru=hn()+500,Cp&&Tl())}}function Ac(e){nl!==null&&nl.tag===0&&!(nr&6)&&U0();var t=nr;nr|=1;var r=ji.transition,n=wr;try{if(ji.transition=null,wr=1,e)return e()}finally{wr=n,ji.transition=r,nr=t,!(nr&6)&&Tl()}}function Av(){ii=P0.current,Rr(P0)}function mc(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,kT(r)),Nn!==null)for(r=Nn.return;r!==null;){var n=r;switch(ov(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&U1();break;case 3:eu(),Rr(Wa),Rr(_a),gv();break;case 5:mv(n);break;case 4:eu();break;case 13:Rr(Hr);break;case 19:Rr(Hr);break;case 10:fv(n.type._context);break;case 22:case 23:Av()}r=r.return}if(Hn=e,Nn=e=ml(e.current,null),ea=ii=t,jn=0,ih=null,Sv=Ip=Ec=0,Ba=Ef=null,cc!==null){for(t=0;t<cc.length;t++)if(r=cc[t],n=r.interleaved,n!==null){r.interleaved=null;var a=n.next,i=r.pending;if(i!==null){var s=i.next;i.next=a,n.next=s}r.pending=n}cc=null}return e}function Uk(e,t){do{var r=Nn;try{if(uv(),x1.current=K1,X1){for(var n=Gr.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}X1=!1}if(Nc=0,Un=In=Gr=null,Sf=!1,rh=0,kv.current=null,r===null||r.return===null){jn=1,ih=t,Nn=null;break}e:{var i=e,s=r.return,o=r,l=t;if(t=ea,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=o,h=u.tag;if(!(u.mode&1)&&(h===0||h===11||h===15)){var m=u.alternate;m?(u.updateQueue=m.updateQueue,u.memoizedState=m.memoizedState,u.lanes=m.lanes):(u.updateQueue=null,u.memoizedState=null)}var f=xw(s);if(f!==null){f.flags&=-257,vw(f,s,o,i,t),f.mode&1&&gw(i,c,t),t=f,l=c;var v=t.updateQueue;if(v===null){var x=new Set;x.add(l),t.updateQueue=x}else v.add(l);break e}else{if(!(t&1)){gw(i,c,t),Tv();break e}l=Error(He(426))}}else if($r&&o.mode&1){var w=xw(s);if(w!==null){!(w.flags&65536)&&(w.flags|=256),vw(w,s,o,i,t),lv(tu(l,o));break e}}i=l=tu(l,o),jn!==4&&(jn=2),Ef===null?Ef=[i]:Ef.push(i),i=s;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var _=kk(i,l,t);uw(i,_);break e;case 1:o=l;var b=i.type,y=i.stateNode;if(!(i.flags&128)&&(typeof b.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(dl===null||!dl.has(y)))){i.flags|=65536,t&=-t,i.lanes|=t;var N=Sk(i,o,t);uw(i,N);break e}}i=i.return}while(i!==null)}Wk(r)}catch(R){t=R,Nn===r&&r!==null&&(Nn=r=r.return);continue}break}while(!0)}function zk(){var e=Y1.current;return Y1.current=K1,e===null?K1:e}function Tv(){(jn===0||jn===3||jn===2)&&(jn=4),Hn===null||!(Ec&268435455)&&!(Ip&268435455)||Zo(Hn,ea)}function Q1(e,t){var r=nr;nr|=2;var n=zk();(Hn!==e||ea!==t)&&(to=null,mc(e,t));do try{XT();break}catch(a){Uk(e,a)}while(!0);if(uv(),nr=r,Y1.current=n,Nn!==null)throw Error(He(261));return Hn=null,ea=0,jn}function XT(){for(;Nn!==null;)$k(Nn)}function KT(){for(;Nn!==null&&!wA();)$k(Nn)}function $k(e){var t=Vk(e.alternate,e,ii);e.memoizedProps=e.pendingProps,t===null?Wk(e):Nn=t,kv.current=null}function Wk(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=$T(r,t),r!==null){r.flags&=32767,Nn=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{jn=6,Nn=null;return}}else if(r=zT(r,t,ii),r!==null){Nn=r;return}if(t=t.sibling,t!==null){Nn=t;return}Nn=t=e}while(t!==null);jn===0&&(jn=5)}function rc(e,t,r){var n=wr,a=ji.transition;try{ji.transition=null,wr=1,YT(e,t,r,n)}finally{ji.transition=a,wr=n}return null}function YT(e,t,r,n){do U0();while(nl!==null);if(nr&6)throw Error(He(327));r=e.finishedWork;var a=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(He(177));e.callbackNode=null,e.callbackPriority=0;var i=r.lanes|r.childLanes;if(FA(e,i),e===Hn&&(Nn=Hn=null,ea=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Md||(Md=!0,qk(O1,function(){return U0(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=ji.transition,ji.transition=null;var s=wr;wr=1;var o=nr;nr|=4,kv.current=null,HT(e,r),Dk(r,e),gT(E2),R1=!!N2,E2=N2=null,e.current=r,VT(r),yA(),nr=o,wr=s,ji.transition=i}else e.current=r;if(Md&&(Md=!1,nl=e,Z1=a),i=e.pendingLanes,i===0&&(dl=null),SA(r.stateNode),Va(e,hn()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)a=t[r],n(a.value,{componentStack:a.stack,digest:a.digest});if(J1)throw J1=!1,e=q2,q2=null,e;return Z1&1&&e.tag!==0&&U0(),i=e.pendingLanes,i&1?e===G2?Af++:(Af=0,G2=e):Af=0,Tl(),null}function U0(){if(nl!==null){var e=k3(Z1),t=ji.transition,r=wr;try{if(ji.transition=null,wr=16>e?16:e,nl===null)var n=!1;else{if(e=nl,nl=null,Z1=0,nr&6)throw Error(He(331));var a=nr;for(nr|=4,ot=e.current;ot!==null;){var i=ot,s=i.child;if(ot.flags&16){var o=i.deletions;if(o!==null){for(var l=0;l<o.length;l++){var c=o[l];for(ot=c;ot!==null;){var u=ot;switch(u.tag){case 0:case 11:case 15:Nf(8,u,i)}var h=u.child;if(h!==null)h.return=u,ot=h;else for(;ot!==null;){u=ot;var m=u.sibling,f=u.return;if(Ok(u),u===c){ot=null;break}if(m!==null){m.return=f,ot=m;break}ot=f}}}var v=i.alternate;if(v!==null){var x=v.child;if(x!==null){v.child=null;do{var w=x.sibling;x.sibling=null,x=w}while(x!==null)}}ot=i}}if(i.subtreeFlags&2064&&s!==null)s.return=i,ot=s;else e:for(;ot!==null;){if(i=ot,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Nf(9,i,i.return)}var _=i.sibling;if(_!==null){_.return=i.return,ot=_;break e}ot=i.return}}var b=e.current;for(ot=b;ot!==null;){s=ot;var y=s.child;if(s.subtreeFlags&2064&&y!==null)y.return=s,ot=y;else e:for(s=b;ot!==null;){if(o=ot,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:Pp(9,o)}}catch(R){en(o,o.return,R)}if(o===s){ot=null;break e}var N=o.sibling;if(N!==null){N.return=o.return,ot=N;break e}ot=o.return}}if(nr=a,Tl(),Is&&typeof Is.onPostCommitFiberRoot=="function")try{Is.onPostCommitFiberRoot(Sp,e)}catch{}n=!0}return n}finally{wr=r,ji.transition=t}}return!1}function Lw(e,t,r){t=tu(r,t),t=kk(e,t,1),e=hl(e,t,1),t=Fa(),e!==null&&(Ch(e,1,t),Va(e,t))}function en(e,t,r){if(e.tag===3)Lw(e,e,r);else for(;t!==null;){if(t.tag===3){Lw(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(dl===null||!dl.has(n))){e=tu(r,e),e=Sk(t,e,1),t=hl(t,e,1),e=Fa(),t!==null&&(Ch(t,1,e),Va(t,e));break}}t=t.return}}function JT(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Fa(),e.pingedLanes|=e.suspendedLanes&r,Hn===e&&(ea&r)===r&&(jn===4||jn===3&&(ea&130023424)===ea&&500>hn()-Nv?mc(e,0):Sv|=r),Va(e,t)}function Hk(e,t){t===0&&(e.mode&1?(t=Td,Td<<=1,!(Td&130023424)&&(Td=4194304)):t=1);var r=Fa();e=vo(e,t),e!==null&&(Ch(e,t,r),Va(e,r))}function ZT(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),Hk(e,r)}function QT(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,a=e.memoizedState;a!==null&&(r=a.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(He(314))}n!==null&&n.delete(t),Hk(e,r)}var Vk;Vk=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Wa.current)za=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return za=!1,UT(e,t,r);za=!!(e.flags&131072)}else za=!1,$r&&t.flags&1048576&&K3(t,W1,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;_1(e,t),e=t.pendingProps;var a=J0(t,_a.current);B0(t,r),a=vv(null,t,n,e,a,r);var i=_v();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ha(n)?(i=!0,z1(t)):i=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,dv(t),a.updater=Lp,t.stateNode=a,a._reactInternals=t,j2(t,n,e,r),t=M2(null,t,n,!0,i,r)):(t.tag=0,$r&&i&&sv(t),Ea(null,t,a,r),t=t.child),t;case 16:n=t.elementType;e:{switch(_1(e,t),e=t.pendingProps,a=n._init,n=a(n._payload),t.type=n,a=t.tag=tC(n),e=ts(n,e),a){case 0:t=D2(null,t,n,e,r);break e;case 1:t=yw(null,t,n,e,r);break e;case 11:t=_w(null,t,n,e,r);break e;case 14:t=ww(null,t,n,ts(n.type,e),r);break e}throw Error(He(306,n,""))}return t;case 0:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:ts(n,a),D2(e,t,n,a,r);case 1:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:ts(n,a),yw(e,t,n,a,r);case 3:e:{if(Tk(t),e===null)throw Error(He(387));n=t.pendingProps,i=t.memoizedState,a=i.element,tk(e,t),q1(t,n,null,r);var s=t.memoizedState;if(n=s.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){a=tu(Error(He(423)),t),t=bw(e,t,n,r,a);break e}else if(n!==a){a=tu(Error(He(424)),t),t=bw(e,t,n,r,a);break e}else for(ui=fl(t.stateNode.containerInfo.firstChild),di=t,$r=!0,as=null,r=Q3(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Z0(),n===a){t=_o(e,t,r);break e}Ea(e,t,n,r)}t=t.child}return t;case 5:return rk(t),e===null&&P2(t),n=t.type,a=t.pendingProps,i=e!==null?e.memoizedProps:null,s=a.children,A2(n,a)?s=null:i!==null&&A2(n,i)&&(t.flags|=32),Ak(e,t),Ea(e,t,s,r),t.child;case 6:return e===null&&P2(t),null;case 13:return Ck(e,t,r);case 4:return pv(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=Q0(t,null,n,r):Ea(e,t,n,r),t.child;case 11:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:ts(n,a),_w(e,t,n,a,r);case 7:return Ea(e,t,t.pendingProps,r),t.child;case 8:return Ea(e,t,t.pendingProps.children,r),t.child;case 12:return Ea(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,a=t.pendingProps,i=t.memoizedProps,s=a.value,Fr(H1,n._currentValue),n._currentValue=s,i!==null)if(fs(i.value,s)){if(i.children===a.children&&!Wa.current){t=_o(e,t,r);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var o=i.dependencies;if(o!==null){s=i.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(i.tag===1){l=co(-1,r&-r),l.tag=2;var c=i.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}i.lanes|=r,l=i.alternate,l!==null&&(l.lanes|=r),I2(i.return,r,t),o.lanes|=r;break}l=l.next}}else if(i.tag===10)s=i.type===t.type?null:i.child;else if(i.tag===18){if(s=i.return,s===null)throw Error(He(341));s.lanes|=r,o=s.alternate,o!==null&&(o.lanes|=r),I2(s,r,t),s=i.sibling}else s=i.child;if(s!==null)s.return=i;else for(s=i;s!==null;){if(s===t){s=null;break}if(i=s.sibling,i!==null){i.return=s.return,s=i;break}s=s.return}i=s}Ea(e,t,a.children,r),t=t.child}return t;case 9:return a=t.type,n=t.pendingProps.children,B0(t,r),a=Mi(a),n=n(a),t.flags|=1,Ea(e,t,n,r),t.child;case 14:return n=t.type,a=ts(n,t.pendingProps),a=ts(n.type,a),ww(e,t,n,a,r);case 15:return Nk(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:ts(n,a),_1(e,t),t.tag=1,Ha(n)?(e=!0,z1(t)):e=!1,B0(t,r),bk(t,n,a),j2(t,n,a,r),M2(null,t,n,!0,e,r);case 19:return Fk(e,t,r);case 22:return Ek(e,t,r)}throw Error(He(156,t.tag))};function qk(e,t){return _3(e,t)}function eC(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Oi(e,t,r,n){return new eC(e,t,r,n)}function Cv(e){return e=e.prototype,!(!e||!e.isReactComponent)}function tC(e){if(typeof e=="function")return Cv(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Xx)return 11;if(e===Kx)return 14}return 2}function ml(e,t){var r=e.alternate;return r===null?(r=Oi(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function b1(e,t,r,n,a,i){var s=2;if(n=e,typeof e=="function")Cv(e)&&(s=1);else if(typeof e=="string")s=5;else e:switch(e){case b0:return gc(r.children,a,i,t);case Gx:s=8,a|=8;break;case i2:return e=Oi(12,r,t,a|2),e.elementType=i2,e.lanes=i,e;case s2:return e=Oi(13,r,t,a),e.elementType=s2,e.lanes=i,e;case o2:return e=Oi(19,r,t,a),e.elementType=o2,e.lanes=i,e;case r3:return Op(r,a,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case e3:s=10;break e;case t3:s=9;break e;case Xx:s=11;break e;case Kx:s=14;break e;case Ko:s=16,n=null;break e}throw Error(He(130,e==null?e:typeof e,""))}return t=Oi(s,r,t,a),t.elementType=e,t.type=n,t.lanes=i,t}function gc(e,t,r,n){return e=Oi(7,e,n,t),e.lanes=r,e}function Op(e,t,r,n){return e=Oi(22,e,n,t),e.elementType=r3,e.lanes=r,e.stateNode={isHidden:!1},e}function ig(e,t,r){return e=Oi(6,e,null,t),e.lanes=r,e}function sg(e,t,r){return t=Oi(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function rC(e,t,r,n,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Um(0),this.expirationTimes=Um(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Um(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function Fv(e,t,r,n,a,i,s,o,l){return e=new rC(e,t,r,o,l),t===1?(t=1,i===!0&&(t|=8)):t=0,i=Oi(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},dv(i),e}function nC(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:y0,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function Gk(e){if(!e)return wl;e=e._reactInternals;e:{if(Mc(e)!==e||e.tag!==1)throw Error(He(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ha(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(He(171))}if(e.tag===1){var r=e.type;if(Ha(r))return G3(e,r,t)}return t}function Xk(e,t,r,n,a,i,s,o,l){return e=Fv(r,n,!0,e,a,i,s,o,l),e.context=Gk(null),r=e.current,n=Fa(),a=pl(r),i=co(n,a),i.callback=t??null,hl(r,i,a),e.current.lanes=a,Ch(e,a,n),Va(e,n),e}function jp(e,t,r,n){var a=t.current,i=Fa(),s=pl(a);return r=Gk(r),t.context===null?t.context=r:t.pendingContext=r,t=co(i,s),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=hl(a,t,s),e!==null&&(ls(e,a,s,i),g1(e,a,s)),s}function ep(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Pw(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Lv(e,t){Pw(e,t),(e=e.alternate)&&Pw(e,t)}function aC(){return null}var Kk=typeof reportError=="function"?reportError:function(e){console.error(e)};function Pv(e){this._internalRoot=e}Rp.prototype.render=Pv.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(He(409));jp(e,t,null,null)};Rp.prototype.unmount=Pv.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Ac(function(){jp(null,e,null,null)}),t[xo]=null}};function Rp(e){this._internalRoot=e}Rp.prototype.unstable_scheduleHydration=function(e){if(e){var t=E3();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Jo.length&&t!==0&&t<Jo[r].priority;r++);Jo.splice(r,0,e),r===0&&T3(e)}};function Iv(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Dp(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Iw(){}function iC(e,t,r,n,a){if(a){if(typeof n=="function"){var i=n;n=function(){var c=ep(s);i.call(c)}}var s=Xk(t,n,e,0,null,!1,!1,"",Iw);return e._reactRootContainer=s,e[xo]=s.current,Jf(e.nodeType===8?e.parentNode:e),Ac(),s}for(;a=e.lastChild;)e.removeChild(a);if(typeof n=="function"){var o=n;n=function(){var c=ep(l);o.call(c)}}var l=Fv(e,0,!1,null,null,!1,!1,"",Iw);return e._reactRootContainer=l,e[xo]=l.current,Jf(e.nodeType===8?e.parentNode:e),Ac(function(){jp(t,l,r,n)}),l}function Mp(e,t,r,n,a){var i=r._reactRootContainer;if(i){var s=i;if(typeof a=="function"){var o=a;a=function(){var l=ep(s);o.call(l)}}jp(t,s,e,a)}else s=iC(r,t,e,a,n);return ep(s)}S3=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=ff(t.pendingLanes);r!==0&&(Zx(t,r|1),Va(t,hn()),!(nr&6)&&(ru=hn()+500,Tl()))}break;case 13:Ac(function(){var n=vo(e,1);if(n!==null){var a=Fa();ls(n,e,1,a)}}),Lv(e,1)}};Qx=function(e){if(e.tag===13){var t=vo(e,134217728);if(t!==null){var r=Fa();ls(t,e,134217728,r)}Lv(e,134217728)}};N3=function(e){if(e.tag===13){var t=pl(e),r=vo(e,t);if(r!==null){var n=Fa();ls(r,e,t,n)}Lv(e,t)}};E3=function(){return wr};A3=function(e,t){var r=wr;try{return wr=e,t()}finally{wr=r}};x2=function(e,t,r){switch(t){case"input":if(u2(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var a=Tp(n);if(!a)throw Error(He(90));a3(n),u2(n,a)}}}break;case"textarea":s3(e,r);break;case"select":t=r.value,t!=null&&j0(e,!!r.multiple,t,!1)}};d3=Ev;p3=Ac;var sC={usingClientEntryPoint:!1,Events:[Lh,E0,Tp,f3,h3,Ev]},rf={findFiberByHostInstance:lc,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},oC={bundleType:rf.bundleType,version:rf.version,rendererPackageName:rf.rendererPackageName,rendererConfig:rf.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:yo.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=x3(e),e===null?null:e.stateNode},findFiberByHostInstance:rf.findFiberByHostInstance||aC,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Bd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Bd.isDisabled&&Bd.supportsFiber)try{Sp=Bd.inject(oC),Is=Bd}catch{}}gi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=sC;gi.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Iv(t))throw Error(He(200));return nC(e,t,null,r)};gi.createRoot=function(e,t){if(!Iv(e))throw Error(He(299));var r=!1,n="",a=Kk;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=Fv(e,1,!1,null,null,r,!1,n,a),e[xo]=t.current,Jf(e.nodeType===8?e.parentNode:e),new Pv(t)};gi.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(He(188)):(e=Object.keys(e).join(","),Error(He(268,e)));return e=x3(t),e=e===null?null:e.stateNode,e};gi.flushSync=function(e){return Ac(e)};gi.hydrate=function(e,t,r){if(!Dp(t))throw Error(He(200));return Mp(null,e,t,!0,r)};gi.hydrateRoot=function(e,t,r){if(!Iv(e))throw Error(He(405));var n=r!=null&&r.hydratedSources||null,a=!1,i="",s=Kk;if(r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(s=r.onRecoverableError)),t=Xk(t,null,e,1,r??null,a,!1,i,s),e[xo]=t.current,Jf(e),n)for(e=0;e<n.length;e++)r=n[e],a=r._getVersion,a=a(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,a]:t.mutableSourceEagerHydrationData.push(r,a);return new Rp(t)};gi.render=function(e,t,r){if(!Dp(t))throw Error(He(200));return Mp(null,e,t,!1,r)};gi.unmountComponentAtNode=function(e){if(!Dp(e))throw Error(He(40));return e._reactRootContainer?(Ac(function(){Mp(null,null,e,!1,function(){e._reactRootContainer=null,e[xo]=null})}),!0):!1};gi.unstable_batchedUpdates=Ev;gi.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Dp(r))throw Error(He(200));if(e==null||e._reactInternals===void 0)throw Error(He(38));return Mp(e,t,r,!1,n)};gi.version="18.3.1-next-f1338f8080-20240426";function Yk(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Yk)}catch(e){console.error(e)}}Yk(),Yb.exports=gi;var lC=Yb.exports,Jk,Ow=lC;Jk=Ow.createRoot,Ow.hydrateRoot;const cC="modulepreload",uC=function(e){return"/"+e},jw={},uo=function(t,r,n){let a=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),o=(s==null?void 0:s.nonce)||(s==null?void 0:s.getAttribute("nonce"));a=Promise.allSettled(r.map(l=>{if(l=uC(l),l in jw)return;jw[l]=!0;const c=l.endsWith(".css"),u=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${u}`))return;const h=document.createElement("link");if(h.rel=c?"stylesheet":cC,c||(h.as="script"),h.crossOrigin="",h.href=l,o&&h.setAttribute("nonce",o),document.head.appendChild(h),c)return new Promise((m,f)=>{h.addEventListener("load",m),h.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${l}`)))})}))}function i(s){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=s,window.dispatchEvent(o),!o.defaultPrevented)throw s}return a.then(s=>{for(const o of s||[])o.status==="rejected"&&i(o.reason);return t().catch(i)})};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var fC={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hC=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),qt=(e,t)=>{const r=nt.forwardRef(({color:n="currentColor",size:a=24,strokeWidth:i=2,absoluteStrokeWidth:s,className:o="",children:l,...c},u)=>nt.createElement("svg",{ref:u,...fC,width:a,height:a,stroke:n,strokeWidth:s?Number(i)*24/Number(a):i,className:["lucide",`lucide-${hC(e)}`,o].join(" "),...c},[...t.map(([h,m])=>nt.createElement(h,m)),...Array.isArray(l)?l:[l]]));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const og=qt("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ov=qt("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jv=qt("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rw=qt("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dC=qt("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pC=qt("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y2=qt("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zk=qt("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J2=qt("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nu=qt("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mC=qt("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qk=qt("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eS=qt("Code",[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gC=qt("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tS=qt("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ih=qt("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xC=qt("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vC=qt("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xc=qt("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _C=qt("Key",[["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["path",{d:"m15.5 7.5 3 3L22 7l-3-3",key:"1rn1fs"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rS=qt("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tp=qt("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nS=qt("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wC=qt("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aS=qt("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yC=qt("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bC=qt("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kC=qt("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dw=qt("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lg=qt("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mw=qt("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SC=qt("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fo=qt("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bw=qt("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z2=qt("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q2=qt("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k1=qt("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NC=qt("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iS=qt("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]);/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var rp={};rp.version="0.18.5";var sS=1252,EC=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Rv={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Dv=function(e){EC.indexOf(e)!=-1&&(sS=Rv[0]=e)};function AC(){Dv(1252)}var is=function(e){Dv(e)};function Mv(){is(1200),AC()}function Uw(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function TC(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function oS(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var df=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?TC(e.slice(2)):t==254&&r==255?oS(e.slice(2)):t==65279?e.slice(1):e},Ud=function(t){return String.fromCharCode(t)},zw=function(t){return String.fromCharCode(t)},Qo,al="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function sh(e){for(var t="",r=0,n=0,a=0,i=0,s=0,o=0,l=0,c=0;c<e.length;)r=e.charCodeAt(c++),i=r>>2,n=e.charCodeAt(c++),s=(r&3)<<4|n>>4,a=e.charCodeAt(c++),o=(n&15)<<2|a>>6,l=a&63,isNaN(n)?o=l=64:isNaN(a)&&(l=64),t+=al.charAt(i)+al.charAt(s)+al.charAt(o)+al.charAt(l);return t}function mi(e){var t="",r=0,n=0,a=0,i=0,s=0,o=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<e.length;)i=al.indexOf(e.charAt(c++)),s=al.indexOf(e.charAt(c++)),r=i<<2|s>>4,t+=String.fromCharCode(r),o=al.indexOf(e.charAt(c++)),n=(s&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),l=al.indexOf(e.charAt(c++)),a=(o&3)<<6|l,l!==64&&(t+=String.fromCharCode(a));return t}var Vt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),bo=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function yl(e){return Vt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function $w(e){return Vt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var li=function(t){return Vt?bo(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Bp(e){if(typeof ArrayBuffer>"u")return li(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function Cl(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function CC(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function Bv(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Bv(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var $n=Vt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:bo(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function FC(e){for(var t=[],r=0,n=e.length+250,a=yl(e.length+255),i=0;i<e.length;++i){var s=e.charCodeAt(i);if(s<128)a[r++]=s;else if(s<2048)a[r++]=192|s>>6&31,a[r++]=128|s&63;else if(s>=55296&&s<57344){s=(s&1023)+64;var o=e.charCodeAt(++i)&1023;a[r++]=240|s>>8&7,a[r++]=128|s>>2&63,a[r++]=128|o>>6&15|(s&3)<<4,a[r++]=128|o&63}else a[r++]=224|s>>12&15,a[r++]=128|s>>6&63,a[r++]=128|s&63;r>n&&(t.push(a.slice(0,r)),r=0,a=yl(65535),n=65530)}return t.push(a.slice(0,r)),$n(t)}var La=/\u0000/g,pf=/[\u0001-\u0006]/g;function z0(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function ss(e,t){var r=""+e;return r.length>=t?r:tn("0",t-r.length)+r}function Uv(e,t){var r=""+e;return r.length>=t?r:tn(" ",t-r.length)+r}function np(e,t){var r=""+e;return r.length>=t?r:r+tn(" ",t-r.length)}function LC(e,t){var r=""+Math.round(e);return r.length>=t?r:tn("0",t-r.length)+r}function PC(e,t){var r=""+e;return r.length>=t?r:tn("0",t-r.length)+r}var Ww=Math.pow(2,32);function a0(e,t){if(e>Ww||e<-Ww)return LC(e,t);var r=Math.round(e);return PC(r,t)}function ap(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var Hw=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],cg=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function IC(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var Nt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},Vw={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},OC={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function ip(e,t,r){for(var n=e<0?-1:1,a=e*n,i=0,s=1,o=0,l=1,c=0,u=0,h=Math.floor(a);c<t&&(h=Math.floor(a),o=h*s+i,u=h*c+l,!(a-h<5e-8));)a=1/(a-h),i=s,s=o,l=c,c=u;if(u>t&&(c>t?(u=l,o=i):(u=c,o=s)),!r)return[0,n*o,u];var m=Math.floor(n*o/u);return[m,n*o-m*u,u]}function fc(e,t,r){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),i=0,s=[],o={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++a==86400&&(o.T=a=0,++n,++o.D)),n===60)s=r?[1317,10,29]:[1900,2,29],i=3;else if(n===0)s=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),s=[l.getFullYear(),l.getMonth()+1,l.getDate()],i=l.getDay(),n<60&&(i=(i+6)%7),r&&(i=UC(l,s))}return o.y=s[0],o.m=s[1],o.d=s[2],o.S=a%60,a=Math.floor(a/60),o.M=a%60,a=Math.floor(a/60),o.H=a,o.q=i,o}var lS=new Date(1899,11,31,0,0,0),jC=lS.getTime(),RC=new Date(1900,2,1,0,0,0);function cS(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=RC&&(r+=24*60*60*1e3),(r-(jC+(e.getTimezoneOffset()-lS.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function zv(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function DC(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function MC(e){var t=e<0?12:11,r=zv(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function BC(e){var t=zv(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function oh(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=MC(e):t===10?r=e.toFixed(10).substr(0,12):r=BC(e),zv(DC(r.toUpperCase()))}function Tc(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):oh(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Ui(14,cS(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function UC(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function zC(e,t,r,n){var a="",i=0,s=0,o=r.y,l,c=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(t.length){case 1:case 2:l=r.m,c=t.length;break;case 3:return cg[r.m-1][1];case 5:return cg[r.m-1][0];default:return cg[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=r.d,c=t.length;break;case 3:return Hw[r.q][0];default:return Hw[r.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(r.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=r.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=r.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?ss(r.S,t.length):(n>=2?s=n===3?1e3:100:s=n===1?10:1,i=Math.round(s*(r.S+r.u)),i>=60*s&&(i=0),t==="s"?i===0?"0":""+i/s:(a=ss(i,2+n),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}c=t.length===3?1:2;break;case 101:l=o,c=1;break}var u=c>0?ss(l,c):"";return u}function il(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var uS=/%/g;function $C(e,t,r){var n=t.replace(uS,""),a=t.length-n.length;return ho(e,n,r*Math.pow(10,2*a))+tn("%",a)}function WC(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return ho(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function fS(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+fS(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),r.indexOf("e")===-1){var s=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+i):r+="E+"+(s-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(a+i)%a)+"."+u.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var hS=/# (\?+)( ?)\/( ?)(\d+)/;function HC(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),i=Math.floor(a/n),s=a-i*n,o=n;return r+(i===0?"":""+i)+" "+(s===0?tn(" ",e[1].length+1+e[4].length):Uv(s,e[1].length)+e[2]+"/"+e[3]+ss(o,e[4].length))}function VC(e,t,r){return r+(t===0?"":""+t)+tn(" ",e[1].length+2+e[4].length)}var dS=/^#*0*\.([0#]+)/,pS=/\).*[0#]/,mS=/\(###\) ###\\?-####/;function Aa(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function qw(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function Gw(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function qC(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function GC(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Ei(e,t,r){if(e.charCodeAt(0)===40&&!t.match(pS)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ei("n",n,r):"("+Ei("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return WC(e,t,r);if(t.indexOf("%")!==-1)return $C(e,t,r);if(t.indexOf("E")!==-1)return fS(t,r);if(t.charCodeAt(0)===36)return"$"+Ei(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,s,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+a0(l,t.length);if(t.match(/^[#?]+$/))return a=a0(r,0),a==="0"&&(a=""),a.length>t.length?a:Aa(t.substr(0,t.length-a.length))+a;if(i=t.match(hS))return HC(i,l,c);if(t.match(/^#+0+$/))return c+a0(l,t.length-t.indexOf("0"));if(i=t.match(dS))return a=qw(r,i[1].length).replace(/^([^\.]+)$/,"$1."+Aa(i[1])).replace(/\.$/,"."+Aa(i[1])).replace(/\.(\d*)$/,function(v,x){return"."+x+tn("0",Aa(i[1]).length-x.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return c+qw(l,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return c+il(a0(l,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ei(e,t,-r):il(""+(Math.floor(r)+qC(r,i[1].length)))+"."+ss(Gw(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return Ei(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=z0(Ei(e,t.replace(/[\\-]/g,""),r)),s=0,z0(z0(t.replace(/\\/g,"")).replace(/[0#]/g,function(v){return s<a.length?a.charAt(s++):v==="0"?"0":""}));if(t.match(mS))return a=Ei(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),o=ip(l,Math.pow(10,s)-1,!1),a=""+c,u=ho("n",i[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),a+=u+i[2]+"/"+i[3],u=np(o[2],s),u.length<i[4].length&&(u=Aa(i[4].substr(i[4].length-u.length))+u),a+=u,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),o=ip(l,Math.pow(10,s)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Uv(o[1],s)+i[2]+"/"+i[3]+np(o[2],s):tn(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=a0(r,0),t.length<=a.length?a:Aa(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var h=t.indexOf(".")-s,m=t.length-a.length-h;return Aa(t.substr(0,h)+a+t.substr(t.length-m))}if(i=t.match(/^00,000\.([#0]*0)$/))return s=Gw(r,i[1].length),r<0?"-"+Ei(e,t,-r):il(GC(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?ss(0,3-v.length):"")+v})+"."+ss(s,i[1].length);switch(t){case"###,##0.00":return Ei(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var f=il(a0(l,0));return f!=="0"?c+f:"";case"###,###.00":return Ei(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Ei(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function XC(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return ho(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function KC(e,t,r){var n=t.replace(uS,""),a=t.length-n.length;return ho(e,n,r*Math.pow(10,2*a))+tn("%",a)}function gS(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+gS(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),!r.match(/[Ee]/)){var s=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+i):r+="E+"+(s-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(a+i)%a)+"."+u.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Ss(e,t,r){if(e.charCodeAt(0)===40&&!t.match(pS)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ss("n",n,r):"("+Ss("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return XC(e,t,r);if(t.indexOf("%")!==-1)return KC(e,t,r);if(t.indexOf("E")!==-1)return gS(t,r);if(t.charCodeAt(0)===36)return"$"+Ss(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,s,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+ss(l,t.length);if(t.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>t.length?a:Aa(t.substr(0,t.length-a.length))+a;if(i=t.match(hS))return VC(i,l,c);if(t.match(/^#+0+$/))return c+ss(l,t.length-t.indexOf("0"));if(i=t.match(dS))return a=(""+r).replace(/^([^\.]+)$/,"$1."+Aa(i[1])).replace(/\.$/,"."+Aa(i[1])),a=a.replace(/\.(\d*)$/,function(v,x){return"."+x+tn("0",Aa(i[1]).length-x.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return c+il(""+l);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ss(e,t,-r):il(""+r)+"."+tn("0",i[1].length);if(i=t.match(/^#,#*,#0/))return Ss(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=z0(Ss(e,t.replace(/[\\-]/g,""),r)),s=0,z0(z0(t.replace(/\\/g,"")).replace(/[0#]/g,function(v){return s<a.length?a.charAt(s++):v==="0"?"0":""}));if(t.match(mS))return a=Ss(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),o=ip(l,Math.pow(10,s)-1,!1),a=""+c,u=ho("n",i[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),a+=u+i[2]+"/"+i[3],u=np(o[2],s),u.length<i[4].length&&(u=Aa(i[4].substr(i[4].length-u.length))+u),a+=u,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),o=ip(l,Math.pow(10,s)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Uv(o[1],s)+i[2]+"/"+i[3]+np(o[2],s):tn(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:Aa(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var h=t.indexOf(".")-s,m=t.length-a.length-h;return Aa(t.substr(0,h)+a+t.substr(t.length-m))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Ss(e,t,-r):il(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?ss(0,3-v.length):"")+v})+"."+ss(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var f=il(""+l);return f!=="0"?c+f:"";default:if(t.match(/\.[0#?]*$/))return Ss(e,t.slice(0,t.lastIndexOf(".")),r)+Aa(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function ho(e,t,r){return(r|0)===r?Ss(e,t,r):Ei(e,t,r)}function YC(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var xS=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function mu(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":ap(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="上午/下午")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(xS))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function JC(e,t,r,n){for(var a=[],i="",s=0,o="",l="t",c,u,h,m="H";s<e.length;)switch(o=e.charAt(s)){case"G":if(!ap(e,s))throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"G",v:"General"},s+=7;break;case'"':for(i="";(h=e.charCodeAt(++s))!==34&&s<e.length;)i+=String.fromCharCode(h);a[a.length]={t:"t",v:i},++s;break;case"\\":var f=e.charAt(++s),v=f==="("||f===")"?f:"t";a[a.length]={t:v,v:f},++s;break;case"_":a[a.length]={t:"t",v:" "},s+=2;break;case"@":a[a.length]={t:"T",v:t},++s;break;case"B":case"b":if(e.charAt(s+1)==="1"||e.charAt(s+1)==="2"){if(c==null&&(c=fc(t,r,e.charAt(s+1)==="2"),c==null))return"";a[a.length]={t:"X",v:e.substr(s,2)},l=o,s+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||c==null&&(c=fc(t,r),c==null))return"";for(i=o;++s<e.length&&e.charAt(s).toLowerCase()===o;)i+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=m),a[a.length]={t:o,v:i},l=o;break;case"A":case"a":case"上":var x={t:o,v:o};if(c==null&&(c=fc(t,r)),e.substr(s,3).toUpperCase()==="A/P"?(c!=null&&(x.v=c.H>=12?"P":"A"),x.t="T",m="h",s+=3):e.substr(s,5).toUpperCase()==="AM/PM"?(c!=null&&(x.v=c.H>=12?"PM":"AM"),x.t="T",s+=5,m="h"):e.substr(s,5).toUpperCase()==="上午/下午"?(c!=null&&(x.v=c.H>=12?"下午":"上午"),x.t="T",s+=5,m="h"):(x.t="t",++s),c==null&&x.t==="T")return"";a[a.length]=x,l=o;break;case"[":for(i=o;e.charAt(s++)!=="]"&&s<e.length;)i+=e.charAt(s);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(xS)){if(c==null&&(c=fc(t,r),c==null))return"";a[a.length]={t:"Z",v:i.toLowerCase()},l=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",mu(e)||(a[a.length]={t:"t",v:i}));break;case".":if(c!=null){for(i=o;++s<e.length&&(o=e.charAt(s))==="0";)i+=o;a[a.length]={t:"s",v:i};break}case"0":case"#":for(i=o;++s<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(s))>-1;)i+=o;a[a.length]={t:"n",v:i};break;case"?":for(i=o;e.charAt(++s)===o;)i+=o;a[a.length]={t:o,v:i},l=o;break;case"*":++s,(e.charAt(s)==" "||e.charAt(s)=="*")&&++s;break;case"(":case")":a[a.length]={t:n===1?"t":o,v:o},++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=o;s<e.length&&"0123456789".indexOf(e.charAt(++s))>-1;)i+=e.charAt(s);a[a.length]={t:"D",v:i};break;case" ":a[a.length]={t:o,v:o},++s;break;case"$":a[a.length]={t:"t",v:"$"},++s;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"t",v:o},++s;break}var w=0,_=0,b;for(s=a.length-1,l="t";s>=0;--s)switch(a[s].t){case"h":case"H":a[s].t=m,l="h",w<1&&(w=1);break;case"s":(b=a[s].v.match(/\.0+$/))&&(_=Math.max(_,b[0].length-1)),w<3&&(w=3);case"d":case"y":case"M":case"e":l=a[s].t;break;case"m":l==="s"&&(a[s].t="M",w<2&&(w=2));break;case"X":break;case"Z":w<1&&a[s].v.match(/[Hh]/)&&(w=1),w<2&&a[s].v.match(/[Mm]/)&&(w=2),w<3&&a[s].v.match(/[Ss]/)&&(w=3)}switch(w){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var y="",N;for(s=0;s<a.length;++s)switch(a[s].t){case"t":case"T":case" ":case"D":break;case"X":a[s].v="",a[s].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[s].v=zC(a[s].t.charCodeAt(0),a[s].v,c,_),a[s].t="t";break;case"n":case"?":for(N=s+1;a[N]!=null&&((o=a[N].t)==="?"||o==="D"||(o===" "||o==="t")&&a[N+1]!=null&&(a[N+1].t==="?"||a[N+1].t==="t"&&a[N+1].v==="/")||a[s].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(a[N].v==="/"||a[N].v===" "&&a[N+1]!=null&&a[N+1].t=="?"));)a[s].v+=a[N].v,a[N]={v:"",t:";"},++N;y+=a[s].v,s=N-1;break;case"G":a[s].t="t",a[s].v=Tc(t,r);break}var R="",P,F;if(y.length>0){y.charCodeAt(0)==40?(P=t<0&&y.charCodeAt(0)===45?-t:t,F=ho("n",y,P)):(P=t<0&&n>1?-t:t,F=ho("n",y,P),P<0&&a[0]&&a[0].t=="t"&&(F=F.substr(1),a[0].v="-"+a[0].v)),N=F.length-1;var C=a.length;for(s=0;s<a.length;++s)if(a[s]!=null&&a[s].t!="t"&&a[s].v.indexOf(".")>-1){C=s;break}var A=a.length;if(C===a.length&&F.indexOf("E")===-1){for(s=a.length-1;s>=0;--s)a[s]==null||"n?".indexOf(a[s].t)===-1||(N>=a[s].v.length-1?(N-=a[s].v.length,a[s].v=F.substr(N+1,a[s].v.length)):N<0?a[s].v="":(a[s].v=F.substr(0,N+1),N=-1),a[s].t="t",A=s);N>=0&&A<a.length&&(a[A].v=F.substr(0,N+1)+a[A].v)}else if(C!==a.length&&F.indexOf("E")===-1){for(N=F.indexOf(".")-1,s=C;s>=0;--s)if(!(a[s]==null||"n?".indexOf(a[s].t)===-1)){for(u=a[s].v.indexOf(".")>-1&&s===C?a[s].v.indexOf(".")-1:a[s].v.length-1,R=a[s].v.substr(u+1);u>=0;--u)N>=0&&(a[s].v.charAt(u)==="0"||a[s].v.charAt(u)==="#")&&(R=F.charAt(N--)+R);a[s].v=R,a[s].t="t",A=s}for(N>=0&&A<a.length&&(a[A].v=F.substr(0,N+1)+a[A].v),N=F.indexOf(".")+1,s=C;s<a.length;++s)if(!(a[s]==null||"n?(".indexOf(a[s].t)===-1&&s!==C)){for(u=a[s].v.indexOf(".")>-1&&s===C?a[s].v.indexOf(".")+1:0,R=a[s].v.substr(0,u);u<a[s].v.length;++u)N<F.length&&(R+=F.charAt(N++));a[s].v=R,a[s].t="t",A=s}}}for(s=0;s<a.length;++s)a[s]!=null&&"n?".indexOf(a[s].t)>-1&&(P=n>1&&t<0&&s>0&&a[s-1].v==="-"?-t:t,a[s].v=ho(a[s].t,a[s].v,P),a[s].t="t");var W="";for(s=0;s!==a.length;++s)a[s]!=null&&(W+=a[s].v);return W}var Xw=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Kw(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function ZC(e,t){var r=YC(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var s=r[0].match(Xw),o=r[1].match(Xw);return Kw(t,s)?[n,r[0]]:Kw(t,o)?[n,r[1]]:[n,r[s!=null&&o!=null?2:1]]}return[n,i]}function Ui(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Nt)[e],n==null&&(n=r.table&&r.table[Vw[e]]||Nt[Vw[e]]),n==null&&(n=OC[e]||"General");break}if(ap(n,0))return Tc(t,r);t instanceof Date&&(t=cS(t,r.date1904));var a=ZC(n,t);if(ap(a[1]))return Tc(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return JC(a[1],t,r,a[0])}function po(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Nt[r]==null){t<0&&(t=r);continue}if(Nt[r]==e){t=r;break}}t<0&&(t=391)}return Nt[t]=e,t}function Up(e){for(var t=0;t!=392;++t)e[t]!==void 0&&po(e[t],t)}function gu(){Nt=IC()}var QC={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},vS=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function eF(e){var t=typeof e=="number"?Nt[e]:e;return t=t.replace(vS,"(\\d+)"),new RegExp("^"+t+"$")}function tF(e,t,r){var n=-1,a=-1,i=-1,s=-1,o=-1,l=-1;(t.match(vS)||[]).forEach(function(h,m){var f=parseInt(r[m+1],10);switch(h.toLowerCase().charAt(0)){case"y":n=f;break;case"d":i=f;break;case"h":s=f;break;case"s":l=f;break;case"m":s>=0?o=f:a=f;break}}),l>=0&&o==-1&&a>=0&&(o=a,a=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var u=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return s==-1&&o==-1&&l==-1?c:n==-1&&a==-1&&i==-1?u:c+"T"+u}var rF=function(){var e={};e.version="1.2.0";function t(){for(var F=0,C=new Array(256),A=0;A!=256;++A)F=A,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,C[A]=F;return typeof Int32Array<"u"?new Int32Array(C):C}var r=t();function n(F){var C=0,A=0,W=0,L=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(W=0;W!=256;++W)L[W]=F[W];for(W=0;W!=256;++W)for(A=F[W],C=256+W;C<4096;C+=256)A=L[C]=A>>>8^F[A&255];var I=[];for(W=1;W!=16;++W)I[W-1]=typeof Int32Array<"u"?L.subarray(W*256,W*256+256):L.slice(W*256,W*256+256);return I}var a=n(r),i=a[0],s=a[1],o=a[2],l=a[3],c=a[4],u=a[5],h=a[6],m=a[7],f=a[8],v=a[9],x=a[10],w=a[11],_=a[12],b=a[13],y=a[14];function N(F,C){for(var A=C^-1,W=0,L=F.length;W<L;)A=A>>>8^r[(A^F.charCodeAt(W++))&255];return~A}function R(F,C){for(var A=C^-1,W=F.length-15,L=0;L<W;)A=y[F[L++]^A&255]^b[F[L++]^A>>8&255]^_[F[L++]^A>>16&255]^w[F[L++]^A>>>24]^x[F[L++]]^v[F[L++]]^f[F[L++]]^m[F[L++]]^h[F[L++]]^u[F[L++]]^c[F[L++]]^l[F[L++]]^o[F[L++]]^s[F[L++]]^i[F[L++]]^r[F[L++]];for(W+=15;L<W;)A=A>>>8^r[(A^F[L++])&255];return~A}function P(F,C){for(var A=C^-1,W=0,L=F.length,I=0,V=0;W<L;)I=F.charCodeAt(W++),I<128?A=A>>>8^r[(A^I)&255]:I<2048?(A=A>>>8^r[(A^(192|I>>6&31))&255],A=A>>>8^r[(A^(128|I&63))&255]):I>=55296&&I<57344?(I=(I&1023)+64,V=F.charCodeAt(W++)&1023,A=A>>>8^r[(A^(240|I>>8&7))&255],A=A>>>8^r[(A^(128|I>>2&63))&255],A=A>>>8^r[(A^(128|V>>6&15|(I&3)<<4))&255],A=A>>>8^r[(A^(128|V&63))&255]):(A=A>>>8^r[(A^(224|I>>12&15))&255],A=A>>>8^r[(A^(128|I>>6&63))&255],A=A>>>8^r[(A^(128|I&63))&255]);return~A}return e.table=r,e.bstr=N,e.buf=R,e.str=P,e}(),vt=function(){var t={};t.version="1.2.1";function r(U,ne){for(var K=U.split("/"),Z=ne.split("/"),ae=0,se=0,ke=Math.min(K.length,Z.length);ae<ke;++ae){if(se=K[ae].length-Z[ae].length)return se;if(K[ae]!=Z[ae])return K[ae]<Z[ae]?-1:1}return K.length-Z.length}function n(U){if(U.charAt(U.length-1)=="/")return U.slice(0,-1).indexOf("/")===-1?U:n(U.slice(0,-1));var ne=U.lastIndexOf("/");return ne===-1?U:U.slice(0,ne+1)}function a(U){if(U.charAt(U.length-1)=="/")return a(U.slice(0,-1));var ne=U.lastIndexOf("/");return ne===-1?U:U.slice(ne+1)}function i(U,ne){typeof ne=="string"&&(ne=new Date(ne));var K=ne.getHours();K=K<<6|ne.getMinutes(),K=K<<5|ne.getSeconds()>>>1,U.write_shift(2,K);var Z=ne.getFullYear()-1980;Z=Z<<4|ne.getMonth()+1,Z=Z<<5|ne.getDate(),U.write_shift(2,Z)}function s(U){var ne=U.read_shift(2)&65535,K=U.read_shift(2)&65535,Z=new Date,ae=K&31;K>>>=5;var se=K&15;K>>>=4,Z.setMilliseconds(0),Z.setFullYear(K+1980),Z.setMonth(se-1),Z.setDate(ae);var ke=ne&31;ne>>>=5;var Fe=ne&63;return ne>>>=6,Z.setHours(ne),Z.setMinutes(Fe),Z.setSeconds(ke<<1),Z}function o(U){Zn(U,0);for(var ne={},K=0;U.l<=U.length-4;){var Z=U.read_shift(2),ae=U.read_shift(2),se=U.l+ae,ke={};switch(Z){case 21589:K=U.read_shift(1),K&1&&(ke.mtime=U.read_shift(4)),ae>5&&(K&2&&(ke.atime=U.read_shift(4)),K&4&&(ke.ctime=U.read_shift(4))),ke.mtime&&(ke.mt=new Date(ke.mtime*1e3));break}U.l=se,ne[Z]=ke}return ne}var l;function c(){return l||(l={})}function u(U,ne){if(U[0]==80&&U[1]==75)return Br(U,ne);if((U[0]|32)==109&&(U[1]|32)==105)return bt(U,ne);if(U.length<512)throw new Error("CFB file size "+U.length+" < 512");var K=3,Z=512,ae=0,se=0,ke=0,Fe=0,Se=0,Ne=[],Te=U.slice(0,512);Zn(Te,0);var ze=h(Te);switch(K=ze[0],K){case 3:Z=512;break;case 4:Z=4096;break;case 0:if(ze[1]==0)return Br(U,ne);default:throw new Error("Major Version: Expected 3 or 4 saw "+K)}Z!==512&&(Te=U.slice(0,Z),Zn(Te,28));var Ge=U.slice(0,Z);m(Te,K);var rt=Te.read_shift(4,"i");if(K===3&&rt!==0)throw new Error("# Directory Sectors: Expected 0 saw "+rt);Te.l+=4,ke=Te.read_shift(4,"i"),Te.l+=4,Te.chk("00100000","Mini Stream Cutoff Size: "),Fe=Te.read_shift(4,"i"),ae=Te.read_shift(4,"i"),Se=Te.read_shift(4,"i"),se=Te.read_shift(4,"i");for(var Ve=-1,Qe=0;Qe<109&&(Ve=Te.read_shift(4,"i"),!(Ve<0));++Qe)Ne[Qe]=Ve;var Tt=f(U,Z);w(Se,se,Tt,Z,Ne);var yr=b(Tt,ke,Ne,Z);yr[ke].name="!Directory",ae>0&&Fe!==V&&(yr[Fe].name="!MiniFAT"),yr[Ne[0]].name="!FAT",yr.fat_addrs=Ne,yr.ssz=Z;var Jt={},Kr=[],ms=[],qi=[];y(ke,yr,Tt,Kr,ae,Jt,ms,Fe),v(ms,qi,Kr),Kr.shift();var gs={FileIndex:ms,FullPaths:qi};return ne&&ne.raw&&(gs.raw={header:Ge,sectors:Tt}),gs}function h(U){if(U[U.l]==80&&U[U.l+1]==75)return[0,0];U.chk(Q,"Header Signature: "),U.l+=16;var ne=U.read_shift(2,"u");return[U.read_shift(2,"u"),ne]}function m(U,ne){var K=9;switch(U.l+=2,K=U.read_shift(2)){case 9:if(ne!=3)throw new Error("Sector Shift: Expected 9 saw "+K);break;case 12:if(ne!=4)throw new Error("Sector Shift: Expected 12 saw "+K);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+K)}U.chk("0600","Mini Sector Shift: "),U.chk("000000000000","Reserved: ")}function f(U,ne){for(var K=Math.ceil(U.length/ne)-1,Z=[],ae=1;ae<K;++ae)Z[ae-1]=U.slice(ae*ne,(ae+1)*ne);return Z[K-1]=U.slice(K*ne),Z}function v(U,ne,K){for(var Z=0,ae=0,se=0,ke=0,Fe=0,Se=K.length,Ne=[],Te=[];Z<Se;++Z)Ne[Z]=Te[Z]=Z,ne[Z]=K[Z];for(;Fe<Te.length;++Fe)Z=Te[Fe],ae=U[Z].L,se=U[Z].R,ke=U[Z].C,Ne[Z]===Z&&(ae!==-1&&Ne[ae]!==ae&&(Ne[Z]=Ne[ae]),se!==-1&&Ne[se]!==se&&(Ne[Z]=Ne[se])),ke!==-1&&(Ne[ke]=Z),ae!==-1&&Z!=Ne[Z]&&(Ne[ae]=Ne[Z],Te.lastIndexOf(ae)<Fe&&Te.push(ae)),se!==-1&&Z!=Ne[Z]&&(Ne[se]=Ne[Z],Te.lastIndexOf(se)<Fe&&Te.push(se));for(Z=1;Z<Se;++Z)Ne[Z]===Z&&(se!==-1&&Ne[se]!==se?Ne[Z]=Ne[se]:ae!==-1&&Ne[ae]!==ae&&(Ne[Z]=Ne[ae]));for(Z=1;Z<Se;++Z)if(U[Z].type!==0){if(Fe=Z,Fe!=Ne[Fe])do Fe=Ne[Fe],ne[Z]=ne[Fe]+"/"+ne[Z];while(Fe!==0&&Ne[Fe]!==-1&&Fe!=Ne[Fe]);Ne[Z]=-1}for(ne[0]+="/",Z=1;Z<Se;++Z)U[Z].type!==2&&(ne[Z]+="/")}function x(U,ne,K){for(var Z=U.start,ae=U.size,se=[],ke=Z;K&&ae>0&&ke>=0;)se.push(ne.slice(ke*I,ke*I+I)),ae-=I,ke=ic(K,ke*4);return se.length===0?Le(0):$n(se).slice(0,U.size)}function w(U,ne,K,Z,ae){var se=V;if(U===V){if(ne!==0)throw new Error("DIFAT chain shorter than expected")}else if(U!==-1){var ke=K[U],Fe=(Z>>>2)-1;if(!ke)return;for(var Se=0;Se<Fe&&(se=ic(ke,Se*4))!==V;++Se)ae.push(se);w(ic(ke,Z-4),ne-1,K,Z,ae)}}function _(U,ne,K,Z,ae){var se=[],ke=[];ae||(ae=[]);var Fe=Z-1,Se=0,Ne=0;for(Se=ne;Se>=0;){ae[Se]=!0,se[se.length]=Se,ke.push(U[Se]);var Te=K[Math.floor(Se*4/Z)];if(Ne=Se*4&Fe,Z<4+Ne)throw new Error("FAT boundary crossed: "+Se+" 4 "+Z);if(!U[Te])break;Se=ic(U[Te],Ne)}return{nodes:se,data:oy([ke])}}function b(U,ne,K,Z){var ae=U.length,se=[],ke=[],Fe=[],Se=[],Ne=Z-1,Te=0,ze=0,Ge=0,rt=0;for(Te=0;Te<ae;++Te)if(Fe=[],Ge=Te+ne,Ge>=ae&&(Ge-=ae),!ke[Ge]){Se=[];var Ve=[];for(ze=Ge;ze>=0;){Ve[ze]=!0,ke[ze]=!0,Fe[Fe.length]=ze,Se.push(U[ze]);var Qe=K[Math.floor(ze*4/Z)];if(rt=ze*4&Ne,Z<4+rt)throw new Error("FAT boundary crossed: "+ze+" 4 "+Z);if(!U[Qe]||(ze=ic(U[Qe],rt),Ve[ze]))break}se[Ge]={nodes:Fe,data:oy([Se])}}return se}function y(U,ne,K,Z,ae,se,ke,Fe){for(var Se=0,Ne=Z.length?2:0,Te=ne[U].data,ze=0,Ge=0,rt;ze<Te.length;ze+=128){var Ve=Te.slice(ze,ze+128);Zn(Ve,64),Ge=Ve.read_shift(2),rt=Xv(Ve,0,Ge-Ne),Z.push(rt);var Qe={name:rt,type:Ve.read_shift(1),color:Ve.read_shift(1),L:Ve.read_shift(4,"i"),R:Ve.read_shift(4,"i"),C:Ve.read_shift(4,"i"),clsid:Ve.read_shift(16),state:Ve.read_shift(4,"i"),start:0,size:0},Tt=Ve.read_shift(2)+Ve.read_shift(2)+Ve.read_shift(2)+Ve.read_shift(2);Tt!==0&&(Qe.ct=N(Ve,Ve.l-8));var yr=Ve.read_shift(2)+Ve.read_shift(2)+Ve.read_shift(2)+Ve.read_shift(2);yr!==0&&(Qe.mt=N(Ve,Ve.l-8)),Qe.start=Ve.read_shift(4,"i"),Qe.size=Ve.read_shift(4,"i"),Qe.size<0&&Qe.start<0&&(Qe.size=Qe.type=0,Qe.start=V,Qe.name=""),Qe.type===5?(Se=Qe.start,ae>0&&Se!==V&&(ne[Se].name="!StreamData")):Qe.size>=4096?(Qe.storage="fat",ne[Qe.start]===void 0&&(ne[Qe.start]=_(K,Qe.start,ne.fat_addrs,ne.ssz)),ne[Qe.start].name=Qe.name,Qe.content=ne[Qe.start].data.slice(0,Qe.size)):(Qe.storage="minifat",Qe.size<0?Qe.size=0:Se!==V&&Qe.start!==V&&ne[Se]&&(Qe.content=x(Qe,ne[Se].data,(ne[Fe]||{}).data))),Qe.content&&Zn(Qe.content,0),se[rt]=Qe,ke.push(Qe)}}function N(U,ne){return new Date((oi(U,ne+4)/1e7*Math.pow(2,32)+oi(U,ne)/1e7-11644473600)*1e3)}function R(U,ne){return c(),u(l.readFileSync(U),ne)}function P(U,ne){var K=ne&&ne.type;switch(K||Vt&&Buffer.isBuffer(U)&&(K="buffer"),K||"base64"){case"file":return R(U,ne);case"base64":return u(li(mi(U)),ne);case"binary":return u(li(U),ne)}return u(U,ne)}function F(U,ne){var K=ne||{},Z=K.root||"Root Entry";if(U.FullPaths||(U.FullPaths=[]),U.FileIndex||(U.FileIndex=[]),U.FullPaths.length!==U.FileIndex.length)throw new Error("inconsistent CFB structure");U.FullPaths.length===0&&(U.FullPaths[0]=Z+"/",U.FileIndex[0]={name:Z,type:5}),K.CLSID&&(U.FileIndex[0].clsid=K.CLSID),C(U)}function C(U){var ne="Sh33tJ5";if(!vt.find(U,"/"+ne)){var K=Le(4);K[0]=55,K[1]=K[3]=50,K[2]=54,U.FileIndex.push({name:ne,type:2,content:K,size:4,L:69,R:69,C:69}),U.FullPaths.push(U.FullPaths[0]+ne),A(U)}}function A(U,ne){F(U);for(var K=!1,Z=!1,ae=U.FullPaths.length-1;ae>=0;--ae){var se=U.FileIndex[ae];switch(se.type){case 0:Z?K=!0:(U.FileIndex.pop(),U.FullPaths.pop());break;case 1:case 2:case 5:Z=!0,isNaN(se.R*se.L*se.C)&&(K=!0),se.R>-1&&se.L>-1&&se.R==se.L&&(K=!0);break;default:K=!0;break}}if(!(!K&&!ne)){var ke=new Date(1987,1,19),Fe=0,Se=Object.create?Object.create(null):{},Ne=[];for(ae=0;ae<U.FullPaths.length;++ae)Se[U.FullPaths[ae]]=!0,U.FileIndex[ae].type!==0&&Ne.push([U.FullPaths[ae],U.FileIndex[ae]]);for(ae=0;ae<Ne.length;++ae){var Te=n(Ne[ae][0]);Z=Se[Te],Z||(Ne.push([Te,{name:a(Te).replace("/",""),type:1,clsid:me,ct:ke,mt:ke,content:null}]),Se[Te]=!0)}for(Ne.sort(function(rt,Ve){return r(rt[0],Ve[0])}),U.FullPaths=[],U.FileIndex=[],ae=0;ae<Ne.length;++ae)U.FullPaths[ae]=Ne[ae][0],U.FileIndex[ae]=Ne[ae][1];for(ae=0;ae<Ne.length;++ae){var ze=U.FileIndex[ae],Ge=U.FullPaths[ae];if(ze.name=a(Ge).replace("/",""),ze.L=ze.R=ze.C=-(ze.color=1),ze.size=ze.content?ze.content.length:0,ze.start=0,ze.clsid=ze.clsid||me,ae===0)ze.C=Ne.length>1?1:-1,ze.size=0,ze.type=5;else if(Ge.slice(-1)=="/"){for(Fe=ae+1;Fe<Ne.length&&n(U.FullPaths[Fe])!=Ge;++Fe);for(ze.C=Fe>=Ne.length?-1:Fe,Fe=ae+1;Fe<Ne.length&&n(U.FullPaths[Fe])!=n(Ge);++Fe);ze.R=Fe>=Ne.length?-1:Fe,ze.type=1}else n(U.FullPaths[ae+1]||"")==n(Ge)&&(ze.R=ae+1),ze.type=2}}}function W(U,ne){var K=ne||{};if(K.fileType=="mad")return Hi(U,K);switch(A(U),K.fileType){case"zip":return hr(U,K)}var Z=function(rt){for(var Ve=0,Qe=0,Tt=0;Tt<rt.FileIndex.length;++Tt){var yr=rt.FileIndex[Tt];if(yr.content){var Jt=yr.content.length;Jt>0&&(Jt<4096?Ve+=Jt+63>>6:Qe+=Jt+511>>9)}}for(var Kr=rt.FullPaths.length+3>>2,ms=Ve+7>>3,qi=Ve+127>>7,gs=ms+Qe+Kr+qi,_i=gs+127>>7,No=_i<=109?0:Math.ceil((_i-109)/127);gs+_i+No+127>>7>_i;)No=++_i<=109?0:Math.ceil((_i-109)/127);var na=[1,No,_i,qi,Kr,Qe,Ve,0];return rt.FileIndex[0].size=Ve<<6,na[7]=(rt.FileIndex[0].start=na[0]+na[1]+na[2]+na[3]+na[4]+na[5])+(na[6]+7>>3),na}(U),ae=Le(Z[7]<<9),se=0,ke=0;{for(se=0;se<8;++se)ae.write_shift(1,ue[se]);for(se=0;se<8;++se)ae.write_shift(2,0);for(ae.write_shift(2,62),ae.write_shift(2,3),ae.write_shift(2,65534),ae.write_shift(2,9),ae.write_shift(2,6),se=0;se<3;++se)ae.write_shift(2,0);for(ae.write_shift(4,0),ae.write_shift(4,Z[2]),ae.write_shift(4,Z[0]+Z[1]+Z[2]+Z[3]-1),ae.write_shift(4,0),ae.write_shift(4,4096),ae.write_shift(4,Z[3]?Z[0]+Z[1]+Z[2]-1:V),ae.write_shift(4,Z[3]),ae.write_shift(-4,Z[1]?Z[0]-1:V),ae.write_shift(4,Z[1]),se=0;se<109;++se)ae.write_shift(-4,se<Z[2]?Z[1]+se:-1)}if(Z[1])for(ke=0;ke<Z[1];++ke){for(;se<236+ke*127;++se)ae.write_shift(-4,se<Z[2]?Z[1]+se:-1);ae.write_shift(-4,ke===Z[1]-1?V:ke+1)}var Fe=function(rt){for(ke+=rt;se<ke-1;++se)ae.write_shift(-4,se+1);rt&&(++se,ae.write_shift(-4,V))};for(ke=se=0,ke+=Z[1];se<ke;++se)ae.write_shift(-4,pe.DIFSECT);for(ke+=Z[2];se<ke;++se)ae.write_shift(-4,pe.FATSECT);Fe(Z[3]),Fe(Z[4]);for(var Se=0,Ne=0,Te=U.FileIndex[0];Se<U.FileIndex.length;++Se)Te=U.FileIndex[Se],Te.content&&(Ne=Te.content.length,!(Ne<4096)&&(Te.start=ke,Fe(Ne+511>>9)));for(Fe(Z[6]+7>>3);ae.l&511;)ae.write_shift(-4,pe.ENDOFCHAIN);for(ke=se=0,Se=0;Se<U.FileIndex.length;++Se)Te=U.FileIndex[Se],Te.content&&(Ne=Te.content.length,!(!Ne||Ne>=4096)&&(Te.start=ke,Fe(Ne+63>>6)));for(;ae.l&511;)ae.write_shift(-4,pe.ENDOFCHAIN);for(se=0;se<Z[4]<<2;++se){var ze=U.FullPaths[se];if(!ze||ze.length===0){for(Se=0;Se<17;++Se)ae.write_shift(4,0);for(Se=0;Se<3;++Se)ae.write_shift(4,-1);for(Se=0;Se<12;++Se)ae.write_shift(4,0);continue}Te=U.FileIndex[se],se===0&&(Te.start=Te.size?Te.start-1:V);var Ge=se===0&&K.root||Te.name;if(Ne=2*(Ge.length+1),ae.write_shift(64,Ge,"utf16le"),ae.write_shift(2,Ne),ae.write_shift(1,Te.type),ae.write_shift(1,Te.color),ae.write_shift(-4,Te.L),ae.write_shift(-4,Te.R),ae.write_shift(-4,Te.C),Te.clsid)ae.write_shift(16,Te.clsid,"hex");else for(Se=0;Se<4;++Se)ae.write_shift(4,0);ae.write_shift(4,Te.state||0),ae.write_shift(4,0),ae.write_shift(4,0),ae.write_shift(4,0),ae.write_shift(4,0),ae.write_shift(4,Te.start),ae.write_shift(4,Te.size),ae.write_shift(4,0)}for(se=1;se<U.FileIndex.length;++se)if(Te=U.FileIndex[se],Te.size>=4096)if(ae.l=Te.start+1<<9,Vt&&Buffer.isBuffer(Te.content))Te.content.copy(ae,ae.l,0,Te.size),ae.l+=Te.size+511&-512;else{for(Se=0;Se<Te.size;++Se)ae.write_shift(1,Te.content[Se]);for(;Se&511;++Se)ae.write_shift(1,0)}for(se=1;se<U.FileIndex.length;++se)if(Te=U.FileIndex[se],Te.size>0&&Te.size<4096)if(Vt&&Buffer.isBuffer(Te.content))Te.content.copy(ae,ae.l,0,Te.size),ae.l+=Te.size+63&-64;else{for(Se=0;Se<Te.size;++Se)ae.write_shift(1,Te.content[Se]);for(;Se&63;++Se)ae.write_shift(1,0)}if(Vt)ae.l=ae.length;else for(;ae.l<ae.length;)ae.write_shift(1,0);return ae}function L(U,ne){var K=U.FullPaths.map(function(Se){return Se.toUpperCase()}),Z=K.map(function(Se){var Ne=Se.split("/");return Ne[Ne.length-(Se.slice(-1)=="/"?2:1)]}),ae=!1;ne.charCodeAt(0)===47?(ae=!0,ne=K[0].slice(0,-1)+ne):ae=ne.indexOf("/")!==-1;var se=ne.toUpperCase(),ke=ae===!0?K.indexOf(se):Z.indexOf(se);if(ke!==-1)return U.FileIndex[ke];var Fe=!se.match(pf);for(se=se.replace(La,""),Fe&&(se=se.replace(pf,"!")),ke=0;ke<K.length;++ke)if((Fe?K[ke].replace(pf,"!"):K[ke]).replace(La,"")==se||(Fe?Z[ke].replace(pf,"!"):Z[ke]).replace(La,"")==se)return U.FileIndex[ke];return null}var I=64,V=-2,Q="d0cf11e0a1b11ae1",ue=[208,207,17,224,161,177,26,225],me="00000000000000000000000000000000",pe={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:V,FREESECT:-1,HEADER_SIGNATURE:Q,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:me,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function oe(U,ne,K){c();var Z=W(U,K);l.writeFileSync(ne,Z)}function G(U){for(var ne=new Array(U.length),K=0;K<U.length;++K)ne[K]=String.fromCharCode(U[K]);return ne.join("")}function ve(U,ne){var K=W(U,ne);switch(ne&&ne.type||"buffer"){case"file":return c(),l.writeFileSync(ne.filename,K),K;case"binary":return typeof K=="string"?K:G(K);case"base64":return sh(typeof K=="string"?K:G(K));case"buffer":if(Vt)return Buffer.isBuffer(K)?K:bo(K);case"array":return typeof K=="string"?li(K):K}return K}var _e;function E(U){try{var ne=U.InflateRaw,K=new ne;if(K._processChunk(new Uint8Array([3,0]),K._finishFlushFlag),K.bytesRead)_e=U;else throw new Error("zlib does not expose bytesRead")}catch(Z){console.error("cannot use native zlib: "+(Z.message||Z))}}function j(U,ne){if(!_e)return Gt(U,ne);var K=_e.InflateRaw,Z=new K,ae=Z._processChunk(U.slice(U.l),Z._finishFlushFlag);return U.l+=Z.bytesRead,ae}function O(U){return _e?_e.deflateRawSync(U):qe(U)}var B=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Y=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],le=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function fe(U){var ne=(U<<1|U<<11)&139536|(U<<5|U<<15)&558144;return(ne>>16|ne>>8|ne)&255}for(var ce=typeof Uint8Array<"u",de=ce?new Uint8Array(256):[],Ce=0;Ce<256;++Ce)de[Ce]=fe(Ce);function X(U,ne){var K=de[U&255];return ne<=8?K>>>8-ne:(K=K<<8|de[U>>8&255],ne<=16?K>>>16-ne:(K=K<<8|de[U>>16&255],K>>>24-ne))}function $e(U,ne){var K=ne&7,Z=ne>>>3;return(U[Z]|(K<=6?0:U[Z+1]<<8))>>>K&3}function be(U,ne){var K=ne&7,Z=ne>>>3;return(U[Z]|(K<=5?0:U[Z+1]<<8))>>>K&7}function ee(U,ne){var K=ne&7,Z=ne>>>3;return(U[Z]|(K<=4?0:U[Z+1]<<8))>>>K&15}function et(U,ne){var K=ne&7,Z=ne>>>3;return(U[Z]|(K<=3?0:U[Z+1]<<8))>>>K&31}function Re(U,ne){var K=ne&7,Z=ne>>>3;return(U[Z]|(K<=1?0:U[Z+1]<<8))>>>K&127}function tt(U,ne,K){var Z=ne&7,ae=ne>>>3,se=(1<<K)-1,ke=U[ae]>>>Z;return K<8-Z||(ke|=U[ae+1]<<8-Z,K<16-Z)||(ke|=U[ae+2]<<16-Z,K<24-Z)||(ke|=U[ae+3]<<24-Z),ke&se}function Me(U,ne,K){var Z=ne&7,ae=ne>>>3;return Z<=5?U[ae]|=(K&7)<<Z:(U[ae]|=K<<Z&255,U[ae+1]=(K&7)>>8-Z),ne+3}function at(U,ne,K){var Z=ne&7,ae=ne>>>3;return K=(K&1)<<Z,U[ae]|=K,ne+1}function Ye(U,ne,K){var Z=ne&7,ae=ne>>>3;return K<<=Z,U[ae]|=K&255,K>>>=8,U[ae+1]=K,ne+8}function At(U,ne,K){var Z=ne&7,ae=ne>>>3;return K<<=Z,U[ae]|=K&255,K>>>=8,U[ae+1]=K&255,U[ae+2]=K>>>8,ne+16}function ut(U,ne){var K=U.length,Z=2*K>ne?2*K:ne+5,ae=0;if(K>=ne)return U;if(Vt){var se=$w(Z);if(U.copy)U.copy(se);else for(;ae<U.length;++ae)se[ae]=U[ae];return se}else if(ce){var ke=new Uint8Array(Z);if(ke.set)ke.set(U);else for(;ae<K;++ae)ke[ae]=U[ae];return ke}return U.length=Z,U}function Ot(U){for(var ne=new Array(U),K=0;K<U;++K)ne[K]=0;return ne}function _t(U,ne,K){var Z=1,ae=0,se=0,ke=0,Fe=0,Se=U.length,Ne=ce?new Uint16Array(32):Ot(32);for(se=0;se<32;++se)Ne[se]=0;for(se=Se;se<K;++se)U[se]=0;Se=U.length;var Te=ce?new Uint16Array(Se):Ot(Se);for(se=0;se<Se;++se)Ne[ae=U[se]]++,Z<ae&&(Z=ae),Te[se]=0;for(Ne[0]=0,se=1;se<=Z;++se)Ne[se+16]=Fe=Fe+Ne[se-1]<<1;for(se=0;se<Se;++se)Fe=U[se],Fe!=0&&(Te[se]=Ne[Fe+16]++);var ze=0;for(se=0;se<Se;++se)if(ze=U[se],ze!=0)for(Fe=X(Te[se],Z)>>Z-ze,ke=(1<<Z+4-ze)-1;ke>=0;--ke)ne[Fe|ke<<ze]=ze&15|se<<4;return Z}var wt=ce?new Uint16Array(512):Ot(512),er=ce?new Uint16Array(32):Ot(32);if(!ce){for(var mt=0;mt<512;++mt)wt[mt]=0;for(mt=0;mt<32;++mt)er[mt]=0}(function(){for(var U=[],ne=0;ne<32;ne++)U.push(5);_t(U,er,32);var K=[];for(ne=0;ne<=143;ne++)K.push(8);for(;ne<=255;ne++)K.push(9);for(;ne<=279;ne++)K.push(7);for(;ne<=287;ne++)K.push(8);_t(K,wt,288)})();var it=function(){for(var ne=ce?new Uint8Array(32768):[],K=0,Z=0;K<le.length-1;++K)for(;Z<le[K+1];++Z)ne[Z]=K;for(;Z<32768;++Z)ne[Z]=29;var ae=ce?new Uint8Array(259):[];for(K=0,Z=0;K<Y.length-1;++K)for(;Z<Y[K+1];++Z)ae[Z]=K;function se(Fe,Se){for(var Ne=0;Ne<Fe.length;){var Te=Math.min(65535,Fe.length-Ne),ze=Ne+Te==Fe.length;for(Se.write_shift(1,+ze),Se.write_shift(2,Te),Se.write_shift(2,~Te&65535);Te-- >0;)Se[Se.l++]=Fe[Ne++]}return Se.l}function ke(Fe,Se){for(var Ne=0,Te=0,ze=ce?new Uint16Array(32768):[];Te<Fe.length;){var Ge=Math.min(65535,Fe.length-Te);if(Ge<10){for(Ne=Me(Se,Ne,+(Te+Ge==Fe.length)),Ne&7&&(Ne+=8-(Ne&7)),Se.l=Ne/8|0,Se.write_shift(2,Ge),Se.write_shift(2,~Ge&65535);Ge-- >0;)Se[Se.l++]=Fe[Te++];Ne=Se.l*8;continue}Ne=Me(Se,Ne,+(Te+Ge==Fe.length)+2);for(var rt=0;Ge-- >0;){var Ve=Fe[Te];rt=(rt<<5^Ve)&32767;var Qe=-1,Tt=0;if((Qe=ze[rt])&&(Qe|=Te&-32768,Qe>Te&&(Qe-=32768),Qe<Te))for(;Fe[Qe+Tt]==Fe[Te+Tt]&&Tt<250;)++Tt;if(Tt>2){Ve=ae[Tt],Ve<=22?Ne=Ye(Se,Ne,de[Ve+1]>>1)-1:(Ye(Se,Ne,3),Ne+=5,Ye(Se,Ne,de[Ve-23]>>5),Ne+=3);var yr=Ve<8?0:Ve-4>>2;yr>0&&(At(Se,Ne,Tt-Y[Ve]),Ne+=yr),Ve=ne[Te-Qe],Ne=Ye(Se,Ne,de[Ve]>>3),Ne-=3;var Jt=Ve<4?0:Ve-2>>1;Jt>0&&(At(Se,Ne,Te-Qe-le[Ve]),Ne+=Jt);for(var Kr=0;Kr<Tt;++Kr)ze[rt]=Te&32767,rt=(rt<<5^Fe[Te])&32767,++Te;Ge-=Tt-1}else Ve<=143?Ve=Ve+48:Ne=at(Se,Ne,1),Ne=Ye(Se,Ne,de[Ve]),ze[rt]=Te&32767,++Te}Ne=Ye(Se,Ne,0)-1}return Se.l=(Ne+7)/8|0,Se.l}return function(Se,Ne){return Se.length<8?se(Se,Ne):ke(Se,Ne)}}();function qe(U){var ne=Le(50+Math.floor(U.length*1.1)),K=it(U,ne);return ne.slice(0,K)}var Ze=ce?new Uint16Array(32768):Ot(32768),Ht=ce?new Uint16Array(32768):Ot(32768),kt=ce?new Uint16Array(128):Ot(128),st=1,Lt=1;function fr(U,ne){var K=et(U,ne)+257;ne+=5;var Z=et(U,ne)+1;ne+=5;var ae=ee(U,ne)+4;ne+=4;for(var se=0,ke=ce?new Uint8Array(19):Ot(19),Fe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Se=1,Ne=ce?new Uint8Array(8):Ot(8),Te=ce?new Uint8Array(8):Ot(8),ze=ke.length,Ge=0;Ge<ae;++Ge)ke[B[Ge]]=se=be(U,ne),Se<se&&(Se=se),Ne[se]++,ne+=3;var rt=0;for(Ne[0]=0,Ge=1;Ge<=Se;++Ge)Te[Ge]=rt=rt+Ne[Ge-1]<<1;for(Ge=0;Ge<ze;++Ge)(rt=ke[Ge])!=0&&(Fe[Ge]=Te[rt]++);var Ve=0;for(Ge=0;Ge<ze;++Ge)if(Ve=ke[Ge],Ve!=0){rt=de[Fe[Ge]]>>8-Ve;for(var Qe=(1<<7-Ve)-1;Qe>=0;--Qe)kt[rt|Qe<<Ve]=Ve&7|Ge<<3}var Tt=[];for(Se=1;Tt.length<K+Z;)switch(rt=kt[Re(U,ne)],ne+=rt&7,rt>>>=3){case 16:for(se=3+$e(U,ne),ne+=2,rt=Tt[Tt.length-1];se-- >0;)Tt.push(rt);break;case 17:for(se=3+be(U,ne),ne+=3;se-- >0;)Tt.push(0);break;case 18:for(se=11+Re(U,ne),ne+=7;se-- >0;)Tt.push(0);break;default:Tt.push(rt),Se<rt&&(Se=rt);break}var yr=Tt.slice(0,K),Jt=Tt.slice(K);for(Ge=K;Ge<286;++Ge)yr[Ge]=0;for(Ge=Z;Ge<30;++Ge)Jt[Ge]=0;return st=_t(yr,Ze,286),Lt=_t(Jt,Ht,30),ne}function yt(U,ne){if(U[0]==3&&!(U[1]&3))return[yl(ne),2];for(var K=0,Z=0,ae=$w(ne||1<<18),se=0,ke=ae.length>>>0,Fe=0,Se=0;!(Z&1);){if(Z=be(U,K),K+=3,Z>>>1)Z>>1==1?(Fe=9,Se=5):(K=fr(U,K),Fe=st,Se=Lt);else{K&7&&(K+=8-(K&7));var Ne=U[K>>>3]|U[(K>>>3)+1]<<8;if(K+=32,Ne>0)for(!ne&&ke<se+Ne&&(ae=ut(ae,se+Ne),ke=ae.length);Ne-- >0;)ae[se++]=U[K>>>3],K+=8;continue}for(;;){!ne&&ke<se+32767&&(ae=ut(ae,se+32767),ke=ae.length);var Te=tt(U,K,Fe),ze=Z>>>1==1?wt[Te]:Ze[Te];if(K+=ze&15,ze>>>=4,!(ze>>>8&255))ae[se++]=ze;else{if(ze==256)break;ze-=257;var Ge=ze<8?0:ze-4>>2;Ge>5&&(Ge=0);var rt=se+Y[ze];Ge>0&&(rt+=tt(U,K,Ge),K+=Ge),Te=tt(U,K,Se),ze=Z>>>1==1?er[Te]:Ht[Te],K+=ze&15,ze>>>=4;var Ve=ze<4?0:ze-2>>1,Qe=le[ze];for(Ve>0&&(Qe+=tt(U,K,Ve),K+=Ve),!ne&&ke<rt&&(ae=ut(ae,rt+100),ke=ae.length);se<rt;)ae[se]=ae[se-Qe],++se}}}return ne?[ae,K+7>>>3]:[ae.slice(0,se),K+7>>>3]}function Gt(U,ne){var K=U.slice(U.l||0),Z=yt(K,ne);return U.l+=Z[1],Z[0]}function Pt(U,ne){if(U)typeof console<"u"&&console.error(ne);else throw new Error(ne)}function Br(U,ne){var K=U;Zn(K,0);var Z=[],ae=[],se={FileIndex:Z,FullPaths:ae};F(se,{root:ne.root});for(var ke=K.length-4;(K[ke]!=80||K[ke+1]!=75||K[ke+2]!=5||K[ke+3]!=6)&&ke>=0;)--ke;K.l=ke+4,K.l+=4;var Fe=K.read_shift(2);K.l+=6;var Se=K.read_shift(4);for(K.l=Se,ke=0;ke<Fe;++ke){K.l+=20;var Ne=K.read_shift(4),Te=K.read_shift(4),ze=K.read_shift(2),Ge=K.read_shift(2),rt=K.read_shift(2);K.l+=8;var Ve=K.read_shift(4),Qe=o(K.slice(K.l+ze,K.l+ze+Ge));K.l+=ze+Ge+rt;var Tt=K.l;K.l=Ve+4,an(K,Ne,Te,se,Qe),K.l=Tt}return se}function an(U,ne,K,Z,ae){U.l+=2;var se=U.read_shift(2),ke=U.read_shift(2),Fe=s(U);if(se&8257)throw new Error("Unsupported ZIP encryption");for(var Se=U.read_shift(4),Ne=U.read_shift(4),Te=U.read_shift(4),ze=U.read_shift(2),Ge=U.read_shift(2),rt="",Ve=0;Ve<ze;++Ve)rt+=String.fromCharCode(U[U.l++]);if(Ge){var Qe=o(U.slice(U.l,U.l+Ge));(Qe[21589]||{}).mt&&(Fe=Qe[21589].mt),((ae||{})[21589]||{}).mt&&(Fe=ae[21589].mt)}U.l+=Ge;var Tt=U.slice(U.l,U.l+Ne);switch(ke){case 8:Tt=j(U,Te);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ke)}var yr=!1;se&8&&(Se=U.read_shift(4),Se==134695760&&(Se=U.read_shift(4),yr=!0),Ne=U.read_shift(4),Te=U.read_shift(4)),Ne!=ne&&Pt(yr,"Bad compressed size: "+ne+" != "+Ne),Te!=K&&Pt(yr,"Bad uncompressed size: "+K+" != "+Te),ra(Z,rt,Tt,{unsafe:!0,mt:Fe})}function hr(U,ne){var K=ne||{},Z=[],ae=[],se=Le(1),ke=K.compression?8:0,Fe=0,Se=0,Ne=0,Te=0,ze=0,Ge=U.FullPaths[0],rt=Ge,Ve=U.FileIndex[0],Qe=[],Tt=0;for(Se=1;Se<U.FullPaths.length;++Se)if(rt=U.FullPaths[Se].slice(Ge.length),Ve=U.FileIndex[Se],!(!Ve.size||!Ve.content||rt=="Sh33tJ5")){var yr=Te,Jt=Le(rt.length);for(Ne=0;Ne<rt.length;++Ne)Jt.write_shift(1,rt.charCodeAt(Ne)&127);Jt=Jt.slice(0,Jt.l),Qe[ze]=rF.buf(Ve.content,0);var Kr=Ve.content;ke==8&&(Kr=O(Kr)),se=Le(30),se.write_shift(4,67324752),se.write_shift(2,20),se.write_shift(2,Fe),se.write_shift(2,ke),Ve.mt?i(se,Ve.mt):se.write_shift(4,0),se.write_shift(-4,Qe[ze]),se.write_shift(4,Kr.length),se.write_shift(4,Ve.content.length),se.write_shift(2,Jt.length),se.write_shift(2,0),Te+=se.length,Z.push(se),Te+=Jt.length,Z.push(Jt),Te+=Kr.length,Z.push(Kr),se=Le(46),se.write_shift(4,33639248),se.write_shift(2,0),se.write_shift(2,20),se.write_shift(2,Fe),se.write_shift(2,ke),se.write_shift(4,0),se.write_shift(-4,Qe[ze]),se.write_shift(4,Kr.length),se.write_shift(4,Ve.content.length),se.write_shift(2,Jt.length),se.write_shift(2,0),se.write_shift(2,0),se.write_shift(2,0),se.write_shift(2,0),se.write_shift(4,0),se.write_shift(4,yr),Tt+=se.l,ae.push(se),Tt+=Jt.length,ae.push(Jt),++ze}return se=Le(22),se.write_shift(4,101010256),se.write_shift(2,0),se.write_shift(2,0),se.write_shift(2,ze),se.write_shift(2,ze),se.write_shift(4,Tt),se.write_shift(4,Te),se.write_shift(2,0),$n([$n(Z),$n(ae),se])}var St={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function sr(U,ne){if(U.ctype)return U.ctype;var K=U.name||"",Z=K.match(/\.([^\.]+)$/);return Z&&St[Z[1]]||ne&&(Z=(K=ne).match(/[\.\\]([^\.\\])+$/),Z&&St[Z[1]])?St[Z[1]]:"application/octet-stream"}function Us(U){for(var ne=sh(U),K=[],Z=0;Z<ne.length;Z+=76)K.push(ne.slice(Z,Z+76));return K.join(`\r
`)+`\r
`}function Dn(U){var ne=U.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Ne){var Te=Ne.charCodeAt(0).toString(16).toUpperCase();return"="+(Te.length==1?"0"+Te:Te)});ne=ne.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),ne.charAt(0)==`
`&&(ne="=0D"+ne.slice(1)),ne=ne.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var K=[],Z=ne.split(`\r
`),ae=0;ae<Z.length;++ae){var se=Z[ae];if(se.length==0){K.push("");continue}for(var ke=0;ke<se.length;){var Fe=76,Se=se.slice(ke,ke+Fe);Se.charAt(Fe-1)=="="?Fe--:Se.charAt(Fe-2)=="="?Fe-=2:Se.charAt(Fe-3)=="="&&(Fe-=3),Se=se.slice(ke,ke+Fe),ke+=Fe,ke<se.length&&(Se+="="),K.push(Se)}}return K.join(`\r
`)}function Wi(U){for(var ne=[],K=0;K<U.length;++K){for(var Z=U[K];K<=U.length&&Z.charAt(Z.length-1)=="=";)Z=Z.slice(0,Z.length-1)+U[++K];ne.push(Z)}for(var ae=0;ae<ne.length;++ae)ne[ae]=ne[ae].replace(/[=][0-9A-Fa-f]{2}/g,function(se){return String.fromCharCode(parseInt(se.slice(1),16))});return li(ne.join(`\r
`))}function vi(U,ne,K){for(var Z="",ae="",se="",ke,Fe=0;Fe<10;++Fe){var Se=ne[Fe];if(!Se||Se.match(/^\s*$/))break;var Ne=Se.match(/^(.*?):\s*([^\s].*)$/);if(Ne)switch(Ne[1].toLowerCase()){case"content-location":Z=Ne[2].trim();break;case"content-type":se=Ne[2].trim();break;case"content-transfer-encoding":ae=Ne[2].trim();break}}switch(++Fe,ae.toLowerCase()){case"base64":ke=li(mi(ne.slice(Fe).join("")));break;case"quoted-printable":ke=Wi(ne.slice(Fe));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+ae)}var Te=ra(U,Z.slice(K.length),ke,{unsafe:!0});se&&(Te.ctype=se)}function bt(U,ne){if(G(U.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var K=ne&&ne.root||"",Z=(Vt&&Buffer.isBuffer(U)?U.toString("binary"):G(U)).split(`\r
`),ae=0,se="";for(ae=0;ae<Z.length;++ae)if(se=Z[ae],!!/^Content-Location:/i.test(se)&&(se=se.slice(se.indexOf("file")),K||(K=se.slice(0,se.lastIndexOf("/")+1)),se.slice(0,K.length)!=K))for(;K.length>0&&(K=K.slice(0,K.length-1),K=K.slice(0,K.lastIndexOf("/")+1),se.slice(0,K.length)!=K););var ke=(Z[1]||"").match(/boundary="(.*?)"/);if(!ke)throw new Error("MAD cannot find boundary");var Fe="--"+(ke[1]||""),Se=[],Ne=[],Te={FileIndex:Se,FullPaths:Ne};F(Te);var ze,Ge=0;for(ae=0;ae<Z.length;++ae){var rt=Z[ae];rt!==Fe&&rt!==Fe+"--"||(Ge++&&vi(Te,Z.slice(ze,ae),K),ze=ae)}return Te}function Hi(U,ne){var K=ne||{},Z=K.boundary||"SheetJS";Z="------="+Z;for(var ae=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+Z.slice(2)+'"',"","",""],se=U.FullPaths[0],ke=se,Fe=U.FileIndex[0],Se=1;Se<U.FullPaths.length;++Se)if(ke=U.FullPaths[Se].slice(se.length),Fe=U.FileIndex[Se],!(!Fe.size||!Fe.content||ke=="Sh33tJ5")){ke=ke.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Tt){return"_x"+Tt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Tt){return"_u"+Tt.charCodeAt(0).toString(16)+"_"});for(var Ne=Fe.content,Te=Vt&&Buffer.isBuffer(Ne)?Ne.toString("binary"):G(Ne),ze=0,Ge=Math.min(1024,Te.length),rt=0,Ve=0;Ve<=Ge;++Ve)(rt=Te.charCodeAt(Ve))>=32&&rt<128&&++ze;var Qe=ze>=Ge*4/5;ae.push(Z),ae.push("Content-Location: "+(K.root||"file:///C:/SheetJS/")+ke),ae.push("Content-Transfer-Encoding: "+(Qe?"quoted-printable":"base64")),ae.push("Content-Type: "+sr(Fe,ke)),ae.push(""),ae.push(Qe?Dn(Te):Us(Te))}return ae.push(Z+`--\r
`),ae.join(`\r
`)}function Vi(U){var ne={};return F(ne,U),ne}function ra(U,ne,K,Z){var ae=Z&&Z.unsafe;ae||F(U);var se=!ae&&vt.find(U,ne);if(!se){var ke=U.FullPaths[0];ne.slice(0,ke.length)==ke?ke=ne:(ke.slice(-1)!="/"&&(ke+="/"),ke=(ke+ne).replace("//","/")),se={name:a(ne),type:2},U.FileIndex.push(se),U.FullPaths.push(ke),ae||vt.utils.cfb_gc(U)}return se.content=K,se.size=K?K.length:0,Z&&(Z.CLSID&&(se.clsid=Z.CLSID),Z.mt&&(se.mt=Z.mt),Z.ct&&(se.ct=Z.ct)),se}function Oa(U,ne){F(U);var K=vt.find(U,ne);if(K){for(var Z=0;Z<U.FileIndex.length;++Z)if(U.FileIndex[Z]==K)return U.FileIndex.splice(Z,1),U.FullPaths.splice(Z,1),!0}return!1}function Ur(U,ne,K){F(U);var Z=vt.find(U,ne);if(Z){for(var ae=0;ae<U.FileIndex.length;++ae)if(U.FileIndex[ae]==Z)return U.FileIndex[ae].name=a(K),U.FullPaths[ae]=K,!0}return!1}function vn(U){A(U,!0)}return t.find=L,t.read=P,t.parse=u,t.write=ve,t.writeFile=oe,t.utils={cfb_new:Vi,cfb_add:ra,cfb_del:Oa,cfb_mov:Ur,cfb_gc:vn,ReadShift:Tf,CheckField:US,prep_blob:Zn,bconcat:$n,use_zlib:E,_deflateRaw:qe,_inflateRaw:Gt,consts:pe},t}();function nF(e){return typeof e=="string"?Bp(e):Array.isArray(e)?CC(e):e}function Oh(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Bp(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?Ls(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var a=new Blob([nF(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,e);if(typeof saveAs<"u")return saveAs(a,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var s=document.createElement("a");if(s.download!=null)return s.download=e,s.href=i,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=Cl(t)),o.write(t),o.close(),t}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+e)}function aF(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function nn(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function Yw(e,t){for(var r=[],n=nn(e),a=0;a!==n.length;++a)r[e[n[a]][t]]==null&&(r[e[n[a]][t]]=n[a]);return r}function zp(e){for(var t=[],r=nn(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function $p(e){for(var t=[],r=nn(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function iF(e){for(var t=[],r=nn(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var sp=new Date(1899,11,30,0,0,0);function Rn(e,t){var r=e.getTime(),n=sp.getTime()+(e.getTimezoneOffset()-sp.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var _S=new Date,sF=sp.getTime()+(_S.getTimezoneOffset()-sp.getTimezoneOffset())*6e4,Jw=_S.getTimezoneOffset();function Wp(e){var t=new Date;return t.setTime(e*24*60*60*1e3+sF),t.getTimezoneOffset()!==Jw&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Jw)*6e4),t}function oF(e){var t=0,r=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var i=1;i!=a.length;++i)if(a[i]){switch(r=1,i>3&&(n=!0),a[i].slice(a[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[i].slice(a[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(a[i],10)}return t}var Zw=new Date("2017-02-19T19:06:09.000Z"),wS=isNaN(Zw.getFullYear())?new Date("2/19/17"):Zw,lF=wS.getFullYear()==2017;function Dr(e,t){var r=new Date(e);if(lF)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(wS.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function Cc(e,t){if(Vt&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Ls(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Ls(oS(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Ls(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Ls(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(i){return r[i]||i})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function Mr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Mr(e[r]));return t}function tn(e,t){for(var r="";r.length<t;)r+=e;return r}function cs(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,i){return r=-r,i}),!isNaN(t=Number(n)))?t/r:t}var cF=["january","february","march","april","may","june","july","august","september","october","november","december"];function au(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),a=t.getMonth(),i=t.getDate();if(isNaN(i))return r;var s=e.toLowerCase();if(s.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(s=s.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),s.length>3&&cF.indexOf(s)==-1)return r}else if(s.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||i>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var uF=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(e||typeof n=="string")return r.split(n);for(var i=r.split(n),s=[i[0]],o=1;o<i.length;++o)s.push(a),s.push(i[o]);return s}}();function yS(e){return e?e.content&&e.type?Cc(e.content,!0):e.data?df(e.data):e.asNodeBuffer&&Vt?df(e.asNodeBuffer().toString("binary")):e.asBinary?df(e.asBinary()):e._data&&e._data.getContent?df(Cc(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function bS(e){if(!e)return null;if(e.data)return Uw(e.data);if(e.asNodeBuffer&&Vt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?Uw(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function fF(e){return e&&e.name.slice(-4)===".bin"?bS(e):yS(e)}function Ci(e,t){for(var r=e.FullPaths||nn(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),i=0;i<r.length;++i){var s=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==s||a==s)return e.files?e.files[r[i]]:e.FileIndex[i]}return null}function $v(e,t){var r=Ci(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function kn(e,t,r){if(!r)return fF($v(e,t));if(!t)return null;try{return kn(e,t)}catch{return null}}function ci(e,t,r){if(!r)return yS($v(e,t));if(!t)return null;try{return ci(e,t)}catch{return null}}function hF(e,t,r){return bS($v(e,t))}function Qw(e){for(var t=e.FullPaths||nn(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function Wt(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return Vt?n=bo(r):n=FC(r),vt.utils.cfb_add(e,t,n)}vt.utils.cfb_add(e,t,r)}else e.file(t,r)}function Wv(){return vt.utils.cfb_new()}function kS(e,t){switch(t.type){case"base64":return vt.read(e,{type:"base64"});case"binary":return vt.read(e,{type:"binary"});case"buffer":case"array":return vt.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function mf(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var xn=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,dF=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,ey=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,pF=/<[^>]*>/g,ya=xn.match(ey)?ey:pF,mF=/<\w*:/,gF=/<(\/?)\w+:/;function Ct(e,t,r){for(var n={},a=0,i=0;a!==e.length&&!((i=e.charCodeAt(a))===32||i===10||i===13);++a);if(t||(n[0]=e.slice(0,a)),a===e.length)return n;var s=e.match(dF),o=0,l="",c=0,u="",h="",m=1;if(s)for(c=0;c!=s.length;++c){for(h=s[c],i=0;i!=h.length&&h.charCodeAt(i)!==61;++i);for(u=h.slice(0,i).trim();h.charCodeAt(i+1)==32;)++i;for(m=(a=h.charCodeAt(i+1))==34||a==39?1:0,l=h.slice(i+1+m,h.length-m),o=0;o!=u.length&&u.charCodeAt(o)!==58;++o);if(o===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),n[u]=l,n[u.toLowerCase()]=l;else{var f=(o===5&&u.slice(0,5)==="xmlns"?"xmlns":"")+u.slice(o+1);if(n[f]&&u.slice(o-3,o)=="ext")continue;n[f]=l,n[f.toLowerCase()]=l}}return n}function Ds(e){return e.replace(gF,"<$1")}var SS={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Hv=zp(SS),ar=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",i=a.indexOf("<![CDATA[");if(i==-1)return a.replace(e,function(o,l){return SS[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,l){return String.fromCharCode(parseInt(l,16))});var s=a.indexOf("]]>");return r(a.slice(0,i))+a.slice(i+9,s)+r(a.slice(s+3))}}(),Vv=/[&<>'"]/g,xF=/[\u0000-\u0008\u000b-\u001f]/g;function _r(e){var t=e+"";return t.replace(Vv,function(r){return Hv[r]}).replace(xF,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function ty(e){return _r(e).replace(/ /g,"_x0020_")}var NS=/[\u0000-\u001f]/g;function qv(e){var t=e+"";return t.replace(Vv,function(r){return Hv[r]}).replace(/\n/g,"<br/>").replace(NS,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function vF(e){var t=e+"";return t.replace(Vv,function(r){return Hv[r]}).replace(NS,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var ry=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function _F(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function Or(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function ug(e){for(var t="",r=0,n=0,a=0,i=0,s=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(a=e.charCodeAt(r++),n>191&&n<224){s=(n&31)<<6,s|=a&63,t+=String.fromCharCode(s);continue}if(i=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(a&63)<<6|i&63);continue}s=e.charCodeAt(r++),o=((n&7)<<18|(a&63)<<12|(i&63)<<6|s&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function ny(e){var t=yl(2*e.length),r,n,a=1,i=0,s=0,o;for(n=0;n<e.length;n+=a)a=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),a=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,s=55296+(r>>>10&1023),r=56320+(r&1023)),s!==0&&(t[i++]=s&255,t[i++]=s>>>8,s=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function ay(e){return bo(e,"binary").toString("utf8")}var zd="foo bar bazâð£",br=Vt&&(ay(zd)==ug(zd)&&ay||ny(zd)==ug(zd)&&ny)||ug,Ls=Vt?function(e){return bo(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},lh=function(){var e={};return function(r,n){var a=r+"|"+(n||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),ES=function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}}(),wF=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),yF=/<\/?(?:vt:)?variant>/g,bF=/<(?:vt:)([^>]*)>([\s\S]*)</;function iy(e,t){var r=Ct(e),n=e.match(wF(r.baseType))||[],a=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(i){var s=i.replace(yF,"").match(bF);s&&a.push({v:br(s[2]),t:s[1]})}),a}var AS=/(^\s|\s$|\n)/;function Qn(e,t){return"<"+e+(t.match(AS)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function ch(e){return nn(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Xe(e,t,r){return"<"+e+(r!=null?ch(r):"")+(t!=null?(t.match(AS)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function ex(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function kF(e,t){switch(typeof e){case"string":var r=Xe("vt:lpwstr",_r(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Xe((e|0)==e?"vt:i4":"vt:r8",_r(String(e)));case"boolean":return Xe("vt:bool",e?"true":"false")}if(e instanceof Date)return Xe("vt:filetime",ex(e));throw new Error("Unable to serialize "+e)}function Gv(e){if(Vt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return br(Cl(Bv(e)));throw new Error("Bad input format: expected Buffer or string")}var uh=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,On={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Bc=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],si={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function SF(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,i=5;i>=0;--i)a=a*256+e[t+i];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function NF(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,i=0,s=n?-t:t;isFinite(s)?s==0?a=i=0:(a=Math.floor(Math.log(s)/Math.LN2),i=s*Math.pow(2,52-a),a<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?a=-1022:(i-=Math.pow(2,52),a+=1023)):(a=2047,i=isNaN(t)?26985:0);for(var o=0;o<=5;++o,i/=256)e[r+o]=i&255;e[r+6]=(a&15)<<4|i&15,e[r+7]=a>>4|n}var sy=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,i=e[0][n].length;a<i;a+=r)t.push.apply(t,e[0][n].slice(a,a+r));return t},oy=Vt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:bo(t)})):sy(e)}:sy,ly=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(lo(e,a)));return n.join("").replace(La,"")},Xv=Vt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(La,""):ly(e,t,r)}:ly,cy=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},TS=Vt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):cy(e,t,r)}:cy,uy=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(g0(e,a)));return n.join("")},jh=Vt?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):uy(t,r,n)}:uy,CS=function(e,t){var r=oi(e,t);return r>0?jh(e,t+4,t+4+r-1):""},FS=CS,LS=function(e,t){var r=oi(e,t);return r>0?jh(e,t+4,t+4+r-1):""},PS=LS,IS=function(e,t){var r=2*oi(e,t);return r>0?jh(e,t+4,t+4+r-1):""},OS=IS,jS=function(t,r){var n=oi(t,r);return n>0?Xv(t,r+4,r+4+n):""},RS=jS,DS=function(e,t){var r=oi(e,t);return r>0?jh(e,t+4,t+4+r):""},MS=DS,BS=function(e,t){return SF(e,t)},op=BS,Kv=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Vt&&(FS=function(t,r){if(!Buffer.isBuffer(t))return CS(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},PS=function(t,r){if(!Buffer.isBuffer(t))return LS(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},OS=function(t,r){if(!Buffer.isBuffer(t))return IS(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},RS=function(t,r){if(!Buffer.isBuffer(t))return jS(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},MS=function(t,r){if(!Buffer.isBuffer(t))return DS(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},op=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):BS(t,r)},Kv=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var g0=function(e,t){return e[t]},lo=function(e,t){return e[t+1]*256+e[t]},EF=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},oi=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},ic=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},AF=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Tf(e,t){var r="",n,a,i=[],s,o,l,c;switch(t){case"dbcs":if(c=this.l,Vt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)r+=String.fromCharCode(lo(this,c)),c+=2;e*=2;break;case"utf8":r=jh(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Xv(this,this.l,this.l+e);break;case"wstr":return Tf.call(this,e,"dbcs");case"lpstr-ansi":r=FS(this,this.l),e=4+oi(this,this.l);break;case"lpstr-cp":r=PS(this,this.l),e=4+oi(this,this.l);break;case"lpwstr":r=OS(this,this.l),e=4+2*oi(this,this.l);break;case"lpp4":e=4+oi(this,this.l),r=RS(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+oi(this,this.l),r=MS(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(s=g0(this,this.l+e++))!==0;)i.push(Ud(s));r=i.join("");break;case"_wstr":for(e=0,r="";(s=lo(this,this.l+e))!==0;)i.push(Ud(s)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",c=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return s=g0(this,c),this.l=c+1,o=Tf.call(this,e-l,s?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(Ud(lo(this,c))),c+=2}r=i.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return s=g0(this,c),this.l=c+1,o=Tf.call(this,e-l,s?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(Ud(g0(this,c))),c+=1}r=i.join("");break;default:switch(e){case 1:return n=g0(this,this.l),this.l++,n;case 2:return n=(t==="i"?EF:lo)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?ic:AF)(this,this.l),this.l+=4,n):(a=oi(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=op(this,this.l):a=op([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:r=TS(this,this.l,e);break}}return this.l+=e,r}var TF=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},CF=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},FF=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function LF(e,t,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=t.length;++a)FF(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;n=t.length}else if(r==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var s=t.charCodeAt(a);this[this.l++]=s&255,this[this.l++]=s>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,TF(this,t,this.l);break;case 8:if(n=8,r==="f"){NF(this,t,this.l);break}case 16:break;case-4:n=4,CF(this,t,this.l);break}return this.l+=n,this}function US(e,t){var r=TS(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Zn(e,t){e.l=t,e.read_shift=Tf,e.chk=US,e.write_shift=LF}function wa(e,t){e.l+=t}function Le(e){var t=yl(e);return Zn(t,0),t}function ko(e,t,r){if(e){var n,a,i;Zn(e,e.l||0);for(var s=e.length,o=0,l=0;e.l<s;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var c=gh[o]||gh[65535];for(n=e.read_shift(1),i=n&127,a=1;a<4&&n&128;++a)i+=((n=e.read_shift(1))&127)<<7*a;l=e.l+i;var u=c.f&&c.f(e,i,r);if(e.l=l,t(u,c,o))return}}}function qa(){var e=[],t=Vt?256:2048,r=function(c){var u=Le(c);return Zn(u,0),u},n=r(t),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},i=function(c){return n&&c<n.length-n.l?n:(a(),n=r(Math.max(c+1,t)))},s=function(){return a(),$n(e)},o=function(c){a(),n=c,n.l==null&&(n.l=n.length),i(t)};return{next:i,push:o,end:s,_bufs:e}}function De(e,t,r,n){var a=+t,i;if(!isNaN(a)){n||(n=gh[a].p||(r||[]).length||0),i=1+(a>=128?1:0)+1,n>=128&&++i,n>=16384&&++i,n>=2097152&&++i;var s=e.next(i);a<=127?s.write_shift(1,a):(s.write_shift(1,(a&127)+128),s.write_shift(1,a>>7));for(var o=0;o!=4;++o)if(n>=128)s.write_shift(1,(n&127)+128),n>>=7;else{s.write_shift(1,n);break}n>0&&Kv(r)&&e.push(r)}}function Cf(e,t,r){var n=Mr(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function fy(e,t,r){var n=Mr(e);return n.s=Cf(n.s,t.s,r),n.e=Cf(n.e,t.s,r),n}function Ff(e,t){if(e.cRel&&e.c<0)for(e=Mr(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Mr(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Et(e);return!e.cRel&&e.cRel!=null&&(r=OF(r)),!e.rRel&&e.rRel!=null&&(r=PF(r)),r}function fg(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Vr(e.s.c)+":"+(e.e.cRel?"":"$")+Vr(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+gn(e.s.r)+":"+(e.e.rRel?"":"$")+gn(e.e.r):Ff(e.s,t.biff)+":"+Ff(e.e,t.biff)}function Yv(e){return parseInt(IF(e),10)-1}function gn(e){return""+(e+1)}function PF(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function IF(e){return e.replace(/\$(\d+)$/,"$1")}function Jv(e){for(var t=jF(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Vr(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function OF(e){return e.replace(/^([A-Z])/,"$$$1")}function jF(e){return e.replace(/^\$([A-Z])/,"$1")}function RF(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function qr(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function Et(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Ga(e){var t=e.indexOf(":");return t==-1?{s:qr(e),e:qr(e)}:{s:qr(e.slice(0,t)),e:qr(e.slice(t+1))}}function Ut(e,t){return typeof t>"u"||typeof t=="number"?Ut(e.s,e.e):(typeof e!="string"&&(e=Et(e)),typeof t!="string"&&(t=Et(t)),e==t?e:e+":"+t)}function ir(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,i=e.length;for(r=0;n<i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===i||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function hy(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Ui(e.z,r?Rn(t):t)}catch{}try{return e.w=Ui((e.XF||{}).numFmtId||(r?14:0),r?Rn(t):t)}catch{return""+t}}function wo(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?So[e.v]||e.v:t==null?hy(e,e.v):hy(e,t))}function Fl(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function zS(e,t,r){var n=r||{},a=e?Array.isArray(e):n.dense,i=e||(a?[]:{}),s=0,o=0;if(i&&n.origin!=null){if(typeof n.origin=="number")s=n.origin;else{var l=typeof n.origin=="string"?qr(n.origin):n.origin;s=l.r,o=l.c}i["!ref"]||(i["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var u=ir(i["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),s==-1&&(c.e.r=s=u.e.r+1)}for(var h=0;h!=t.length;++h)if(t[h]){if(!Array.isArray(t[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var m=0;m!=t[h].length;++m)if(!(typeof t[h][m]>"u")){var f={v:t[h][m]},v=s+h,x=o+m;if(c.s.r>v&&(c.s.r=v),c.s.c>x&&(c.s.c=x),c.e.r<v&&(c.e.r=v),c.e.c<x&&(c.e.c=x),t[h][m]&&typeof t[h][m]=="object"&&!Array.isArray(t[h][m])&&!(t[h][m]instanceof Date))f=t[h][m];else if(Array.isArray(f.v)&&(f.f=t[h][m][1],f.v=f.v[0]),f.v===null)if(f.f)f.t="n";else if(n.nullError)f.t="e",f.v=0;else if(n.sheetStubs)f.t="z";else continue;else typeof f.v=="number"?f.t="n":typeof f.v=="boolean"?f.t="b":f.v instanceof Date?(f.z=n.dateNF||Nt[14],n.cellDates?(f.t="d",f.w=Ui(f.z,Rn(f.v))):(f.t="n",f.v=Rn(f.v),f.w=Ui(f.z,f.v))):f.t="s";if(a)i[v]||(i[v]=[]),i[v][x]&&i[v][x].z&&(f.z=i[v][x].z),i[v][x]=f;else{var w=Et({c:x,r:v});i[w]&&i[w].z&&(f.z=i[w].z),i[w]=f}}}return c.s.c<1e7&&(i["!ref"]=Ut(c)),i}function xu(e,t){return zS(null,e,t)}function DF(e){return e.read_shift(4,"i")}function us(e,t){return t||(t=Le(4)),t.write_shift(4,e),t}function va(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Wn(e,t){var r=!1;return t==null&&(r=!0,t=Le(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function MF(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function BF(e,t){return t||(t=Le(4)),t.write_shift(2,0),t.write_shift(2,0),t}function Zv(e,t){var r=e.l,n=e.read_shift(1),a=va(e),i=[],s={t:a,h:a};if(n&1){for(var o=e.read_shift(4),l=0;l!=o;++l)i.push(MF(e));s.r=i}else s.r=[{ich:0,ifnt:0}];return e.l=r+t,s}function UF(e,t){var r=!1;return t==null&&(r=!0,t=Le(15+4*e.t.length)),t.write_shift(1,0),Wn(e.t,t),r?t.slice(0,t.l):t}var zF=Zv;function $F(e,t){var r=!1;return t==null&&(r=!0,t=Le(23+4*e.t.length)),t.write_shift(1,1),Wn(e.t,t),t.write_shift(4,1),BF({ich:0,ifnt:0},t),r?t.slice(0,t.l):t}function $i(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Uc(e,t){return t==null&&(t=Le(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function zc(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function $c(e,t){return t==null&&(t=Le(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var WF=va,$S=Wn;function Qv(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function lp(e,t){var r=!1;return t==null&&(r=!0,t=Le(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var HF=va,tx=Qv,e_=lp;function t_(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var a=n===0?op([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):ic(t,0)>>2;return r?a/100:a}function WS(e,t){t==null&&(t=Le(4));var r=0,n=0,a=e*100;if(e==(e|0)&&e>=-(1<<29)&&e<1<<29?n=1:a==(a|0)&&a>=-(1<<29)&&a<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?a:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function HS(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function VF(e,t){return t||(t=Le(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Wc=HS,vu=VF;function xa(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Fc(e,t){return(t||Le(8)).write_shift(8,e,"f")}function qF(e){var t={},r=e.read_shift(1),n=r>>>1,a=e.read_shift(1),i=e.read_shift(2,"i"),s=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=a;var c=vc[a];c&&(t.rgb=hh(c));break;case 2:t.rgb=hh([s,o,l]);break;case 3:t.theme=a;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function cp(e,t){if(t||(t=Le(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function GF(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function XF(e,t){t||(t=Le(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function VS(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function KF(e){return VS(e,1)}function YF(e){return VS(e,2)}var r_=2,Ma=3,$d=11,dy=12,up=19,Wd=64,JF=65,ZF=71,QF=4108,e7=4126,Bn=80,qS=81,t7=[Bn,qS],rx={1:{n:"CodePage",t:r_},2:{n:"Category",t:Bn},3:{n:"PresentationFormat",t:Bn},4:{n:"ByteCount",t:Ma},5:{n:"LineCount",t:Ma},6:{n:"ParagraphCount",t:Ma},7:{n:"SlideCount",t:Ma},8:{n:"NoteCount",t:Ma},9:{n:"HiddenCount",t:Ma},10:{n:"MultimediaClipCount",t:Ma},11:{n:"ScaleCrop",t:$d},12:{n:"HeadingPairs",t:QF},13:{n:"TitlesOfParts",t:e7},14:{n:"Manager",t:Bn},15:{n:"Company",t:Bn},16:{n:"LinksUpToDate",t:$d},17:{n:"CharacterCount",t:Ma},19:{n:"SharedDoc",t:$d},22:{n:"HyperlinksChanged",t:$d},23:{n:"AppVersion",t:Ma,p:"version"},24:{n:"DigSig",t:JF},26:{n:"ContentType",t:Bn},27:{n:"ContentStatus",t:Bn},28:{n:"Language",t:Bn},29:{n:"Version",t:Bn},255:{},2147483648:{n:"Locale",t:up},2147483651:{n:"Behavior",t:up},1919054434:{}},nx={1:{n:"CodePage",t:r_},2:{n:"Title",t:Bn},3:{n:"Subject",t:Bn},4:{n:"Author",t:Bn},5:{n:"Keywords",t:Bn},6:{n:"Comments",t:Bn},7:{n:"Template",t:Bn},8:{n:"LastAuthor",t:Bn},9:{n:"RevNumber",t:Bn},10:{n:"EditTime",t:Wd},11:{n:"LastPrinted",t:Wd},12:{n:"CreatedDate",t:Wd},13:{n:"ModifiedDate",t:Wd},14:{n:"PageCount",t:Ma},15:{n:"WordCount",t:Ma},16:{n:"CharCount",t:Ma},17:{n:"Thumbnail",t:ZF},18:{n:"Application",t:Bn},19:{n:"DocSecurity",t:Ma},255:{},2147483648:{n:"Locale",t:up},2147483651:{n:"Behavior",t:up},1919054434:{}},py={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},r7=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function n7(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var a7=n7([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),vc=Mr(a7),So={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},GS={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},ax={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Hd={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function n_(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function i7(e){var t=n_();if(!e||!e.match)return t;var r={};if((e.match(ya)||[]).forEach(function(n){var a=Ct(n);switch(a[0].replace(mF,"<")){case"<?xml":break;case"<Types":t.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":t[ax[a.ContentType]]!==void 0&&t[ax[a.ContentType]].push(a.PartName);break}}),t.xmlns!==On.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function XS(e,t){var r=iF(ax),n=[],a;n[n.length]=xn,n[n.length]=Xe("Types",null,{xmlns:On.CT,"xmlns:xsd":On.xsd,"xmlns:xsi":On.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return Xe("Default",null,{Extension:l[0],ContentType:l[1]})}));var i=function(l){e[l]&&e[l].length>0&&(a=e[l][0],n[n.length]=Xe("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:Hd[l][t.bookType]||Hd[l].xlsx}))},s=function(l){(e[l]||[]).forEach(function(c){n[n.length]=Xe("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:Hd[l][t.bookType]||Hd[l].xlsx})})},o=function(l){(e[l]||[]).forEach(function(c){n[n.length]=Xe("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:r[l][0]})})};return i("workbooks"),s("sheets"),s("charts"),o("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),s("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Xt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function fh(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Lf(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(ya)||[]).forEach(function(a){var i=Ct(a);if(i[0]==="<Relationship"){var s={};s.Type=i.Type,s.Target=i.Target,s.Id=i.Id,i.TargetMode&&(s.TargetMode=i.TargetMode);var o=i.TargetMode==="External"?i.Target:mf(i.Target,t);r[o]=s,n[i.Id]=s}}),r["!id"]=n,r}function $0(e){var t=[xn,Xe("Relationships",null,{xmlns:On.RELS})];return nn(e["!id"]).forEach(function(r){t[t.length]=Xe("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function xr(e,t,r,n,a,i){if(a||(a={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,a.Id="rId"+t,a.Type=n,a.Target=r,[Xt.HLINK,Xt.XPATH,Xt.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),e["!id"][a.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][a.Id]=a,e[("/"+a.Target).replace("//","/")]=a,t}var s7="application/vnd.oasis.opendocument.spreadsheet";function o7(e,t){for(var r=Gv(e),n,a;n=uh.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=Ct(n[0],!1),a.path=="/"&&a.type!==s7)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function l7(e){var t=[xn];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function my(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function c7(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function u7(e){var t=[xn];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(my(e[r][0],e[r][1])),t.push(c7("",e[r][0]));return t.push(my("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function KS(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+rp.version+"</meta:generator></office:meta></office:document-meta>"}var Ri=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],f7=function(){for(var e=new Array(Ri.length),t=0;t<Ri.length;++t){var r=Ri[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function YS(e){var t={};e=br(e);for(var r=0;r<Ri.length;++r){var n=Ri[r],a=e.match(f7[r]);a!=null&&a.length>0&&(t[n[1]]=ar(a[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=Dr(t[n[1]]))}return t}function hg(e,t,r,n,a){a[e]!=null||t==null||t===""||(a[e]=t,t=_r(t),n[n.length]=r?Xe(e,t,r):Qn(e,t))}function JS(e,t){var r=t||{},n=[xn,Xe("cp:coreProperties",null,{"xmlns:cp":On.CORE_PROPS,"xmlns:dc":On.dc,"xmlns:dcterms":On.dcterms,"xmlns:dcmitype":On.dcmitype,"xmlns:xsi":On.xsi})],a={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&hg("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:ex(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),e.ModifiedDate!=null&&hg("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:ex(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var i=0;i!=Ri.length;++i){var s=Ri[i],o=r.Props&&r.Props[s[1]]!=null?r.Props[s[1]]:e?e[s[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&hg(s[0],o,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var _c=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],ZS=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function QS(e,t,r,n){var a=[];if(typeof e=="string")a=iy(e,n);else for(var i=0;i<e.length;++i)a=a.concat(e[i].map(function(u){return{v:u}}));var s=typeof t=="string"?iy(t,n).map(function(u){return u.v}):t,o=0,l=0;if(s.length>0)for(var c=0;c!==a.length;c+=2){switch(l=+a[c+1].v,a[c].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=s.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":r.NamedRanges=l,r.DefinedNames=s.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=s.slice(o,o+l);break}o+=l}}function h7(e,t,r){var n={};return t||(t={}),e=br(e),_c.forEach(function(a){var i=(e.match(lh(a[0]))||[])[1];switch(a[2]){case"string":i&&(t[a[1]]=ar(i));break;case"bool":t[a[1]]=i==="true";break;case"raw":var s=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));s&&s.length>0&&(n[a[1]]=s[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&QS(n.HeadingPairs,n.TitlesOfParts,t,r),t}function e6(e){var t=[],r=Xe;return e||(e={}),e.Application="SheetJS",t[t.length]=xn,t[t.length]=Xe("Properties",null,{xmlns:On.EXT_PROPS,"xmlns:vt":On.vt}),_c.forEach(function(n){if(e[n[1]]!==void 0){var a;switch(n[2]){case"string":a=_r(String(e[n[1]]));break;case"bool":a=e[n[1]]?"true":"false";break}a!==void 0&&(t[t.length]=r(n[0],a))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+_r(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var d7=/<[^>]+>[^<]*/g;function p7(e,t){var r={},n="",a=e.match(d7);if(a)for(var i=0;i!=a.length;++i){var s=a[i],o=Ct(s);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=ar(o.name);break;case"</property>":n=null;break;default:if(s.indexOf("<vt:")===0){var l=s.split(">"),c=l[0].slice(4),u=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":r[n]=ar(u);break;case"bool":r[n]=Or(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(u,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(u);break;case"filetime":case"date":r[n]=Dr(u);break;case"cy":case"error":r[n]=ar(u);break;default:if(c.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",s,c,l)}}else if(s.slice(0,2)!=="</"){if(t.WTF)throw new Error(s)}}}return r}function t6(e){var t=[xn,Xe("Properties",null,{xmlns:On.CUST_PROPS,"xmlns:vt":On.vt})];if(!e)return t.join("");var r=1;return nn(e).forEach(function(a){++r,t[t.length]=Xe("property",kF(e[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:_r(a)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var ix={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},dg;function m7(e,t,r){dg||(dg=zp(ix)),t=dg[t]||t,e[t]=r}function g7(e,t){var r=[];return nn(ix).map(function(n){for(var a=0;a<Ri.length;++a)if(Ri[a][1]==n)return Ri[a];for(a=0;a<_c.length;++a)if(_c[a][1]==n)return _c[a];throw n}).forEach(function(n){if(e[n[1]]!=null){var a=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),r.push(Qn(ix[n[1]]||n[1],a))}}),Xe("DocumentProperties",r.join(""),{xmlns:si.o})}function x7(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return e&&nn(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)){for(var s=0;s<Ri.length;++s)if(i==Ri[s][1])return;for(s=0;s<_c.length;++s)if(i==_c[s][1])return;for(s=0;s<r.length;++s)if(i==r[s])return;var o=e[i],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),a.push(Xe(ty(i),o,{"dt:dt":l}))}}),t&&nn(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)&&!(e&&Object.prototype.hasOwnProperty.call(e,i))){var s=t[i],o="string";typeof s=="number"?(o="float",s=String(s)):s===!0||s===!1?(o="boolean",s=s?"1":"0"):s instanceof Date?(o="dateTime.tz",s=s.toISOString()):s=String(s),a.push(Xe(ty(i),s,{"dt:dt":o}))}}),"<"+n+' xmlns="'+si.o+'">'+a.join("")+"</"+n+">"}function a_(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function v7(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),a=(r-n)/Math.pow(2,32);n*=1e7,a*=1e7;var i=n/Math.pow(2,32)|0;i>0&&(n=n%Math.pow(2,32),a+=i);var s=Le(8);return s.write_shift(4,n),s.write_shift(4,a),s}function r6(e,t,r){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return a}function n6(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function a6(e,t,r){return t===31?n6(e):r6(e,t,r)}function sx(e,t,r){return a6(e,t,r===!1?0:4)}function _7(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return a6(e,t,0)}function w7(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var a=e.l;r[n]=e.read_shift(0,"lpwstr").replace(La,""),e.l-a&2&&(e.l+=2)}return r}function y7(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(La,"");return r}function b7(e){var t=e.l,r=fp(e,qS);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=fp(e,Ma);return[r,n]}function k7(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(b7(e));return r}function gy(e,t){for(var r=e.read_shift(4),n={},a=0;a!=r;++a){var i=e.read_shift(4),s=e.read_shift(4);n[i]=e.read_shift(s,t===1200?"utf16le":"utf8").replace(La,"").replace(pf,"!"),t===1200&&s%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function i6(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function S7(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function fp(e,t,r){var n=e.read_shift(2),a,i=r||{};if(e.l+=2,t!==dy&&n!==t&&t7.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===dy?n:t){case 2:return a=e.read_shift(2,"i"),i.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return r6(e,n,4).replace(La,"");case 31:return n6(e);case 64:return a_(e);case 65:return i6(e);case 71:return S7(e);case 80:return sx(e,n,!i.raw).replace(La,"");case 81:return _7(e,n).replace(La,"");case 4108:return k7(e);case 4126:case 4127:return n==4127?w7(e):y7(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function xy(e,t){var r=Le(4),n=Le(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=Le(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=v7(t);break;case 31:case 80:for(n=Le(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return $n([r,n])}function vy(e,t){var r=e.l,n=e.read_shift(4),a=e.read_shift(4),i=[],s=0,o=0,l=-1,c={};for(s=0;s!=a;++s){var u=e.read_shift(4),h=e.read_shift(4);i[s]=[u,h+r]}i.sort(function(b,y){return b[1]-y[1]});var m={};for(s=0;s!=a;++s){if(e.l!==i[s][1]){var f=!0;if(s>0&&t)switch(t[i[s-1][0]].t){case 2:e.l+2===i[s][1]&&(e.l+=2,f=!1);break;case 80:e.l<=i[s][1]&&(e.l=i[s][1],f=!1);break;case 4108:e.l<=i[s][1]&&(e.l=i[s][1],f=!1);break}if((!t||s==0)&&e.l<=i[s][1]&&(f=!1,e.l=i[s][1]),f)throw new Error("Read Error: Expected address "+i[s][1]+" at "+e.l+" :"+s)}if(t){var v=t[i[s][0]];if(m[v.n]=fp(e,v.t,{raw:!0}),v.p==="version"&&(m[v.n]=String(m[v.n]>>16)+"."+("0000"+String(m[v.n]&65535)).slice(-4)),v.n=="CodePage")switch(m[v.n]){case 0:m[v.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:is(o=m[v.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+m[v.n])}}else if(i[s][0]===1){if(o=m.CodePage=fp(e,r_),is(o),l!==-1){var x=e.l;e.l=i[l][1],c=gy(e,o),e.l=x}}else if(i[s][0]===0){if(o===0){l=s,e.l=i[s+1][1];continue}c=gy(e,o)}else{var w=c[i[s][0]],_;switch(e[e.l]){case 65:e.l+=4,_=i6(e);break;case 30:e.l+=4,_=sx(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,_=sx(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,_=e.read_shift(4,"i");break;case 19:e.l+=4,_=e.read_shift(4);break;case 5:e.l+=4,_=e.read_shift(8,"f");break;case 11:e.l+=4,_=fn(e,4);break;case 64:e.l+=4,_=Dr(a_(e));break;default:throw new Error("unparsed value: "+e[e.l])}m[w]=_}}return e.l=r+n,m}var s6=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function N7(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function _y(e,t,r){var n=Le(8),a=[],i=[],s=8,o=0,l=Le(8),c=Le(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),i.push(l),a.push(c),s+=8+l.length,!t){c=Le(8),c.write_shift(4,0),a.unshift(c);var u=[Le(4)];for(u[0].write_shift(4,e.length),o=0;o<e.length;++o){var h=e[o][0];for(l=Le(8+2*(h.length+1)+(h.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,h.length+1),l.write_shift(0,h,"dbcs");l.l!=l.length;)l.write_shift(1,0);u.push(l)}l=$n(u),i.unshift(l),s+=8+l.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(s6.indexOf(e[o][0])>-1||ZS.indexOf(e[o][0])>-1)&&e[o][1]!=null){var m=e[o][1],f=0;if(t){f=+t[e[o][0]];var v=r[f];if(v.p=="version"&&typeof m=="string"){var x=m.split(".");m=(+x[0]<<16)+(+x[1]||0)}l=xy(v.t,m)}else{var w=N7(m);w==-1&&(w=31,m=String(m)),l=xy(w,m)}i.push(l),c=Le(8),c.write_shift(4,t?f:2+o),a.push(c),s+=8+l.length}var _=8*(i.length+1);for(o=0;o<i.length;++o)a[o].write_shift(4,_),_+=i[o].length;return n.write_shift(4,s),n.write_shift(4,i.length),$n([n].concat(a).concat(i))}function wy(e,t,r){var n=e.content;if(!n)return{};Zn(n,0);var a,i,s,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),u=n.read_shift(16);if(u!==vt.utils.consts.HEADER_CLSID&&u!==r)throw new Error("Bad PropertySet CLSID "+u);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(i=n.read_shift(16),o=n.read_shift(4),a===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);a===2&&(s=n.read_shift(16),l=n.read_shift(4));var h=vy(n,t),m={SystemIdentifier:c};for(var f in h)m[f]=h[f];if(m.FMTID=i,a===1)return m;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var v;try{v=vy(n,null)}catch{}for(f in v)m[f]=v[f];return m.FMTID=[i,s],m}function yy(e,t,r,n,a,i){var s=Le(a?68:48),o=[s];s.write_shift(2,65534),s.write_shift(2,0),s.write_shift(4,842412599),s.write_shift(16,vt.utils.consts.HEADER_CLSID,"hex"),s.write_shift(4,a?2:1),s.write_shift(16,t,"hex"),s.write_shift(4,a?68:48);var l=_y(e,r,n);if(o.push(l),a){var c=_y(a,null,null);s.write_shift(16,i,"hex"),s.write_shift(4,68+l.length),o.push(c)}return $n(o)}function Wo(e,t){return e.read_shift(t),null}function E7(e,t){t||(t=Le(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function A7(e,t,r){for(var n=[],a=e.l+t;e.l<a;)n.push(r(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}function fn(e,t){return e.read_shift(t)===1}function Ta(e,t){return t||(t=Le(2)),t.write_shift(2,+!!e),t}function Sn(e){return e.read_shift(2,"u")}function Fi(e,t){return t||(t=Le(2)),t.write_shift(2,e),t}function o6(e,t){return A7(e,t,Sn)}function T7(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function l6(e,t,r){return r||(r=Le(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function Rh(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=e.read_shift(1);i&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var s=n?e.read_shift(n,a):"";return s}function C7(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,a=r&8,i=1+(r&1),s=0,o,l={};a&&(s=e.read_shift(2)),n&&(o=e.read_shift(4));var c=i==2?"dbcs-cont":"sbcs-cont",u=t===0?"":e.read_shift(t,c);return a&&(e.l+=4*s),n&&(e.l+=o),l.t=u,a||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function F7(e){var t=e.t||"",r=Le(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=Le(2*t.length);n.write_shift(2*t.length,t,"utf16le");var a=[r,n];return $n(a)}function Lc(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function Dh(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):Lc(e,n,r)}function Hc(e,t,r){if(r.biff>5)return Dh(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function c6(e,t,r){return r||(r=Le(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function L7(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function P7(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var a=e.read_shift((n?t-24:t)>>1,"utf16le").replace(La,"");return n&&(e.l+=24),a}function I7(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var i=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var s=e.read_shift(i>>1,"utf16le").replace(La,"");return r+s}function O7(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return P7(e);case"0303000000000000c000000000000046":return I7(e);default:throw new Error("Unsupported Moniker "+r)}}function Vd(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(La,""):"";return r}function by(e,t){t||(t=Le(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function j7(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var i,s,o,l,c="",u,h;a&16&&(i=Vd(e,r-e.l)),a&128&&(s=Vd(e,r-e.l)),(a&257)===257&&(o=Vd(e,r-e.l)),(a&257)===1&&(l=O7(e,r-e.l)),a&8&&(c=Vd(e,r-e.l)),a&32&&(u=e.read_shift(16)),a&64&&(h=a_(e)),e.l=r;var m=s||o||l||"";m&&c&&(m+="#"+c),m||(m="#"+c),a&2&&m.charAt(0)=="/"&&m.charAt(1)!="/"&&(m="file://"+m);var f={Target:m};return u&&(f.guid=u),h&&(f.time=h),i&&(f.Tooltip=i),f}function R7(e){var t=Le(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),i=a>-1?31:23;switch(n.charAt(0)){case"#":i=28;break;case".":i&=-3;break}t.write_shift(4,2),t.write_shift(4,i);var s=[8,6815827,6619237,4849780,83];for(r=0;r<s.length;++r)t.write_shift(4,s[r]);if(i==28)n=n.slice(1),by(n,t);else if(i&2){for(s="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<s.length;++r)t.write_shift(1,parseInt(s[r],16));var o=a>-1?n.slice(0,a):n;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),i&8&&by(a>-1?n.slice(a+1):"",t)}else{for(s="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<s.length;++r)t.write_shift(1,parseInt(s[r],16));for(var l=0;n.slice(l*3,l*3+3)=="../"||n.slice(l*3,l*3+3)=="..\\";)++l;for(t.write_shift(2,l),t.write_shift(4,n.length-3*l+1),r=0;r<n.length-3*l;++r)t.write_shift(1,n.charCodeAt(r+3*l)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function u6(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),a=e.read_shift(1);return[t,r,n,a]}function f6(e,t){var r=u6(e);return r[3]=0,r}function Ms(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function Pc(e,t,r,n){return n||(n=Le(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function D7(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function M7(e,t,r){return t===0?"":Hc(e,t,r)}function B7(e,t,r){var n=r.biff>8?4:2,a=e.read_shift(n),i=e.read_shift(n,"i"),s=e.read_shift(n,"i");return[a,i,s]}function h6(e){var t=e.read_shift(2),r=t_(e);return[t,r]}function U7(e,t,r){e.l+=4,t-=4;var n=e.l+t,a=Rh(e,t,r),i=e.read_shift(2);if(n-=e.l,i!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+i);return e.l+=i,a}function Hp(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r:t},e:{c:a,r}}}function d6(e,t){return t||(t=Le(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function p6(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),a=e.read_shift(1);return{s:{c:n,r:t},e:{c:a,r}}}var z7=p6;function m6(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function $7(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function W7(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function la(e){e.l+=2,e.l+=e.read_shift(2)}var H7={0:la,4:la,5:la,6:la,7:W7,8:la,9:la,10:la,11:la,12:la,13:$7,14:la,15:la,16:la,17:la,18:la,19:la,20:la,21:m6};function V7(e,t){for(var r=e.l+t,n=[];e.l<r;){var a=e.read_shift(2);e.l-=2;try{n.push(H7[a](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function qd(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function i_(e,t,r){var n=1536,a=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=Le(a);return i.write_shift(2,n),i.write_shift(2,t),a>4&&i.write_shift(2,29282),a>6&&i.write_shift(2,1997),a>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function q7(e,t){return t===0||e.read_shift(2),1200}function G7(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,a=Hc(e,0,r);return e.read_shift(t+n-e.l),a}function X7(e,t){var r=!t||t.biff==8,n=Le(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function K7(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function Y7(e,t,r){var n=e.read_shift(4),a=e.read_shift(1)&3,i=e.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var s=Rh(e,0,r);return s.length===0&&(s="Sheet1"),{pos:n,hs:a,dt:i,name:s}}function J7(e,t){var r=!t||t.biff>=8?2:1,n=Le(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function Z7(e,t){for(var r=e.l+t,n=e.read_shift(4),a=e.read_shift(4),i=[],s=0;s!=a&&e.l<r;++s)i.push(C7(e));return i.Count=n,i.Unique=a,i}function Q7(e,t){var r=Le(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],a=0;a<e.length;++a)n[a]=F7(e[a]);var i=$n([r].concat(n));return i.parts=[r.length].concat(n.map(function(s){return s.length})),i}function eL(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function tL(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function rL(e){var t=D7(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function nL(e){return e.read_shift(2),e.read_shift(4)}function ky(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var a=e.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var i={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[i,a]}function aL(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2);return{Pos:[t,r],Dim:[n,a],Flags:i,CurTab:s,FirstTab:o,Selected:l,TabRatio:c}}function iL(){var e=Le(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function sL(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function oL(e){var t=Le(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function lL(){}function cL(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=Rh(e,0,r),n}function uL(e,t){var r=e.name||"Arial",n=t&&t.biff==5,a=n?15+r.length:16+2*r.length,i=Le(a);return i.write_shift(2,(e.sz||12)*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),n||i.write_shift(1,1),i.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),i}function fL(e){var t=Ms(e);return t.isst=e.read_shift(4),t}function hL(e,t,r,n){var a=Le(10);return Pc(e,t,n,a),a.write_shift(4,r),a}function dL(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,a=Ms(e);r.biff==2&&e.l++;var i=Dh(e,n-e.l,r);return a.val=i,a}function pL(e,t,r,n,a){var i=!a||a.biff==8,s=Le(8+ +i+(1+i)*r.length);return Pc(e,t,n,s),s.write_shift(2,r.length),i&&s.write_shift(1,1),s.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),s}function mL(e,t,r){var n=e.read_shift(2),a=Hc(e,0,r);return[n,a]}function gL(e,t,r,n){var a=r&&r.biff==5;n||(n=Le(a?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(a?1:2,t.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*t.length,t,a?"sbcs":"utf16le");var i=n.length>n.l?n.slice(0,n.l):n;return i.l==null&&(i.l=i.length),i}var xL=Hc;function Sy(e,t,r){var n=e.l+t,a=r.biff==8||!r.biff?4:2,i=e.read_shift(a),s=e.read_shift(a),o=e.read_shift(2),l=e.read_shift(2);return e.l=n,{s:{r:i,c:o},e:{r:s,c:l}}}function vL(e,t){var r=t.biff==8||!t.biff?4:2,n=Le(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function _L(e){var t=e.read_shift(2),r=e.read_shift(2),n=h6(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function wL(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),i=[];e.l<r;)i.push(h6(e));if(e.l!==r)throw new Error("MulRK read error");var s=e.read_shift(2);if(i.length!=s-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:s,rkrec:i}}function yL(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),i=[];e.l<r;)i.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var s=e.read_shift(2);if(i.length!=s-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:s,ixfe:i}}function bL(e,t,r,n){var a={},i=e.read_shift(4),s=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(2);return a.patternType=r7[o>>26],n.cellStyles&&(a.alc=i&7,a.fWrap=i>>3&1,a.alcV=i>>4&7,a.fJustLast=i>>7&1,a.trot=i>>8&255,a.cIndent=i>>16&15,a.fShrinkToFit=i>>20&1,a.iReadOrder=i>>22&2,a.fAtrNum=i>>26&1,a.fAtrFnt=i>>27&1,a.fAtrAlc=i>>28&1,a.fAtrBdr=i>>29&1,a.fAtrPat=i>>30&1,a.fAtrProt=i>>31&1,a.dgLeft=s&15,a.dgRight=s>>4&15,a.dgTop=s>>8&15,a.dgBottom=s>>12&15,a.icvLeft=s>>16&127,a.icvRight=s>>23&127,a.grbitDiag=s>>30&3,a.icvTop=o&127,a.icvBottom=o>>7&127,a.icvDiag=o>>14&127,a.dgDiag=o>>21&15,a.icvFore=l&127,a.icvBack=l>>7&127,a.fsxButton=l>>14&1),a}function kL(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=bL(e,t,n.fStyle,r),n}function Ny(e,t,r,n){var a=r&&r.biff==5;n||(n=Le(a?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var i=0;return e.numFmtId>0&&a&&(i|=1024),n.write_shift(4,i),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function SL(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function NL(e){var t=Le(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function Ey(e,t,r){var n=Ms(e);(r.biff==2||t==9)&&++e.l;var a=T7(e);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function EL(e,t,r,n,a,i){var s=Le(8);return Pc(e,t,n,s),l6(r,i,s),s}function AL(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Ms(e),a=xa(e);return n.val=a,n}function TL(e,t,r,n){var a=Le(14);return Pc(e,t,n,a),Fc(r,a),a}var Ay=M7;function CL(e,t,r){var n=e.l+t,a=e.read_shift(2),i=e.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,a];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var s=Lc(e,i),o=[];n>e.l;)o.push(Dh(e));return[i,a,s,o]}function Ty(e,t,r){var n=e.read_shift(2),a,i={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=U7(e,t-2,r)),i.body=a||e.read_shift(t-2),typeof a=="string"&&(i.Name=a),i}var FL=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Cy(e,t,r){var n=e.l+t,a=e.read_shift(2),i=e.read_shift(1),s=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),l=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var c=Lc(e,s,r);a&32&&(c=FL[c.charCodeAt(0)]);var u=n-e.l;r&&r.biff==2&&--u;var h=n==e.l||o===0||!(u>0)?[]:Vj(e,u,r,o);return{chKey:i,Name:c,itab:l,rgce:h}}function g6(e,t,r){if(r.biff<8)return LL(e,t,r);for(var n=[],a=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)n.push(B7(e,r.biff>8?12:6,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function LL(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=Rh(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function PL(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),a=e.read_shift(2),i=Lc(e,n,r),s=Lc(e,a,r);return[i,s]}function IL(e,t,r){var n=p6(e);e.l++;var a=e.read_shift(1);return t-=8,[qj(e,t,r),a,n]}function Fy(e,t,r){var n=z7(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,Wj(e,t,r)]}function OL(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function jL(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),o=Hc(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:a},o,s,i]}}function RL(e,t,r){return jL(e,t,r)}function DL(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(Hp(e));return r}function ML(e){var t=Le(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)d6(e[r],t);return t}function BL(e,t,r){if(r&&r.biff<8)return zL(e,t,r);var n=m6(e),a=V7(e,t-22,n[1]);return{cmo:n,ft:a}}var UL={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=r,{fmt:n}}};function zL(e,t,r){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var s=[];return s.push((UL[n]||wa)(e,t,r)),{cmo:[a,n,i],ft:s}}function $L(e,t,r){var n=e.l,a="";try{e.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],s;[0,5,7,11,12,14].indexOf(i)==-1?e.l+=6:s=L7(e,6,r);var o=e.read_shift(2);e.read_shift(2),Sn(e,2);var l=e.read_shift(2);e.l+=l;for(var c=1;c<e.lens.length-1;++c){if(e.l-n!=e.lens[c])throw new Error("TxO: bad continue record");var u=e[e.l],h=Lc(e,e.lens[c+1]-e.lens[c]-1);if(a+=h,a.length>=(u?o:2*o))break}if(a.length!==o&&a.length!==o*2)throw new Error("cchText: "+o+" != "+a.length);return e.l=n+t,{t:a}}catch{return e.l=n+t,{t:a}}}function WL(e,t){var r=Hp(e);e.l+=16;var n=j7(e,t-24);return[r,n]}function HL(e){var t=Le(24),r=qr(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)t.write_shift(1,parseInt(n[a],16));return $n([t,R7(e[1])])}function VL(e,t){e.read_shift(2);var r=Hp(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(La,""),[r,n]}function qL(e){var t=e[1].Tooltip,r=Le(10+2*(t.length+1));r.write_shift(2,2048);var n=qr(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var a=0;a<t.length;++a)r.write_shift(2,t.charCodeAt(a));return r.write_shift(2,0),r}function GL(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=py[r]||r,r=e.read_shift(2),t[1]=py[r]||r,t}function XL(e){return e||(e=Le(4)),e.write_shift(2,1),e.write_shift(2,1),e}function KL(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(f6(e));return r}function YL(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(f6(e));return r}function JL(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function x6(e,t,r){if(!r.cellStyles)return wa(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),i=e.read_shift(n),s=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(2);n==2&&(e.l+=2);var c={s:a,e:i,w:s,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}function ZL(e,t){var r=Le(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function QL(e,t){var r={};return t<32||(e.l+=16,r.header=xa(e),r.footer=xa(e),e.l+=2),r}function eP(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var a=e.read_shift(1);return e.l+=3,a&16&&(n.area=!0),n}function tP(e){for(var t=Le(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var rP=Ms,nP=o6,aP=Dh;function iP(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}function sP(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Ms(e);++e.l;var a=Hc(e,t-7,r);return n.t="str",n.val=a,n}function oP(e){var t=Ms(e);++e.l;var r=xa(e);return t.t="n",t.val=r,t}function lP(e,t,r){var n=Le(15);return zh(n,e,t),n.write_shift(8,r,"f"),n}function cP(e){var t=Ms(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function uP(e,t,r){var n=Le(9);return zh(n,e,t),n.write_shift(2,r),n}function fP(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function hP(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function dP(e,t,r){var n=e.l+t,a=Ms(e),i=e.read_shift(2),s=Lc(e,i,r);return e.l=n,a.t="str",a.val=s,a}var pP=[2,3,48,49,131,139,140,245],ox=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=zp({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var c=[],u=yl(1);switch(l.type){case"base64":u=li(mi(o));break;case"binary":u=li(o);break;case"buffer":case"array":u=o;break}Zn(u,0);var h=u.read_shift(1),m=!!(h&136),f=!1,v=!1;switch(h){case 2:break;case 3:break;case 48:f=!0,m=!0;break;case 49:f=!0,m=!0;break;case 131:break;case 139:break;case 140:v=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var x=0,w=521;h==2&&(x=u.read_shift(2)),u.l+=3,h!=2&&(x=u.read_shift(4)),x>1048576&&(x=1e6),h!=2&&(w=u.read_shift(2));var _=u.read_shift(2),b=l.codepage||1252;h!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(b=e[u[u.l]]),u.l+=1,u.l+=2),v&&(u.l+=36);for(var y=[],N={},R=Math.min(u.length,h==2?521:w-10-(f?264:0)),P=v?32:11;u.l<R&&u[u.l]!=13;)switch(N={},N.name=Qo.utils.decode(b,u.slice(u.l,u.l+P)).replace(/[\u0000\r\n].*$/g,""),u.l+=P,N.type=String.fromCharCode(u.read_shift(1)),h!=2&&!v&&(N.offset=u.read_shift(4)),N.len=u.read_shift(1),h==2&&(N.offset=u.read_shift(2)),N.dec=u.read_shift(1),N.name.length&&y.push(N),h!=2&&(u.l+=v?13:14),N.type){case"B":(!f||N.len!=8)&&l.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+N.type)}if(u[u.l]!==13&&(u.l=w-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=w;var F=0,C=0;for(c[0]=[],C=0;C!=y.length;++C)c[0][C]=y[C].name;for(;x-- >0;){if(u[u.l]===42){u.l+=_;continue}for(++u.l,c[++F]=[],C=0,C=0;C!=y.length;++C){var A=u.slice(u.l,u.l+y[C].len);u.l+=y[C].len,Zn(A,0);var W=Qo.utils.decode(b,A);switch(y[C].type){case"C":W.trim().length&&(c[F][C]=W.replace(/\s+$/,""));break;case"D":W.length===8?c[F][C]=new Date(+W.slice(0,4),+W.slice(4,6)-1,+W.slice(6,8)):c[F][C]=W;break;case"F":c[F][C]=parseFloat(W.trim());break;case"+":case"I":c[F][C]=v?A.read_shift(-4,"i")^2147483648:A.read_shift(4,"i");break;case"L":switch(W.trim().toUpperCase()){case"Y":case"T":c[F][C]=!0;break;case"N":case"F":c[F][C]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+W+"|")}break;case"M":if(!m)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));c[F][C]="##MEMO##"+(v?parseInt(W.trim(),10):A.read_shift(4));break;case"N":W=W.replace(/\u0000/g,"").trim(),W&&W!="."&&(c[F][C]=+W||0);break;case"@":c[F][C]=new Date(A.read_shift(-8,"f")-621356832e5);break;case"T":c[F][C]=new Date((A.read_shift(4)-2440588)*864e5+A.read_shift(4));break;case"Y":c[F][C]=A.read_shift(4,"i")/1e4+A.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[F][C]=-A.read_shift(-8,"f");break;case"B":if(f&&y[C].len==8){c[F][C]=A.read_shift(8,"f");break}case"G":case"P":A.l+=y[C].len;break;case"0":if(y[C].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+y[C].type)}}}if(h!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=y,c}function n(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var u=xu(r(o,c),c);return u["!cols"]=c.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete c.DBF,u}function a(o,l){try{return Fl(n(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function s(o,l){var c=l||{};if(+c.codepage>=0&&is(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var u=qa(),h=pp(o,{header:1,raw:!0,cellDates:!0}),m=h[0],f=h.slice(1),v=o["!cols"]||[],x=0,w=0,_=0,b=1;for(x=0;x<m.length;++x){if(((v[x]||{}).DBF||{}).name){m[x]=v[x].DBF.name,++_;continue}if(m[x]!=null){if(++_,typeof m[x]=="number"&&(m[x]=m[x].toString(10)),typeof m[x]!="string")throw new Error("DBF Invalid column name "+m[x]+" |"+typeof m[x]+"|");if(m.indexOf(m[x])!==x){for(w=0;w<1024;++w)if(m.indexOf(m[x]+"_"+w)==-1){m[x]+="_"+w;break}}}}var y=ir(o["!ref"]),N=[],R=[],P=[];for(x=0;x<=y.e.c-y.s.c;++x){var F="",C="",A=0,W=[];for(w=0;w<f.length;++w)f[w][x]!=null&&W.push(f[w][x]);if(W.length==0||m[x]==null){N[x]="?";continue}for(w=0;w<W.length;++w){switch(typeof W[w]){case"number":C="B";break;case"string":C="C";break;case"boolean":C="L";break;case"object":C=W[w]instanceof Date?"D":"C";break;default:C="C"}A=Math.max(A,String(W[w]).length),F=F&&F!=C?"C":C}A>250&&(A=250),C=((v[x]||{}).DBF||{}).type,C=="C"&&v[x].DBF.len>A&&(A=v[x].DBF.len),F=="B"&&C=="N"&&(F="N",P[x]=v[x].DBF.dec,A=v[x].DBF.len),R[x]=F=="C"||C=="N"?A:i[F]||0,b+=R[x],N[x]=F}var L=u.next(32);for(L.write_shift(4,318902576),L.write_shift(4,f.length),L.write_shift(2,296+32*_),L.write_shift(2,b),x=0;x<4;++x)L.write_shift(4,0);for(L.write_shift(4,0|(+t[sS]||3)<<8),x=0,w=0;x<m.length;++x)if(m[x]!=null){var I=u.next(32),V=(m[x].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);I.write_shift(1,V,"sbcs"),I.write_shift(1,N[x]=="?"?"C":N[x],"sbcs"),I.write_shift(4,w),I.write_shift(1,R[x]||i[N[x]]||0),I.write_shift(1,P[x]||0),I.write_shift(1,2),I.write_shift(4,0),I.write_shift(1,0),I.write_shift(4,0),I.write_shift(4,0),w+=R[x]||i[N[x]]||0}var Q=u.next(264);for(Q.write_shift(4,13),x=0;x<65;++x)Q.write_shift(4,0);for(x=0;x<f.length;++x){var ue=u.next(b);for(ue.write_shift(1,0),w=0;w<m.length;++w)if(m[w]!=null)switch(N[w]){case"L":ue.write_shift(1,f[x][w]==null?63:f[x][w]?84:70);break;case"B":ue.write_shift(8,f[x][w]||0,"f");break;case"N":var me="0";for(typeof f[x][w]=="number"&&(me=f[x][w].toFixed(P[w]||0)),_=0;_<R[w]-me.length;++_)ue.write_shift(1,32);ue.write_shift(1,me,"sbcs");break;case"D":f[x][w]?(ue.write_shift(4,("0000"+f[x][w].getFullYear()).slice(-4),"sbcs"),ue.write_shift(2,("00"+(f[x][w].getMonth()+1)).slice(-2),"sbcs"),ue.write_shift(2,("00"+f[x][w].getDate()).slice(-2),"sbcs")):ue.write_shift(8,"00000000","sbcs");break;case"C":var pe=String(f[x][w]!=null?f[x][w]:"").slice(0,R[w]);for(ue.write_shift(1,pe,"sbcs"),_=0;_<R[w]-pe.length;++_)ue.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:a,to_sheet:n,from_sheet:s}}(),v6=function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+nn(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(m,f){var v=e[f];return typeof v=="number"?zw(v):v},n=function(m,f,v){var x=f.charCodeAt(0)-32<<4|v.charCodeAt(0)-48;return x==59?m:zw(x)};e["|"]=254;function a(m,f){switch(f.type){case"base64":return i(mi(m),f);case"binary":return i(m,f);case"buffer":return i(Vt&&Buffer.isBuffer(m)?m.toString("binary"):Cl(m),f);case"array":return i(Cc(m),f)}throw new Error("Unrecognized type "+f.type)}function i(m,f){var v=m.split(/[\n\r]+/),x=-1,w=-1,_=0,b=0,y=[],N=[],R=null,P={},F=[],C=[],A=[],W=0,L;for(+f.codepage>=0&&is(+f.codepage);_!==v.length;++_){W=0;var I=v[_].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),V=I.replace(/;;/g,"\0").split(";").map(function(B){return B.replace(/\u0000/g,";")}),Q=V[0],ue;if(I.length>0)switch(Q){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":V[1].charAt(0)=="P"&&N.push(I.slice(3).replace(/;;/g,";"));break;case"C":var me=!1,pe=!1,oe=!1,G=!1,ve=-1,_e=-1;for(b=1;b<V.length;++b)switch(V[b].charAt(0)){case"A":break;case"X":w=parseInt(V[b].slice(1))-1,pe=!0;break;case"Y":for(x=parseInt(V[b].slice(1))-1,pe||(w=0),L=y.length;L<=x;++L)y[L]=[];break;case"K":ue=V[b].slice(1),ue.charAt(0)==='"'?ue=ue.slice(1,ue.length-1):ue==="TRUE"?ue=!0:ue==="FALSE"?ue=!1:isNaN(cs(ue))?isNaN(au(ue).getDate())||(ue=Dr(ue)):(ue=cs(ue),R!==null&&mu(R)&&(ue=Wp(ue))),me=!0;break;case"E":G=!0;var E=W0(V[b].slice(1),{r:x,c:w});y[x][w]=[y[x][w],E];break;case"S":oe=!0,y[x][w]=[y[x][w],"S5S"];break;case"G":break;case"R":ve=parseInt(V[b].slice(1))-1;break;case"C":_e=parseInt(V[b].slice(1))-1;break;default:if(f&&f.WTF)throw new Error("SYLK bad record "+I)}if(me&&(y[x][w]&&y[x][w].length==2?y[x][w][0]=ue:y[x][w]=ue,R=null),oe){if(G)throw new Error("SYLK shared formula cannot have own formula");var j=ve>-1&&y[ve][_e];if(!j||!j[1])throw new Error("SYLK shared formula cannot find base");y[x][w][1]=R6(j[1],{r:x-ve,c:w-_e})}break;case"F":var O=0;for(b=1;b<V.length;++b)switch(V[b].charAt(0)){case"X":w=parseInt(V[b].slice(1))-1,++O;break;case"Y":for(x=parseInt(V[b].slice(1))-1,L=y.length;L<=x;++L)y[L]=[];break;case"M":W=parseInt(V[b].slice(1))/20;break;case"F":break;case"G":break;case"P":R=N[parseInt(V[b].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(A=V[b].slice(1).split(" "),L=parseInt(A[0],10);L<=parseInt(A[1],10);++L)W=parseInt(A[2],10),C[L-1]=W===0?{hidden:!0}:{wch:W},bl(C[L-1]);break;case"C":w=parseInt(V[b].slice(1))-1,C[w]||(C[w]={});break;case"R":x=parseInt(V[b].slice(1))-1,F[x]||(F[x]={}),W>0?(F[x].hpt=W,F[x].hpx=su(W)):W===0&&(F[x].hidden=!0);break;default:if(f&&f.WTF)throw new Error("SYLK bad record "+I)}O<1&&(R=null);break;default:if(f&&f.WTF)throw new Error("SYLK bad record "+I)}}return F.length>0&&(P["!rows"]=F),C.length>0&&(P["!cols"]=C),f&&f.sheetRows&&(y=y.slice(0,f.sheetRows)),[y,P]}function s(m,f){var v=a(m,f),x=v[0],w=v[1],_=xu(x,f);return nn(w).forEach(function(b){_[b]=w[b]}),_}function o(m,f){return Fl(s(m,f),f)}function l(m,f,v,x){var w="C;Y"+(v+1)+";X"+(x+1)+";K";switch(m.t){case"n":w+=m.v||0,m.f&&!m.F&&(w+=";E"+f_(m.f,{r:v,c:x}));break;case"b":w+=m.v?"TRUE":"FALSE";break;case"e":w+=m.w||m.v;break;case"d":w+='"'+(m.w||m.v)+'"';break;case"s":w+='"'+m.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return w}function c(m,f){f.forEach(function(v,x){var w="F;W"+(x+1)+" "+(x+1)+" ";v.hidden?w+="0":(typeof v.width=="number"&&!v.wpx&&(v.wpx=dh(v.width)),typeof v.wpx=="number"&&!v.wch&&(v.wch=ph(v.wpx)),typeof v.wch=="number"&&(w+=Math.round(v.wch))),w.charAt(w.length-1)!=" "&&m.push(w)})}function u(m,f){f.forEach(function(v,x){var w="F;";v.hidden?w+="M0;":v.hpt?w+="M"+20*v.hpt+";":v.hpx&&(w+="M"+20*mh(v.hpx)+";"),w.length>2&&m.push(w+"R"+(x+1))})}function h(m,f){var v=["ID;PWXL;N;E"],x=[],w=ir(m["!ref"]),_,b=Array.isArray(m),y=`\r
`;v.push("P;PGeneral"),v.push("F;P0;DG0G8;M255"),m["!cols"]&&c(v,m["!cols"]),m["!rows"]&&u(v,m["!rows"]),v.push("B;Y"+(w.e.r-w.s.r+1)+";X"+(w.e.c-w.s.c+1)+";D"+[w.s.c,w.s.r,w.e.c,w.e.r].join(" "));for(var N=w.s.r;N<=w.e.r;++N)for(var R=w.s.c;R<=w.e.c;++R){var P=Et({r:N,c:R});_=b?(m[N]||[])[R]:m[P],!(!_||_.v==null&&(!_.f||_.F))&&x.push(l(_,m,N,R))}return v.join(y)+y+x.join(y)+y+"E"+y}return{to_workbook:o,to_sheet:s,from_sheet:h}}(),_6=function(){function e(i,s){switch(s.type){case"base64":return t(mi(i),s);case"binary":return t(i,s);case"buffer":return t(Vt&&Buffer.isBuffer(i)?i.toString("binary"):Cl(i),s);case"array":return t(Cc(i),s)}throw new Error("Unrecognized type "+s.type)}function t(i,s){for(var o=i.split(`
`),l=-1,c=-1,u=0,h=[];u!==o.length;++u){if(o[u].trim()==="BOT"){h[++l]=[],c=0;continue}if(!(l<0)){var m=o[u].trim().split(","),f=m[0],v=m[1];++u;for(var x=o[u]||"";(x.match(/["]/g)||[]).length&1&&u<o.length-1;)x+=`
`+o[++u];switch(x=x.trim(),+f){case-1:if(x==="BOT"){h[++l]=[],c=0;continue}else if(x!=="EOD")throw new Error("Unrecognized DIF special command "+x);break;case 0:x==="TRUE"?h[l][c]=!0:x==="FALSE"?h[l][c]=!1:isNaN(cs(v))?isNaN(au(v).getDate())?h[l][c]=v:h[l][c]=Dr(v):h[l][c]=cs(v),++c;break;case 1:x=x.slice(1,x.length-1),x=x.replace(/""/g,'"'),x&&x.match(/^=".*"$/)&&(x=x.slice(2,-1)),h[l][c++]=x!==""?x:null;break}if(x==="EOD")break}}return s&&s.sheetRows&&(h=h.slice(0,s.sheetRows)),h}function r(i,s){return xu(e(i,s),s)}function n(i,s){return Fl(r(i,s),s)}var a=function(){var i=function(l,c,u,h,m){l.push(c),l.push(u+","+h),l.push('"'+m.replace(/"/g,'""')+'"')},s=function(l,c,u,h){l.push(c+","+u),l.push(c==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(l){var c=[],u=ir(l["!ref"]),h,m=Array.isArray(l);i(c,"TABLE",0,1,"sheetjs"),i(c,"VECTORS",0,u.e.r-u.s.r+1,""),i(c,"TUPLES",0,u.e.c-u.s.c+1,""),i(c,"DATA",0,0,"");for(var f=u.s.r;f<=u.e.r;++f){s(c,-1,0,"BOT");for(var v=u.s.c;v<=u.e.c;++v){var x=Et({r:f,c:v});if(h=m?(l[f]||[])[v]:l[x],!h){s(c,1,0,"");continue}switch(h.t){case"n":var w=h.w;!w&&h.v!=null&&(w=h.v),w==null?h.f&&!h.F?s(c,1,0,"="+h.f):s(c,1,0,""):s(c,0,w,"V");break;case"b":s(c,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":s(c,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=Ui(h.z||Nt[14],Rn(Dr(h.v)))),s(c,0,h.w,"V");break;default:s(c,1,0,"")}}}s(c,-1,0,"EOD");var _=`\r
`,b=c.join(_);return b}}();return{to_workbook:n,to_sheet:r,from_sheet:a}}(),w6=function(){function e(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(h,m){for(var f=h.split(`
`),v=-1,x=-1,w=0,_=[];w!==f.length;++w){var b=f[w].trim().split(":");if(b[0]==="cell"){var y=qr(b[1]);if(_.length<=y.r)for(v=_.length;v<=y.r;++v)_[v]||(_[v]=[]);switch(v=y.r,x=y.c,b[2]){case"t":_[v][x]=e(b[3]);break;case"v":_[v][x]=+b[3];break;case"vtf":var N=b[b.length-1];case"vtc":switch(b[3]){case"nl":_[v][x]=!!+b[4];break;default:_[v][x]=+b[4];break}b[2]=="vtf"&&(_[v][x]=[_[v][x],N])}}}return m&&m.sheetRows&&(_=_.slice(0,m.sheetRows)),_}function n(h,m){return xu(r(h,m),m)}function a(h,m){return Fl(n(h,m),m)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),s=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(h){if(!h||!h["!ref"])return"";for(var m=[],f=[],v,x="",w=Ga(h["!ref"]),_=Array.isArray(h),b=w.s.r;b<=w.e.r;++b)for(var y=w.s.c;y<=w.e.c;++y)if(x=Et({r:b,c:y}),v=_?(h[b]||[])[y]:h[x],!(!v||v.v==null||v.t==="z")){switch(f=["cell",x,"t"],v.t){case"s":case"str":f.push(t(v.v));break;case"n":v.f?(f[2]="vtf",f[3]="n",f[4]=v.v,f[5]=t(v.f)):(f[2]="v",f[3]=v.v);break;case"b":f[2]="vt"+(v.f?"f":"c"),f[3]="nl",f[4]=v.v?"1":"0",f[5]=t(v.f||(v.v?"TRUE":"FALSE"));break;case"d":var N=Rn(Dr(v.v));f[2]="vtc",f[3]="nd",f[4]=""+N,f[5]=v.w||Ui(v.z||Nt[14],N);break;case"e":continue}m.push(f.join(":"))}return m.push("sheet:c:"+(w.e.c-w.s.c+1)+":r:"+(w.e.r-w.s.r+1)+":tvf:1"),m.push("valueformat:1:text-wiki"),m.join(`
`)}function u(h){return[i,s,o,s,c(h),l].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:u}}(),iu=function(){function e(u,h,m,f,v){v.raw?h[m][f]=u:u===""||(u==="TRUE"?h[m][f]=!0:u==="FALSE"?h[m][f]=!1:isNaN(cs(u))?isNaN(au(u).getDate())?h[m][f]=u:h[m][f]=Dr(u):h[m][f]=cs(u))}function t(u,h){var m=h||{},f=[];if(!u||u.length===0)return f;for(var v=u.split(/[\r\n]/),x=v.length-1;x>=0&&v[x].length===0;)--x;for(var w=10,_=0,b=0;b<=x;++b)_=v[b].indexOf(" "),_==-1?_=v[b].length:_++,w=Math.max(w,_);for(b=0;b<=x;++b){f[b]=[];var y=0;for(e(v[b].slice(0,w).trim(),f,b,y,m),y=1;y<=(v[b].length-w)/10+1;++y)e(v[b].slice(w+(y-1)*10,w+y*10).trim(),f,b,y,m)}return m.sheetRows&&(f=f.slice(0,m.sheetRows)),f}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(u){for(var h={},m=!1,f=0,v=0;f<u.length;++f)(v=u.charCodeAt(f))==34?m=!m:!m&&v in r&&(h[v]=(h[v]||0)+1);v=[];for(f in h)Object.prototype.hasOwnProperty.call(h,f)&&v.push([h[f],f]);if(!v.length){h=n;for(f in h)Object.prototype.hasOwnProperty.call(h,f)&&v.push([h[f],f])}return v.sort(function(x,w){return x[0]-w[0]||n[x[1]]-n[w[1]]}),r[v.pop()[1]]||44}function i(u,h){var m=h||{},f="",v=m.dense?[]:{},x={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(f=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(f=u.charAt(4),u=u.slice(6)):f=a(u.slice(0,1024)):m&&m.FS?f=m.FS:f=a(u.slice(0,1024));var w=0,_=0,b=0,y=0,N=0,R=f.charCodeAt(0),P=!1,F=0,C=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var A=m.dateNF!=null?eF(m.dateNF):null;function W(){var L=u.slice(y,N),I={};if(L.charAt(0)=='"'&&L.charAt(L.length-1)=='"'&&(L=L.slice(1,-1).replace(/""/g,'"')),L.length===0)I.t="z";else if(m.raw)I.t="s",I.v=L;else if(L.trim().length===0)I.t="s",I.v=L;else if(L.charCodeAt(0)==61)L.charCodeAt(1)==34&&L.charCodeAt(L.length-1)==34?(I.t="s",I.v=L.slice(2,-1).replace(/""/g,'"')):CO(L)?(I.t="n",I.f=L.slice(1)):(I.t="s",I.v=L);else if(L=="TRUE")I.t="b",I.v=!0;else if(L=="FALSE")I.t="b",I.v=!1;else if(!isNaN(b=cs(L)))I.t="n",m.cellText!==!1&&(I.w=L),I.v=b;else if(!isNaN(au(L).getDate())||A&&L.match(A)){I.z=m.dateNF||Nt[14];var V=0;A&&L.match(A)&&(L=tF(L,m.dateNF,L.match(A)||[]),V=1),m.cellDates?(I.t="d",I.v=Dr(L,V)):(I.t="n",I.v=Rn(Dr(L,V))),m.cellText!==!1&&(I.w=Ui(I.z,I.v instanceof Date?Rn(I.v):I.v)),m.cellNF||delete I.z}else I.t="s",I.v=L;if(I.t=="z"||(m.dense?(v[w]||(v[w]=[]),v[w][_]=I):v[Et({c:_,r:w})]=I),y=N+1,C=u.charCodeAt(y),x.e.c<_&&(x.e.c=_),x.e.r<w&&(x.e.r=w),F==R)++_;else if(_=0,++w,m.sheetRows&&m.sheetRows<=w)return!0}e:for(;N<u.length;++N)switch(F=u.charCodeAt(N)){case 34:C===34&&(P=!P);break;case R:case 10:case 13:if(!P&&W())break e;break}return N-y>0&&W(),v["!ref"]=Ut(x),v}function s(u,h){return!(h&&h.PRN)||h.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?i(u,h):xu(t(u,h),h)}function o(u,h){var m="",f=h.type=="string"?[0,0,0,0]:__(u,h);switch(h.type){case"base64":m=mi(u);break;case"binary":m=u;break;case"buffer":h.codepage==65001?m=u.toString("utf8"):h.codepage&&typeof Qo<"u"?m=Qo.utils.decode(h.codepage,u):m=Vt&&Buffer.isBuffer(u)?u.toString("binary"):Cl(u);break;case"array":m=Cc(u);break;case"string":m=u;break;default:throw new Error("Unrecognized type "+h.type)}return f[0]==239&&f[1]==187&&f[2]==191?m=br(m.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?m=br(m):h.type=="binary"&&typeof Qo<"u"&&h.codepage&&(m=Qo.utils.decode(h.codepage,Qo.utils.encode(28591,m))),m.slice(0,19)=="socialcalc:version:"?w6.to_sheet(h.type=="string"?m:br(m),h):s(m,h)}function l(u,h){return Fl(o(u,h),h)}function c(u){for(var h=[],m=ir(u["!ref"]),f,v=Array.isArray(u),x=m.s.r;x<=m.e.r;++x){for(var w=[],_=m.s.c;_<=m.e.c;++_){var b=Et({r:x,c:_});if(f=v?(u[x]||[])[_]:u[b],!f||f.v==null){w.push("          ");continue}for(var y=(f.w||(wo(f),f.w)||"").slice(0,10);y.length<10;)y+=" ";w.push(y+(_===0?" ":""))}h.push(w.join(""))}return h.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}}();function mP(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var a=v6.to_workbook(e,r);return r.WTF=n,a}catch(i){if(r.WTF=n,!i.message.match(/SYLK bad record ID/)&&n)throw i;return iu.to_workbook(e,t)}}var wc=function(){function e(E,j,O){if(E){Zn(E,E.l||0);for(var B=O.Enum||ve;E.l<E.length;){var Y=E.read_shift(2),le=B[Y]||B[65535],fe=E.read_shift(2),ce=E.l+fe,de=le.f&&le.f(E,fe,O);if(E.l=ce,j(de,le,Y))return}}}function t(E,j){switch(j.type){case"base64":return r(li(mi(E)),j);case"binary":return r(li(E),j);case"buffer":case"array":return r(E,j)}throw"Unsupported type "+j.type}function r(E,j){if(!E)return E;var O=j||{},B=O.dense?[]:{},Y="Sheet1",le="",fe=0,ce={},de=[],Ce=[],X={s:{r:0,c:0},e:{r:0,c:0}},$e=O.sheetRows||0;if(E[2]==0&&(E[3]==8||E[3]==9)&&E.length>=16&&E[14]==5&&E[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(E[2]==2)O.Enum=ve,e(E,function(Re,tt,Me){switch(Me){case 0:O.vers=Re,Re>=4096&&(O.qpro=!0);break;case 6:X=Re;break;case 204:Re&&(le=Re);break;case 222:le=Re;break;case 15:case 51:O.qpro||(Re[1].v=Re[1].v.slice(1));case 13:case 14:case 16:Me==14&&(Re[2]&112)==112&&(Re[2]&15)>1&&(Re[2]&15)<15&&(Re[1].z=O.dateNF||Nt[14],O.cellDates&&(Re[1].t="d",Re[1].v=Wp(Re[1].v))),O.qpro&&Re[3]>fe&&(B["!ref"]=Ut(X),ce[Y]=B,de.push(Y),B=O.dense?[]:{},X={s:{r:0,c:0},e:{r:0,c:0}},fe=Re[3],Y=le||"Sheet"+(fe+1),le="");var at=O.dense?(B[Re[0].r]||[])[Re[0].c]:B[Et(Re[0])];if(at){at.t=Re[1].t,at.v=Re[1].v,Re[1].z!=null&&(at.z=Re[1].z),Re[1].f!=null&&(at.f=Re[1].f);break}O.dense?(B[Re[0].r]||(B[Re[0].r]=[]),B[Re[0].r][Re[0].c]=Re[1]):B[Et(Re[0])]=Re[1];break}},O);else if(E[2]==26||E[2]==14)O.Enum=_e,E[2]==14&&(O.qpro=!0,E.l=0),e(E,function(Re,tt,Me){switch(Me){case 204:Y=Re;break;case 22:Re[1].v=Re[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Re[3]>fe&&(B["!ref"]=Ut(X),ce[Y]=B,de.push(Y),B=O.dense?[]:{},X={s:{r:0,c:0},e:{r:0,c:0}},fe=Re[3],Y="Sheet"+(fe+1)),$e>0&&Re[0].r>=$e)break;O.dense?(B[Re[0].r]||(B[Re[0].r]=[]),B[Re[0].r][Re[0].c]=Re[1]):B[Et(Re[0])]=Re[1],X.e.c<Re[0].c&&(X.e.c=Re[0].c),X.e.r<Re[0].r&&(X.e.r=Re[0].r);break;case 27:Re[14e3]&&(Ce[Re[14e3][0]]=Re[14e3][1]);break;case 1537:Ce[Re[0]]=Re[1],Re[0]==fe&&(Y=Re[1]);break}},O);else throw new Error("Unrecognized LOTUS BOF "+E[2]);if(B["!ref"]=Ut(X),ce[le||Y]=B,de.push(le||Y),!Ce.length)return{SheetNames:de,Sheets:ce};for(var be={},ee=[],et=0;et<Ce.length;++et)ce[de[et]]?(ee.push(Ce[et]||de[et]),be[Ce[et]]=ce[Ce[et]]||ce[de[et]]):(ee.push(Ce[et]),be[Ce[et]]={"!ref":"A1"});return{SheetNames:ee,Sheets:be}}function n(E,j){var O=j||{};if(+O.codepage>=0&&is(+O.codepage),O.type=="string")throw new Error("Cannot write WK1 to JS string");var B=qa(),Y=ir(E["!ref"]),le=Array.isArray(E),fe=[];Ke(B,0,i(1030)),Ke(B,6,l(Y));for(var ce=Math.min(Y.e.r,8191),de=Y.s.r;de<=ce;++de)for(var Ce=gn(de),X=Y.s.c;X<=Y.e.c;++X){de===Y.s.r&&(fe[X]=Vr(X));var $e=fe[X]+Ce,be=le?(E[de]||[])[X]:E[$e];if(!(!be||be.t=="z"))if(be.t=="n")(be.v|0)==be.v&&be.v>=-32768&&be.v<=32767?Ke(B,13,f(de,X,be.v)):Ke(B,14,x(de,X,be.v));else{var ee=wo(be);Ke(B,15,h(de,X,ee.slice(0,239)))}}return Ke(B,1),B.end()}function a(E,j){var O=j||{};if(+O.codepage>=0&&is(+O.codepage),O.type=="string")throw new Error("Cannot write WK3 to JS string");var B=qa();Ke(B,0,s(E));for(var Y=0,le=0;Y<E.SheetNames.length;++Y)(E.Sheets[E.SheetNames[Y]]||{})["!ref"]&&Ke(B,27,G(E.SheetNames[Y],le++));var fe=0;for(Y=0;Y<E.SheetNames.length;++Y){var ce=E.Sheets[E.SheetNames[Y]];if(!(!ce||!ce["!ref"])){for(var de=ir(ce["!ref"]),Ce=Array.isArray(ce),X=[],$e=Math.min(de.e.r,8191),be=de.s.r;be<=$e;++be)for(var ee=gn(be),et=de.s.c;et<=de.e.c;++et){be===de.s.r&&(X[et]=Vr(et));var Re=X[et]+ee,tt=Ce?(ce[be]||[])[et]:ce[Re];if(!(!tt||tt.t=="z"))if(tt.t=="n")Ke(B,23,W(be,et,fe,tt.v));else{var Me=wo(tt);Ke(B,22,F(be,et,fe,Me.slice(0,239)))}}++fe}}return Ke(B,1),B.end()}function i(E){var j=Le(2);return j.write_shift(2,E),j}function s(E){var j=Le(26);j.write_shift(2,4096),j.write_shift(2,4),j.write_shift(4,0);for(var O=0,B=0,Y=0,le=0;le<E.SheetNames.length;++le){var fe=E.SheetNames[le],ce=E.Sheets[fe];if(!(!ce||!ce["!ref"])){++Y;var de=Ga(ce["!ref"]);O<de.e.r&&(O=de.e.r),B<de.e.c&&(B=de.e.c)}}return O>8191&&(O=8191),j.write_shift(2,O),j.write_shift(1,Y),j.write_shift(1,B),j.write_shift(2,0),j.write_shift(2,0),j.write_shift(1,1),j.write_shift(1,2),j.write_shift(4,0),j.write_shift(4,0),j}function o(E,j,O){var B={s:{c:0,r:0},e:{c:0,r:0}};return j==8&&O.qpro?(B.s.c=E.read_shift(1),E.l++,B.s.r=E.read_shift(2),B.e.c=E.read_shift(1),E.l++,B.e.r=E.read_shift(2),B):(B.s.c=E.read_shift(2),B.s.r=E.read_shift(2),j==12&&O.qpro&&(E.l+=2),B.e.c=E.read_shift(2),B.e.r=E.read_shift(2),j==12&&O.qpro&&(E.l+=2),B.s.c==65535&&(B.s.c=B.e.c=B.s.r=B.e.r=0),B)}function l(E){var j=Le(8);return j.write_shift(2,E.s.c),j.write_shift(2,E.s.r),j.write_shift(2,E.e.c),j.write_shift(2,E.e.r),j}function c(E,j,O){var B=[{c:0,r:0},{t:"n",v:0},0,0];return O.qpro&&O.vers!=20768?(B[0].c=E.read_shift(1),B[3]=E.read_shift(1),B[0].r=E.read_shift(2),E.l+=2):(B[2]=E.read_shift(1),B[0].c=E.read_shift(2),B[0].r=E.read_shift(2)),B}function u(E,j,O){var B=E.l+j,Y=c(E,j,O);if(Y[1].t="s",O.vers==20768){E.l++;var le=E.read_shift(1);return Y[1].v=E.read_shift(le,"utf8"),Y}return O.qpro&&E.l++,Y[1].v=E.read_shift(B-E.l,"cstr"),Y}function h(E,j,O){var B=Le(7+O.length);B.write_shift(1,255),B.write_shift(2,j),B.write_shift(2,E),B.write_shift(1,39);for(var Y=0;Y<B.length;++Y){var le=O.charCodeAt(Y);B.write_shift(1,le>=128?95:le)}return B.write_shift(1,0),B}function m(E,j,O){var B=c(E,j,O);return B[1].v=E.read_shift(2,"i"),B}function f(E,j,O){var B=Le(7);return B.write_shift(1,255),B.write_shift(2,j),B.write_shift(2,E),B.write_shift(2,O,"i"),B}function v(E,j,O){var B=c(E,j,O);return B[1].v=E.read_shift(8,"f"),B}function x(E,j,O){var B=Le(13);return B.write_shift(1,255),B.write_shift(2,j),B.write_shift(2,E),B.write_shift(8,O,"f"),B}function w(E,j,O){var B=E.l+j,Y=c(E,j,O);if(Y[1].v=E.read_shift(8,"f"),O.qpro)E.l=B;else{var le=E.read_shift(2);N(E.slice(E.l,E.l+le),Y),E.l+=le}return Y}function _(E,j,O){var B=j&32768;return j&=-32769,j=(B?E:0)+(j>=8192?j-16384:j),(B?"":"$")+(O?Vr(j):gn(j))}var b={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},y=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function N(E,j){Zn(E,0);for(var O=[],B=0,Y="",le="",fe="",ce="";E.l<E.length;){var de=E[E.l++];switch(de){case 0:O.push(E.read_shift(8,"f"));break;case 1:le=_(j[0].c,E.read_shift(2),!0),Y=_(j[0].r,E.read_shift(2),!1),O.push(le+Y);break;case 2:{var Ce=_(j[0].c,E.read_shift(2),!0),X=_(j[0].r,E.read_shift(2),!1);le=_(j[0].c,E.read_shift(2),!0),Y=_(j[0].r,E.read_shift(2),!1),O.push(Ce+X+":"+le+Y)}break;case 3:if(E.l<E.length){console.error("WK1 premature formula end");return}break;case 4:O.push("("+O.pop()+")");break;case 5:O.push(E.read_shift(2));break;case 6:{for(var $e="";de=E[E.l++];)$e+=String.fromCharCode(de);O.push('"'+$e.replace(/"/g,'""')+'"')}break;case 8:O.push("-"+O.pop());break;case 23:O.push("+"+O.pop());break;case 22:O.push("NOT("+O.pop()+")");break;case 20:case 21:ce=O.pop(),fe=O.pop(),O.push(["AND","OR"][de-20]+"("+fe+","+ce+")");break;default:if(de<32&&y[de])ce=O.pop(),fe=O.pop(),O.push(fe+y[de]+ce);else if(b[de]){if(B=b[de][1],B==69&&(B=E[E.l++]),B>O.length){console.error("WK1 bad formula parse 0x"+de.toString(16)+":|"+O.join("|")+"|");return}var be=O.slice(-B);O.length-=B,O.push(b[de][0]+"("+be.join(",")+")")}else return de<=7?console.error("WK1 invalid opcode "+de.toString(16)):de<=24?console.error("WK1 unsupported op "+de.toString(16)):de<=30?console.error("WK1 invalid opcode "+de.toString(16)):de<=115?console.error("WK1 unsupported function opcode "+de.toString(16)):console.error("WK1 unrecognized opcode "+de.toString(16))}}O.length==1?j[1].f=""+O[0]:console.error("WK1 bad formula parse |"+O.join("|")+"|")}function R(E){var j=[{c:0,r:0},{t:"n",v:0},0];return j[0].r=E.read_shift(2),j[3]=E[E.l++],j[0].c=E[E.l++],j}function P(E,j){var O=R(E);return O[1].t="s",O[1].v=E.read_shift(j-4,"cstr"),O}function F(E,j,O,B){var Y=Le(6+B.length);Y.write_shift(2,E),Y.write_shift(1,O),Y.write_shift(1,j),Y.write_shift(1,39);for(var le=0;le<B.length;++le){var fe=B.charCodeAt(le);Y.write_shift(1,fe>=128?95:fe)}return Y.write_shift(1,0),Y}function C(E,j){var O=R(E);O[1].v=E.read_shift(2);var B=O[1].v>>1;if(O[1].v&1)switch(B&7){case 0:B=(B>>3)*5e3;break;case 1:B=(B>>3)*500;break;case 2:B=(B>>3)/20;break;case 3:B=(B>>3)/200;break;case 4:B=(B>>3)/2e3;break;case 5:B=(B>>3)/2e4;break;case 6:B=(B>>3)/16;break;case 7:B=(B>>3)/64;break}return O[1].v=B,O}function A(E,j){var O=R(E),B=E.read_shift(4),Y=E.read_shift(4),le=E.read_shift(2);if(le==65535)return B===0&&Y===3221225472?(O[1].t="e",O[1].v=15):B===0&&Y===3489660928?(O[1].t="e",O[1].v=42):O[1].v=0,O;var fe=le&32768;return le=(le&32767)-16446,O[1].v=(1-fe*2)*(Y*Math.pow(2,le+32)+B*Math.pow(2,le)),O}function W(E,j,O,B){var Y=Le(14);if(Y.write_shift(2,E),Y.write_shift(1,O),Y.write_shift(1,j),B==0)return Y.write_shift(4,0),Y.write_shift(4,0),Y.write_shift(2,65535),Y;var le=0,fe=0,ce=0,de=0;return B<0&&(le=1,B=-B),fe=Math.log2(B)|0,B/=Math.pow(2,fe-31),de=B>>>0,de&2147483648||(B/=2,++fe,de=B>>>0),B-=de,de|=2147483648,de>>>=0,B*=Math.pow(2,32),ce=B>>>0,Y.write_shift(4,ce),Y.write_shift(4,de),fe+=16383+(le?32768:0),Y.write_shift(2,fe),Y}function L(E,j){var O=A(E);return E.l+=j-14,O}function I(E,j){var O=R(E),B=E.read_shift(4);return O[1].v=B>>6,O}function V(E,j){var O=R(E),B=E.read_shift(8,"f");return O[1].v=B,O}function Q(E,j){var O=V(E);return E.l+=j-10,O}function ue(E,j){return E[E.l+j-1]==0?E.read_shift(j,"cstr"):""}function me(E,j){var O=E[E.l++];O>j-1&&(O=j-1);for(var B="";B.length<O;)B+=String.fromCharCode(E[E.l++]);return B}function pe(E,j,O){if(!(!O.qpro||j<21)){var B=E.read_shift(1);E.l+=17,E.l+=1,E.l+=2;var Y=E.read_shift(j-21,"cstr");return[B,Y]}}function oe(E,j){for(var O={},B=E.l+j;E.l<B;){var Y=E.read_shift(2);if(Y==14e3){for(O[Y]=[0,""],O[Y][0]=E.read_shift(2);E[E.l];)O[Y][1]+=String.fromCharCode(E[E.l]),E.l++;E.l++}}return O}function G(E,j){var O=Le(5+E.length);O.write_shift(2,14e3),O.write_shift(2,j);for(var B=0;B<E.length;++B){var Y=E.charCodeAt(B);O[O.l++]=Y>127?95:Y}return O[O.l++]=0,O}var ve={0:{n:"BOF",f:Sn},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:m},14:{n:"NUMBER",f:v},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:w},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ue},222:{n:"SHEETNAMELP",f:me},65535:{n:""}},_e={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:P},23:{n:"NUMBER17",f:A},24:{n:"NUMBER18",f:C},25:{n:"FORMULA19",f:L},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:oe},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:I},38:{n:"??"},39:{n:"NUMBER27",f:V},40:{n:"FORMULA28",f:Q},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ue},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:pe},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:t}}();function gP(e){var t={},r=e.match(ya),n=0,a=!1;if(r)for(;n!=r.length;++n){var i=Ct(r[n]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;t.cp=Rv[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=i.val;break;case"<sz":t.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":i.rgb&&(t.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(i[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+i[0])}}return t}var xP=function(){var e=lh("t"),t=lh("rPr");function r(i){var s=i.match(e);if(!s)return{t:"s",v:""};var o={t:"s",v:ar(s[1])},l=i.match(t);return l&&(o.s=gP(l[1])),o}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(s){return s.replace(n,"").split(a).map(r).filter(function(o){return o.v})}}(),vP=function(){var t=/(\r\n|\n)/g;function r(a,i,s){var o=[];a.u&&o.push("text-decoration: underline;"),a.uval&&o.push("text-underline-style:"+a.uval+";"),a.sz&&o.push("font-size:"+a.sz+"pt;"),a.outline&&o.push("text-effect: outline;"),a.shadow&&o.push("text-shadow: auto;"),i.push('<span style="'+o.join("")+'">'),a.b&&(i.push("<b>"),s.push("</b>")),a.i&&(i.push("<i>"),s.push("</i>")),a.strike&&(i.push("<s>"),s.push("</s>"));var l=a.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(i.push("<"+l+">"),s.push("</"+l+">")),s.push("</span>"),a}function n(a){var i=[[],a.v,[]];return a.v?(a.s&&r(a.s,i[0],i[2]),i[0].join("")+i[1].replace(t,"<br/>")+i[2].join("")):""}return function(i){return i.map(n).join("")}}(),_P=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,wP=/<(?:\w+:)?r>/,yP=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function s_(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=ar(br(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=br(e),r&&(n.h=qv(n.t))):e.match(wP)&&(n.r=br(e),n.t=ar(br((e.replace(yP,"").match(_P)||[]).join("").replace(ya,""))),r&&(n.h=vP(xP(n.r)))),n):{t:""}}var bP=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,kP=/<(?:\w+:)?(?:si|sstItem)>/g,SP=/<\/(?:\w+:)?(?:si|sstItem)>/;function NP(e,t){var r=[],n="";if(!e)return r;var a=e.match(bP);if(a){n=a[2].replace(kP,"").split(SP);for(var i=0;i!=n.length;++i){var s=s_(n[i].trim(),t);s!=null&&(r[r.length]=s)}a=Ct(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}var EP=/^\s|\s$|[\t\n\r]/;function y6(e,t){if(!t.bookSST)return"";var r=[xn];r[r.length]=Xe("sst",null,{xmlns:Bc[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var a=e[n],i="<si>";a.r?i+=a.r:(i+="<t",a.t||(a.t=""),a.t.match(EP)&&(i+=' xml:space="preserve"'),i+=">"+_r(a.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function AP(e){return[e.read_shift(4),e.read_shift(4)]}function TP(e,t){var r=[],n=!1;return ko(e,function(i,s,o){switch(o){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(s.T,!n||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function CP(e,t){return t||(t=Le(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var FP=UF;function LP(e){var t=qa();De(t,159,CP(e));for(var r=0;r<e.length;++r)De(t,19,FP(e[r]));return De(t,160),t.end()}function b6(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function mo(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function PP(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=mo(e,4),t.U=mo(e,4),t.W=mo(e,4),t}function IP(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},a=e.read_shift(4),i=[];a-- >0;)i.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=i,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function OP(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(IP(e));return t}function jP(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function RP(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=mo(e,4),t.U=mo(e,4),t.W=mo(e,4),t}function DP(e){var t=RP(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function k6(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function S6(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function MP(e){var t=mo(e);switch(t.Minor){case 2:return[t.Minor,BP(e)];case 3:return[t.Minor,UP()];case 4:return[t.Minor,zP(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function BP(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=k6(e,r),a=S6(e,e.length-e.l);return{t:"Std",h:n,v:a}}function UP(){throw new Error("File is password-protected: ECMA-376 Extensible")}function zP(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(ya,function(i){var s=Ct(i);switch(Ds(s[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){n[o]=s[o]});break;case"<dataIntegrity":n.encryptedHmacKey=s.encryptedHmacKey,n.encryptedHmacValue=s.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=s.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(s);break;default:throw s[0]}}),n}function $P(e,t){var r={},n=r.EncryptionVersionInfo=mo(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,r.EncryptionHeader=k6(e,a),t-=a,r.EncryptionVerifier=S6(e,t),r}function WP(e){var t={},r=t.EncryptionVersionInfo=mo(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function o_(e){var t=0,r,n=b6(e),a=n.length+1,i,s,o,l,c;for(r=yl(a),r[0]=n.length,i=1;i!=a;++i)r[i]=n[i-1];for(i=a-1;i>=0;--i)s=r[i],o=t&16384?1:0,l=t<<1&32767,c=o|l,t=c^s;return t^52811}var N6=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(s){return(s/2|s*128)&255},a=function(s,o){return n(s^o)},i=function(s){for(var o=t[s.length-1],l=104,c=s.length-1;c>=0;--c)for(var u=s[c],h=0;h!=7;++h)u&64&&(o^=r[l]),u*=2,--l;return o};return function(s){for(var o=b6(s),l=i(o),c=o.length,u=yl(16),h=0;h!=16;++h)u[h]=0;var m,f,v;for((c&1)===1&&(m=l>>8,u[c]=a(e[0],m),--c,m=l&255,f=o[o.length-1],u[c]=a(f,m));c>0;)--c,m=l>>8,u[c]=a(o[c],m),--c,m=l&255,u[c]=a(o[c],m);for(c=15,v=15-o.length;v>0;)m=l>>8,u[c]=a(e[v],m),--c,--v,m=l&255,u[c]=a(o[c],m),--c,--v;return u}}(),HP=function(e,t,r,n,a){a||(a=t),n||(n=N6(e));var i,s;for(i=0;i!=t.length;++i)s=t[i],s^=n[r],s=(s>>5|s<<3)&255,a[i]=s,++r;return[a,r,n]},VP=function(e){var t=0,r=N6(e);return function(n){var a=HP("",n,t,r);return t=a[1],a[0]}};function qP(e,t,r,n){var a={key:Sn(e),verificationBytes:Sn(e)};return r.password&&(a.verifier=o_(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=VP(r.password)),a}function GP(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=WP(e):n.Data=$P(e,t),n}function XP(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?GP(e,t-2,n):qP(e,r.biff>=8?t:t-2,r,n),n}var E6=function(){function e(a,i){switch(i.type){case"base64":return t(mi(a),i);case"binary":return t(a,i);case"buffer":return t(Vt&&Buffer.isBuffer(a)?a.toString("binary"):Cl(a),i);case"array":return t(Cc(a),i)}throw new Error("Unrecognized type "+i.type)}function t(a,i){var s=i||{},o=s.dense?[]:{},l=a.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(u,h){Array.isArray(o)&&(o[h]=[]);for(var m=/\\\w+\b/g,f=0,v,x=-1;v=m.exec(u);){switch(v[0]){case"\\cell":var w=u.slice(f,m.lastIndex-v[0].length);if(w[0]==" "&&(w=w.slice(1)),++x,w.length){var _={v:w,t:"s"};Array.isArray(o)?o[h][x]=_:o[Et({r:h,c:x})]=_}break}f=m.lastIndex}x>c.e.c&&(c.e.c=x)}),o["!ref"]=Ut(c),o}function r(a,i){return Fl(e(a,i),i)}function n(a){for(var i=["{\\rtf1\\ansi"],s=ir(a["!ref"]),o,l=Array.isArray(a),c=s.s.r;c<=s.e.r;++c){i.push("\\trowd\\trautofit1");for(var u=s.s.c;u<=s.e.c;++u)i.push("\\cellx"+(u+1));for(i.push("\\pard\\intbl"),u=s.s.c;u<=s.e.c;++u){var h=Et({r:c,c:u});o=l?(a[c]||[])[u]:a[h],!(!o||o.v==null&&(!o.f||o.F))&&(i.push(" "+(o.w||(wo(o),o.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function KP(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function hh(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function YP(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,a=Math.max(t,r,n),i=Math.min(t,r,n),s=a-i;if(s===0)return[0,0,t];var o=0,l=0,c=a+i;switch(l=s/(c>1?2-c:c),a){case t:o=((r-n)/s+6)%6;break;case r:o=(n-t)/s+2;break;case n:o=(t-r)/s+4;break}return[o/6,l,c/2]}function JP(e){var t=e[0],r=e[1],n=e[2],a=r*2*(n<.5?n:1-n),i=n-a/2,s=[i,i,i],o=6*t,l;if(r!==0)switch(o|0){case 0:case 6:l=a*o,s[0]+=a,s[1]+=l;break;case 1:l=a*(2-o),s[0]+=l,s[1]+=a;break;case 2:l=a*(o-2),s[1]+=a,s[2]+=l;break;case 3:l=a*(4-o),s[1]+=l,s[2]+=a;break;case 4:l=a*(o-4),s[2]+=a,s[0]+=l;break;case 5:l=a*(6-o),s[2]+=l,s[0]+=a;break}for(var c=0;c!=3;++c)s[c]=Math.round(s[c]*255);return s}function hp(e,t){if(t===0)return e;var r=YP(KP(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),hh(JP(r))}var A6=6,ZP=15,QP=1,ga=A6;function dh(e){return Math.floor((e+Math.round(128/ga)/256)*ga)}function ph(e){return Math.floor((e-5)/ga*100+.5)/100}function dp(e){return Math.round((e*ga+5)/ga*256)/256}function pg(e){return dp(ph(dh(e)))}function l_(e){var t=Math.abs(e-pg(e)),r=ga;if(t>.005)for(ga=QP;ga<ZP;++ga)Math.abs(e-pg(e))<=t&&(t=Math.abs(e-pg(e)),r=ga);ga=r}function bl(e){e.width?(e.wpx=dh(e.width),e.wch=ph(e.wpx),e.MDW=ga):e.wpx?(e.wch=ph(e.wpx),e.width=dp(e.wch),e.MDW=ga):typeof e.wch=="number"&&(e.width=dp(e.wch),e.wpx=dh(e.width),e.MDW=ga),e.customWidth&&delete e.customWidth}var eI=96,T6=eI;function mh(e){return e*96/T6}function su(e){return e*T6/96}var tI={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function rI(e,t,r,n){t.Borders=[];var a={},i=!1;(e[0].match(ya)||[]).forEach(function(s){var o=Ct(s);switch(Ds(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},o.diagonalUp&&(a.diagonalUp=Or(o.diagonalUp)),o.diagonalDown&&(a.diagonalDown=Or(o.diagonalDown)),t.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in borders")}})}function nI(e,t,r,n){t.Fills=[];var a={},i=!1;(e[0].match(ya)||[]).forEach(function(s){var o=Ct(s);switch(Ds(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":o.patternType&&(a.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),o.indexed&&(a.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(a.bgColor.theme=parseInt(o.theme,10)),o.tint&&(a.bgColor.tint=parseFloat(o.tint)),o.rgb&&(a.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),o.theme&&(a.fgColor.theme=parseInt(o.theme,10)),o.tint&&(a.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(a.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fills")}})}function aI(e,t,r,n){t.Fonts=[];var a={},i=!1;(e[0].match(ya)||[]).forEach(function(s){var o=Ct(s);switch(Ds(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":o.val&&(a.name=br(o.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=o.val?Or(o.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=o.val?Or(o.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(o.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=o.val?Or(o.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=o.val?Or(o.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=o.val?Or(o.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=o.val?Or(o.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=o.val?Or(o.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":o.val&&(a.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(a.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(a.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(a.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=Rv[parseInt(o.val,10)];break;case"<color":if(a.color||(a.color={}),o.auto&&(a.color.auto=Or(o.auto)),o.rgb)a.color.rgb=o.rgb.slice(-6);else if(o.indexed){a.color.index=parseInt(o.indexed,10);var l=vc[a.color.index];a.color.index==81&&(l=vc[1]),l||(l=vc[1]),a.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(a.color.theme=parseInt(o.theme,10),o.tint&&(a.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=hp(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fonts")}})}function iI(e,t,r){t.NumberFmt=[];for(var n=nn(Nt),a=0;a<n.length;++a)t.NumberFmt[n[a]]=Nt[n[a]];var i=e[0].match(ya);if(i)for(a=0;a<i.length;++a){var s=Ct(i[a]);switch(Ds(s[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=ar(br(s.formatCode)),l=parseInt(s.numFmtId,10);if(t.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&t.NumberFmt[l]!=null;--l);t.NumberFmt[l]=o}po(o,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+s[0]+" in numFmts")}}}function sI(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=Xe("numFmt",null,{numFmtId:n,formatCode:_r(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Xe("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var Gd=["numFmtId","fillId","fontId","borderId","xfId"],Xd=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function oI(e,t,r){t.CellXf=[];var n,a=!1;(e[0].match(ya)||[]).forEach(function(i){var s=Ct(i),o=0;switch(Ds(s[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=s,delete n[0],o=0;o<Gd.length;++o)n[Gd[o]]&&(n[Gd[o]]=parseInt(n[Gd[o]],10));for(o=0;o<Xd.length;++o)n[Xd[o]]&&(n[Xd[o]]=Or(n[Xd[o]]));if(t.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};s.vertical&&(l.vertical=s.vertical),s.horizontal&&(l.horizontal=s.horizontal),s.textRotation!=null&&(l.textRotation=s.textRotation),s.indent&&(l.indent=s.indent),s.wrapText&&(l.wrapText=Or(s.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+s[0]+" in cellXfs")}})}function lI(e){var t=[];return t[t.length]=Xe("cellXfs",null),e.forEach(function(r){t[t.length]=Xe("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Xe("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var cI=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,c){var u={};if(!o)return u;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var h;return(h=o.match(t))&&iI(h,u,c),(h=o.match(a))&&aI(h,u,l,c),(h=o.match(n))&&nI(h,u,l,c),(h=o.match(i))&&rI(h,u,l,c),(h=o.match(r))&&oI(h,u,c),u}}();function C6(e,t){var r=[xn,Xe("styleSheet",null,{xmlns:Bc[0],"xmlns:vt":On.vt})],n;return e.SSF&&(n=sI(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=lI(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function uI(e,t){var r=e.read_shift(2),n=va(e);return[r,n]}function fI(e,t,r){r||(r=Le(6+4*t.length)),r.write_shift(2,e),Wn(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function hI(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=GF(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var i=e.read_shift(2);switch(i===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var s=e.read_shift(1);s!=0&&(n.underline=s);var o=e.read_shift(1);o>0&&(n.family=o);var l=e.read_shift(1);switch(l>0&&(n.charset=l),e.l++,n.color=qF(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=va(e),n}function dI(e,t){t||(t=Le(25+4*32)),t.write_shift(2,e.sz*20),XF(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),cp(e.color,t);var n=0;return e.scheme=="major"&&(n=1),e.scheme=="minor"&&(n=2),t.write_shift(1,n),Wn(e.name,t),t.length>t.l?t.slice(0,t.l):t}var pI=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],mg,mI=wa;function Ly(e,t){t||(t=Le(4*3+8*7+16*1)),mg||(mg=zp(pI));var r=mg[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(cp({auto:1},t),cp({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function gI(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}function F6(e,t,r){r||(r=Le(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function nf(e,t){return t||(t=Le(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var xI=wa;function vI(e,t){return t||(t=Le(51)),t.write_shift(1,0),nf(null,t),nf(null,t),nf(null,t),nf(null,t),nf(null,t),t.length>t.l?t.slice(0,t.l):t}function _I(e,t){return t||(t=Le(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,+e.builtinId),t.write_shift(1,0),lp(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function wI(e,t,r){var n=Le(2052);return n.write_shift(4,e),lp(t,n),lp(r,n),n.length>n.l?n.slice(0,n.l):n}function yI(e,t,r){var n={};n.NumberFmt=[];for(var a in Nt)n.NumberFmt[a]=Nt[a];n.CellXf=[],n.Fonts=[];var i=[],s=!1;return ko(e,function(l,c,u){switch(u){case 44:n.NumberFmt[l[0]]=l[1],po(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(l.color.rgb=hp(t.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:i.push(u),s=!0;break;case 38:i.pop(),s=!1;break;default:if(c.T>0)i.push(u);else if(c.T<0)i.pop();else if(!s||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}function bI(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&++r}),r!=0&&(De(e,615,us(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&De(e,44,fI(a,t[a]))}),De(e,616))}}function kI(e){var t=1;De(e,611,us(t)),De(e,43,dI({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),De(e,612)}function SI(e){var t=2;De(e,603,us(t)),De(e,45,Ly({patternType:"none"})),De(e,45,Ly({patternType:"gray125"})),De(e,604)}function NI(e){var t=1;De(e,613,us(t)),De(e,46,vI()),De(e,614)}function EI(e){var t=1;De(e,626,us(t)),De(e,47,F6({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),De(e,627)}function AI(e,t){De(e,617,us(t.length)),t.forEach(function(r){De(e,47,F6(r,0))}),De(e,618)}function TI(e){var t=1;De(e,619,us(t)),De(e,48,_I({xfId:0,builtinId:0,name:"Normal"})),De(e,620)}function CI(e){var t=0;De(e,505,us(t)),De(e,506)}function FI(e){var t=0;De(e,508,wI(t,"TableStyleMedium9","PivotStyleMedium4")),De(e,509)}function LI(e,t){var r=qa();return De(r,278),bI(r,e.SSF),kI(r),SI(r),NI(r),EI(r),AI(r,t.cellXfs),TI(r),CI(r),FI(r),De(r,279),r.end()}var PI=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function II(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(ya)||[]).forEach(function(a){var i=Ct(a);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=i.val;break;case"<a:sysClr":n.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(t.themeElements.clrScheme[PI.indexOf(i[0])]=n,n={}):n.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function OI(){}function jI(){}var RI=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,DI=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,MI=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function BI(e,t,r){t.themeElements={};var n;[["clrScheme",RI,II],["fontScheme",DI,OI],["fmtScheme",MI,jI]].forEach(function(a){if(!(n=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,t,r)})}var UI=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function L6(e,t){(!e||e.length===0)&&(e=c_());var r,n={};if(!(r=e.match(UI)))throw new Error("themeElements not found in theme");return BI(r[0],n,t),n.raw=e,n}function c_(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[xn];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function zI(e,t,r){var n=e.l+t,a=e.read_shift(4);if(a!==124226){if(!r.cellStyles){e.l=n;return}var i=e.slice(e.l);e.l=n;var s;try{s=kS(i,{type:"array"})}catch{return}var o=ci(s,"theme/theme/theme1.xml",!0);if(o)return L6(o,r)}}function $I(e){return e.read_shift(4)}function WI(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=HI(e,4);break;case 2:t.xclrValue=u6(e);break;case 3:t.xclrValue=$I(e);break;case 4:e.l+=4;break}return e.l+=8,t}function HI(e,t){return wa(e,t)}function VI(e,t){return wa(e,t)}function qI(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=WI(e);break;case 6:n[1]=VI(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function GI(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),i=[];a-- >0;)i.push(qI(e,r-e.l));return{ixfe:n,ext:i}}function XI(e,t){t.forEach(function(r){switch(r[0]){}})}function KI(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:va(e)}}function YI(e){var t=Le(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Wn(e.name,t),t.slice(0,t.l)}function JI(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function ZI(e){var t=Le(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function QI(e,t){var r=Le(8+2*t.length);return r.write_shift(4,e),Wn(t,r),r.slice(0,r.l)}function eO(e){return e.l+=4,e.read_shift(4)!=0}function tO(e,t){var r=Le(8);return r.write_shift(4,e),r.write_shift(4,1),r}function rO(e,t,r){var n={Types:[],Cell:[],Value:[]},a=r||{},i=[],s=!1,o=2;return ko(e,function(l,c,u){switch(u){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(h){o==1?n.Cell.push({type:n.Types[h[0]-1].name,index:h[1]}):o==0&&n.Value.push({type:n.Types[h[0]-1].name,index:h[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:i.push(u),s=!0;break;case 36:i.pop(),s=!1;break;default:if(!c.T){if(!s||a.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}}),n}function nO(){var e=qa();return De(e,332),De(e,334,us(1)),De(e,335,YI({name:"XLDAPR",version:12e4,flags:3496657072})),De(e,336),De(e,339,QI(1,"XLDAPR")),De(e,52),De(e,35,us(514)),De(e,4096,us(0)),De(e,4097,Fi(1)),De(e,36),De(e,53),De(e,340),De(e,337,tO(1)),De(e,51,ZI([[1,0]])),De(e,338),De(e,333),e.end()}function aO(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a=!1,i=2,s;return e.replace(ya,function(o){var l=Ct(o);switch(Ds(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<n.Types.length;++c)n.Types[c].name==l.name&&(s=n.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):i==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!s)break;s.offsets||(s.offsets=[]),s.offsets.push(+l.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function P6(){var e=[xn];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function iO(e){var t=[];if(!e)return t;var r=1;return(e.match(ya)||[]).forEach(function(n){var a=Ct(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,t.push(a);break}}),t}function sO(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Et(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function oO(e,t,r){var n=[];return ko(e,function(i,s,o){switch(o){case 63:n.push(i);break;default:if(!s.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function lO(e,t,r,n){if(!e)return e;var a=n||{},i=!1;ko(e,function(o,l,c){switch(c){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!l.T){if(!i||a.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}},a)}function cO(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var I0=1024;function I6(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),a=[Xe("xml",null,{"xmlns:v":si.v,"xmlns:o":si.o,"xmlns:x":si.x,"xmlns:mv":si.mv}).replace(/\/>/,">"),Xe("o:shapelayout",Xe("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Xe("v:shapetype",[Xe("v:stroke",null,{joinstyle:"miter"}),Xe("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];I0<e*1e3;)I0+=1e3;return t.forEach(function(i){var s=qr(i[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?Xe("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,c=Xe("v:fill",l,o),u={on:"t",obscured:"t"};++I0,a=a.concat(["<v:shape"+ch({id:"_x0000_s"+I0,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",c,Xe("v:shadow",null,u),Xe("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Qn("x:Anchor",[s.c+1,0,s.r+1,0,s.c+3,20,s.r+5,20].join(",")),Qn("x:AutoFill","False"),Qn("x:Row",String(s.r)),Qn("x:Column",String(s.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function Py(e,t,r,n){var a=Array.isArray(e),i;t.forEach(function(s){var o=qr(s.ref);if(a?(e[o.r]||(e[o.r]=[]),i=e[o.r][o.c]):i=e[s.ref],!i){i={t:"z"},a?e[o.r][o.c]=i:e[s.ref]=i;var l=ir(e["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var c=Ut(l);c!==e["!ref"]&&(e["!ref"]=c)}i.c||(i.c=[]);var u={a:s.author,t:s.t,r:s.r,T:r};s.h&&(u.h=s.h);for(var h=i.c.length-1;h>=0;--h){if(!r&&i.c[h].T)return;r&&!i.c[h].T&&i.c.splice(h,1)}if(r&&n){for(h=0;h<n.length;++h)if(u.a==n[h].id){u.a=n[h].name||u.a;break}}i.c.push(u)})}function uO(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(s){if(!(s===""||s.trim()==="")){var o=s.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var i=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(s){if(!(s===""||s.trim()==="")){var o=s.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=Ct(o[0]),c={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},u=qr(l.ref);if(!(t.sheetRows&&t.sheetRows<=u.r)){var h=s.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),m=!!h&&!!h[1]&&s_(h[1])||{r:"",t:"",h:""};c.r=m.r,m.r=="<t></t>"&&(m.t=m.h=""),c.t=(m.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(c.h=m.h),n.push(c)}}}}),n}function O6(e){var t=[xn,Xe("comments",null,{xmlns:Bc[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(a){var i=_r(a.a);r.indexOf(i)==-1&&(r.push(i),t.push("<author>"+i+"</author>")),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),t.push("<author>tc="+a.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var a=0,i=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?a=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(l){l.a&&(a=r.indexOf(_r(l.a))),i.push(l.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>'),i.length<=1)t.push(Qn("t",_r(i[0]||"")));else{for(var s=`Comment:
    `+i[0]+`
`,o=1;o<i.length;++o)s+=`Reply:
    `+i[o]+`
`;t.push(Qn("t",_r(s)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function fO(e,t){var r=[],n=!1,a={},i=0;return e.replace(ya,function(o,l){var c=Ct(o);switch(Ds(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":i=l+o.length;break;case"</text>":a.t=e.slice(i,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o}),r}function hO(e,t,r){var n=[xn,Xe("ThreadedComments",null,{xmlns:On.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(a){var i="";(a[1]||[]).forEach(function(s,o){if(!s.T){delete s.ID;return}s.a&&t.indexOf(s.a)==-1&&t.push(s.a);var l={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?i=l.id:l.parentId=i,s.ID=l.id,s.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(s.a)).slice(-12)+"}"),n.push(Xe("threadedComment",Qn("text",s.t||""),l))})}),n.push("</ThreadedComments>"),n.join("")}function dO(e,t){var r=[],n=!1;return e.replace(ya,function(i){var s=Ct(i);switch(Ds(s[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:s.displayname,id:s.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+s[0]+" in threaded comments")}return i}),r}function pO(e){var t=[xn,Xe("personList",null,{xmlns:On.TCMNT,"xmlns:x":Bc[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(Xe("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function mO(e){var t={};t.iauthor=e.read_shift(4);var r=Wc(e);return t.rfx=r.s,t.ref=Et(r.s),e.l+=16,t}function gO(e,t){return t==null&&(t=Le(36)),t.write_shift(4,e[1].iauthor),vu(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var xO=va;function vO(e){return Wn(e.slice(0,54))}function _O(e,t){var r=[],n=[],a={},i=!1;return ko(e,function(o,l,c){switch(c){case 632:n.push(o);break;case 635:a=o;break;case 637:a.t=o.t,a.h=o.h,a.r=o.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!i||t.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),r}function wO(e){var t=qa(),r=[];return De(t,628),De(t,630),e.forEach(function(n){n[1].forEach(function(a){r.indexOf(a.a)>-1||(r.push(a.a.slice(0,54)),De(t,632,vO(a.a)))})}),De(t,631),De(t,633),e.forEach(function(n){n[1].forEach(function(a){a.iauthor=r.indexOf(a.a);var i={s:qr(n[0]),e:qr(n[0])};De(t,635,gO([i,a])),a.t&&a.t.length>0&&De(t,637,$F(a)),De(t,636),delete a.iauthor})}),De(t,634),De(t,629),t.end()}var yO="application/vnd.ms-office.vbaProject";function bO(e){var t=vt.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");vt.utils.cfb_add(t,a,e.FileIndex[n].content)}}),vt.write(t)}function kO(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var a=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&vt.utils.cfb_add(e,a,t.FileIndex[n].content)}})}var j6=["xlsb","xlsm","xlam","biff8","xla"];function SO(){return{"!type":"dialog"}}function NO(){return{"!type":"dialog"}}function EO(){return{"!type":"macro"}}function AO(){return{"!type":"macro"}}var W0=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,a,i,s){var o=!1,l=!1;i.length==0?l=!0:i.charAt(0)=="["&&(l=!0,i=i.slice(1,-1)),s.length==0?o=!0:s.charAt(0)=="["&&(o=!0,s=s.slice(1,-1));var c=i.length>0?parseInt(i,10)|0:0,u=s.length>0?parseInt(s,10)|0:0;return o?u+=t.c:--u,l?c+=t.r:--c,a+(o?"":"$")+Vr(u)+(l?"":"$")+gn(c)}return function(a,i){return t=i,a.replace(e,r)}}(),u_=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,f_=function(){return function(t,r){return t.replace(u_,function(n,a,i,s,o,l){var c=Jv(s)-(i?0:r.c),u=Yv(l)-(o?0:r.r),h=u==0?"":o?u+1:"["+u+"]",m=c==0?"":i?c+1:"["+c+"]";return a+"R"+h+"C"+m})}}();function R6(e,t){return e.replace(u_,function(r,n,a,i,s,o){return n+(a=="$"?a+i:Vr(Jv(i)+t.c))+(s=="$"?s+o:gn(Yv(o)+t.r))})}function TO(e,t,r){var n=Ga(t),a=n.s,i=qr(r),s={r:i.r-a.r,c:i.c-a.c};return R6(e,s)}function CO(e){return e.length!=1}function Iy(e){return e.replace(/_xlfn\./g,"")}function bn(e){e.l+=1}function kl(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function D6(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return M6(e);r.biff==12&&(n=4)}var a=e.read_shift(n),i=e.read_shift(n),s=kl(e),o=kl(e);return{s:{r:a,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function M6(e){var t=kl(e),r=kl(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function FO(e,t,r){if(r.biff<8)return M6(e);var n=e.read_shift(r.biff==12?4:2),a=e.read_shift(r.biff==12?4:2),i=kl(e),s=kl(e);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:s[0],cRel:s[1],rRel:s[2]}}}function B6(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return LO(e);var n=e.read_shift(r&&r.biff==12?4:2),a=kl(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function LO(e){var t=kl(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function PO(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function IO(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return OO(e);var a=e.read_shift(n>=12?4:2),i=e.read_shift(2),s=(i&16384)>>14,o=(i&32768)>>15;if(i&=16383,o==1)for(;a>524287;)a-=1048576;if(s==1)for(;i>8191;)i=i-16384;return{r:a,c:i,cRel:s,rRel:o}}function OO(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),a==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:a,rRel:n}}function jO(e,t,r){var n=(e[e.l++]&96)>>5,a=D6(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function RO(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var s=D6(e,i,r);return[n,a,s]}function DO(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function MO(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[n,a]}function BO(e,t,r){var n=(e[e.l++]&96)>>5,a=FO(e,t-1,r);return[n,a]}function UO(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function Oy(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function zO(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),a=[],i=0;i<=n;++i)a.push(e.read_shift(r&&r.biff==2?1:2));return a}function $O(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function WO(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function HO(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function VO(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function U6(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function qO(e){return e.read_shift(2),U6(e)}function GO(e){return e.read_shift(2),U6(e)}function XO(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=B6(e,0,r);return[n,a]}function KO(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=IO(e,0,r);return[n,a]}function YO(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=B6(e,0,r);return[n,a,i]}function JO(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[eR[a],W6[a],n]}function ZO(e,t,r){var n=e[e.l++],a=e.read_shift(1),i=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:QO(e);return[a,(i[0]===0?W6:Qj)[i[1]]]}function QO(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function ej(e,t,r){e.l+=r&&r.biff==2?3:4}function tj(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function rj(e){return e.l++,So[e.read_shift(1)]}function nj(e){return e.l++,e.read_shift(2)}function aj(e){return e.l++,e.read_shift(1)!==0}function ij(e){return e.l++,xa(e)}function sj(e,t,r){return e.l++,Rh(e,t-1,r)}function oj(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=fn(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=So[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=xa(e);break;case 2:r[1]=Hc(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function lj(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),a=[],i=0;i!=n;++i)a.push((r.biff==12?Wc:Hp)(e));return a}function cj(e,t,r){var n=0,a=0;r.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var i=0,s=[];i!=n&&(s[i]=[]);++i)for(var o=0;o!=a;++o)s[i][o]=oj(e,r.biff);return s}function uj(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,i=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,i]}function fj(e,t,r){if(r.biff==5)return hj(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),i=e.read_shift(4);return[n,a,i]}function hj(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function dj(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function pj(e,t,r){var n=e.read_shift(1)>>>5&3,a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function mj(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function gj(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[n,a]}var xj=wa,vj=wa,_j=wa;function Mh(e,t,r){return e.l+=2,[PO(e)]}function h_(e){return e.l+=6,[]}var wj=Mh,yj=h_,bj=h_,kj=Mh;function z6(e){return e.l+=2,[Sn(e),e.read_shift(2)&1]}var Sj=Mh,Nj=z6,Ej=h_,Aj=Mh,Tj=Mh,Cj=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function Fj(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),i=e.read_shift(2),s=Cj[r>>2&31];return{ixti:t,coltype:r&3,rt:s,idx:n,c:a,C:i}}function Lj(e){return e.l+=2,[e.read_shift(4)]}function Pj(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function Ij(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function Oj(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function jj(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function Rj(e){return e.l+=4,[0,0]}var jy={1:{n:"PtgExp",f:tj},2:{n:"PtgTbl",f:_j},3:{n:"PtgAdd",f:bn},4:{n:"PtgSub",f:bn},5:{n:"PtgMul",f:bn},6:{n:"PtgDiv",f:bn},7:{n:"PtgPower",f:bn},8:{n:"PtgConcat",f:bn},9:{n:"PtgLt",f:bn},10:{n:"PtgLe",f:bn},11:{n:"PtgEq",f:bn},12:{n:"PtgGe",f:bn},13:{n:"PtgGt",f:bn},14:{n:"PtgNe",f:bn},15:{n:"PtgIsect",f:bn},16:{n:"PtgUnion",f:bn},17:{n:"PtgRange",f:bn},18:{n:"PtgUplus",f:bn},19:{n:"PtgUminus",f:bn},20:{n:"PtgPercent",f:bn},21:{n:"PtgParen",f:bn},22:{n:"PtgMissArg",f:bn},23:{n:"PtgStr",f:sj},26:{n:"PtgSheet",f:Pj},27:{n:"PtgEndSheet",f:Ij},28:{n:"PtgErr",f:rj},29:{n:"PtgBool",f:aj},30:{n:"PtgInt",f:nj},31:{n:"PtgNum",f:ij},32:{n:"PtgArray",f:UO},33:{n:"PtgFunc",f:JO},34:{n:"PtgFuncVar",f:ZO},35:{n:"PtgName",f:uj},36:{n:"PtgRef",f:XO},37:{n:"PtgArea",f:jO},38:{n:"PtgMemArea",f:dj},39:{n:"PtgMemErr",f:xj},40:{n:"PtgMemNoMem",f:vj},41:{n:"PtgMemFunc",f:pj},42:{n:"PtgRefErr",f:mj},43:{n:"PtgAreaErr",f:DO},44:{n:"PtgRefN",f:KO},45:{n:"PtgAreaN",f:BO},46:{n:"PtgMemAreaN",f:Oj},47:{n:"PtgMemNoMemN",f:jj},57:{n:"PtgNameX",f:fj},58:{n:"PtgRef3d",f:YO},59:{n:"PtgArea3d",f:RO},60:{n:"PtgRefErr3d",f:gj},61:{n:"PtgAreaErr3d",f:MO},255:{}},Dj={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Mj={1:{n:"PtgElfLel",f:z6},2:{n:"PtgElfRw",f:Aj},3:{n:"PtgElfCol",f:wj},6:{n:"PtgElfRwV",f:Tj},7:{n:"PtgElfColV",f:kj},10:{n:"PtgElfRadical",f:Sj},11:{n:"PtgElfRadicalS",f:Ej},13:{n:"PtgElfColS",f:yj},15:{n:"PtgElfColSV",f:bj},16:{n:"PtgElfRadicalLel",f:Nj},25:{n:"PtgList",f:Fj},29:{n:"PtgSxName",f:Lj},255:{}},Bj={0:{n:"PtgAttrNoop",f:Rj},1:{n:"PtgAttrSemi",f:VO},2:{n:"PtgAttrIf",f:WO},4:{n:"PtgAttrChoose",f:zO},8:{n:"PtgAttrGoto",f:$O},16:{n:"PtgAttrSum",f:ej},32:{n:"PtgAttrBaxcel",f:Oy},33:{n:"PtgAttrBaxcel",f:Oy},64:{n:"PtgAttrSpace",f:qO},65:{n:"PtgAttrSpaceSemi",f:GO},128:{n:"PtgAttrIfError",f:HO},255:{}};function Bh(e,t,r,n){if(n.biff<8)return wa(e,t);for(var a=e.l+t,i=[],s=0;s!==r.length;++s)switch(r[s][0]){case"PtgArray":r[s][1]=cj(e,0,n),i.push(r[s][1]);break;case"PtgMemArea":r[s][2]=lj(e,r[s][1],n),i.push(r[s][2]);break;case"PtgExp":n&&n.biff==12&&(r[s][1][1]=e.read_shift(4),i.push(r[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[s][0]}return t=a-e.l,t!==0&&i.push(wa(e,t)),i}function Uh(e,t,r){for(var n=e.l+t,a,i,s=[];n!=e.l;)t=n-e.l,i=e[e.l],a=jy[i]||jy[Dj[i]],(i===24||i===25)&&(a=(i===24?Mj:Bj)[e[e.l+1]]),!a||!a.f?wa(e,t):s.push([a.n,a.f(e,t,r)]);return s}function Uj(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],i=0;i<n.length;++i){var s=n[i];if(s)switch(s[0]){case 2:a.push('"'+s[1].replace(/"/g,'""')+'"');break;default:a.push(s[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var zj={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function $j(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function $6(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Ry(e,t,r){var n=$6(e,t,r);return n=="#REF"?n:$j(n,r)}function pa(e,t,r,n,a){var i=a&&a.biff||8,s={s:{c:0,r:0},e:{c:0,r:0}},o=[],l,c,u,h=0,m=0,f,v="";if(!e[0]||!e[0][0])return"";for(var x=-1,w="",_=0,b=e[0].length;_<b;++_){var y=e[0][_];switch(y[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),x>=0){switch(e[0][x][1][0]){case 0:w=tn(" ",e[0][x][1][1]);break;case 1:w=tn("\r",e[0][x][1][1]);break;default:if(w="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][x][1][0])}c=c+w,x=-1}o.push(c+zj[y[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=Cf(y[1][1],s,a),o.push(Ff(u,i));break;case"PtgRefN":u=r?Cf(y[1][1],r,a):y[1][1],o.push(Ff(u,i));break;case"PtgRef3d":h=y[1][1],u=Cf(y[1][2],s,a),v=Ry(n,h,a),o.push(v+"!"+Ff(u,i));break;case"PtgFunc":case"PtgFuncVar":var N=y[1][0],R=y[1][1];N||(N=0),N&=127;var P=N==0?[]:o.slice(-N);o.length-=N,R==="User"&&(R=P.shift()),o.push(R+"("+P.join(",")+")");break;case"PtgBool":o.push(y[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(y[1]);break;case"PtgNum":o.push(String(y[1]));break;case"PtgStr":o.push('"'+y[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(y[1]);break;case"PtgAreaN":f=fy(y[1][1],r?{s:r}:s,a),o.push(fg(f,a));break;case"PtgArea":f=fy(y[1][1],s,a),o.push(fg(f,a));break;case"PtgArea3d":h=y[1][1],f=y[1][2],v=Ry(n,h,a),o.push(v+"!"+fg(f,a));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":m=y[1][2];var F=(n.names||[])[m-1]||(n[0]||[])[m],C=F?F.Name:"SH33TJSNAME"+String(m);C&&C.slice(0,6)=="_xlfn."&&!a.xlfn&&(C=C.slice(6)),o.push(C);break;case"PtgNameX":var A=y[1][1];m=y[1][2];var W;if(a.biff<=5)A<0&&(A=-A),n[A]&&(W=n[A][m]);else{var L="";if(((n[A]||[])[0]||[])[0]==14849||(((n[A]||[])[0]||[])[0]==1025?n[A][m]&&n[A][m].itab>0&&(L=n.SheetNames[n[A][m].itab-1]+"!"):L=n.SheetNames[m-1]+"!"),n[A]&&n[A][m])L+=n[A][m].Name;else if(n[0]&&n[0][m])L+=n[0][m].Name;else{var I=($6(n,A,a)||"").split(";;");I[m-1]?L=I[m-1]:L+="SH33TJSERRX"}o.push(L);break}W||(W={Name:"SH33TJSERRY"}),o.push(W.Name);break;case"PtgParen":var V="(",Q=")";if(x>=0){switch(w="",e[0][x][1][0]){case 2:V=tn(" ",e[0][x][1][1])+V;break;case 3:V=tn("\r",e[0][x][1][1])+V;break;case 4:Q=tn(" ",e[0][x][1][1])+Q;break;case 5:Q=tn("\r",e[0][x][1][1])+Q;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][x][1][0])}x=-1}o.push(V+o.pop()+Q);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":u={c:y[1][1],r:y[1][0]};var ue={c:r.c,r:r.r};if(n.sharedf[Et(u)]){var me=n.sharedf[Et(u)];o.push(pa(me,s,ue,n,a))}else{var pe=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(u.c<c[0].s.c||u.c>c[0].e.c)&&!(u.r<c[0].s.r||u.r>c[0].e.r)){o.push(pa(c[1],s,ue,n,a)),pe=!0;break}pe||o.push(y[1])}break;case"PtgArray":o.push("{"+Uj(y[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":x=_;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+y[1].idx+"[#"+y[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(y));default:throw new Error("Unrecognized Formula Token: "+String(y))}var oe=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&x>=0&&oe.indexOf(e[0][_][0])==-1){y=e[0][x];var G=!0;switch(y[1][0]){case 4:G=!1;case 0:w=tn(" ",y[1][1]);break;case 5:G=!1;case 1:w=tn("\r",y[1][1]);break;default:if(w="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+y[1][0])}o.push((G?w:"")+o.pop()+(G?"":w)),x=-1}}if(o.length>1&&a.WTF)throw new Error("bad formula stack");return o[0]}function Wj(e,t,r){var n=e.l+t,a=r.biff==2?1:2,i,s=e.read_shift(a);if(s==65535)return[[],wa(e,t-2)];var o=Uh(e,s,r);return t!==s+a&&(i=Bh(e,t-s-a,o,r)),e.l=n,[o,i]}function Hj(e,t,r){var n=e.l+t,a=r.biff==2?1:2,i,s=e.read_shift(a);if(s==65535)return[[],wa(e,t-2)];var o=Uh(e,s,r);return t!==s+a&&(i=Bh(e,t-s-a,o,r)),e.l=n,[o,i]}function Vj(e,t,r,n){var a=e.l+t,i=Uh(e,n,r),s;return a!==e.l&&(s=Bh(e,a-e.l,i,r)),[i,s]}function qj(e,t,r){var n=e.l+t,a,i=e.read_shift(2),s=Uh(e,i,r);return i==65535?[[],wa(e,t-2)]:(t!==i+2&&(a=Bh(e,n-i-2,s,r)),[s,a])}function Gj(e){var t;if(lo(e,e.l+6)!==65535)return[xa(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function Xj(e){if(e==null){var t=Le(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Fc(e);return Fc(0)}function gg(e,t,r){var n=e.l+t,a=Ms(e);r.biff==2&&++e.l;var i=Gj(e),s=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=Hj(e,n-e.l,r);return{cell:a,val:i[0],formula:o,shared:s>>3&1,tt:i[1]}}function Kj(e,t,r,n,a){var i=Pc(t,r,a),s=Xj(e.v),o=Le(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var c=Le(e.bf.length),u=0;u<e.bf.length;++u)c[u]=e.bf[u];var h=$n([i,s,o,c]);return h}function Vp(e,t,r){var n=e.read_shift(4),a=Uh(e,n,r),i=e.read_shift(4),s=i>0?Bh(e,i,a,r):null;return[a,s]}var Yj=Vp,qp=Vp,Jj=Vp,Zj=Vp,Qj={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},W6={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},eR={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Dy(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function tR(e){var t="of:="+e.replace(u_,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function xg(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function rR(e){return e.replace(/\./,"!")}var Pf={},H0={},If=typeof Map<"u";function d_(e,t,r){var n=0,a=e.length;if(r){if(If?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var i=If?r.get(t):r[t];n<i.length;++n)if(e[i[n]].t===t)return e.Count++,i[n]}}else for(;n<a;++n)if(e[n].t===t)return e.Count++,n;return e[a]={t},e.Count++,e.Unique++,r&&(If?(r.has(t)||r.set(t,[]),r.get(t).push(a)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(a))),a}function Gp(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(ga=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=ph(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=dp(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function yc(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Ll(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],a=60,i=e.length;if(n==null&&r.ssf){for(;a<392;++a)if(r.ssf[a]==null){po(t.z,a),r.ssf[a]=t.z,r.revssf[t.z]=n=a;break}}for(a=0;a!=i;++a)if(e[a].numFmtId===n)return a;return e[i]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function H6(e,t,r,n,a,i){try{n.cellNF&&(e.z=Nt[t])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Dr(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(Nt[t]==null&&po(QC[t]||"General",t),e.t==="e")e.w=e.w||So[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=oh(e.v);else if(e.t==="d"){var s=Rn(e.v);(s|0)===s?e.w=s.toString(10):e.w=oh(s)}else{if(e.v===void 0)return"";e.w=Tc(e.v,H0)}else e.t==="d"?e.w=Ui(t,Rn(e.v),H0):e.w=Ui(t,e.v,H0)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{e.s=i.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=hp(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=hp(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&i.Fills)throw o}}}function nR(e,t,r){if(e&&e["!ref"]){var n=ir(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function aR(e,t){var r=ir(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Ut(r))}var iR=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,sR=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,oR=/<(?:\w:)?hyperlink [^>]*>/mg,lR=/"(\w*:\w*)"/,cR=/<(?:\w:)?col\b[^>]*[\/]?>/g,uR=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,fR=/<(?:\w:)?pageMargins[^>]*\/>/g,V6=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,hR=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,dR=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function pR(e,t,r,n,a,i,s){if(!e)return e;n||(n={"!id":{}});var o=t.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",u="",h=e.match(sR);h?(c=e.slice(0,h.index),u=e.slice(h.index+h[0].length)):c=u=e;var m=c.match(V6);m?p_(m[0],o,a,r):(m=c.match(hR))&&gR(m[0],m[1]||"",o,a,r);var f=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(f>0){var v=c.slice(f,f+50).match(lR);v&&aR(o,v[1])}var x=c.match(dR);x&&x[1]&&CR(x[1],a);var w=[];if(t.cellStyles){var _=c.match(cR);_&&SR(w,_)}h&&PR(h[1],o,t,l,i,s);var b=u.match(uR);b&&(o["!autofilter"]=ER(b[0]));var y=[],N=u.match(iR);if(N)for(f=0;f!=N.length;++f)y[f]=ir(N[f].slice(N[f].indexOf('"')+1));var R=u.match(oR);R&&yR(o,R,n);var P=u.match(fR);if(P&&(o["!margins"]=bR(Ct(P[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=Ut(l)),t.sheetRows>0&&o["!ref"]){var F=ir(o["!ref"]);t.sheetRows<=+F.e.r&&(F.e.r=t.sheetRows-1,F.e.r>l.e.r&&(F.e.r=l.e.r),F.e.r<F.s.r&&(F.s.r=F.e.r),F.e.c>l.e.c&&(F.e.c=l.e.c),F.e.c<F.s.c&&(F.s.c=F.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Ut(F))}return w.length>0&&(o["!cols"]=w),y.length>0&&(o["!merges"]=y),o}function mR(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Ut(e[r])+'"/>';return t+"</mergeCells>"}function p_(e,t,r,n){var a=Ct(e);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=ar(br(a.codeName)))}function gR(e,t,r,n,a){p_(e.slice(0,e.indexOf(">")),r,n,a)}function xR(e,t,r,n,a){var i=!1,s={},o=null;if(n.bookType!=="xlsx"&&t.vbaraw){var l=t.SheetNames[r];try{t.Workbook&&(l=t.Workbook.Sheets[r].CodeName||l)}catch{}i=!0,s.codeName=Ls(_r(l))}if(e&&e["!outline"]){var c={summaryBelow:1,summaryRight:1};e["!outline"].above&&(c.summaryBelow=0),e["!outline"].left&&(c.summaryRight=0),o=(o||"")+Xe("outlinePr",null,c)}!i&&!o||(a[a.length]=Xe("sheetPr",o,s))}var vR=["objects","scenarios","selectLockedCells","selectUnlockedCells"],_R=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function wR(e){var t={sheet:1};return vR.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),_R.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=o_(e.password).toString(16).toUpperCase()),Xe("sheetProtection",null,t)}function yR(e,t,r){for(var n=Array.isArray(e),a=0;a!=t.length;++a){var i=Ct(br(t[a]),!0);if(!i.ref)return;var s=((r||{})["!id"]||[])[i.id];s?(i.Target=s.Target,i.location&&(i.Target+="#"+ar(i.location))):(i.Target="#"+ar(i.location),s={Target:i.Target,TargetMode:"Internal"}),i.Rel=s,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var o=ir(i.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var u=Et({c,r:l});n?(e[l]||(e[l]=[]),e[l][c]||(e[l][c]={t:"z",v:void 0}),e[l][c].l=i):(e[u]||(e[u]={t:"z",v:void 0}),e[u].l=i)}}}function bR(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function kR(e){return yc(e),Xe("pageMargins",null,e)}function SR(e,t){for(var r=!1,n=0;n!=t.length;++n){var a=Ct(t[n],!0);a.hidden&&(a.hidden=Or(a.hidden));var i=parseInt(a.min,10)-1,s=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,l_(a.width)),bl(a);i<=s;)e[i++]=Mr(a)}}function NR(e,t){for(var r=["<cols>"],n,a=0;a!=t.length;++a)(n=t[a])&&(r[r.length]=Xe("col",null,Gp(a,n)));return r[r.length]="</cols>",r.join("")}function ER(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function AR(e,t,r,n){var a=typeof e.ref=="string"?e.ref:Ut(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,s=Ga(a);s.s.r==s.e.r&&(s.e.r=Ga(t["!ref"]).e.r,a=Ut(s));for(var o=0;o<i.length;++o){var l=i[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+a;break}}return o==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),Xe("autoFilter",null,{ref:a})}var TR=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function CR(e,t){t.Views||(t.Views=[{}]),(e.match(TR)||[]).forEach(function(r,n){var a=Ct(r);t.Views[n]||(t.Views[n]={}),+a.zoomScale&&(t.Views[n].zoom=+a.zoomScale),Or(a.rightToLeft)&&(t.Views[n].RTL=!0)})}function FR(e,t,r,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Xe("sheetViews",Xe("sheetView",null,a),{})}function LR(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var a="",i=e.t,s=e.v;if(e.t!=="z")switch(e.t){case"b":a=e.v?"1":"0";break;case"n":a=""+e.v;break;case"e":a=So[e.v];break;case"d":n&&n.cellDates?a=Dr(e.v,-1).toISOString():(e=Mr(e),e.t="n",a=""+(e.v=Rn(Dr(e.v)))),typeof e.z>"u"&&(e.z=Nt[14]);break;default:a=e.v;break}var o=Qn("v",_r(a)),l={r:t},c=Ll(n.cellXfs,e,n);switch(c!==0&&(l.s=c),e.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=Qn("v",""+d_(n.Strings,e.v,n.revStrings)),l.t="s";break}l.t="str";break}if(e.t!=i&&(e.t=i,e.v=s),typeof e.f=="string"&&e.f){var u=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=Xe("f",_r(e.f),u)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(l.cm=1),Xe("c",o,l)}var PR=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,i=lh("v"),s=lh("f");return function(l,c,u,h,m,f){for(var v=0,x="",w=[],_=[],b=0,y=0,N=0,R="",P,F,C=0,A=0,W,L,I=0,V=0,Q=Array.isArray(f.CellXf),ue,me=[],pe=[],oe=Array.isArray(c),G=[],ve={},_e=!1,E=!!u.sheetStubs,j=l.split(t),O=0,B=j.length;O!=B;++O){x=j[O].trim();var Y=x.length;if(Y!==0){var le=0;e:for(v=0;v<Y;++v)switch(x[v]){case">":if(x[v-1]!="/"){++v;break e}if(u&&u.cellStyles){if(F=Ct(x.slice(le,v),!0),C=F.r!=null?parseInt(F.r,10):C+1,A=-1,u.sheetRows&&u.sheetRows<C)continue;ve={},_e=!1,F.ht&&(_e=!0,ve.hpt=parseFloat(F.ht),ve.hpx=su(ve.hpt)),F.hidden=="1"&&(_e=!0,ve.hidden=!0),F.outlineLevel!=null&&(_e=!0,ve.level=+F.outlineLevel),_e&&(G[C-1]=ve)}break;case"<":le=v;break}if(le>=v)break;if(F=Ct(x.slice(le,v),!0),C=F.r!=null?parseInt(F.r,10):C+1,A=-1,!(u.sheetRows&&u.sheetRows<C)){h.s.r>C-1&&(h.s.r=C-1),h.e.r<C-1&&(h.e.r=C-1),u&&u.cellStyles&&(ve={},_e=!1,F.ht&&(_e=!0,ve.hpt=parseFloat(F.ht),ve.hpx=su(ve.hpt)),F.hidden=="1"&&(_e=!0,ve.hidden=!0),F.outlineLevel!=null&&(_e=!0,ve.level=+F.outlineLevel),_e&&(G[C-1]=ve)),w=x.slice(v).split(e);for(var fe=0;fe!=w.length&&w[fe].trim().charAt(0)=="<";++fe);for(w=w.slice(fe),v=0;v!=w.length;++v)if(x=w[v].trim(),x.length!==0){if(_=x.match(r),b=v,y=0,N=0,x="<c "+(x.slice(0,1)=="<"?">":"")+x,_!=null&&_.length===2){for(b=0,R=_[1],y=0;y!=R.length&&!((N=R.charCodeAt(y)-64)<1||N>26);++y)b=26*b+N;--b,A=b}else++A;for(y=0;y!=x.length&&x.charCodeAt(y)!==62;++y);if(++y,F=Ct(x.slice(0,y),!0),F.r||(F.r=Et({r:C-1,c:A})),R=x.slice(y),P={t:""},(_=R.match(i))!=null&&_[1]!==""&&(P.v=ar(_[1])),u.cellFormula){if((_=R.match(s))!=null&&_[1]!==""){if(P.f=ar(br(_[1])).replace(/\r\n/g,`
`),u.xlfn||(P.f=Iy(P.f)),_[0].indexOf('t="array"')>-1)P.F=(R.match(a)||[])[1],P.F.indexOf(":")>-1&&me.push([ir(P.F),P.F]);else if(_[0].indexOf('t="shared"')>-1){L=Ct(_[0]);var ce=ar(br(_[1]));u.xlfn||(ce=Iy(ce)),pe[parseInt(L.si,10)]=[L,ce,F.r]}}else(_=R.match(/<f[^>]*\/>/))&&(L=Ct(_[0]),pe[L.si]&&(P.f=TO(pe[L.si][1],pe[L.si][2],F.r)));var de=qr(F.r);for(y=0;y<me.length;++y)de.r>=me[y][0].s.r&&de.r<=me[y][0].e.r&&de.c>=me[y][0].s.c&&de.c<=me[y][0].e.c&&(P.F=me[y][1])}if(F.t==null&&P.v===void 0)if(P.f||P.F)P.v=0,P.t="n";else if(E)P.t="z";else continue;else P.t=F.t||"n";switch(h.s.c>A&&(h.s.c=A),h.e.c<A&&(h.e.c=A),P.t){case"n":if(P.v==""||P.v==null){if(!E)continue;P.t="z"}else P.v=parseFloat(P.v);break;case"s":if(typeof P.v>"u"){if(!E)continue;P.t="z"}else W=Pf[parseInt(P.v,10)],P.v=W.t,P.r=W.r,u.cellHTML&&(P.h=W.h);break;case"str":P.t="s",P.v=P.v!=null?br(P.v):"",u.cellHTML&&(P.h=qv(P.v));break;case"inlineStr":_=R.match(n),P.t="s",_!=null&&(W=s_(_[1]))?(P.v=W.t,u.cellHTML&&(P.h=W.h)):P.v="";break;case"b":P.v=Or(P.v);break;case"d":u.cellDates?P.v=Dr(P.v,1):(P.v=Rn(Dr(P.v,1)),P.t="n");break;case"e":(!u||u.cellText!==!1)&&(P.w=P.v),P.v=GS[P.v];break}if(I=V=0,ue=null,Q&&F.s!==void 0&&(ue=f.CellXf[F.s],ue!=null&&(ue.numFmtId!=null&&(I=ue.numFmtId),u.cellStyles&&ue.fillId!=null&&(V=ue.fillId))),H6(P,I,V,u,m,f),u.cellDates&&Q&&P.t=="n"&&mu(Nt[I])&&(P.t="d",P.v=Wp(P.v)),F.cm&&u.xlmeta){var Ce=(u.xlmeta.Cell||[])[+F.cm-1];Ce&&Ce.type=="XLDAPR"&&(P.D=!0)}if(oe){var X=qr(F.r);c[X.r]||(c[X.r]=[]),c[X.r][X.c]=P}else c[F.r]=P}}}}G.length>0&&(c["!rows"]=G)}}();function IR(e,t,r,n){var a=[],i=[],s=ir(e["!ref"]),o="",l,c="",u=[],h=0,m=0,f=e["!rows"],v=Array.isArray(e),x={r:c},w,_=-1;for(m=s.s.c;m<=s.e.c;++m)u[m]=Vr(m);for(h=s.s.r;h<=s.e.r;++h){for(i=[],c=gn(h),m=s.s.c;m<=s.e.c;++m){l=u[m]+c;var b=v?(e[h]||[])[m]:e[l];b!==void 0&&(o=LR(b,l,e,t))!=null&&i.push(o)}(i.length>0||f&&f[h])&&(x={r:c},f&&f[h]&&(w=f[h],w.hidden&&(x.hidden=1),_=-1,w.hpx?_=mh(w.hpx):w.hpt&&(_=w.hpt),_>-1&&(x.ht=_,x.customHeight=1),w.level&&(x.outlineLevel=w.level)),a[a.length]=Xe("row",i.join(""),x))}if(f)for(;h<f.length;++h)f&&f[h]&&(x={r:h+1},w=f[h],w.hidden&&(x.hidden=1),_=-1,w.hpx?_=mh(w.hpx):w.hpt&&(_=w.hpt),_>-1&&(x.ht=_,x.customHeight=1),w.level&&(x.outlineLevel=w.level),a[a.length]=Xe("row","",x));return a.join("")}function q6(e,t,r,n){var a=[xn,Xe("worksheet",null,{xmlns:Bc[0],"xmlns:r":On.r})],i=r.SheetNames[e],s=0,o="",l=r.Sheets[i];l==null&&(l={});var c=l["!ref"]||"A1",u=ir(c);if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),c=Ut(u)}n||(n={}),l["!comments"]=[];var h=[];xR(l,r,e,t,a),a[a.length]=Xe("dimension",null,{ref:c}),a[a.length]=FR(l,t,e,r),t.sheetFormat&&(a[a.length]=Xe("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(a[a.length]=NR(l,l["!cols"])),a[s=a.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=IR(l,t),o.length>0&&(a[a.length]=o)),a.length>s+1&&(a[a.length]="</sheetData>",a[s]=a[s].replace("/>",">")),l["!protect"]&&(a[a.length]=wR(l["!protect"])),l["!autofilter"]!=null&&(a[a.length]=AR(l["!autofilter"],l,r,e)),l["!merges"]!=null&&l["!merges"].length>0&&(a[a.length]=mR(l["!merges"]));var m=-1,f,v=-1;return l["!links"].length>0&&(a[a.length]="<hyperlinks>",l["!links"].forEach(function(x){x[1].Target&&(f={ref:x[0]},x[1].Target.charAt(0)!="#"&&(v=xr(n,-1,_r(x[1].Target).replace(/#.*$/,""),Xt.HLINK),f["r:id"]="rId"+v),(m=x[1].Target.indexOf("#"))>-1&&(f.location=_r(x[1].Target.slice(m+1))),x[1].Tooltip&&(f.tooltip=_r(x[1].Tooltip)),a[a.length]=Xe("hyperlink",null,f))}),a[a.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(a[a.length]=kR(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(a[a.length]=Qn("ignoredErrors",Xe("ignoredError",null,{numberStoredAsText:1,sqref:c}))),h.length>0&&(v=xr(n,-1,"../drawings/drawing"+(e+1)+".xml",Xt.DRAW),a[a.length]=Xe("drawing",null,{"r:id":"rId"+v}),l["!drawing"]=h),l["!comments"].length>0&&(v=xr(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Xt.VML),a[a.length]=Xe("legacyDrawing",null,{"r:id":"rId"+v}),l["!legacy"]=v),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function OR(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=n,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=a/20),r}function jR(e,t,r){var n=Le(145),a=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var i=320;a.hpx?i=mh(a.hpx)*20:a.hpt&&(i=a.hpt*20),n.write_shift(2,i),n.write_shift(1,0);var s=0;a.level&&(s|=a.level),a.hidden&&(s|=16),(a.hpx||a.hpt)&&(s|=32),n.write_shift(1,s),n.write_shift(1,0);var o=0,l=n.l;n.l+=4;for(var c={r:e,c:0},u=0;u<16;++u)if(!(t.s.c>u+1<<10||t.e.c<u<<10)){for(var h=-1,m=-1,f=u<<10;f<u+1<<10;++f){c.c=f;var v=Array.isArray(r)?(r[c.r]||[])[c.c]:r[Et(c)];v&&(h<0&&(h=f),m=f)}h<0||(++o,n.write_shift(4,h),n.write_shift(4,m))}var x=n.l;return n.l=l,n.write_shift(4,o),n.l=x,n.length>n.l?n.slice(0,n.l):n}function RR(e,t,r,n){var a=jR(n,r,t);(a.length>17||(t["!rows"]||[])[n])&&De(e,0,a)}var DR=Wc,MR=vu;function BR(){}function UR(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=WF(e),r}function zR(e,t,r){r==null&&(r=Le(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var a=1;a<3;++a)r.write_shift(1,0);return cp({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),$S(e,r),r.slice(0,r.l)}function $R(e){var t=$i(e);return[t]}function WR(e,t,r){return r==null&&(r=Le(8)),Uc(t,r)}function HR(e){var t=zc(e);return[t]}function VR(e,t,r){return r==null&&(r=Le(4)),$c(t,r)}function qR(e){var t=$i(e),r=e.read_shift(1);return[t,r,"b"]}function GR(e,t,r){return r==null&&(r=Le(9)),Uc(t,r),r.write_shift(1,e.v?1:0),r}function XR(e){var t=zc(e),r=e.read_shift(1);return[t,r,"b"]}function KR(e,t,r){return r==null&&(r=Le(5)),$c(t,r),r.write_shift(1,e.v?1:0),r}function YR(e){var t=$i(e),r=e.read_shift(1);return[t,r,"e"]}function JR(e,t,r){return r==null&&(r=Le(9)),Uc(t,r),r.write_shift(1,e.v),r}function ZR(e){var t=zc(e),r=e.read_shift(1);return[t,r,"e"]}function QR(e,t,r){return r==null&&(r=Le(8)),$c(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function e9(e){var t=$i(e),r=e.read_shift(4);return[t,r,"s"]}function t9(e,t,r){return r==null&&(r=Le(12)),Uc(t,r),r.write_shift(4,t.v),r}function r9(e){var t=zc(e),r=e.read_shift(4);return[t,r,"s"]}function n9(e,t,r){return r==null&&(r=Le(8)),$c(t,r),r.write_shift(4,t.v),r}function a9(e){var t=$i(e),r=xa(e);return[t,r,"n"]}function i9(e,t,r){return r==null&&(r=Le(16)),Uc(t,r),Fc(e.v,r),r}function G6(e){var t=zc(e),r=xa(e);return[t,r,"n"]}function s9(e,t,r){return r==null&&(r=Le(12)),$c(t,r),Fc(e.v,r),r}function o9(e){var t=$i(e),r=t_(e);return[t,r,"n"]}function l9(e,t,r){return r==null&&(r=Le(12)),Uc(t,r),WS(e.v,r),r}function c9(e){var t=zc(e),r=t_(e);return[t,r,"n"]}function u9(e,t,r){return r==null&&(r=Le(8)),$c(t,r),WS(e.v,r),r}function f9(e){var t=$i(e),r=Zv(e);return[t,r,"is"]}function h9(e){var t=$i(e),r=va(e);return[t,r,"str"]}function d9(e,t,r){return r==null&&(r=Le(12+4*e.v.length)),Uc(t,r),Wn(e.v,r),r.length>r.l?r.slice(0,r.l):r}function p9(e){var t=zc(e),r=va(e);return[t,r,"str"]}function m9(e,t,r){return r==null&&(r=Le(8+4*e.v.length)),$c(t,r),Wn(e.v,r),r.length>r.l?r.slice(0,r.l):r}function g9(e,t,r){var n=e.l+t,a=$i(e);a.r=r["!row"];var i=e.read_shift(1),s=[a,i,"b"];if(r.cellFormula){e.l+=2;var o=qp(e,n-e.l,r);s[3]=pa(o,null,a,r.supbooks,r)}else e.l=n;return s}function x9(e,t,r){var n=e.l+t,a=$i(e);a.r=r["!row"];var i=e.read_shift(1),s=[a,i,"e"];if(r.cellFormula){e.l+=2;var o=qp(e,n-e.l,r);s[3]=pa(o,null,a,r.supbooks,r)}else e.l=n;return s}function v9(e,t,r){var n=e.l+t,a=$i(e);a.r=r["!row"];var i=xa(e),s=[a,i,"n"];if(r.cellFormula){e.l+=2;var o=qp(e,n-e.l,r);s[3]=pa(o,null,a,r.supbooks,r)}else e.l=n;return s}function _9(e,t,r){var n=e.l+t,a=$i(e);a.r=r["!row"];var i=va(e),s=[a,i,"str"];if(r.cellFormula){e.l+=2;var o=qp(e,n-e.l,r);s[3]=pa(o,null,a,r.supbooks,r)}else e.l=n;return s}var w9=Wc,y9=vu;function b9(e,t){return t==null&&(t=Le(4)),t.write_shift(4,e),t}function k9(e,t){var r=e.l+t,n=Wc(e),a=Qv(e),i=va(e),s=va(e),o=va(e);e.l=r;var l={rfx:n,relId:a,loc:i,display:o};return s&&(l.Tooltip=s),l}function S9(e,t){var r=Le(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));vu({s:qr(e[0]),e:qr(e[0])},r),e_("rId"+t,r);var n=e[1].Target.indexOf("#"),a=n==-1?"":e[1].Target.slice(n+1);return Wn(a||"",r),Wn(e[1].Tooltip||"",r),Wn("",r),r.slice(0,r.l)}function N9(){}function E9(e,t,r){var n=e.l+t,a=HS(e),i=e.read_shift(1),s=[a];if(s[2]=i,r.cellFormula){var o=Yj(e,n-e.l,r);s[1]=o}else e.l=n;return s}function A9(e,t,r){var n=e.l+t,a=Wc(e),i=[a];if(r.cellFormula){var s=Zj(e,n-e.l,r);i[1]=s,e.l=n}else e.l=n;return i}function T9(e,t,r){r==null&&(r=Le(18));var n=Gp(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var a=0;return t.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),t.level&&(a|=t.level<<8),r.write_shift(2,a),r}var X6=["left","right","top","bottom","header","footer"];function C9(e){var t={};return X6.forEach(function(r){t[r]=xa(e)}),t}function F9(e,t){return t==null&&(t=Le(6*8)),yc(e),X6.forEach(function(r){Fc(e[r],t)}),t}function L9(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function P9(e,t,r){r==null&&(r=Le(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function I9(e){var t=Le(24);return t.write_shift(4,4),t.write_shift(4,1),vu(e,t),t}function O9(e,t){return t==null&&(t=Le(16*4+2)),t.write_shift(2,e.password?o_(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function j9(){}function R9(){}function D9(e,t,r,n,a,i,s){if(!e)return e;var o=t||{};n||(n={"!id":{}});var l=o.dense?[]:{},c,u={s:{r:2e6,c:2e6},e:{r:0,c:0}},h=!1,m=!1,f,v,x,w,_,b,y,N,R,P=[];o.biff=12,o["!row"]=0;var F=0,C=!1,A=[],W={},L=o.supbooks||a.supbooks||[[]];if(L.sharedf=W,L.arrayf=A,L.SheetNames=a.SheetNames||a.Sheets.map(function(oe){return oe.name}),!o.supbooks&&(o.supbooks=L,a.Names))for(var I=0;I<a.Names.length;++I)L[0][I+1]=a.Names[I];var V=[],Q=[],ue=!1;gh[16]={n:"BrtShortReal",f:G6};var me;if(ko(e,function(G,ve,_e){if(!m)switch(_e){case 148:c=G;break;case 0:f=G,o.sheetRows&&o.sheetRows<=f.r&&(m=!0),N=gn(w=f.r),o["!row"]=f.r,(G.hidden||G.hpt||G.level!=null)&&(G.hpt&&(G.hpx=su(G.hpt)),Q[G.r]=G);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(v={t:G[2]},G[2]){case"n":v.v=G[1];break;case"s":y=Pf[G[1]],v.v=y.t,v.r=y.r;break;case"b":v.v=!!G[1];break;case"e":v.v=G[1],o.cellText!==!1&&(v.w=So[v.v]);break;case"str":v.t="s",v.v=G[1];break;case"is":v.t="s",v.v=G[1].t;break}if((x=s.CellXf[G[0].iStyleRef])&&H6(v,x.numFmtId,null,o,i,s),_=G[0].c==-1?_+1:G[0].c,o.dense?(l[w]||(l[w]=[]),l[w][_]=v):l[Vr(_)+N]=v,o.cellFormula){for(C=!1,F=0;F<A.length;++F){var E=A[F];f.r>=E[0].s.r&&f.r<=E[0].e.r&&_>=E[0].s.c&&_<=E[0].e.c&&(v.F=Ut(E[0]),C=!0)}!C&&G.length>3&&(v.f=G[3])}if(u.s.r>f.r&&(u.s.r=f.r),u.s.c>_&&(u.s.c=_),u.e.r<f.r&&(u.e.r=f.r),u.e.c<_&&(u.e.c=_),o.cellDates&&x&&v.t=="n"&&mu(Nt[x.numFmtId])){var j=fc(v.v);j&&(v.t="d",v.v=new Date(j.y,j.m-1,j.d,j.H,j.M,j.S,j.u))}me&&(me.type=="XLDAPR"&&(v.D=!0),me=void 0);break;case 1:case 12:if(!o.sheetStubs||h)break;v={t:"z",v:void 0},_=G[0].c==-1?_+1:G[0].c,o.dense?(l[w]||(l[w]=[]),l[w][_]=v):l[Vr(_)+N]=v,u.s.r>f.r&&(u.s.r=f.r),u.s.c>_&&(u.s.c=_),u.e.r<f.r&&(u.e.r=f.r),u.e.c<_&&(u.e.c=_),me&&(me.type=="XLDAPR"&&(v.D=!0),me=void 0);break;case 176:P.push(G);break;case 49:me=((o.xlmeta||{}).Cell||[])[G-1];break;case 494:var O=n["!id"][G.relId];for(O?(G.Target=O.Target,G.loc&&(G.Target+="#"+G.loc),G.Rel=O):G.relId==""&&(G.Target="#"+G.loc),w=G.rfx.s.r;w<=G.rfx.e.r;++w)for(_=G.rfx.s.c;_<=G.rfx.e.c;++_)o.dense?(l[w]||(l[w]=[]),l[w][_]||(l[w][_]={t:"z",v:void 0}),l[w][_].l=G):(b=Et({c:_,r:w}),l[b]||(l[b]={t:"z",v:void 0}),l[b].l=G);break;case 426:if(!o.cellFormula)break;A.push(G),R=o.dense?l[w][_]:l[Vr(_)+N],R.f=pa(G[1],u,{r:f.r,c:_},L,o),R.F=Ut(G[0]);break;case 427:if(!o.cellFormula)break;W[Et(G[0].s)]=G[1],R=o.dense?l[w][_]:l[Vr(_)+N],R.f=pa(G[1],u,{r:f.r,c:_},L,o);break;case 60:if(!o.cellStyles)break;for(;G.e>=G.s;)V[G.e--]={width:G.w/256,hidden:!!(G.flags&1),level:G.level},ue||(ue=!0,l_(G.w/256)),bl(V[G.e+1]);break;case 161:l["!autofilter"]={ref:Ut(G)};break;case 476:l["!margins"]=G;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),G.name&&(a.Sheets[r].CodeName=G.name),(G.above||G.left)&&(l["!outline"]={above:G.above,left:G.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),G.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:h=!0;break;case 36:h=!1;break;case 37:h=!0;break;case 38:h=!1;break;default:if(!ve.T){if(!h||o.WTF)throw new Error("Unexpected record 0x"+_e.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(u.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(l["!ref"]=Ut(c||u)),o.sheetRows&&l["!ref"]){var pe=ir(l["!ref"]);o.sheetRows<=+pe.e.r&&(pe.e.r=o.sheetRows-1,pe.e.r>u.e.r&&(pe.e.r=u.e.r),pe.e.r<pe.s.r&&(pe.s.r=pe.e.r),pe.e.c>u.e.c&&(pe.e.c=u.e.c),pe.e.c<pe.s.c&&(pe.s.c=pe.e.c),l["!fullref"]=l["!ref"],l["!ref"]=Ut(pe))}return P.length>0&&(l["!merges"]=P),V.length>0&&(l["!cols"]=V),Q.length>0&&(l["!rows"]=Q),l}function M9(e,t,r,n,a,i,s){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=Mr(t),t.z=t.z||Nt[14],t.v=Rn(Dr(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var l={r,c:n};switch(l.s=Ll(a.cellXfs,t,a),t.l&&i["!links"].push([Et(l),t.l]),t.c&&i["!comments"].push([Et(l),t.c]),t.t){case"s":case"str":return a.bookSST?(o=d_(a.Strings,t.v,a.revStrings),l.t="s",l.v=o,s?De(e,18,n9(t,l)):De(e,7,t9(t,l))):(l.t="str",s?De(e,17,m9(t,l)):De(e,6,d9(t,l))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?s?De(e,13,u9(t,l)):De(e,2,l9(t,l)):s?De(e,16,s9(t,l)):De(e,5,i9(t,l)),!0;case"b":return l.t="b",s?De(e,15,KR(t,l)):De(e,4,GR(t,l)),!0;case"e":return l.t="e",s?De(e,14,QR(t,l)):De(e,3,JR(t,l)),!0}return s?De(e,12,VR(t,l)):De(e,1,WR(t,l)),!0}function B9(e,t,r,n){var a=ir(t["!ref"]||"A1"),i,s="",o=[];De(e,145);var l=Array.isArray(t),c=a.e.r;t["!rows"]&&(c=Math.max(a.e.r,t["!rows"].length-1));for(var u=a.s.r;u<=c;++u){s=gn(u),RR(e,t,a,u);var h=!1;if(u<=a.e.r)for(var m=a.s.c;m<=a.e.c;++m){u===a.s.r&&(o[m]=Vr(m)),i=o[m]+s;var f=l?(t[u]||[])[m]:t[i];if(!f){h=!1;continue}h=M9(e,f,u,m,n,t,h)}}De(e,146)}function U9(e,t){!t||!t["!merges"]||(De(e,177,b9(t["!merges"].length)),t["!merges"].forEach(function(r){De(e,176,y9(r))}),De(e,178))}function z9(e,t){!t||!t["!cols"]||(De(e,390),t["!cols"].forEach(function(r,n){r&&De(e,60,T9(n,r))}),De(e,391))}function $9(e,t){!t||!t["!ref"]||(De(e,648),De(e,649,I9(ir(t["!ref"]))),De(e,650))}function W9(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var a=xr(r,-1,n[1].Target.replace(/#.*$/,""),Xt.HLINK);De(e,494,S9(n,a))}}),delete t["!links"]}function H9(e,t,r,n){if(t["!comments"].length>0){var a=xr(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Xt.VML);De(e,551,e_("rId"+a)),t["!legacy"]=a}}function V9(e,t,r,n){if(t["!autofilter"]){var a=t["!autofilter"],i=typeof a.ref=="string"?a.ref:Ut(a.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,o=Ga(i);o.s.r==o.e.r&&(o.e.r=Ga(t["!ref"]).e.r,i=Ut(o));for(var l=0;l<s.length;++l){var c=s[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+i;break}}l==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),De(e,161,vu(ir(i))),De(e,162)}}function q9(e,t,r){De(e,133),De(e,137,P9(t,r)),De(e,138),De(e,134)}function G9(e,t){t["!protect"]&&De(e,535,O9(t["!protect"]))}function X9(e,t,r,n){var a=qa(),i=r.SheetNames[e],s=r.Sheets[i]||{},o=i;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var l=ir(s["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return s["!links"]=[],s["!comments"]=[],De(a,129),(r.vbaraw||s["!outline"])&&De(a,147,zR(o,s["!outline"])),De(a,148,MR(l)),q9(a,s,r.Workbook),z9(a,s),B9(a,s,e,t),G9(a,s),V9(a,s,r,e),U9(a,s),W9(a,s,n),s["!margins"]&&De(a,476,F9(s["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&$9(a,s),H9(a,s,e,n),De(a,130),a.end()}function K9(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var s=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);s&&(t[+s[1]]=r?+s[2]:s[2])});var a=ar((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){n=i.replace(/<.*?>/g,"")}),[t,a,n]}function Y9(e,t,r,n,a,i){var s=i||{"!type":"chart"};if(!e)return i;var o=0,l=0,c="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(h){var m=K9(h);u.s.r=u.s.c=0,u.e.c=o,c=Vr(o),m[0].forEach(function(f,v){s[c+gn(v)]={t:"n",v:f,z:m[1]},l=v}),u.e.r<l&&(u.e.r=l),++o}),o>0&&(s["!ref"]=Ut(u)),s}function J9(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},s,o=e.match(V6);return o&&p_(o[0],i,a,r),(s=e.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=s[1]),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}function Z9(e,t){e.l+=10;var r=va(e);return{name:r}}function Q9(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},s=!1;return ko(e,function(l,c,u){switch(u){case 550:i["!rel"]=l;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),l.name&&(a.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!(c.T>0)){if(!(c.T<0)){if(!s||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}},t),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}var m_=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],eD=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],tD=[],rD=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function My(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],a=0;a!=t.length;++a){var i=t[a];if(n[i[0]]==null)n[i[0]]=i[1];else switch(i[2]){case"bool":typeof n[i[0]]=="string"&&(n[i[0]]=Or(n[i[0]]));break;case"int":typeof n[i[0]]=="string"&&(n[i[0]]=parseInt(n[i[0]],10));break}}}function By(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=Or(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function K6(e){By(e.WBProps,m_),By(e.CalcPr,rD),My(e.WBView,eD),My(e.Sheets,tD),H0.date1904=Or(e.WBProps.date1904)}function nD(e){return!e.Workbook||!e.Workbook.WBProps?"false":Or(e.Workbook.WBProps.date1904)?"true":"false"}var aD="][*?/\\".split("");function Y6(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return aD.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function iD(e,t,r){e.forEach(function(n,a){Y6(n);for(var i=0;i<a;++i)if(n==e[i])throw new Error("Duplicate Sheet Name: "+n);if(r){var s=t&&t[a]&&t[a].CodeName||n;if(s.charCodeAt(0)==95&&s.length>22)throw new Error("Bad Code Name: Worksheet"+s)}})}function sD(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];iD(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)nR(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var oD=/<\w+:workbook/;function lD(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",i={},s=0;if(e.replace(ya,function(l,c){var u=Ct(l);switch(Ds(u[0])){case"<?xml":break;case"<workbook":l.match(oD)&&(a="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=u[a];break;case"</workbook>":break;case"<fileVersion":delete u[0],r.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":m_.forEach(function(h){if(u[h[0]]!=null)switch(h[2]){case"bool":r.WBProps[h[0]]=Or(u[h[0]]);break;case"int":r.WBProps[h[0]]=parseInt(u[h[0]],10);break;default:r.WBProps[h[0]]=u[h[0]]}}),u.codeName&&(r.WBProps.CodeName=br(u.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],r.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=ar(br(u.name)),delete u[0],r.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":i={},i.Name=br(u.name),u.comment&&(i.Comment=u.comment),u.localSheetId&&(i.Sheet=+u.localSheetId),Or(u.hidden||"0")&&(i.Hidden=!0),s=c+l.length;break;case"</definedName>":i.Ref=ar(br(e.slice(s,c))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete u[0],r.CalcPr=u;break;case"<calcPr/>":delete u[0],r.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return l}),Bc.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return K6(r),r}function J6(e){var t=[xn];t[t.length]=Xe("workbook",null,{xmlns:Bc[0],"xmlns:r":On.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(m_.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=Xe("workbookPr",null,n);var a=e.Workbook&&e.Workbook.Sheets||[],i=0;if(a&&a[0]&&a[0].Hidden){for(t[t.length]="<bookViews>",i=0;i!=e.SheetNames.length&&!(!a[i]||!a[i].Hidden);++i);i==e.SheetNames.length&&(i=0),t[t.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var s={name:_r(e.SheetNames[i].slice(0,31))};if(s.sheetId=""+(i+1),s["r:id"]="rId"+(i+1),a[i])switch(a[i].Hidden){case 1:s.state="hidden";break;case 2:s.state="veryHidden";break}t[t.length]=Xe("sheet",null,s)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(t[t.length]=Xe("definedName",_r(o.Ref),l))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function cD(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=tx(e),r.name=va(e),r}function uD(e,t){return t||(t=Le(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),e_(e.strRelID,t),Wn(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function fD(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?va(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function hD(e,t){t||(t=Le(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),$S(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function dD(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function pD(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),i=HF(e),s=Jj(e,0,r),o=Qv(e);e.l=n;var l={Name:i,Ptg:s};return a<268435455&&(l.Sheet=a),o&&(l.Comment=o),l}function mD(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;t||(t={}),t.biff=12;var i=[],s=[[]];return s.SheetNames=[],s.XTI=[],gh[16]={n:"BrtFRTArchID$",f:dD},ko(e,function(l,c,u){switch(u){case 156:s.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(t.SID=l.Sheet),l.Ref=pa(l.Ptg,null,null,s,t),delete t.SID,delete l.Ptg,i.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:s[0].length?s.push([u,l]):s[0]=[u,l],s[s.length-1].XTI=[];break;case 362:s.length===0&&(s[0]=[],s[0].XTI=[]),s[s.length-1].XTI=s[s.length-1].XTI.concat(l),s.XTI=s.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(u),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(u),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!c.T){if(!a||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}},t),K6(r),r.Names=i,r.supbooks=s,r}function gD(e,t){De(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,a={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};De(e,156,uD(a))}De(e,144)}function xD(e,t){t||(t=Le(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Wn("SheetJS",t),Wn(rp.version,t),Wn(rp.version,t),Wn("7262",t),t.length>t.l?t.slice(0,t.l):t}function vD(e,t){t||(t=Le(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function _D(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,a=-1,i=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&a==-1?a=n:r[n].Hidden==1&&i==-1&&(i=n);i>a||(De(e,135),De(e,158,vD(a)),De(e,136))}}function wD(e,t){var r=qa();return De(r,131),De(r,128,xD()),De(r,153,hD(e.Workbook&&e.Workbook.WBProps||null)),_D(r,e),gD(r,e),De(r,132),r.end()}function yD(e,t,r){return t.slice(-4)===".bin"?mD(e,r):lD(e,r)}function bD(e,t,r,n,a,i,s,o){return t.slice(-4)===".bin"?D9(e,n,r,a,i,s,o):pR(e,n,r,a,i,s,o)}function kD(e,t,r,n,a,i,s,o){return t.slice(-4)===".bin"?Q9(e,n,r,a,i):J9(e,n,r,a,i)}function SD(e,t,r,n,a,i,s,o){return t.slice(-4)===".bin"?EO():AO()}function ND(e,t,r,n,a,i,s,o){return t.slice(-4)===".bin"?SO():NO()}function ED(e,t,r,n){return t.slice(-4)===".bin"?yI(e,r,n):cI(e,r,n)}function AD(e,t,r){return L6(e,r)}function TD(e,t,r){return t.slice(-4)===".bin"?TP(e,r):NP(e,r)}function CD(e,t,r){return t.slice(-4)===".bin"?_O(e,r):uO(e,r)}function FD(e,t,r){return t.slice(-4)===".bin"?oO(e):iO(e)}function LD(e,t,r,n){return r.slice(-4)===".bin"?lO(e,t,r,n):void 0}function PD(e,t,r){return t.slice(-4)===".bin"?rO(e,t,r):aO(e,t,r)}function ID(e,t,r){return(t.slice(-4)===".bin"?wD:J6)(e)}function OD(e,t,r,n,a){return(t.slice(-4)===".bin"?X9:q6)(e,r,n,a)}function jD(e,t,r){return(t.slice(-4)===".bin"?LI:C6)(e,r)}function RD(e,t,r){return(t.slice(-4)===".bin"?LP:y6)(e,r)}function DD(e,t,r){return(t.slice(-4)===".bin"?wO:O6)(e)}function MD(e){return(e.slice(-4)===".bin"?nO:P6)()}var Z6=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,Q6=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Zi(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var a=e.match(Z6),i,s,o,l;if(a)for(l=0;l!=a.length;++l)i=a[l].match(Q6),(s=i[1].indexOf(":"))===-1?n[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(s+1),n[o]=i[2].slice(1,i[2].length-1));return n}function BD(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(Z6),a,i,s,o;if(n)for(o=0;o!=n.length;++o)a=n[o].match(Q6),(i=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?s="xmlns"+a[1].slice(6):s=a[1].slice(i+1),r[s]=a[2].slice(1,a[2].length-1));return r}var Of;function UD(e,t){var r=Of[e]||ar(e);return r==="General"?Tc(t):Ui(r,t)}function zD(e,t,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=Or(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=Dr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[ar(t)]=a}function $D(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||So[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=oh(e.v):e.w=Tc(e.v):e.w=UD(t||"General",e.v)}catch(i){if(r.WTF)throw i}try{var n=Of[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&mu(n)){var a=fc(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(i){if(r.WTF)throw i}}}function WD(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=tI[n.Pattern]||n.Pattern)}e[t.ID]=t}function HD(e,t,r,n,a,i,s,o,l,c){var u="General",h=n.StyleID,m={};c=c||{};var f=[],v=0;for(h===void 0&&o&&(h=o.StyleID),h===void 0&&s&&(h=s.StyleID);i[h]!==void 0&&(i[h].nf&&(u=i[h].nf),i[h].Interior&&f.push(i[h].Interior),!!i[h].Parent);)h=i[h].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Or(e);break;case"String":n.t="s",n.r=ry(ar(e)),n.v=e.indexOf("<")>-1?ar(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(Dr(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=ar(e):n.v<60&&(n.v=n.v-1),(!u||u=="General")&&(u="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=GS[e],c.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=ry(t||e));break}if($D(n,u,c),c.cellFormula!==!1)if(n.Formula){var x=ar(n.Formula);x.charCodeAt(0)==61&&(x=x.slice(1)),n.f=W0(x,a),delete n.Formula,n.ArrayRange=="RC"?n.F=W0("RC:RC",a):n.ArrayRange&&(n.F=W0(n.ArrayRange,a),l.push([ir(n.F),n.F]))}else for(v=0;v<l.length;++v)a.r>=l[v][0].s.r&&a.r<=l[v][0].e.r&&a.c>=l[v][0].s.c&&a.c<=l[v][0].e.c&&(n.F=l[v][1]);c.cellStyles&&(f.forEach(function(w){!m.patternType&&w.patternType&&(m.patternType=w.patternType)}),n.s=m),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function VD(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function vg(e,t){var r=t||{};gu();var n=df(Gv(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=br(n));var a=n.slice(0,1024).toLowerCase(),i=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var s=Mr(r);return s.type="string",iu.to_workbook(n,s)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(tt){a.indexOf("<"+tt)>=0&&(i=!0)}),i)return FM(n,r);Of={"General Number":"General","General Date":Nt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Nt[15],"Short Date":Nt[14],"Long Time":Nt[19],"Medium Time":Nt[18],"Short Time":Nt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Nt[2],Standard:Nt[4],Percent:Nt[10],Scientific:Nt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],c,u={},h=[],m=r.dense?[]:{},f="",v={},x={},w=Zi('<Data ss:Type="String">'),_=0,b=0,y=0,N={s:{r:2e6,c:2e6},e:{r:0,c:0}},R={},P={},F="",C=0,A=[],W={},L={},I=0,V=[],Q=[],ue={},me=[],pe,oe=!1,G=[],ve=[],_e={},E=0,j=0,O={Sheets:[],WBProps:{date1904:!1}},B={};uh.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var Y="";o=uh.exec(n);)switch(o[3]=(Y=o[3]).toLowerCase()){case"data":if(Y=="data"){if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?HD(n.slice(_,o.index),F,w,l[l.length-1][0]=="comment"?ue:v,{c:b,r:y},R,me[b],x,G,r):(F="",w=Zi(o[0]),_=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(Q.length>0&&(v.c=Q),(!r.sheetRows||r.sheetRows>y)&&v.v!==void 0&&(r.dense?(m[y]||(m[y]=[]),m[y][b]=v):m[Vr(b)+gn(y)]=v),v.HRef&&(v.l={Target:ar(v.HRef)},v.HRefScreenTip&&(v.l.Tooltip=v.HRefScreenTip),delete v.HRef,delete v.HRefScreenTip),(v.MergeAcross||v.MergeDown)&&(E=b+(parseInt(v.MergeAcross,10)|0),j=y+(parseInt(v.MergeDown,10)|0),A.push({s:{c:b,r:y},e:{c:E,r:j}})),!r.sheetStubs)v.MergeAcross?b=E+1:++b;else if(v.MergeAcross||v.MergeDown){for(var le=b;le<=E;++le)for(var fe=y;fe<=j;++fe)(le>b||fe>y)&&(r.dense?(m[fe]||(m[fe]=[]),m[fe][le]={t:"z"}):m[Vr(le)+gn(fe)]={t:"z"});b=E+1}else++b;else v=BD(o[0]),v.Index&&(b=+v.Index-1),b<N.s.c&&(N.s.c=b),b>N.e.c&&(N.e.c=b),o[0].slice(-2)==="/>"&&++b,Q=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(y<N.s.r&&(N.s.r=y),y>N.e.r&&(N.e.r=y),o[0].slice(-2)==="/>"&&(x=Zi(o[0]),x.Index&&(y=+x.Index-1)),b=0,++y):(x=Zi(o[0]),x.Index&&(y=+x.Index-1),_e={},(x.AutoFitHeight=="0"||x.Height)&&(_e.hpx=parseInt(x.Height,10),_e.hpt=mh(_e.hpx),ve[y]=_e),x.Hidden=="1"&&(_e.hidden=!0,ve[y]=_e));break;case"worksheet":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));h.push(f),N.s.r<=N.e.r&&N.s.c<=N.e.c&&(m["!ref"]=Ut(N),r.sheetRows&&r.sheetRows<=N.e.r&&(m["!fullref"]=m["!ref"],N.e.r=r.sheetRows-1,m["!ref"]=Ut(N))),A.length&&(m["!merges"]=A),me.length>0&&(m["!cols"]=me),ve.length>0&&(m["!rows"]=ve),u[f]=m}else N={s:{r:2e6,c:2e6},e:{r:0,c:0}},y=b=0,l.push([o[3],!1]),c=Zi(o[0]),f=ar(c.Name),m=r.dense?[]:{},A=[],G=[],ve=[],B={name:f,Hidden:0},O.Sheets.push(B);break;case"table":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),me=[],oe=!1}break;case"style":o[1]==="/"?WD(R,P,r):P=Zi(o[0]);break;case"numberformat":P.nf=ar(Zi(o[0]).Format||"General"),Of[P.nf]&&(P.nf=Of[P.nf]);for(var ce=0;ce!=392&&Nt[ce]!=P.nf;++ce);if(ce==392){for(ce=57;ce!=392;++ce)if(Nt[ce]==null){po(P.nf,ce);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(pe=Zi(o[0]),pe.Hidden&&(pe.hidden=!0,delete pe.Hidden),pe.Width&&(pe.wpx=parseInt(pe.Width,10)),!oe&&pe.wpx>10){oe=!0,ga=A6;for(var de=0;de<me.length;++de)me[de]&&bl(me[de])}oe&&bl(pe),me[pe.Index-1||me.length]=pe;for(var Ce=0;Ce<+pe.Span;++Ce)me[me.length]=Mr(pe);break;case"namedrange":if(o[1]==="/")break;O.Names||(O.Names=[]);var X=Ct(o[0]),$e={Name:X.Name,Ref:W0(X.RefersTo.slice(1),{r:0,c:0})};O.Sheets.length>0&&($e.Sheet=O.Sheets.length-1),O.Names.push($e);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?F+=n.slice(C,o.index):C=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;P.Interior=Zi(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?m7(W,Y,n.slice(I,o.index)):I=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));VD(ue),Q.push(ue)}else l.push([o[3],!1]),c=Zi(o[0]),ue={a:c.Author};break;case"autofilter":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var be=Zi(o[0]);m["!autofilter"]={ref:W0(be.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return Hy(n,r);var ee=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:ee=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:ee=!1}break;case"excelworkbook":switch(o[3]){case"date1904":O.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:ee=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:ee=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(I,o.index)){case"SheetHidden":B.Hidden=1;break;case"SheetVeryHidden":B.Hidden=2;break}else I=o.index+o[0].length;break;case"header":m["!margins"]||yc(m["!margins"]={},"xlml"),isNaN(+Ct(o[0]).Margin)||(m["!margins"].header=+Ct(o[0]).Margin);break;case"footer":m["!margins"]||yc(m["!margins"]={},"xlml"),isNaN(+Ct(o[0]).Margin)||(m["!margins"].footer=+Ct(o[0]).Margin);break;case"pagemargins":var et=Ct(o[0]);m["!margins"]||yc(m["!margins"]={},"xlml"),isNaN(+et.Top)||(m["!margins"].top=+et.Top),isNaN(+et.Left)||(m["!margins"].left=+et.Left),isNaN(+et.Right)||(m["!margins"].right=+et.Right),isNaN(+et.Bottom)||(m["!margins"].bottom=+et.Bottom);break;case"displayrighttoleft":O.Views||(O.Views=[]),O.Views[0]||(O.Views[0]={}),O.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:ee=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:ee=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:ee=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:ee=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:ee=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:ee=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:ee=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:ee=!1}break;case"smarttags":break;default:ee=!1;break}if(ee||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?zD(L,Y,V,n.slice(I,o.index)):(V=o,I=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var Re={};return!r.bookSheets&&!r.bookProps&&(Re.Sheets=u),Re.SheetNames=h,Re.Workbook=O,Re.SSF=Mr(Nt),Re.Props=W,Re.Custprops=L,Re}function lx(e,t){switch(x_(t=t||{}),t.type||"base64"){case"base64":return vg(mi(e),t);case"binary":case"buffer":case"file":return vg(e,t);case"array":return vg(Cl(e),t)}}function qD(e,t){var r=[];return e.Props&&r.push(g7(e.Props,t)),e.Custprops&&r.push(x7(e.Props,e.Custprops)),r.join("")}function GD(){return""}function XD(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,a){var i=[];i.push(Xe("NumberFormat",null,{"ss:Format":_r(Nt[n.numFmtId])}));var s={"ss:ID":"s"+(21+a)};r.push(Xe("Style",i.join(""),s))}),Xe("Styles",r.join(""))}function eN(e){return Xe("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+f_(e.Ref,{r:0,c:0})})}function KD(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var a=t[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||r.push(eN(a)))}return Xe("Names",r.join(""))}function YD(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,i=[],s=0;s<a.length;++s){var o=a[s];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||i.push(eN(o)))}return i.join("")}function JD(e,t,r,n){if(!e)return"";var a=[];if(e["!margins"]&&(a.push("<PageSetup>"),e["!margins"].header&&a.push(Xe("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&a.push(Xe("Footer",null,{"x:Margin":e["!margins"].footer})),a.push(Xe("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)a.push(Xe("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(n.Workbook.Sheets[i]&&!n.Workbook.Sheets[i].Hidden);++i);i==r&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),e["!protect"]&&(a.push(Qn("ProtectContents","True")),e["!protect"].objects&&a.push(Qn("ProtectObjects","True")),e["!protect"].scenarios&&a.push(Qn("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?a.push(Qn("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&a.push(Qn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(s){e["!protect"][s[0]]&&a.push("<"+s[1]+"/>")})),a.length==0?"":Xe("WorksheetOptions",a.join(""),{xmlns:si.x})}function ZD(e){return e.map(function(t){var r=_F(t.t||""),n=Xe("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Xe("Comment",n,{"ss:Author":t.a})}).join("")}function QD(e,t,r,n,a,i,s){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+_r(f_(e.f,s))),e.F&&e.F.slice(0,t.length)==t){var l=qr(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==s.r?"":"["+(l.r-s.r)+"]")+"C"+(l.c==s.c?"":"["+(l.c-s.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=_r(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=_r(e.l.Tooltip))),r["!merges"])for(var c=r["!merges"],u=0;u!=c.length;++u)c[u].s.c!=s.c||c[u].s.r!=s.r||(c[u].e.c>c[u].s.c&&(o["ss:MergeAcross"]=c[u].e.c-c[u].s.c),c[u].e.r>c[u].s.r&&(o["ss:MergeDown"]=c[u].e.r-c[u].s.r));var h="",m="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":h="Number",m=String(e.v);break;case"b":h="Boolean",m=e.v?"1":"0";break;case"e":h="Error",m=So[e.v];break;case"d":h="DateTime",m=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Nt[14]);break;case"s":h="String",m=vF(e.v||"");break}var f=Ll(n.cellXfs,e,n);o["ss:StyleID"]="s"+(21+f),o["ss:Index"]=s.c+1;var v=e.v!=null?m:"",x=e.t=="z"?"":'<Data ss:Type="'+h+'">'+v+"</Data>";return(e.c||[]).length>0&&(x+=ZD(e.c)),Xe("Cell",x,o)}function eM(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=su(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function tM(e,t,r,n){if(!e["!ref"])return"";var a=ir(e["!ref"]),i=e["!merges"]||[],s=0,o=[];e["!cols"]&&e["!cols"].forEach(function(w,_){bl(w);var b=!!w.width,y=Gp(_,w),N={"ss:Index":_+1};b&&(N["ss:Width"]=dh(y.width)),w.hidden&&(N["ss:Hidden"]="1"),o.push(Xe("Column",null,N))});for(var l=Array.isArray(e),c=a.s.r;c<=a.e.r;++c){for(var u=[eM(c,(e["!rows"]||[])[c])],h=a.s.c;h<=a.e.c;++h){var m=!1;for(s=0;s!=i.length;++s)if(!(i[s].s.c>h)&&!(i[s].s.r>c)&&!(i[s].e.c<h)&&!(i[s].e.r<c)){(i[s].s.c!=h||i[s].s.r!=c)&&(m=!0);break}if(!m){var f={r:c,c:h},v=Et(f),x=l?(e[c]||[])[h]:e[v];u.push(QD(x,v,e,t,r,n,f))}}u.push("</Row>"),u.length>2&&o.push(u.join(""))}return o.join("")}function rM(e,t,r){var n=[],a=r.SheetNames[e],i=r.Sheets[a],s=i?YD(i,t,e,r):"";return s.length>0&&n.push("<Names>"+s+"</Names>"),s=i?tM(i,t,e,r):"",s.length>0&&n.push("<Table>"+s+"</Table>"),n.push(JD(i,t,e,r)),n.join("")}function nM(e,t){t||(t={}),e.SSF||(e.SSF=Mr(Nt)),e.SSF&&(gu(),Up(e.SSF),t.revssf=$p(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Ll(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(qD(e,t)),r.push(GD()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(Xe("Worksheet",rM(n,t,e),{"ss:Name":_r(e.SheetNames[n])}));return r[2]=XD(e,t),r[3]=KD(e),xn+Xe("Workbook",r.join(""),{xmlns:si.ss,"xmlns:o":si.o,"xmlns:x":si.x,"xmlns:ss":si.ss,"xmlns:dt":si.dt,"xmlns:html":si.html})}function aM(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=KF(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=YF(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var iM=[60,1084,2066,2165,2175];function sM(e,t,r,n,a){var i=n,s=[],o=r.slice(r.l,r.l+i);if(a&&a.enc&&a.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(o)}s.push(o),r.l+=i;for(var l=lo(r,r.l),c=cx[l],u=0;c!=null&&iM.indexOf(l)>-1;)i=lo(r,r.l+2),u=r.l+4,l==2066?u+=4:(l==2165||l==2175)&&(u+=12),o=r.slice(u,r.l+4+i),s.push(o),r.l+=4+i,c=cx[l=lo(r,r.l)];var h=$n(s);Zn(h,0);var m=0;h.lens=[];for(var f=0;f<s.length;++f)h.lens.push(m),m+=s[f].length;if(h.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+h.length+" < "+n;return t.f(h,h.length,a)}function bs(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Nt[n])}catch(i){if(t.WTF)throw i}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||So[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=oh(e.v):e.w=Tc(e.v):e.w=Ui(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(i){if(t.WTF)throw i}if(t.cellDates&&n&&e.t=="n"&&mu(Nt[n]||String(n))){var a=fc(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function Kd(e,t,r){return{v:e,ixfe:t,t:r}}function oM(e,t){var r={opts:{}},n={},a=t.dense?[]:{},i={},s={},o=null,l=[],c="",u={},h,m="",f,v,x,w,_={},b=[],y,N,R=[],P=[],F={Sheets:[],WBProps:{date1904:!1},Views:[{}]},C={},A=function(qe){return qe<8?vc[qe]:qe<64&&P[qe-8]||vc[qe]},W=function(qe,Ze,Ht){var kt=Ze.XF.data;if(!(!kt||!kt.patternType||!Ht||!Ht.cellStyles)){Ze.s={},Ze.s.patternType=kt.patternType;var st;(st=hh(A(kt.icvFore)))&&(Ze.s.fgColor={rgb:st}),(st=hh(A(kt.icvBack)))&&(Ze.s.bgColor={rgb:st})}},L=function(qe,Ze,Ht){if(!(_e>1)&&!(Ht.sheetRows&&qe.r>=Ht.sheetRows)){if(Ht.cellStyles&&Ze.XF&&Ze.XF.data&&W(qe,Ze,Ht),delete Ze.ixfe,delete Ze.XF,h=qe,m=Et(qe),(!s||!s.s||!s.e)&&(s={s:{r:0,c:0},e:{r:0,c:0}}),qe.r<s.s.r&&(s.s.r=qe.r),qe.c<s.s.c&&(s.s.c=qe.c),qe.r+1>s.e.r&&(s.e.r=qe.r+1),qe.c+1>s.e.c&&(s.e.c=qe.c+1),Ht.cellFormula&&Ze.f){for(var kt=0;kt<b.length;++kt)if(!(b[kt][0].s.c>qe.c||b[kt][0].s.r>qe.r)&&!(b[kt][0].e.c<qe.c||b[kt][0].e.r<qe.r)){Ze.F=Ut(b[kt][0]),(b[kt][0].s.c!=qe.c||b[kt][0].s.r!=qe.r)&&delete Ze.f,Ze.f&&(Ze.f=""+pa(b[kt][1],s,qe,G,I));break}}Ht.dense?(a[qe.r]||(a[qe.r]=[]),a[qe.r][qe.c]=Ze):a[m]=Ze}},I={enc:!1,sbcch:0,snames:[],sharedf:_,arrayf:b,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(I.password=t.password);var V,Q=[],ue=[],me=[],pe=[],oe=!1,G=[];G.SheetNames=I.snames,G.sharedf=I.sharedf,G.arrayf=I.arrayf,G.names=[],G.XTI=[];var ve=0,_e=0,E=0,j=[],O=[],B;I.codepage=1200,is(1200);for(var Y=!1;e.l<e.length-1;){var le=e.l,fe=e.read_shift(2);if(fe===0&&ve===10)break;var ce=e.l===e.length?0:e.read_shift(2),de=cx[fe];if(de&&de.f){if(t.bookSheets&&ve===133&&fe!==133)break;if(ve=fe,de.r===2||de.r==12){var Ce=e.read_shift(2);if(ce-=2,!I.enc&&Ce!==fe&&((Ce&255)<<8|Ce>>8)!==fe)throw new Error("rt mismatch: "+Ce+"!="+fe);de.r==12&&(e.l+=10,ce-=10)}var X={};if(fe===10?X=de.f(e,ce,I):X=sM(fe,de,e,ce,I),_e==0&&[9,521,1033,2057].indexOf(ve)===-1)continue;switch(fe){case 34:r.opts.Date1904=F.WBProps.date1904=X;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(I.enc||(e.l=0),I.enc=X,!t.password)throw new Error("File is password-protected");if(X.valid==null)throw new Error("Encryption scheme unsupported");if(!X.valid)throw new Error("Password is incorrect");break;case 92:I.lastuser=X;break;case 66:var $e=Number(X);switch($e){case 21010:$e=1200;break;case 32768:$e=1e4;break;case 32769:$e=1252;break}is(I.codepage=$e),Y=!0;break;case 317:I.rrtabid=X;break;case 25:I.winlocked=X;break;case 439:r.opts.RefreshAll=X;break;case 12:r.opts.CalcCount=X;break;case 16:r.opts.CalcDelta=X;break;case 17:r.opts.CalcIter=X;break;case 13:r.opts.CalcMode=X;break;case 14:r.opts.CalcPrecision=X;break;case 95:r.opts.CalcSaveRecalc=X;break;case 15:I.CalcRefMode=X;break;case 2211:r.opts.FullCalc=X;break;case 129:X.fDialog&&(a["!type"]="dialog"),X.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),X.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:R.push(X);break;case 430:G.push([X]),G[G.length-1].XTI=[];break;case 35:case 547:G[G.length-1].push(X);break;case 24:case 536:B={Name:X.Name,Ref:pa(X.rgce,s,null,G,I)},X.itab>0&&(B.Sheet=X.itab-1),G.names.push(B),G[0]||(G[0]=[],G[0].XTI=[]),G[G.length-1].push(X),X.Name=="_xlnm._FilterDatabase"&&X.itab>0&&X.rgce&&X.rgce[0]&&X.rgce[0][0]&&X.rgce[0][0][0]=="PtgArea3d"&&(O[X.itab-1]={ref:Ut(X.rgce[0][0][1][2])});break;case 22:I.ExternCount=X;break;case 23:G.length==0&&(G[0]=[],G[0].XTI=[]),G[G.length-1].XTI=G[G.length-1].XTI.concat(X),G.XTI=G.XTI.concat(X);break;case 2196:if(I.biff<8)break;B!=null&&(B.Comment=X[1]);break;case 18:a["!protect"]=X;break;case 19:X!==0&&I.WTF&&console.error("Password verifier: "+X);break;case 133:i[X.pos]=X,I.snames.push(X.name);break;case 10:{if(--_e)break;if(s.e){if(s.e.r>0&&s.e.c>0){if(s.e.r--,s.e.c--,a["!ref"]=Ut(s),t.sheetRows&&t.sheetRows<=s.e.r){var be=s.e.r;s.e.r=t.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=Ut(s),s.e.r=be}s.e.r++,s.e.c++}Q.length>0&&(a["!merges"]=Q),ue.length>0&&(a["!objects"]=ue),me.length>0&&(a["!cols"]=me),pe.length>0&&(a["!rows"]=pe),F.Sheets.push(C)}c===""?u=a:n[c]=a,a=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(I.biff===8&&(I.biff={9:2,521:3,1033:4}[fe]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[X.BIFFVer]||8),I.biffguess=X.BIFFVer==0,X.BIFFVer==0&&X.dt==4096&&(I.biff=5,Y=!0,is(I.codepage=28591)),I.biff==8&&X.BIFFVer==0&&X.dt==16&&(I.biff=2),_e++)break;if(a=t.dense?[]:{},I.biff<8&&!Y&&(Y=!0,is(I.codepage=t.codepage||1252)),I.biff<5||X.BIFFVer==0&&X.dt==4096){c===""&&(c="Sheet1"),s={s:{r:0,c:0},e:{r:0,c:0}};var ee={pos:e.l-ce,name:c};i[ee.pos]=ee,I.snames.push(c)}else c=(i[le]||{name:""}).name;X.dt==32&&(a["!type"]="chart"),X.dt==64&&(a["!type"]="macro"),Q=[],ue=[],I.arrayf=b=[],me=[],pe=[],oe=!1,C={Hidden:(i[le]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(t.dense?(a[X.r]||[])[X.c]:a[Et({c:X.c,r:X.r})])&&++X.c,y={ixfe:X.ixfe,XF:R[X.ixfe]||{},v:X.val,t:"n"},E>0&&(y.z=j[y.ixfe>>8&63]),bs(y,t,r.opts.Date1904),L({c:X.c,r:X.r},y,t);break;case 5:case 517:y={ixfe:X.ixfe,XF:R[X.ixfe],v:X.val,t:X.t},E>0&&(y.z=j[y.ixfe>>8&63]),bs(y,t,r.opts.Date1904),L({c:X.c,r:X.r},y,t);break;case 638:y={ixfe:X.ixfe,XF:R[X.ixfe],v:X.rknum,t:"n"},E>0&&(y.z=j[y.ixfe>>8&63]),bs(y,t,r.opts.Date1904),L({c:X.c,r:X.r},y,t);break;case 189:for(var et=X.c;et<=X.C;++et){var Re=X.rkrec[et-X.c][0];y={ixfe:Re,XF:R[Re],v:X.rkrec[et-X.c][1],t:"n"},E>0&&(y.z=j[y.ixfe>>8&63]),bs(y,t,r.opts.Date1904),L({c:et,r:X.r},y,t)}break;case 6:case 518:case 1030:{if(X.val=="String"){o=X;break}if(y=Kd(X.val,X.cell.ixfe,X.tt),y.XF=R[y.ixfe],t.cellFormula){var tt=X.formula;if(tt&&tt[0]&&tt[0][0]&&tt[0][0][0]=="PtgExp"){var Me=tt[0][0][1][0],at=tt[0][0][1][1],Ye=Et({r:Me,c:at});_[Ye]?y.f=""+pa(X.formula,s,X.cell,G,I):y.F=((t.dense?(a[Me]||[])[at]:a[Ye])||{}).F}else y.f=""+pa(X.formula,s,X.cell,G,I)}E>0&&(y.z=j[y.ixfe>>8&63]),bs(y,t,r.opts.Date1904),L(X.cell,y,t),o=X}break;case 7:case 519:if(o)o.val=X,y=Kd(X,o.cell.ixfe,"s"),y.XF=R[y.ixfe],t.cellFormula&&(y.f=""+pa(o.formula,s,o.cell,G,I)),E>0&&(y.z=j[y.ixfe>>8&63]),bs(y,t,r.opts.Date1904),L(o.cell,y,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{b.push(X);var At=Et(X[0].s);if(f=t.dense?(a[X[0].s.r]||[])[X[0].s.c]:a[At],t.cellFormula&&f){if(!o||!At||!f)break;f.f=""+pa(X[1],s,X[0],G,I),f.F=Ut(X[0])}}break;case 1212:{if(!t.cellFormula)break;if(m){if(!o)break;_[Et(o.cell)]=X[0],f=t.dense?(a[o.cell.r]||[])[o.cell.c]:a[Et(o.cell)],(f||{}).f=""+pa(X[0],s,h,G,I)}}break;case 253:y=Kd(l[X.isst].t,X.ixfe,"s"),l[X.isst].h&&(y.h=l[X.isst].h),y.XF=R[y.ixfe],E>0&&(y.z=j[y.ixfe>>8&63]),bs(y,t,r.opts.Date1904),L({c:X.c,r:X.r},y,t);break;case 513:t.sheetStubs&&(y={ixfe:X.ixfe,XF:R[X.ixfe],t:"z"},E>0&&(y.z=j[y.ixfe>>8&63]),bs(y,t,r.opts.Date1904),L({c:X.c,r:X.r},y,t));break;case 190:if(t.sheetStubs)for(var ut=X.c;ut<=X.C;++ut){var Ot=X.ixfe[ut-X.c];y={ixfe:Ot,XF:R[Ot],t:"z"},E>0&&(y.z=j[y.ixfe>>8&63]),bs(y,t,r.opts.Date1904),L({c:ut,r:X.r},y,t)}break;case 214:case 516:case 4:y=Kd(X.val,X.ixfe,"s"),y.XF=R[y.ixfe],E>0&&(y.z=j[y.ixfe>>8&63]),bs(y,t,r.opts.Date1904),L({c:X.c,r:X.r},y,t);break;case 0:case 512:_e===1&&(s=X);break;case 252:l=X;break;case 1054:if(I.biff==4){j[E++]=X[1];for(var _t=0;_t<E+163&&Nt[_t]!=X[1];++_t);_t>=163&&po(X[1],E+163)}else po(X[1],X[0]);break;case 30:{j[E++]=X;for(var wt=0;wt<E+163&&Nt[wt]!=X;++wt);wt>=163&&po(X,E+163)}break;case 229:Q=Q.concat(X);break;case 93:ue[X.cmo[0]]=I.lastobj=X;break;case 438:I.lastobj.TxO=X;break;case 127:I.lastobj.ImData=X;break;case 440:for(w=X[0].s.r;w<=X[0].e.r;++w)for(x=X[0].s.c;x<=X[0].e.c;++x)f=t.dense?(a[w]||[])[x]:a[Et({c:x,r:w})],f&&(f.l=X[1]);break;case 2048:for(w=X[0].s.r;w<=X[0].e.r;++w)for(x=X[0].s.c;x<=X[0].e.c;++x)f=t.dense?(a[w]||[])[x]:a[Et({c:x,r:w})],f&&f.l&&(f.l.Tooltip=X[1]);break;case 28:{if(I.biff<=5&&I.biff>=2)break;f=t.dense?(a[X[0].r]||[])[X[0].c]:a[Et(X[0])];var er=ue[X[2]];f||(t.dense?(a[X[0].r]||(a[X[0].r]=[]),f=a[X[0].r][X[0].c]={t:"z"}):f=a[Et(X[0])]={t:"z"},s.e.r=Math.max(s.e.r,X[0].r),s.s.r=Math.min(s.s.r,X[0].r),s.e.c=Math.max(s.e.c,X[0].c),s.s.c=Math.min(s.s.c,X[0].c)),f.c||(f.c=[]),v={a:X[1],t:er.TxO.t},f.c.push(v)}break;case 2173:XI(R[X.ixfe],X.ext);break;case 125:{if(!I.cellStyles)break;for(;X.e>=X.s;)me[X.e--]={width:X.w/256,level:X.level||0,hidden:!!(X.flags&1)},oe||(oe=!0,l_(X.w/256)),bl(me[X.e+1])}break;case 520:{var mt={};X.level!=null&&(pe[X.r]=mt,mt.level=X.level),X.hidden&&(pe[X.r]=mt,mt.hidden=!0),X.hpt&&(pe[X.r]=mt,mt.hpt=X.hpt,mt.hpx=su(X.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||yc(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[fe]]=X;break;case 161:a["!margins"]||yc(a["!margins"]={}),a["!margins"].header=X.header,a["!margins"].footer=X.footer;break;case 574:X.RTL&&(F.Views[0].RTL=!0);break;case 146:P=X;break;case 2198:V=X;break;case 140:N=X;break;case 442:c?C.CodeName=X||C.name:F.WBProps.CodeName=X||"ThisWorkbook";break}}else de||console.error("Missing Info for XLS Record 0x"+fe.toString(16)),e.l+=ce}return r.SheetNames=nn(i).sort(function(it,qe){return Number(it)-Number(qe)}).map(function(it){return i[it].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&u["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=u)):r.Preamble=u,r.Sheets&&O.forEach(function(it,qe){r.Sheets[r.SheetNames[qe]]["!autofilter"]=it}),r.Strings=l,r.SSF=Mr(Nt),I.enc&&(r.Encryption=I.enc),V&&(r.Themes=V),r.Metadata={},N!==void 0&&(r.Metadata.Country=N),G.names.length>0&&(F.Names=G.names),r.Workbook=F,r}var jf={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function lM(e,t,r){var n=vt.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=wy(n,rx,jf.DSI);for(var i in a)t[i]=a[i]}catch(c){if(r.WTF)throw c}var s=vt.find(e,"/!SummaryInformation");if(s&&s.size>0)try{var o=wy(s,nx,jf.SI);for(var l in o)t[l]==null&&(t[l]=o[l])}catch(c){if(r.WTF)throw c}t.HeadingPairs&&t.TitlesOfParts&&(QS(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function cM(e,t){var r=[],n=[],a=[],i=0,s,o=Yw(rx,"n"),l=Yw(nx,"n");if(e.Props)for(s=nn(e.Props),i=0;i<s.length;++i)(Object.prototype.hasOwnProperty.call(o,s[i])?r:Object.prototype.hasOwnProperty.call(l,s[i])?n:a).push([s[i],e.Props[s[i]]]);if(e.Custprops)for(s=nn(e.Custprops),i=0;i<s.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},s[i])||(Object.prototype.hasOwnProperty.call(o,s[i])?r:Object.prototype.hasOwnProperty.call(l,s[i])?n:a).push([s[i],e.Custprops[s[i]]]);var c=[];for(i=0;i<a.length;++i)s6.indexOf(a[i][0])>-1||ZS.indexOf(a[i][0])>-1||a[i][1]!=null&&c.push(a[i]);n.length&&vt.utils.cfb_add(t,"/SummaryInformation",yy(n,jf.SI,l,nx)),(r.length||c.length)&&vt.utils.cfb_add(t,"/DocumentSummaryInformation",yy(r,jf.DSI,o,rx,c.length?c:null,jf.UDI))}function tN(e,t){t||(t={}),x_(t),Mv(),t.codepage&&Dv(t.codepage);var r,n;if(e.FullPaths){if(vt.find(e,"/encryption"))throw new Error("File is password-protected");r=vt.find(e,"!CompObj"),n=vt.find(e,"/Workbook")||vt.find(e,"/Book")}else{switch(t.type){case"base64":e=li(mi(e));break;case"binary":e=li(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Zn(e,0),n={content:e}}var a,i;if(r&&aM(r),t.bookProps&&!t.bookSheets)a={};else{var s=Vt?"buffer":"array";if(n&&n.content)a=oM(n.content,t);else if((i=vt.find(e,"PerfectOffice_MAIN"))&&i.content)a=wc.to_workbook(i.content,(t.type=s,t));else if((i=vt.find(e,"NativeContent_MAIN"))&&i.content)a=wc.to_workbook(i.content,(t.type=s,t));else throw(i=vt.find(e,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&vt.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=bO(e))}var o={};return e.FullPaths&&lM(e,o,t),a.Props=a.Custprops=o,t.bookFiles&&(a.cfb=e),a}function uM(e,t){var r=t||{},n=vt.utils.cfb_new({root:"R"}),a="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":a="/Workbook",r.biff=8;break;case"biff5":a="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return vt.utils.cfb_add(n,a,rN(e,r)),r.biff==8&&(e.Props||e.Custprops)&&cM(e,n),r.biff==8&&e.vbaraw&&kO(n,vt.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var gh={0:{f:OR},1:{f:$R},2:{f:o9},3:{f:YR},4:{f:qR},5:{f:a9},6:{f:h9},7:{f:e9},8:{f:_9},9:{f:v9},10:{f:g9},11:{f:x9},12:{f:HR},13:{f:c9},14:{f:ZR},15:{f:XR},16:{f:G6},17:{f:p9},18:{f:r9},19:{f:Zv},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:pD},40:{},42:{},43:{f:hI},44:{f:uI},45:{f:mI},46:{f:xI},47:{f:gI},48:{},49:{f:DF},50:{},51:{f:JI},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:x6},62:{f:f9},63:{f:sO},64:{f:j9},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:wa,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:L9},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:UR},148:{f:DR,p:16},151:{f:N9},152:{},153:{f:fD},154:{},155:{},156:{f:cD},157:{},158:{},159:{T:1,f:AP},160:{T:-1},161:{T:1,f:Wc},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:w9},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:KI},336:{T:-1},337:{f:eO,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:tx},357:{},358:{},359:{},360:{T:1},361:{},362:{f:g6},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:E9},427:{f:A9},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:C9},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:BR},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:k9},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:tx},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:xO},633:{T:1},634:{T:-1},635:{T:1,f:mO},636:{T:-1},637:{f:zF},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Z9},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:R9},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},cx={6:{f:gg},10:{f:Wo},12:{f:Sn},13:{f:Sn},14:{f:fn},15:{f:fn},16:{f:xa},17:{f:fn},18:{f:fn},19:{f:Sn},20:{f:Ay},21:{f:Ay},23:{f:g6},24:{f:Cy},25:{f:fn},26:{},27:{},28:{f:RL},29:{},34:{f:fn},35:{f:Ty},38:{f:xa},39:{f:xa},40:{f:xa},41:{f:xa},42:{f:fn},43:{f:fn},47:{f:XP},49:{f:cL},51:{f:Sn},60:{},61:{f:aL},64:{f:fn},65:{f:lL},66:{f:Sn},77:{},80:{},81:{},82:{},85:{f:Sn},89:{},90:{},91:{},92:{f:G7},93:{f:BL},94:{},95:{f:fn},96:{},97:{},99:{f:fn},125:{f:x6},128:{f:SL},129:{f:K7},130:{f:Sn},131:{f:fn},132:{f:fn},133:{f:Y7},134:{},140:{f:GL},141:{f:Sn},144:{},146:{f:YL},151:{},152:{},153:{},154:{},155:{},156:{f:Sn},157:{},158:{},160:{f:nP},161:{f:QL},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:wL},190:{f:yL},193:{f:Wo},197:{},198:{},199:{},200:{},201:{},202:{f:fn},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Sn},220:{},221:{f:fn},222:{},224:{f:kL},225:{f:q7},226:{f:Wo},227:{},229:{f:DL},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:Z7},253:{f:fL},255:{f:eL},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:o6},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:fn},353:{f:Wo},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:CL},431:{f:fn},432:{},433:{},434:{},437:{},438:{f:$L},439:{f:fn},440:{f:WL},441:{},442:{f:Dh},443:{},444:{f:Sn},445:{},446:{},448:{f:Wo},449:{f:nL,r:2},450:{f:Wo},512:{f:Sy},513:{f:rP},515:{f:AL},516:{f:dL},517:{f:Ey},519:{f:aP},520:{f:tL},523:{},545:{f:Fy},549:{f:ky},566:{},574:{f:sL},638:{f:_L},659:{},1048:{},1054:{f:mL},1084:{},1212:{f:IL},2048:{f:VL},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:qd},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Wo},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:JL,r:12},2173:{f:GI,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:fn,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:PL,r:12},2197:{},2198:{f:zI,r:12},2199:{},2200:{},2201:{},2202:{f:OL,r:12},2203:{f:Wo},2204:{},2205:{},2206:{},2207:{},2211:{f:rL},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Sn},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:eP},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:KL},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Sy},1:{},2:{f:cP},3:{f:oP},4:{f:sP},5:{f:Ey},7:{f:fP},8:{},9:{f:qd},11:{},22:{f:Sn},30:{f:xL},31:{},32:{},33:{f:Fy},36:{},37:{f:ky},50:{f:hP},62:{},52:{},67:{},68:{f:Sn},69:{},86:{},126:{},127:{f:iP},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:dP},223:{},234:{},354:{},421:{},518:{f:gg},521:{f:qd},536:{f:Cy},547:{f:Ty},561:{},579:{},1030:{f:gg},1033:{f:qd},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Ke(e,t,r,n){var a=t;if(!isNaN(a)){var i=n||(r||[]).length||0,s=e.next(4);s.write_shift(2,a),s.write_shift(2,i),i>0&&Kv(r)&&e.push(r)}}function fM(e,t,r,n){var a=(r||[]).length||0;if(a<=8224)return Ke(e,t,r,a);var i=t;if(!isNaN(i)){for(var s=r.parts||[],o=0,l=0,c=0;c+(s[o]||8224)<=8224;)c+=s[o]||8224,o++;var u=e.next(4);for(u.write_shift(2,i),u.write_shift(2,c),e.push(r.slice(l,l+c)),l+=c;l<a;){for(u=e.next(4),u.write_shift(2,60),c=0;c+(s[o]||8224)<=8224;)c+=s[o]||8224,o++;u.write_shift(2,c),e.push(r.slice(l,l+c)),l+=c}}}function zh(e,t,r){return e||(e=Le(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function hM(e,t,r,n){var a=Le(9);return zh(a,e,t),l6(r,n||"b",a),a}function dM(e,t,r){var n=Le(8+2*r.length);return zh(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function pM(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var a=t.t=="d"?Rn(Dr(t.v)):t.v;a==(a|0)&&a>=0&&a<65536?Ke(e,2,uP(r,n,a)):Ke(e,3,lP(r,n,a));return;case"b":case"e":Ke(e,5,hM(r,n,t.v,t.t));return;case"s":case"str":Ke(e,4,dM(r,n,(t.v||"").slice(0,255)));return}Ke(e,1,zh(null,r,n))}function mM(e,t,r,n){var a=Array.isArray(t),i=ir(t["!ref"]||"A1"),s,o="",l=[];if(i.e.c>255||i.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),s=Ut(i)}for(var c=i.s.r;c<=i.e.r;++c){o=gn(c);for(var u=i.s.c;u<=i.e.c;++u){c===i.s.r&&(l[u]=Vr(u)),s=l[u]+o;var h=a?(t[c]||[])[u]:t[s];h&&pM(e,h,c,u)}}}function gM(e,t){for(var r=t||{},n=qa(),a=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==r.sheet&&(a=i);if(a==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Ke(n,r.biff==4?1033:r.biff==3?521:9,i_(e,16,r)),mM(n,e.Sheets[e.SheetNames[a]],a,r),Ke(n,10),n.end()}function xM(e,t,r){Ke(e,49,uL({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},r))}function vM(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&Ke(e,1054,gL(a,t[a],r))})}function _M(e,t){var r=Le(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Ke(e,2151,r),r=Le(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),d6(ir(t["!ref"]||"A1"),r),r.write_shift(4,4),Ke(e,2152,r)}function wM(e,t){for(var r=0;r<16;++r)Ke(e,224,Ny({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){Ke(e,224,Ny(n,0,t))})}function yM(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];Ke(e,440,HL(n)),n[1].Tooltip&&Ke(e,2048,qL(n))}delete t["!links"]}function bM(e,t){if(t){var r=0;t.forEach(function(n,a){++r<=256&&n&&Ke(e,125,ZL(Gp(a,n),a))})}}function kM(e,t,r,n,a){var i=16+Ll(a.cellXfs,t,a);if(t.v==null&&!t.bf){Ke(e,513,Pc(r,n,i));return}if(t.bf)Ke(e,6,Kj(t,r,n,a,i));else switch(t.t){case"d":case"n":var s=t.t=="d"?Rn(Dr(t.v)):t.v;Ke(e,515,TL(r,n,s,i));break;case"b":case"e":Ke(e,517,EL(r,n,t.v,i,a,t.t));break;case"s":case"str":if(a.bookSST){var o=d_(a.Strings,t.v,a.revStrings);Ke(e,253,hL(r,n,o,i))}else Ke(e,516,pL(r,n,(t.v||"").slice(0,255),i,a));break;default:Ke(e,513,Pc(r,n,i))}}function SM(e,t,r){var n=qa(),a=r.SheetNames[e],i=r.Sheets[a]||{},s=(r||{}).Workbook||{},o=(s.Sheets||[])[e]||{},l=Array.isArray(i),c=t.biff==8,u,h="",m=[],f=ir(i["!ref"]||"A1"),v=c?65536:16384;if(f.e.c>255||f.e.r>=v){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");f.e.c=Math.min(f.e.c,255),f.e.r=Math.min(f.e.c,v-1)}Ke(n,2057,i_(r,16,t)),Ke(n,13,Fi(1)),Ke(n,12,Fi(100)),Ke(n,15,Ta(!0)),Ke(n,17,Ta(!1)),Ke(n,16,Fc(.001)),Ke(n,95,Ta(!0)),Ke(n,42,Ta(!1)),Ke(n,43,Ta(!1)),Ke(n,130,Fi(1)),Ke(n,128,NL()),Ke(n,131,Ta(!1)),Ke(n,132,Ta(!1)),c&&bM(n,i["!cols"]),Ke(n,512,vL(f,t)),c&&(i["!links"]=[]);for(var x=f.s.r;x<=f.e.r;++x){h=gn(x);for(var w=f.s.c;w<=f.e.c;++w){x===f.s.r&&(m[w]=Vr(w)),u=m[w]+h;var _=l?(i[x]||[])[w]:i[u];_&&(kM(n,_,x,w,t),c&&_.l&&i["!links"].push([u,_.l]))}}var b=o.CodeName||o.name||a;return c&&Ke(n,574,oL((s.Views||[])[0])),c&&(i["!merges"]||[]).length&&Ke(n,229,ML(i["!merges"])),c&&yM(n,i),Ke(n,442,c6(b)),c&&_M(n,i),Ke(n,10),n.end()}function NM(e,t,r){var n=qa(),a=(e||{}).Workbook||{},i=a.Sheets||[],s=a.WBProps||{},o=r.biff==8,l=r.biff==5;if(Ke(n,2057,i_(e,5,r)),r.bookType=="xla"&&Ke(n,135),Ke(n,225,o?Fi(1200):null),Ke(n,193,E7(2)),l&&Ke(n,191),l&&Ke(n,192),Ke(n,226),Ke(n,92,X7("SheetJS",r)),Ke(n,66,Fi(o?1200:1252)),o&&Ke(n,353,Fi(0)),o&&Ke(n,448),Ke(n,317,tP(e.SheetNames.length)),o&&e.vbaraw&&Ke(n,211),o&&e.vbaraw){var c=s.CodeName||"ThisWorkbook";Ke(n,442,c6(c))}Ke(n,156,Fi(17)),Ke(n,25,Ta(!1)),Ke(n,18,Ta(!1)),Ke(n,19,Fi(0)),o&&Ke(n,431,Ta(!1)),o&&Ke(n,444,Fi(0)),Ke(n,61,iL()),Ke(n,64,Ta(!1)),Ke(n,141,Fi(0)),Ke(n,34,Ta(nD(e)=="true")),Ke(n,14,Ta(!0)),o&&Ke(n,439,Ta(!1)),Ke(n,218,Fi(0)),xM(n,e,r),vM(n,e.SSF,r),wM(n,r),o&&Ke(n,352,Ta(!1));var u=n.end(),h=qa();o&&Ke(h,140,XL()),o&&r.Strings&&fM(h,252,Q7(r.Strings)),Ke(h,10);var m=h.end(),f=qa(),v=0,x=0;for(x=0;x<e.SheetNames.length;++x)v+=(o?12:11)+(o?2:1)*e.SheetNames[x].length;var w=u.length+v+m.length;for(x=0;x<e.SheetNames.length;++x){var _=i[x]||{};Ke(f,133,J7({pos:w,hs:_.Hidden||0,dt:0,name:e.SheetNames[x]},r)),w+=t[x].length}var b=f.end();if(v!=b.length)throw new Error("BS8 "+v+" != "+b.length);var y=[];return u.length&&y.push(u),b.length&&y.push(b),m.length&&y.push(m),$n(y)}function EM(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=Mr(Nt)),e&&e.SSF&&(gu(),Up(e.SSF),r.revssf=$p(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,v_(r),r.cellXfs=[],Ll(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var a=0;a<e.SheetNames.length;++a)n[n.length]=SM(a,r,e);return n.unshift(NM(e,n,r)),$n(n)}function rN(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var a=Ga(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var i=t||{};switch(i.biff||2){case 8:case 5:return EM(e,t);case 4:case 3:case 2:return gM(e,t)}throw new Error("invalid type "+i.bookType+" for BIFF")}function Uy(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var i=e.match(/<\/table/i),s=a.index,o=i&&i.index||e.length,l=uF(e.slice(s,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,u=0,h=0,m=0,f={s:{r:1e7,c:1e7},e:{r:0,c:0}},v=[];for(s=0;s<l.length;++s){var x=l[s].trim(),w=x.slice(0,3).toLowerCase();if(w=="<tr"){if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}u=0;continue}if(!(w!="<td"&&w!="<th")){var _=x.split(/<\/t[dh]>/i);for(o=0;o<_.length;++o){var b=_[o].trim();if(b.match(/<t[dh]/i)){for(var y=b,N=0;y.charAt(0)=="<"&&(N=y.indexOf(">"))>-1;)y=y.slice(N+1);for(var R=0;R<v.length;++R){var P=v[R];P.s.c==u&&P.s.r<c&&c<=P.e.r&&(u=P.e.c+1,R=-1)}var F=Ct(b.slice(0,b.indexOf(">")));m=F.colspan?+F.colspan:1,((h=+F.rowspan)>1||m>1)&&v.push({s:{r:c,c:u},e:{r:c+(h||1)-1,c:u+m-1}});var C=F.t||F["data-t"]||"";if(!y.length){u+=m;continue}if(y=ES(y),f.s.r>c&&(f.s.r=c),f.e.r<c&&(f.e.r=c),f.s.c>u&&(f.s.c=u),f.e.c<u&&(f.e.c=u),!y.length){u+=m;continue}var A={t:"s",v:y};r.raw||!y.trim().length||C=="s"||(y==="TRUE"?A={t:"b",v:!0}:y==="FALSE"?A={t:"b",v:!1}:isNaN(cs(y))?isNaN(au(y).getDate())||(A={t:"d",v:Dr(y)},r.cellDates||(A={t:"n",v:Rn(A.v)}),A.z=r.dateNF||Nt[14]):A={t:"n",v:cs(y)}),r.dense?(n[c]||(n[c]=[]),n[c][u]=A):n[Et({r:c,c:u})]=A,u+=m}}}}return n["!ref"]=Ut(f),v.length&&(n["!merges"]=v),n}function AM(e,t,r,n){for(var a=e["!merges"]||[],i=[],s=t.s.c;s<=t.e.c;++s){for(var o=0,l=0,c=0;c<a.length;++c)if(!(a[c].s.r>r||a[c].s.c>s)&&!(a[c].e.r<r||a[c].e.c<s)){if(a[c].s.r<r||a[c].s.c<s){o=-1;break}o=a[c].e.r-a[c].s.r+1,l=a[c].e.c-a[c].s.c+1;break}if(!(o<0)){var u=Et({r,c:s}),h=n.dense?(e[r]||[])[s]:e[u],m=h&&h.v!=null&&(h.h||qv(h.w||(wo(h),h.w)||""))||"",f={};o>1&&(f.rowspan=o),l>1&&(f.colspan=l),n.editable?m='<span contenteditable="true">'+m+"</span>":h&&(f["data-t"]=h&&h.t||"z",h.v!=null&&(f["data-v"]=h.v),h.z!=null&&(f["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(m='<a href="'+h.l.Target+'">'+m+"</a>")),f.id=(n.id||"sjs")+"-"+u,i.push(Xe("td",m,f))}}var v="<tr>";return v+i.join("")+"</tr>"}var TM='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',CM="</body></html>";function FM(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Fl(Uy(r[0],t),t);var n=b_();return r.forEach(function(a,i){k_(n,Uy(a,t),"Sheet"+(i+1))}),n}function LM(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function nN(e,t){var r=t||{},n=r.header!=null?r.header:TM,a=r.footer!=null?r.footer:CM,i=[n],s=Ga(e["!ref"]);r.dense=Array.isArray(e),i.push(LM(e,s,r));for(var o=s.s.r;o<=s.e.r;++o)i.push(AM(e,s,o,r));return i.push("</table>"+a),i.join("")}function aN(e,t,r){var n=r||{},a=0,i=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var s=typeof n.origin=="string"?qr(n.origin):n.origin;a=s.r,i=s.c}var o=t.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:a,c:i}};if(e["!ref"]){var u=Ga(e["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),a==-1&&(c.e.r=a=u.e.r+1)}var h=[],m=0,f=e["!rows"]||(e["!rows"]=[]),v=0,x=0,w=0,_=0,b=0,y=0;for(e["!cols"]||(e["!cols"]=[]);v<o.length&&x<l;++v){var N=o[v];if(zy(N)){if(n.display)continue;f[x]={hidden:!0}}var R=N.children;for(w=_=0;w<R.length;++w){var P=R[w];if(!(n.display&&zy(P))){var F=P.hasAttribute("data-v")?P.getAttribute("data-v"):P.hasAttribute("v")?P.getAttribute("v"):ES(P.innerHTML),C=P.getAttribute("data-z")||P.getAttribute("z");for(m=0;m<h.length;++m){var A=h[m];A.s.c==_+i&&A.s.r<x+a&&x+a<=A.e.r&&(_=A.e.c+1-i,m=-1)}y=+P.getAttribute("colspan")||1,((b=+P.getAttribute("rowspan")||1)>1||y>1)&&h.push({s:{r:x+a,c:_+i},e:{r:x+a+(b||1)-1,c:_+i+(y||1)-1}});var W={t:"s",v:F},L=P.getAttribute("data-t")||P.getAttribute("t")||"";F!=null&&(F.length==0?W.t=L||"z":n.raw||F.trim().length==0||L=="s"||(F==="TRUE"?W={t:"b",v:!0}:F==="FALSE"?W={t:"b",v:!1}:isNaN(cs(F))?isNaN(au(F).getDate())||(W={t:"d",v:Dr(F)},n.cellDates||(W={t:"n",v:Rn(W.v)}),W.z=n.dateNF||Nt[14]):W={t:"n",v:cs(F)})),W.z===void 0&&C!=null&&(W.z=C);var I="",V=P.getElementsByTagName("A");if(V&&V.length)for(var Q=0;Q<V.length&&!(V[Q].hasAttribute("href")&&(I=V[Q].getAttribute("href"),I.charAt(0)!="#"));++Q);I&&I.charAt(0)!="#"&&(W.l={Target:I}),n.dense?(e[x+a]||(e[x+a]=[]),e[x+a][_+i]=W):e[Et({c:_+i,r:x+a})]=W,c.e.c<_+i&&(c.e.c=_+i),_+=y}}++x}return h.length&&(e["!merges"]=(e["!merges"]||[]).concat(h)),c.e.r=Math.max(c.e.r,x-1+a),e["!ref"]=Ut(c),x>=l&&(e["!fullref"]=Ut((c.e.r=o.length-v+x-1+a,c))),e}function iN(e,t){var r=t||{},n=r.dense?[]:{};return aN(n,e,t)}function PM(e,t){return Fl(iN(e,t),t)}function zy(e){var t="",r=IM(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function IM(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function OM(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=ar(t.replace(/<[^>]*>/g,""));return[r]}var $y={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function sN(e,t){var r=t||{},n=Gv(e),a=[],i,s,o={name:""},l="",c=0,u,h,m={},f=[],v=r.dense?[]:{},x,w,_={value:""},b="",y=0,N=[],R=-1,P=-1,F={s:{r:1e6,c:1e7},e:{r:0,c:0}},C=0,A={},W=[],L={},I=0,V=0,Q=[],ue=1,me=1,pe=[],oe={Names:[]},G={},ve=["",""],_e=[],E={},j="",O=0,B=!1,Y=!1,le=0;for(uh.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");x=uh.exec(n);)switch(x[3]=x[3].replace(/_.*$/,"")){case"table":case"工作表":x[1]==="/"?(F.e.c>=F.s.c&&F.e.r>=F.s.r?v["!ref"]=Ut(F):v["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=F.e.r&&(v["!fullref"]=v["!ref"],F.e.r=r.sheetRows-1,v["!ref"]=Ut(F)),W.length&&(v["!merges"]=W),Q.length&&(v["!rows"]=Q),u.name=u.名称||u.name,typeof JSON<"u"&&JSON.stringify(u),f.push(u.name),m[u.name]=v,Y=!1):x[0].charAt(x[0].length-2)!=="/"&&(u=Ct(x[0],!1),R=P=-1,F.s.r=F.s.c=1e7,F.e.r=F.e.c=0,v=r.dense?[]:{},W=[],Q=[],Y=!0);break;case"table-row-group":x[1]==="/"?--C:++C;break;case"table-row":case"行":if(x[1]==="/"){R+=ue,ue=1;break}if(h=Ct(x[0],!1),h.行号?R=h.行号-1:R==-1&&(R=0),ue=+h["number-rows-repeated"]||1,ue<10)for(le=0;le<ue;++le)C>0&&(Q[R+le]={level:C});P=-1;break;case"covered-table-cell":x[1]!=="/"&&++P,r.sheetStubs&&(r.dense?(v[R]||(v[R]=[]),v[R][P]={t:"z"}):v[Et({r:R,c:P})]={t:"z"}),b="",N=[];break;case"table-cell":case"数据":if(x[0].charAt(x[0].length-2)==="/")++P,_=Ct(x[0],!1),me=parseInt(_["number-columns-repeated"]||"1",10),w={t:"z",v:null},_.formula&&r.cellFormula!=!1&&(w.f=Dy(ar(_.formula))),(_.数据类型||_["value-type"])=="string"&&(w.t="s",w.v=ar(_["string-value"]||""),r.dense?(v[R]||(v[R]=[]),v[R][P]=w):v[Et({r:R,c:P})]=w),P+=me-1;else if(x[1]!=="/"){++P,b="",y=0,N=[],me=1;var fe=ue?R+ue-1:R;if(P>F.e.c&&(F.e.c=P),P<F.s.c&&(F.s.c=P),R<F.s.r&&(F.s.r=R),fe>F.e.r&&(F.e.r=fe),_=Ct(x[0],!1),_e=[],E={},w={t:_.数据类型||_["value-type"],v:null},r.cellFormula)if(_.formula&&(_.formula=ar(_.formula)),_["number-matrix-columns-spanned"]&&_["number-matrix-rows-spanned"]&&(I=parseInt(_["number-matrix-rows-spanned"],10)||0,V=parseInt(_["number-matrix-columns-spanned"],10)||0,L={s:{r:R,c:P},e:{r:R+I-1,c:P+V-1}},w.F=Ut(L),pe.push([L,w.F])),_.formula)w.f=Dy(_.formula);else for(le=0;le<pe.length;++le)R>=pe[le][0].s.r&&R<=pe[le][0].e.r&&P>=pe[le][0].s.c&&P<=pe[le][0].e.c&&(w.F=pe[le][1]);switch((_["number-columns-spanned"]||_["number-rows-spanned"])&&(I=parseInt(_["number-rows-spanned"],10)||0,V=parseInt(_["number-columns-spanned"],10)||0,L={s:{r:R,c:P},e:{r:R+I-1,c:P+V-1}},W.push(L)),_["number-columns-repeated"]&&(me=parseInt(_["number-columns-repeated"],10)),w.t){case"boolean":w.t="b",w.v=Or(_["boolean-value"]);break;case"float":w.t="n",w.v=parseFloat(_.value);break;case"percentage":w.t="n",w.v=parseFloat(_.value);break;case"currency":w.t="n",w.v=parseFloat(_.value);break;case"date":w.t="d",w.v=Dr(_["date-value"]),r.cellDates||(w.t="n",w.v=Rn(w.v)),w.z="m/d/yy";break;case"time":w.t="n",w.v=oF(_["time-value"])/86400,r.cellDates&&(w.t="d",w.v=Wp(w.v)),w.z="HH:MM:SS";break;case"number":w.t="n",w.v=parseFloat(_.数据数值);break;default:if(w.t==="string"||w.t==="text"||!w.t)w.t="s",_["string-value"]!=null&&(b=ar(_["string-value"]),N=[]);else throw new Error("Unsupported value type "+w.t)}}else{if(B=!1,w.t==="s"&&(w.v=b||"",N.length&&(w.R=N),B=y==0),G.Target&&(w.l=G),_e.length>0&&(w.c=_e,_e=[]),b&&r.cellText!==!1&&(w.w=b),B&&(w.t="z",delete w.v),(!B||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=R))for(var ce=0;ce<ue;++ce){if(me=parseInt(_["number-columns-repeated"]||"1",10),r.dense)for(v[R+ce]||(v[R+ce]=[]),v[R+ce][P]=ce==0?w:Mr(w);--me>0;)v[R+ce][P+me]=Mr(w);else for(v[Et({r:R+ce,c:P})]=w;--me>0;)v[Et({r:R+ce,c:P+me})]=Mr(w);F.e.c<=P&&(F.e.c=P)}me=parseInt(_["number-columns-repeated"]||"1",10),P+=me-1,me=0,w={},b="",N=[]}G={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(x[1]==="/"){if((i=a.pop())[0]!==x[3])throw"Bad state: "+i}else x[0].charAt(x[0].length-2)!=="/"&&a.push([x[3],!0]);break;case"annotation":if(x[1]==="/"){if((i=a.pop())[0]!==x[3])throw"Bad state: "+i;E.t=b,N.length&&(E.R=N),E.a=j,_e.push(E)}else x[0].charAt(x[0].length-2)!=="/"&&a.push([x[3],!1]);j="",O=0,b="",y=0,N=[];break;case"creator":x[1]==="/"?j=n.slice(O,x.index):O=x.index+x[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(x[1]==="/"){if((i=a.pop())[0]!==x[3])throw"Bad state: "+i}else x[0].charAt(x[0].length-2)!=="/"&&a.push([x[3],!1]);b="",y=0,N=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(x[1]==="/"){if(A[o.name]=l,(i=a.pop())[0]!==x[3])throw"Bad state: "+i}else x[0].charAt(x[0].length-2)!=="/"&&(l="",o=Ct(x[0],!1),a.push([x[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":s=Ct(x[0],!1),l+=$y[x[3]][s.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":s=Ct(x[0],!1),l+=$y[x[3]][s.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(x[0].slice(-2)==="/>")break;if(x[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(c,x.index);break}else c=x.index+x[0].length;break;case"named-range":s=Ct(x[0],!1),ve=xg(s["cell-range-address"]);var de={Name:s.name,Ref:ve[0]+"!"+ve[1]};Y&&(de.Sheet=f.length),oe.Names.push(de);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(x[1]==="/"&&(!_||!_["string-value"])){var Ce=OM(n.slice(y,x.index));b=(b.length>0?b+`
`:"")+Ce[0]}else Ct(x[0],!1),y=x.index+x[0].length;break;case"s":break;case"database-range":if(x[1]==="/")break;try{ve=xg(Ct(x[0])["target-range-address"]),m[ve[0]]["!autofilter"]={ref:ve[1]}}catch{}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(x[1]!=="/"){if(G=Ct(x[0],!1),!G.href)break;G.Target=ar(G.href),delete G.href,G.Target.charAt(0)=="#"&&G.Target.indexOf(".")>-1?(ve=xg(G.Target.slice(1)),G.Target="#"+ve[0]+"!"+ve[1]):G.Target.match(/^\.\.[\\\/]/)&&(G.Target=G.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(x[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(r.WTF)throw new Error(x)}}var X={Sheets:m,SheetNames:f,Workbook:oe};return r.bookSheets&&delete X.Sheets,X}function Wy(e,t){t=t||{},Ci(e,"META-INF/manifest.xml")&&o7(kn(e,"META-INF/manifest.xml"),t);var r=ci(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=sN(br(r),t);return Ci(e,"meta.xml")&&(n.Props=YS(kn(e,"meta.xml"))),n}function Hy(e,t){return sN(e,t)}var jM=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+ch({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return xn+t}}(),Vy=function(){var e=function(i){return _r(i).replace(/  +/g,function(s){return'<text:s text:c="'+s.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(i,s,o){var l=[];l.push('      <table:table table:name="'+_r(s.SheetNames[o])+`" table:style-name="ta1">
`);var c=0,u=0,h=Ga(i["!ref"]||"A1"),m=i["!merges"]||[],f=0,v=Array.isArray(i);if(i["!cols"])for(u=0;u<=h.e.c;++u)l.push("        <table:table-column"+(i["!cols"][u]?' table:style-name="co'+i["!cols"][u].ods+'"':"")+`></table:table-column>
`);var x="",w=i["!rows"]||[];for(c=0;c<h.s.r;++c)x=w[c]?' table:style-name="ro'+w[c].ods+'"':"",l.push("        <table:table-row"+x+`></table:table-row>
`);for(;c<=h.e.r;++c){for(x=w[c]?' table:style-name="ro'+w[c].ods+'"':"",l.push("        <table:table-row"+x+`>
`),u=0;u<h.s.c;++u)l.push(t);for(;u<=h.e.c;++u){var _=!1,b={},y="";for(f=0;f!=m.length;++f)if(!(m[f].s.c>u)&&!(m[f].s.r>c)&&!(m[f].e.c<u)&&!(m[f].e.r<c)){(m[f].s.c!=u||m[f].s.r!=c)&&(_=!0),b["table:number-columns-spanned"]=m[f].e.c-m[f].s.c+1,b["table:number-rows-spanned"]=m[f].e.r-m[f].s.r+1;break}if(_){l.push(r);continue}var N=Et({r:c,c:u}),R=v?(i[c]||[])[u]:i[N];if(R&&R.f&&(b["table:formula"]=_r(tR(R.f)),R.F&&R.F.slice(0,N.length)==N)){var P=Ga(R.F);b["table:number-matrix-columns-spanned"]=P.e.c-P.s.c+1,b["table:number-matrix-rows-spanned"]=P.e.r-P.s.r+1}if(!R){l.push(t);continue}switch(R.t){case"b":y=R.v?"TRUE":"FALSE",b["office:value-type"]="boolean",b["office:boolean-value"]=R.v?"true":"false";break;case"n":y=R.w||String(R.v||0),b["office:value-type"]="float",b["office:value"]=R.v||0;break;case"s":case"str":y=R.v==null?"":R.v,b["office:value-type"]="string";break;case"d":y=R.w||Dr(R.v).toISOString(),b["office:value-type"]="date",b["office:date-value"]=Dr(R.v).toISOString(),b["table:style-name"]="ce1";break;default:l.push(t);continue}var F=e(y);if(R.l&&R.l.Target){var C=R.l.Target;C=C.charAt(0)=="#"?"#"+rR(C.slice(1)):C,C.charAt(0)!="#"&&!C.match(/^\w+:/)&&(C="../"+C),F=Xe("text:a",F,{"xlink:href":C.replace(/&/g,"&amp;")})}l.push("          "+Xe("table:table-cell",Xe("text:p",F,{}),b)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},a=function(i,s){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var o=0;s.SheetNames.map(function(c){return s.Sheets[c]}).forEach(function(c){if(c&&c["!cols"]){for(var u=0;u<c["!cols"].length;++u)if(c["!cols"][u]){var h=c["!cols"][u];if(h.width==null&&h.wpx==null&&h.wch==null)continue;bl(h),h.ods=o;var m=c["!cols"][u].wpx+"px";i.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+m+`"/>
`),i.push(`  </style:style>
`),++o}}});var l=0;s.SheetNames.map(function(c){return s.Sheets[c]}).forEach(function(c){if(c&&c["!rows"]){for(var u=0;u<c["!rows"].length;++u)if(c["!rows"][u]){c["!rows"][u].ods=l;var h=c["!rows"][u].hpx+"px";i.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+h+`"/>
`),i.push(`  </style:style>
`),++l}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(s,o){var l=[xn],c=ch({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),u=ch({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+c+u+`>
`),l.push(KS().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+c+`>
`),a(l,s),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var h=0;h!=s.SheetNames.length;++h)l.push(n(s.Sheets[s.SheetNames[h]],s,h));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function oN(e,t){if(t.bookType=="fods")return Vy(e,t);var r=Wv(),n="",a=[],i=[];return n="mimetype",Wt(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Wt(r,n,Vy(e,t)),a.push([n,"text/xml"]),i.push([n,"ContentFile"]),n="styles.xml",Wt(r,n,jM(e,t)),a.push([n,"text/xml"]),i.push([n,"StylesFile"]),n="meta.xml",Wt(r,n,xn+KS()),a.push([n,"text/xml"]),i.push([n,"MetadataFile"]),n="manifest.rdf",Wt(r,n,u7(i)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Wt(r,n,l7(a)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Ic(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function ux(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):br(Cl(e))}function RM(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):li(Ls(e))}function DM(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function Sl(e){var t=e.reduce(function(a,i){return a+i.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(a){r.set(a,n),n+=a.length}),r}function qy(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function MM(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,a=t+13;a>=t;--a)n=n*256+e[a];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function BM(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,a=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var i=0;a>=1;++i,a/=256)e[t+i]=a&255;e[t+15]|=r>=0?0:128}function xh(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function gr(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function rn(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function or(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],a=xh(e,r),i=a&7;a=Math.floor(a/8);var s=0,o;if(a==0)break;switch(i){case 0:{for(var l=r[0];e[r[0]++]>=128;);o=e.slice(l,r[0])}break;case 5:s=4,o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 1:s=8,o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 2:s=xh(e,r),o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(a," at offset ").concat(n))}var c={data:o,type:i};t[a]==null?t[a]=[c]:t[a].push(c)}return t}function Kn(e){var t=[];return e.forEach(function(r,n){r.forEach(function(a){a.data&&(t.push(gr(n*8+a.type)),a.type==2&&t.push(gr(a.data.length)),t.push(a.data))})}),Sl(t)}function g_(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function Ai(e){for(var t,r=[],n=[0];n[0]<e.length;){var a=xh(e,n),i=or(e.slice(n[0],n[0]+a));n[0]+=a;var s={id:rn(i[1][0].data),messages:[]};i[2].forEach(function(o){var l=or(o.data),c=rn(l[3][0].data);s.messages.push({meta:l,data:e.slice(n[0],n[0]+c)}),n[0]+=c}),(t=i[3])!=null&&t[0]&&(s.merge=rn(i[3][0].data)>>>0>0),r.push(s)}return r}function i0(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:gr(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:gr(+!!r.merge),type:0}]);var a=[];r.messages.forEach(function(s){a.push(s.data),s.meta[3]=[{type:0,data:gr(s.data.length)}],n[2].push({data:Kn(s.meta),type:2})});var i=Kn(n);t.push(gr(i.length)),t.push(i),a.forEach(function(s){return t.push(s)})}),Sl(t)}function UM(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=xh(t,r),a=[];r[0]<t.length;){var i=t[r[0]]&3;if(i==0){var s=t[r[0]++]>>2;if(s<60)++s;else{var o=s-59;s=t[r[0]],o>1&&(s|=t[r[0]+1]<<8),o>2&&(s|=t[r[0]+2]<<16),o>3&&(s|=t[r[0]+3]<<24),s>>>=0,s++,r[0]+=o}a.push(t.slice(r[0],r[0]+s)),r[0]+=s;continue}else{var l=0,c=0;if(i==1?(c=(t[r[0]]>>2&7)+4,l=(t[r[0]++]&224)<<3,l|=t[r[0]++]):(c=(t[r[0]++]>>2)+1,i==2?(l=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(l=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),a=[Sl(a)],l==0)throw new Error("Invalid offset 0");if(l>a[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(a.push(a[0].slice(-l)),c-=l;c>=a[a.length-1].length;)a.push(a[a.length-1]),c-=a[a.length-1].length;a.push(a[0].slice(-l,-l+c))}}var u=Sl(a);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function Ti(e){for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(UM(n,e.slice(r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Sl(t)}function s0(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),a=new Uint8Array(4);t.push(a);var i=gr(n),s=i.length;t.push(i),n<=60?(s++,t.push(new Uint8Array([n-1<<2]))):n<=256?(s+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(s+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(s+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(s+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),s+=n,a[0]=0,a[1]=s&255,a[2]=s>>8&255,a[3]=s>>16&255,r+=n}return Sl(t)}function zM(e,t,r,n){var a=Ic(e),i=a.getUint32(4,!0),s=(n>1?12:8)+qy(i&(n>1?3470:398))*4,o=-1,l=-1,c=NaN,u=new Date(2001,0,1);i&512&&(o=a.getUint32(s,!0),s+=4),s+=qy(i&(n>1?12288:4096))*4,i&16&&(l=a.getUint32(s,!0),s+=4),i&32&&(c=a.getFloat64(s,!0),s+=8),i&64&&(u.setTime(u.getTime()+a.getFloat64(s,!0)*1e3),s+=8);var h;switch(e[2]){case 0:break;case 2:h={t:"n",v:c};break;case 3:h={t:"s",v:t[l]};break;case 5:h={t:"d",v:u};break;case 6:h={t:"b",v:c>0};break;case 7:h={t:"n",v:c/86400};break;case 8:h={t:"e",v:0};break;case 9:if(o>-1)h={t:"s",v:r[o]};else if(l>-1)h={t:"s",v:t[l]};else if(!isNaN(c))h={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return h}function $M(e,t,r){var n=Ic(e),a=n.getUint32(8,!0),i=12,s=-1,o=-1,l=NaN,c=NaN,u=new Date(2001,0,1);a&1&&(l=MM(e,i),i+=16),a&2&&(c=n.getFloat64(i,!0),i+=8),a&4&&(u.setTime(u.getTime()+n.getFloat64(i,!0)*1e3),i+=8),a&8&&(o=n.getUint32(i,!0),i+=4),a&16&&(s=n.getUint32(i,!0),i+=4);var h;switch(e[1]){case 0:break;case 2:h={t:"n",v:l};break;case 3:h={t:"s",v:t[o]};break;case 5:h={t:"d",v:u};break;case 6:h={t:"b",v:c>0};break;case 7:h={t:"n",v:c/86400};break;case 8:h={t:"e",v:0};break;case 9:if(s>-1)h={t:"s",v:r[s]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:h={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return h}function _g(e,t){var r=new Uint8Array(32),n=Ic(r),a=12,i=0;switch(r[0]=5,e.t){case"n":r[1]=2,BM(r,a,e.v),i|=1,a+=16;break;case"b":r[1]=6,n.setFloat64(a,e.v?1:0,!0),i|=2,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(a,t.indexOf(e.v),!0),i|=8,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,i,!0),r.slice(0,a)}function wg(e,t){var r=new Uint8Array(32),n=Ic(r),a=12,i=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(a,e.v,!0),i|=32,a+=8;break;case"b":r[2]=6,n.setFloat64(a,e.v?1:0,!0),i|=32,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(a,t.indexOf(e.v),!0),i|=16,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,i,!0),r.slice(0,a)}function WM(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return zM(e,t,r,e[0]);case 5:return $M(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function da(e){var t=or(e);return xh(t[1][0].data)}function Gy(e,t){var r=or(t.data),n=rn(r[1][0].data),a=r[3],i=[];return(a||[]).forEach(function(s){var o=or(s.data),l=rn(o[1][0].data)>>>0;switch(n){case 1:i[l]=ux(o[3][0].data);break;case 8:{var c=e[da(o[9][0].data)][0],u=or(c.data),h=e[da(u[1][0].data)][0],m=rn(h.meta[1][0].data);if(m!=2001)throw new Error("2000 unexpected reference to ".concat(m));var f=or(h.data);i[l]=f[3].map(function(v){return ux(v.data)}).join("")}break}}),i}function HM(e,t){var r,n,a,i,s,o,l,c,u,h,m,f,v,x,w=or(e),_=rn(w[1][0].data)>>>0,b=rn(w[2][0].data)>>>0,y=((n=(r=w[8])==null?void 0:r[0])==null?void 0:n.data)&&rn(w[8][0].data)>0||!1,N,R;if((i=(a=w[7])==null?void 0:a[0])!=null&&i.data&&t!=0)N=(o=(s=w[7])==null?void 0:s[0])==null?void 0:o.data,R=(c=(l=w[6])==null?void 0:l[0])==null?void 0:c.data;else if((h=(u=w[4])==null?void 0:u[0])!=null&&h.data&&t!=1)N=(f=(m=w[4])==null?void 0:m[0])==null?void 0:f.data,R=(x=(v=w[3])==null?void 0:v[0])==null?void 0:x.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var P=y?4:1,F=Ic(N),C=[],A=0;A<N.length/2;++A){var W=F.getUint16(A*2,!0);W<65535&&C.push([A,W])}if(C.length!=b)throw"Expected ".concat(b," cells, found ").concat(C.length);var L=[];for(A=0;A<C.length-1;++A)L[C[A][0]]=R.subarray(C[A][1]*P,C[A+1][1]*P);return C.length>=1&&(L[C[C.length-1][0]]=R.subarray(C[C.length-1][1]*P)),{R:_,cells:L}}function VM(e,t){var r,n=or(t.data),a=(r=n==null?void 0:n[7])!=null&&r[0]?rn(n[7][0].data)>>>0>0?1:0:-1,i=g_(n[5],function(s){return HM(s,a)});return{nrows:rn(n[4][0].data)>>>0,data:i.reduce(function(s,o){return s[o.R]||(s[o.R]=[]),o.cells.forEach(function(l,c){if(s[o.R][c])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(c));s[o.R][c]=l}),s},[])}}function qM(e,t,r){var n,a=or(t.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(rn(a[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(i.e.c=(rn(a[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=Ut(i);var s=or(a[4][0].data),o=Gy(e,e[da(s[4][0].data)][0]),l=(n=s[17])!=null&&n[0]?Gy(e,e[da(s[17][0].data)][0]):[],c=or(s[3][0].data),u=0;c[1].forEach(function(h){var m=or(h.data),f=e[da(m[2][0].data)][0],v=rn(f.meta[1][0].data);if(v!=6002)throw new Error("6001 unexpected reference to ".concat(v));var x=VM(e,f);x.data.forEach(function(w,_){w.forEach(function(b,y){var N=Et({r:u+_,c:y}),R=WM(b,o,l);R&&(r[N]=R)})}),u+=x.nrows})}function GM(e,t){var r=or(t.data),n={"!ref":"A1"},a=e[da(r[2][0].data)],i=rn(a[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return qM(e,a[0],n),n}function XM(e,t){var r,n=or(t.data),a={name:(r=n[1])!=null&&r[0]?ux(n[1][0].data):"",sheets:[]},i=g_(n[2],da);return i.forEach(function(s){e[s].forEach(function(o){var l=rn(o.meta[1][0].data);l==6e3&&a.sheets.push(GM(e,o))})}),a}function KM(e,t){var r=b_(),n=or(t.data),a=g_(n[1],da);if(a.forEach(function(i){e[i].forEach(function(s){var o=rn(s.meta[1][0].data);if(o==2){var l=XM(e,s);l.sheets.forEach(function(c,u){k_(r,c,u==0?l.name:l.name+"_"+u,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function yg(e){var t,r,n,a,i={},s=[];if(e.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var c;try{c=Ti(l.content)}catch(h){return console.log("?? "+l.content.length+" "+(h.message||h))}var u;try{u=Ai(c)}catch(h){return console.log("## "+(h.message||h))}u.forEach(function(h){i[h.id]=h.messages,s.push(h.id)})}}),!s.length)throw new Error("File has no messages");var o=((a=(n=(r=(t=i==null?void 0:i[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&rn(i[1][0].meta[1][0].data)==1&&i[1][0];if(o||s.forEach(function(l){i[l].forEach(function(c){var u=rn(c.meta[1][0].data)>>>0;if(u==1)if(!o)o=c;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return KM(i,o)}function YM(e,t,r){var n,a,i,s;if(!((n=e[6])!=null&&n[0])||!((a=e[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var o=((s=(i=e[8])==null?void 0:i[0])==null?void 0:s.data)&&rn(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,c=Ic(e[7][0].data),u=0,h=[],m=Ic(e[4][0].data),f=0,v=[],x=0;x<t.length;++x){if(t[x]==null){c.setUint16(x*2,65535,!0),m.setUint16(x*2,65535);continue}c.setUint16(x*2,u,!0),m.setUint16(x*2,f,!0);var w,_;switch(typeof t[x]){case"string":w=_g({t:"s",v:t[x]},r),_=wg({t:"s",v:t[x]},r);break;case"number":w=_g({t:"n",v:t[x]},r),_=wg({t:"n",v:t[x]},r);break;case"boolean":w=_g({t:"b",v:t[x]},r),_=wg({t:"b",v:t[x]},r);break;default:throw new Error("Unsupported value "+t[x])}h.push(w),u+=w.length,v.push(_),f+=_.length,++l}for(e[2][0].data=gr(l);x<e[7][0].data.length/2;++x)c.setUint16(x*2,65535,!0),m.setUint16(x*2,65535,!0);return e[6][0].data=Sl(h),e[3][0].data=Sl(v),l}function JM(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Ga(r["!ref"]);n.s.r=n.s.c=0;var a=!1;n.e.c>9&&(a=!0,n.e.c=9),n.e.r>49&&(a=!0,n.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(Ut(n)));var i=pp(r,{range:n,header:1}),s=["~Sh33tJ5~"];i.forEach(function(j){return j.forEach(function(O){typeof O=="string"&&s.push(O)})});var o={},l=[],c=vt.read(t.numbers,{type:"base64"});c.FileIndex.map(function(j,O){return[j,c.FullPaths[O]]}).forEach(function(j){var O=j[0],B=j[1];if(O.type==2&&O.name.match(/\.iwa/)){var Y=O.content,le=Ti(Y),fe=Ai(le);fe.forEach(function(ce){l.push(ce.id),o[ce.id]={deps:[],location:B,type:rn(ce.messages[0].meta[1][0].data)}})}}),l.sort(function(j,O){return j-O});var u=l.filter(function(j){return j>1}).map(function(j){return[j,gr(j)]});c.FileIndex.map(function(j,O){return[j,c.FullPaths[O]]}).forEach(function(j){var O=j[0];if(j[1],!!O.name.match(/\.iwa/)){var B=Ai(Ti(O.content));B.forEach(function(Y){Y.messages.forEach(function(le){u.forEach(function(fe){Y.messages.some(function(ce){return rn(ce.meta[1][0].data)!=11006&&DM(ce.data,fe[1])})&&o[fe[0]].deps.push(Y.id)})})})}});for(var h=vt.find(c,o[1].location),m=Ai(Ti(h.content)),f,v=0;v<m.length;++v){var x=m[v];x.id==1&&(f=x)}var w=da(or(f.messages[0].data)[1][0].data);for(h=vt.find(c,o[w].location),m=Ai(Ti(h.content)),v=0;v<m.length;++v)x=m[v],x.id==w&&(f=x);for(w=da(or(f.messages[0].data)[2][0].data),h=vt.find(c,o[w].location),m=Ai(Ti(h.content)),v=0;v<m.length;++v)x=m[v],x.id==w&&(f=x);for(w=da(or(f.messages[0].data)[2][0].data),h=vt.find(c,o[w].location),m=Ai(Ti(h.content)),v=0;v<m.length;++v)x=m[v],x.id==w&&(f=x);var _=or(f.messages[0].data);{_[6][0].data=gr(n.e.r+1),_[7][0].data=gr(n.e.c+1);var b=da(_[46][0].data),y=vt.find(c,o[b].location),N=Ai(Ti(y.content));{for(var R=0;R<N.length&&N[R].id!=b;++R);if(N[R].id!=b)throw"Bad ColumnRowUIDMapArchive";var P=or(N[R].messages[0].data);P[1]=[],P[2]=[],P[3]=[];for(var F=0;F<=n.e.c;++F){var C=[];C[1]=C[2]=[{type:0,data:gr(F+420690)}],P[1].push({type:2,data:Kn(C)}),P[2].push({type:0,data:gr(F)}),P[3].push({type:0,data:gr(F)})}P[4]=[],P[5]=[],P[6]=[];for(var A=0;A<=n.e.r;++A)C=[],C[1]=C[2]=[{type:0,data:gr(A+726270)}],P[4].push({type:2,data:Kn(C)}),P[5].push({type:0,data:gr(A)}),P[6].push({type:0,data:gr(A)});N[R].messages[0].data=Kn(P)}y.content=s0(i0(N)),y.size=y.content.length,delete _[46];var W=or(_[4][0].data);{W[7][0].data=gr(n.e.r+1);var L=or(W[1][0].data),I=da(L[2][0].data);y=vt.find(c,o[I].location),N=Ai(Ti(y.content));{if(N[0].id!=I)throw"Bad HeaderStorageBucket";var V=or(N[0].messages[0].data);for(A=0;A<i.length;++A){var Q=or(V[2][0].data);Q[1][0].data=gr(A),Q[4][0].data=gr(i[A].length),V[2][A]={type:V[2][0].type,data:Kn(Q)}}N[0].messages[0].data=Kn(V)}y.content=s0(i0(N)),y.size=y.content.length;var ue=da(W[2][0].data);y=vt.find(c,o[ue].location),N=Ai(Ti(y.content));{if(N[0].id!=ue)throw"Bad HeaderStorageBucket";for(V=or(N[0].messages[0].data),F=0;F<=n.e.c;++F)Q=or(V[2][0].data),Q[1][0].data=gr(F),Q[4][0].data=gr(n.e.r+1),V[2][F]={type:V[2][0].type,data:Kn(Q)};N[0].messages[0].data=Kn(V)}y.content=s0(i0(N)),y.size=y.content.length;var me=da(W[4][0].data);(function(){for(var j=vt.find(c,o[me].location),O=Ai(Ti(j.content)),B,Y=0;Y<O.length;++Y){var le=O[Y];le.id==me&&(B=le)}var fe=or(B.messages[0].data);{fe[3]=[];var ce=[];s.forEach(function(X,$e){ce[1]=[{type:0,data:gr($e)}],ce[2]=[{type:0,data:gr(1)}],ce[3]=[{type:2,data:RM(X)}],fe[3].push({type:2,data:Kn(ce)})})}B.messages[0].data=Kn(fe);var de=i0(O),Ce=s0(de);j.content=Ce,j.size=j.content.length})();var pe=or(W[3][0].data);{var oe=pe[1][0];delete pe[2];var G=or(oe.data);{var ve=da(G[2][0].data);(function(){for(var j=vt.find(c,o[ve].location),O=Ai(Ti(j.content)),B,Y=0;Y<O.length;++Y){var le=O[Y];le.id==ve&&(B=le)}var fe=or(B.messages[0].data);{delete fe[6],delete pe[7];var ce=new Uint8Array(fe[5][0].data);fe[5]=[];for(var de=0,Ce=0;Ce<=n.e.r;++Ce){var X=or(ce);de+=YM(X,i[Ce],s),X[1][0].data=gr(Ce),fe[5].push({data:Kn(X),type:2})}fe[1]=[{type:0,data:gr(n.e.c+1)}],fe[2]=[{type:0,data:gr(n.e.r+1)}],fe[3]=[{type:0,data:gr(de)}],fe[4]=[{type:0,data:gr(n.e.r+1)}]}B.messages[0].data=Kn(fe);var $e=i0(O),be=s0($e);j.content=be,j.size=j.content.length})()}oe.data=Kn(G)}W[3][0].data=Kn(pe)}_[4][0].data=Kn(W)}f.messages[0].data=Kn(_);var _e=i0(m),E=s0(_e);return h.content=E,h.size=h.content.length,c}function lN(e){return function(r){for(var n=0;n!=e.length;++n){var a=e[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function x_(e){lN([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function v_(e){lN([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function ZM(e){return Xt.WS.indexOf(e)>-1?"sheet":e==Xt.CS?"chart":e==Xt.DS?"dialog":e==Xt.MS?"macro":e&&e.length?e:"sheet"}function QM(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,ZM(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function eB(e,t,r,n,a,i,s,o,l,c,u,h){try{i[n]=Lf(ci(e,r,!0),t);var m=kn(e,t),f;switch(o){case"sheet":f=bD(m,t,a,l,i[n],c,u,h);break;case"chart":if(f=kD(m,t,a,l,i[n],c,u,h),!f||!f["!drawel"])break;var v=mf(f["!drawel"].Target,t),x=fh(v),w=cO(ci(e,v,!0),Lf(ci(e,x,!0),v)),_=mf(w,v),b=fh(_);f=Y9(ci(e,_,!0),_,l,Lf(ci(e,b,!0),_),c,f);break;case"macro":f=SD(m,t,a,l,i[n],c,u,h);break;case"dialog":f=ND(m,t,a,l,i[n],c,u,h);break;default:throw new Error("Unrecognized sheet type "+o)}s[n]=f;var y=[];i&&i[n]&&nn(i[n]).forEach(function(N){var R="";if(i[n][N].Type==Xt.CMNT){R=mf(i[n][N].Target,t);var P=CD(kn(e,R,!0),R,l);if(!P||!P.length)return;Py(f,P,!1)}i[n][N].Type==Xt.TCMNT&&(R=mf(i[n][N].Target,t),y=y.concat(fO(kn(e,R,!0),l)))}),y&&y.length&&Py(f,y,!0,l.people||[])}catch(N){if(l.WTF)throw N}}function Ni(e){return e.charAt(0)=="/"?e.slice(1):e}function tB(e,t){if(gu(),t=t||{},x_(t),Ci(e,"META-INF/manifest.xml")||Ci(e,"objectdata.xml"))return Wy(e,t);if(Ci(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof yg<"u"){if(e.FileIndex)return yg(e);var r=vt.utils.cfb_new();return Qw(e).forEach(function(Q){Wt(r,Q,hF(e,Q))}),yg(r)}throw new Error("Unsupported NUMBERS file")}if(!Ci(e,"[Content_Types].xml"))throw Ci(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Ci(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=Qw(e),a=i7(ci(e,"[Content_Types].xml")),i=!1,s,o;if(a.workbooks.length===0&&(o="xl/workbook.xml",kn(e,o,!0)&&a.workbooks.push(o)),a.workbooks.length===0){if(o="xl/workbook.bin",!kn(e,o,!0))throw new Error("Could not find workbook");a.workbooks.push(o),i=!0}a.workbooks[0].slice(-3)=="bin"&&(i=!0);var l={},c={};if(!t.bookSheets&&!t.bookProps){if(Pf=[],a.sst)try{Pf=TD(kn(e,Ni(a.sst)),a.sst,t)}catch(Q){if(t.WTF)throw Q}t.cellStyles&&a.themes.length&&(l=AD(ci(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],t)),a.style&&(c=ED(kn(e,Ni(a.style)),a.style,l,t))}a.links.map(function(Q){try{var ue=Lf(ci(e,fh(Ni(Q))),Q);return LD(kn(e,Ni(Q)),ue,Q,t)}catch{}});var u=yD(kn(e,Ni(a.workbooks[0])),a.workbooks[0],t),h={},m="";a.coreprops.length&&(m=kn(e,Ni(a.coreprops[0]),!0),m&&(h=YS(m)),a.extprops.length!==0&&(m=kn(e,Ni(a.extprops[0]),!0),m&&h7(m,h,t)));var f={};(!t.bookSheets||t.bookProps)&&a.custprops.length!==0&&(m=ci(e,Ni(a.custprops[0]),!0),m&&(f=p7(m,t)));var v={};if((t.bookSheets||t.bookProps)&&(u.Sheets?s=u.Sheets.map(function(ue){return ue.name}):h.Worksheets&&h.SheetNames.length>0&&(s=h.SheetNames),t.bookProps&&(v.Props=h,v.Custprops=f),t.bookSheets&&typeof s<"u"&&(v.SheetNames=s),t.bookSheets?v.SheetNames:t.bookProps))return v;s={};var x={};t.bookDeps&&a.calcchain&&(x=FD(kn(e,Ni(a.calcchain)),a.calcchain));var w=0,_={},b,y;{var N=u.Sheets;h.Worksheets=N.length,h.SheetNames=[];for(var R=0;R!=N.length;++R)h.SheetNames[R]=N[R].name}var P=i?"bin":"xml",F=a.workbooks[0].lastIndexOf("/"),C=(a.workbooks[0].slice(0,F+1)+"_rels/"+a.workbooks[0].slice(F+1)+".rels").replace(/^\//,"");Ci(e,C)||(C="xl/_rels/workbook."+P+".rels");var A=Lf(ci(e,C,!0),C.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(t.xlmeta=PD(kn(e,Ni(a.metadata[0])),a.metadata[0],t)),(a.people||[]).length>=1&&(t.people=dO(kn(e,Ni(a.people[0])),t)),A&&(A=QM(A,u.Sheets));var W=kn(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(w=0;w!=h.Worksheets;++w){var L="sheet";if(A&&A[w]?(b="xl/"+A[w][1].replace(/[\/]?xl\//,""),Ci(e,b)||(b=A[w][1]),Ci(e,b)||(b=C.replace(/_rels\/.*$/,"")+A[w][1]),L=A[w][2]):(b="xl/worksheets/sheet"+(w+1-W)+"."+P,b=b.replace(/sheet0\./,"sheet.")),y=b.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(w!=t.sheets)continue e;break;case"string":if(h.SheetNames[w].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var I=!1,V=0;V!=t.sheets.length;++V)typeof t.sheets[V]=="number"&&t.sheets[V]==w&&(I=1),typeof t.sheets[V]=="string"&&t.sheets[V].toLowerCase()==h.SheetNames[w].toLowerCase()&&(I=1);if(!I)continue e}}eB(e,b,y,h.SheetNames[w],w,_,s,L,t,u,l,c)}return v={Directory:a,Workbook:u,Props:h,Custprops:f,Deps:x,Sheets:s,SheetNames:h.SheetNames,Strings:Pf,Styles:c,Themes:l,SSF:Mr(Nt)},t&&t.bookFiles&&(e.files?(v.keys=n,v.files=e.files):(v.keys=[],v.files={},e.FullPaths.forEach(function(Q,ue){Q=Q.replace(/^Root Entry[\/]/,""),v.keys.push(Q),v.files[Q]=e.FileIndex[ue]}))),t&&t.bookVBA&&(a.vba.length>0?v.vbaraw=kn(e,Ni(a.vba[0]),!0):a.defaults&&a.defaults.bin===yO&&(v.vbaraw=kn(e,"xl/vbaProject.bin",!0))),v}function rB(e,t){var r=t||{},n="Workbook",a=vt.find(e,n);try{if(n="/!DataSpaces/Version",a=vt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(PP(a.content),n="/!DataSpaces/DataSpaceMap",a=vt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=OP(a.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=vt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=jP(a.content);if(s.length!=1||s[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=vt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);DP(a.content)}catch{}if(n="/EncryptionInfo",a=vt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=MP(a.content);if(n="/EncryptedPackage",a=vt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],a.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function nB(e,t){return t.bookType=="ods"?oN(e,t):t.bookType=="numbers"?JM(e,t):t.bookType=="xlsb"?aB(e,t):iB(e,t)}function aB(e,t){I0=1024,e&&!e.SSF&&(e.SSF=Mr(Nt)),e&&e.SSF&&(gu(),Up(e.SSF),t.revssf=$p(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,If?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=j6.indexOf(t.bookType)>-1,a=n_();v_(t=t||{});var i=Wv(),s="",o=0;if(t.cellXfs=[],Ll(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),s="docProps/core.xml",Wt(i,s,JS(e.Props,t)),a.coreprops.push(s),xr(t.rels,2,s,Xt.CORE_PROPS),s="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}for(e.Props.Worksheets=e.Props.SheetNames.length,Wt(i,s,e6(e.Props)),a.extprops.push(s),xr(t.rels,3,s,Xt.EXT_PROPS),e.Custprops!==e.Props&&nn(e.Custprops||{}).length>0&&(s="docProps/custom.xml",Wt(i,s,t6(e.Custprops)),a.custprops.push(s),xr(t.rels,4,s,Xt.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var u={"!id":{}},h=e.Sheets[e.SheetNames[o-1]],m=(h||{})["!type"]||"sheet";switch(m){case"chart":default:s="xl/worksheets/sheet"+o+"."+r,Wt(i,s,OD(o-1,s,t,e,u)),a.sheets.push(s),xr(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Xt.WS[0])}if(h){var f=h["!comments"],v=!1,x="";f&&f.length>0&&(x="xl/comments"+o+"."+r,Wt(i,x,DD(f,x)),a.comments.push(x),xr(u,-1,"../comments"+o+"."+r,Xt.CMNT),v=!0),h["!legacy"]&&v&&Wt(i,"xl/drawings/vmlDrawing"+o+".vml",I6(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}u["!id"].rId1&&Wt(i,fh(s),$0(u))}return t.Strings!=null&&t.Strings.length>0&&(s="xl/sharedStrings."+r,Wt(i,s,RD(t.Strings,s,t)),a.strs.push(s),xr(t.wbrels,-1,"sharedStrings."+r,Xt.SST)),s="xl/workbook."+r,Wt(i,s,ID(e,s)),a.workbooks.push(s),xr(t.rels,1,s,Xt.WB),s="xl/theme/theme1.xml",Wt(i,s,c_(e.Themes,t)),a.themes.push(s),xr(t.wbrels,-1,"theme/theme1.xml",Xt.THEME),s="xl/styles."+r,Wt(i,s,jD(e,s,t)),a.styles.push(s),xr(t.wbrels,-1,"styles."+r,Xt.STY),e.vbaraw&&n&&(s="xl/vbaProject.bin",Wt(i,s,e.vbaraw),a.vba.push(s),xr(t.wbrels,-1,"vbaProject.bin",Xt.VBA)),s="xl/metadata."+r,Wt(i,s,MD(s)),a.metadata.push(s),xr(t.wbrels,-1,"metadata."+r,Xt.XLMETA),Wt(i,"[Content_Types].xml",XS(a,t)),Wt(i,"_rels/.rels",$0(t.rels)),Wt(i,"xl/_rels/workbook."+r+".rels",$0(t.wbrels)),delete t.revssf,delete t.ssf,i}function iB(e,t){I0=1024,e&&!e.SSF&&(e.SSF=Mr(Nt)),e&&e.SSF&&(gu(),Up(e.SSF),t.revssf=$p(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,If?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=j6.indexOf(t.bookType)>-1,a=n_();v_(t=t||{});var i=Wv(),s="",o=0;if(t.cellXfs=[],Ll(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),s="docProps/core.xml",Wt(i,s,JS(e.Props,t)),a.coreprops.push(s),xr(t.rels,2,s,Xt.CORE_PROPS),s="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}e.Props.Worksheets=e.Props.SheetNames.length,Wt(i,s,e6(e.Props)),a.extprops.push(s),xr(t.rels,3,s,Xt.EXT_PROPS),e.Custprops!==e.Props&&nn(e.Custprops||{}).length>0&&(s="docProps/custom.xml",Wt(i,s,t6(e.Custprops)),a.custprops.push(s),xr(t.rels,4,s,Xt.CUST_PROPS));var u=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var h={"!id":{}},m=e.Sheets[e.SheetNames[o-1]],f=(m||{})["!type"]||"sheet";switch(f){case"chart":default:s="xl/worksheets/sheet"+o+"."+r,Wt(i,s,q6(o-1,t,e,h)),a.sheets.push(s),xr(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Xt.WS[0])}if(m){var v=m["!comments"],x=!1,w="";if(v&&v.length>0){var _=!1;v.forEach(function(b){b[1].forEach(function(y){y.T==!0&&(_=!0)})}),_&&(w="xl/threadedComments/threadedComment"+o+"."+r,Wt(i,w,hO(v,u,t)),a.threadedcomments.push(w),xr(h,-1,"../threadedComments/threadedComment"+o+"."+r,Xt.TCMNT)),w="xl/comments"+o+"."+r,Wt(i,w,O6(v)),a.comments.push(w),xr(h,-1,"../comments"+o+"."+r,Xt.CMNT),x=!0}m["!legacy"]&&x&&Wt(i,"xl/drawings/vmlDrawing"+o+".vml",I6(o,m["!comments"])),delete m["!comments"],delete m["!legacy"]}h["!id"].rId1&&Wt(i,fh(s),$0(h))}return t.Strings!=null&&t.Strings.length>0&&(s="xl/sharedStrings."+r,Wt(i,s,y6(t.Strings,t)),a.strs.push(s),xr(t.wbrels,-1,"sharedStrings."+r,Xt.SST)),s="xl/workbook."+r,Wt(i,s,J6(e)),a.workbooks.push(s),xr(t.rels,1,s,Xt.WB),s="xl/theme/theme1.xml",Wt(i,s,c_(e.Themes,t)),a.themes.push(s),xr(t.wbrels,-1,"theme/theme1.xml",Xt.THEME),s="xl/styles."+r,Wt(i,s,C6(e,t)),a.styles.push(s),xr(t.wbrels,-1,"styles."+r,Xt.STY),e.vbaraw&&n&&(s="xl/vbaProject.bin",Wt(i,s,e.vbaraw),a.vba.push(s),xr(t.wbrels,-1,"vbaProject.bin",Xt.VBA)),s="xl/metadata."+r,Wt(i,s,P6()),a.metadata.push(s),xr(t.wbrels,-1,"metadata."+r,Xt.XLMETA),u.length>1&&(s="xl/persons/person.xml",Wt(i,s,pO(u)),a.people.push(s),xr(t.wbrels,-1,"persons/person.xml",Xt.PEOPLE)),Wt(i,"[Content_Types].xml",XS(a,t)),Wt(i,"_rels/.rels",$0(t.rels)),Wt(i,"xl/_rels/workbook."+r+".rels",$0(t.wbrels)),delete t.revssf,delete t.ssf,i}function __(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=mi(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function sB(e,t){return vt.find(e,"EncryptedPackage")?rB(e,t):tN(e,t)}function oB(e,t){var r,n=e,a=t||{};return a.type||(a.type=Vt&&Buffer.isBuffer(e)?"buffer":"base64"),r=kS(n,a),tB(r,a)}function cN(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return lx(e.slice(r),t);default:break e}return iu.to_workbook(e,t)}function lB(e,t){var r="",n=__(e,t);switch(t.type){case"base64":r=mi(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=Cc(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=br(r)),t.type="binary",cN(r,t)}function cB(e,t){var r=e;return t.type=="base64"&&(r=mi(r)),r=Qo.utils.decode(1200,r.slice(2),"str"),t.type="binary",cN(r,t)}function uB(e){return e.match(/[^\x00-\x7F]/)?Ls(e):e}function bg(e,t,r,n){return n?(r.type="string",iu.to_workbook(e,r)):iu.to_workbook(t,r)}function fx(e,t){Mv();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return fx(new Uint8Array(e),(r=Mr(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,a=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),H0={},r.dateNF&&(H0.dateNF=r.dateNF),r.type||(r.type=Vt&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=Vt?"buffer":"binary",n=aF(e),typeof Uint8Array<"u"&&!Vt&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,n=uB(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var s=new ArrayBuffer(3),o=new Uint8Array(s);if(o.foo="bar",!o.foo)return r=Mr(r),r.type="array",fx(Bv(n),r)}switch((a=__(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return sB(vt.read(n,r),r);break;case 9:if(a[1]<=8)return tN(n,r);break;case 60:return lx(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return mP(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return _6.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?oB(n,r):bg(e,n,r,i);case 239:return a[3]===60?lx(n,r):bg(e,n,r,i);case 255:if(a[1]===254)return cB(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return wc.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return wc.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return ox.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return E6.to_workbook(n,r);break;case 10:case 13:case 32:return lB(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return pP.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?ox.to_workbook(n,r):bg(e,n,r,i)}function uN(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Oh(t.file,vt.write(e,{type:Vt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return vt.write(e,t)}function fB(e,t){var r=Mr(t||{}),n=nB(e,r);return hB(n,r)}function hB(e,t){var r={},n=Vt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var a=e.FullPaths?vt.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof a=="string"){if(t.type=="binary"||t.type=="base64")return a;a=new Uint8Array(Bp(a))}return t.password&&typeof encrypt_agile<"u"?uN(encrypt_agile(a,t.password),t):t.type==="file"?Oh(t.file,a):t.type=="string"?br(a):a}function dB(e,t){var r=t||{},n=uM(e,r);return uN(n,r)}function Ns(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return sh(Ls(n));case"binary":return Ls(n);case"string":return e;case"file":return Oh(t.file,n,"utf8");case"buffer":return Vt?bo(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Ns(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function pB(e,t){switch(t.type){case"base64":return sh(e);case"binary":return e;case"string":return e;case"file":return Oh(t.file,e,"binary");case"buffer":return Vt?bo(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Yd(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?sh(r):t.type=="string"?br(r):r;case"file":return Oh(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function w_(e,t){Mv(),sD(e);var r=Mr(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=w_(e,r);return r.type="array",Bp(n)}var a=0;if(r.sheet&&(typeof r.sheet=="number"?a=r.sheet:a=e.SheetNames.indexOf(r.sheet),!e.SheetNames[a]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Ns(nM(e,r),r);case"slk":case"sylk":return Ns(v6.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"htm":case"html":return Ns(nN(e.Sheets[e.SheetNames[a]],r),r);case"txt":return pB(hN(e.Sheets[e.SheetNames[a]],r),r);case"csv":return Ns(y_(e.Sheets[e.SheetNames[a]],r),r,"\uFEFF");case"dif":return Ns(_6.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"dbf":return Yd(ox.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"prn":return Ns(iu.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"rtf":return Ns(E6.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"eth":return Ns(w6.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"fods":return Ns(oN(e,r),r);case"wk1":return Yd(wc.sheet_to_wk1(e.Sheets[e.SheetNames[a]],r),r);case"wk3":return Yd(wc.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Yd(rN(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),dB(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return fB(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function mB(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function fN(e,t,r){var n=r||{};return n.type="file",n.file=t,mB(n),w_(e,n)}function gB(e,t,r,n,a,i,s,o){var l=gn(r),c=o.defval,u=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),h=!0,m=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(m,"__rowNum__",{value:r,enumerable:!1})}catch{m.__rowNum__=r}else m.__rowNum__=r;if(!s||e[r])for(var f=t.s.c;f<=t.e.c;++f){var v=s?e[r][f]:e[n[f]+l];if(v===void 0||v.t===void 0){if(c===void 0)continue;i[f]!=null&&(m[i[f]]=c);continue}var x=v.v;switch(v.t){case"z":if(x==null)break;continue;case"e":x=x==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+v.t)}if(i[f]!=null){if(x==null)if(v.t=="e"&&x===null)m[i[f]]=null;else if(c!==void 0)m[i[f]]=c;else if(u&&x===null)m[i[f]]=null;else continue;else m[i[f]]=u&&(v.t!=="n"||v.t==="n"&&o.rawNumbers!==!1)?x:wo(v,x,o);x!=null&&(h=!1)}}return{row:m,isempty:h}}function pp(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,i=[],s=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},u=c.range!=null?c.range:e["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof u){case"string":l=ir(u);break;case"number":l=ir(e["!ref"]),l.s.r=u;break;default:l=u}n>0&&(a=0);var h=gn(l.s.r),m=[],f=[],v=0,x=0,w=Array.isArray(e),_=l.s.r,b=0,y={};w&&!e[_]&&(e[_]=[]);var N=c.skipHidden&&e["!cols"]||[],R=c.skipHidden&&e["!rows"]||[];for(b=l.s.c;b<=l.e.c;++b)if(!(N[b]||{}).hidden)switch(m[b]=Vr(b),r=w?e[_][b]:e[m[b]+h],n){case 1:i[b]=b-l.s.c;break;case 2:i[b]=m[b];break;case 3:i[b]=c.header[b-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=s=wo(r,null,c),x=y[s]||0,!x)y[s]=1;else{do o=s+"_"+x++;while(y[o]);y[s]=x,y[o]=1}i[b]=o}for(_=l.s.r+a;_<=l.e.r;++_)if(!(R[_]||{}).hidden){var P=gB(e,l,_,m,n,i,w,c);(P.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(f[v++]=P.row)}return f.length=v,f}var Xy=/"/g;function xB(e,t,r,n,a,i,s,o){for(var l=!0,c=[],u="",h=gn(r),m=t.s.c;m<=t.e.c;++m)if(n[m]){var f=o.dense?(e[r]||[])[m]:e[n[m]+h];if(f==null)u="";else if(f.v!=null){l=!1,u=""+(o.rawNumbers&&f.t=="n"?f.v:wo(f,null,o));for(var v=0,x=0;v!==u.length;++v)if((x=u.charCodeAt(v))===a||x===i||x===34||o.forceQuotes){u='"'+u.replace(Xy,'""')+'"';break}u=="ID"&&(u='"ID"')}else f.f!=null&&!f.F?(l=!1,u="="+f.f,u.indexOf(",")>=0&&(u='"'+u.replace(Xy,'""')+'"')):u="";c.push(u)}return o.blankrows===!1&&l?null:c.join(s)}function y_(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var a=ir(e["!ref"]),i=n.FS!==void 0?n.FS:",",s=i.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),c=new RegExp((i=="|"?"\\|":i)+"+$"),u="",h=[];n.dense=Array.isArray(e);for(var m=n.skipHidden&&e["!cols"]||[],f=n.skipHidden&&e["!rows"]||[],v=a.s.c;v<=a.e.c;++v)(m[v]||{}).hidden||(h[v]=Vr(v));for(var x=0,w=a.s.r;w<=a.e.r;++w)(f[w]||{}).hidden||(u=xB(e,a,w,h,s,l,i,n),u!=null&&(n.strip&&(u=u.replace(c,"")),(u||n.blankrows!==!1)&&r.push((x++?o:"")+u)));return delete n.dense,r.join("")}function hN(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=y_(e,t);return r}function vB(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var a=ir(e["!ref"]),i="",s=[],o,l=[],c=Array.isArray(e);for(o=a.s.c;o<=a.e.c;++o)s[o]=Vr(o);for(var u=a.s.r;u<=a.e.r;++u)for(i=gn(u),o=a.s.c;o<=a.e.c;++o)if(t=s[o]+i,r=c?(e[u]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=t+"="+n}return l}function dN(e,t,r){var n=r||{},a=+!n.skipHeader,i=e||{},s=0,o=0;if(i&&n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var l=typeof n.origin=="string"?qr(n.origin):n.origin;s=l.r,o=l.c}var c,u={s:{c:0,r:0},e:{c:o,r:s+t.length-1+a}};if(i["!ref"]){var h=ir(i["!ref"]);u.e.c=Math.max(u.e.c,h.e.c),u.e.r=Math.max(u.e.r,h.e.r),s==-1&&(s=h.e.r+1,u.e.r=s+t.length-1+a)}else s==-1&&(s=0,u.e.r=t.length-1+a);var m=n.header||[],f=0;t.forEach(function(x,w){nn(x).forEach(function(_){(f=m.indexOf(_))==-1&&(m[f=m.length]=_);var b=x[_],y="z",N="",R=Et({c:o+f,r:s+w+a});c=vh(i,R),b&&typeof b=="object"&&!(b instanceof Date)?i[R]=b:(typeof b=="number"?y="n":typeof b=="boolean"?y="b":typeof b=="string"?y="s":b instanceof Date?(y="d",n.cellDates||(y="n",b=Rn(b)),N=n.dateNF||Nt[14]):b===null&&n.nullError&&(y="e",b=0),c?(c.t=y,c.v=b,delete c.w,delete c.R,N&&(c.z=N)):i[R]=c={t:y,v:b},N&&(c.z=N))})}),u.e.c=Math.max(u.e.c,o+m.length-1);var v=gn(s);if(a)for(f=0;f<m.length;++f)i[Vr(f+o)+v]={t:"s",v:m[f]};return i["!ref"]=Ut(u),i}function _B(e,t){return dN(null,e,t)}function vh(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=qr(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?vh(e,Et(t)):vh(e,Et({r:t,c:r||0}))}function wB(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function b_(){return{SheetNames:[],Sheets:{}}}function k_(e,t,r,n){var a=1;if(!r)for(;a<=65535&&e.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);a=i&&+i[2]||0;var s=i&&i[1]||r;for(++a;a<=65535&&e.SheetNames.indexOf(r=s+a)!=-1;++a);}if(Y6(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function yB(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=wB(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function bB(e,t){return e.z=t,e}function pN(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function kB(e,t,r){return pN(e,"#"+t,r)}function SB(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function NB(e,t,r,n){for(var a=typeof t!="string"?t:ir(t),i=typeof t=="string"?t:Ut(t),s=a.s.r;s<=a.e.r;++s)for(var o=a.s.c;o<=a.e.c;++o){var l=vh(e,s,o);l.t="n",l.F=i,delete l.v,s==a.s.r&&o==a.s.c&&(l.f=r,n&&(l.D=!0))}return e}var Er={encode_col:Vr,encode_row:gn,encode_cell:Et,encode_range:Ut,decode_col:Jv,decode_row:Yv,split_cell:RF,decode_cell:qr,decode_range:Ga,format_cell:wo,sheet_add_aoa:zS,sheet_add_json:dN,sheet_add_dom:aN,aoa_to_sheet:xu,json_to_sheet:_B,table_to_sheet:iN,table_to_book:PM,sheet_to_csv:y_,sheet_to_txt:hN,sheet_to_json:pp,sheet_to_html:nN,sheet_to_formulae:vB,sheet_to_row_object_array:pp,sheet_get_cell:vh,book_new:b_,book_append_sheet:k_,book_set_sheet_visibility:yB,cell_set_number_format:bB,cell_set_hyperlink:pN,cell_set_internal_link:kB,cell_add_comment:SB,sheet_set_array_formula:NB,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};async function EB(e){var t;try{const r=(t=e.name.split(".").pop())==null?void 0:t.toLowerCase();if(r==="xlsx"||r==="xls")return console.log("Processando arquivo Excel:",e.name),await AB(e);{console.log("Processando arquivo CSV:",e.name);const n=await e.text();return FB(n)}}catch(r){throw console.error("Erro em parseFile:",r),r}}function AB(e){return new Promise((t,r)=>{const n=new FileReader;n.onload=a=>{var i;try{console.log("FileReader onload disparado");const s=(i=a.target)==null?void 0:i.result,o=fx(s,{type:"binary"});console.log("Workbook lido, sheets:",o.SheetNames);const l=o.Sheets[o.SheetNames[0]],c=Er.sheet_to_json(l,{header:1});if(console.log("JSON data extraído, linhas:",c.length),c.length===0){r(new Error("Planilha vazia"));return}const u=c[0].map(N=>(N!=null?String(N):"").toLowerCase().trim());console.log("Headers processados:",u);const h=c.slice(1),m=u.findIndex(N=>N&&(N.includes("razao")||N.includes("razão")||N.includes("social")||N.includes("empresa")||N.includes("nome")||N==="name"||N==="company")),f=u.findIndex(N=>N&&(N.includes("cidade")||N.includes("município")||N.includes("municipio")||N==="city")),v=u.findIndex(N=>N&&(N.includes("estado")||N.includes("uf")||N==="state")),x=u.findIndex(N=>N&&(N.includes("categoria")||N.includes("segmento")||N==="category")),w=u.findIndex(N=>N&&(N.includes("telefone")||N.includes("phone")||N.includes("celular"))),_=u.findIndex(N=>N&&(N.includes("endereço")||N.includes("endereco")||N==="address")),b=u.findIndex(N=>N&&(N.includes("website")||N.includes("site")||N==="url"));if(console.log("Índices encontrados - Nome:",m,"Cidade:",f),m===-1||f===-1){r(new Error("Colunas obrigatórias não encontradas: Nome da Empresa e Cidade"));return}const y=[];for(const N of h){if(!N||!Array.isArray(N))continue;const R=(N[m]!=null?String(N[m]):"").trim(),P=(N[f]!=null?String(N[f]):"").trim();R&&P&&y.push({company_name:R,city:P,state:v!==-1&&N[v]!=null?String(N[v]).trim():void 0,category:x!==-1&&N[x]!=null?String(N[x]).trim():void 0,phone:w!==-1&&N[w]!=null?String(N[w]).trim():void 0,address:_!==-1&&N[_]!=null?String(N[_]).trim():void 0,website:b!==-1&&N[b]!=null?String(N[b]).trim():void 0})}if(console.log("Total de empresas extraídas:",y.length),y.length===0){r(new Error("Nenhuma empresa válida encontrada na planilha"));return}t(y)}catch(s){console.error("Erro ao processar Excel:",s),r(s instanceof Error?s:new Error("Erro ao processar planilha"))}},n.onerror=()=>r(new Error("Erro ao ler arquivo")),n.readAsBinaryString(e)})}const TB=e=>{const t=(e.match(/,/g)||[]).length,r=(e.match(/;/g)||[]).length,n=(e.match(/\t/g)||[]).length;return n>t&&n>r?"	":r>t?";":","},Ky=(e,t=",")=>{const r=[];let n="",a=!1;for(let i=0;i<e.length;i++){const s=e[i];s==='"'?a=!a:s===t&&!a?(r.push(n.trim()),n=""):n+=s}return r.push(n.trim()),r},CB=e=>{const t=e.map(a=>a.toLowerCase().trim()),r=t.some(a=>a.includes("razao")||a.includes("razão")||a.includes("social")||a.includes("empresa")||a.includes("nome")||a==="name"||a==="company"||a.includes("restaurante")),n=t.some(a=>a.includes("cidade")||a.includes("município")||a.includes("municipio")||a==="city"||a.includes("local"));return r||n},FB=e=>{const t=e.split(/\r?\n/);console.log("Total de linhas brutas no arquivo:",t.length);const r=t.map(w=>w.trim()).filter(w=>w.length>0);if(console.log("Linhas não vazias:",r.length),r.length===0)throw new Error("Arquivo vazio. Por favor, adicione dados à planilha.");const n=TB(r[0]);console.log("Delimitador detectado:",n===","?"vírgula":n===";"?"ponto-e-vírgula":"tab");const a=Ky(r[0],n),i=CB(a);console.log("Primeira linha:",a),console.log("Tem cabeçalho?",i);let s=0,o=1,l=2,c=-1,u=-1,h=-1,m=-1,f=0;if(i){f=1;const w=a.map(C=>C.trim().toLowerCase().replace(/^"|"$/g,""));console.log("Cabeçalhos detectados:",w);const _=w.findIndex(C=>C.includes("razao")||C.includes("razão")||C.includes("social")||C.includes("empresa")||C.includes("nome")||C==="name"||C==="company"||C.includes("restaurante")),b=w.findIndex(C=>C.includes("cidade")||C.includes("município")||C.includes("municipio")||C==="city"||C.includes("local")),y=w.findIndex(C=>C.includes("estado")||C==="state"||C==="uf"),N=w.findIndex(C=>C.includes("categoria")||C==="category"||C.includes("tipo")||C.includes("segmento")),R=w.findIndex(C=>C.includes("telefone")||C.includes("phone")||C.includes("celular")||C.includes("fone")),P=w.findIndex(C=>C.includes("endereço")||C.includes("endereco")||C.includes("address")||C.includes("rua")),F=w.findIndex(C=>C.includes("site")||C.includes("website")||C.includes("url")||C.includes("web"));_!==-1&&(s=_),b!==-1&&(o=b),y!==-1&&(l=y),N!==-1&&(c=N),R!==-1&&(u=R),P!==-1&&(h=P),F!==-1&&(m=F)}console.log(`Índices das colunas - Nome: ${s}, Cidade: ${o}, Estado: ${l}`);const v=[];let x=0;for(let w=f;w<r.length;w++)try{const _=Ky(r[w],n);if(_.length<2){w<f+3&&console.log(`Linha ${w+1} tem menos de 2 colunas:`,_),x++;continue}const b=(_[s]||"").replace(/^"|"$/g,"").trim(),y=(_[o]||"").replace(/^"|"$/g,"").trim();if(!b||!y){w<f+3&&console.log(`Linha ${w+1} está vazia (nome ou cidade faltando):`,{company_name:b,city:y,values:_}),x++;continue}v.push({company_name:b,city:y,state:l!==-1&&_[l]?_[l].replace(/^"|"$/g,"").trim():void 0,category:c!==-1&&_[c]?_[c].replace(/^"|"$/g,"").trim():void 0,phone:u!==-1&&_[u]?_[u].replace(/^"|"$/g,"").trim():void 0,address:h!==-1&&_[h]?_[h].replace(/^"|"$/g,"").trim():void 0,website:m!==-1&&_[m]?_[m].replace(/^"|"$/g,"").trim():void 0})}catch(_){console.warn(`Erro ao processar linha ${w+1}, pulando...`,_),x++;continue}if(console.log(`Empresas válidas encontradas: ${v.length}`),console.log(`Linhas puladas: ${x}`),v.length===0)throw new Error("Nenhuma empresa válida encontrada. Verifique o formato do arquivo.");return v},LB=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>uo(async()=>{const{default:n}=await Promise.resolve().then(()=>_u);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)};class S_ extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class PB extends S_{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class Yy extends S_{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class Jy extends S_{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var hx;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(hx||(hx={}));var IB=function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function o(u){try{c(n.next(u))}catch(h){s(h)}}function l(u){try{c(n.throw(u))}catch(h){s(h)}}function c(u){u.done?i(u.value):a(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};class OB{constructor(t,{headers:r={},customFetch:n,region:a=hx.Any}={}){this.url=t,this.headers=r,this.region=a,this.fetch=LB(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,r={}){var n;return IB(this,void 0,void 0,function*(){try{const{headers:a,method:i,body:s}=r;let o={},{region:l}=r;l||(l=this.region);const c=new URL(`${this.url}/${t}`);l&&l!=="any"&&(o["x-region"]=l,c.searchParams.set("forceFunctionRegion",l));let u;s&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)&&(typeof Blob<"u"&&s instanceof Blob||s instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",u=s):typeof s=="string"?(o["Content-Type"]="text/plain",u=s):typeof FormData<"u"&&s instanceof FormData?u=s:(o["Content-Type"]="application/json",u=JSON.stringify(s)));const h=yield this.fetch(c.toString(),{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),a),body:u}).catch(x=>{throw new PB(x)}),m=h.headers.get("x-relay-error");if(m&&m==="true")throw new Yy(h);if(!h.ok)throw new Jy(h);let f=((n=h.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),v;return f==="application/json"?v=yield h.json():f==="application/octet-stream"?v=yield h.blob():f==="text/event-stream"?v=h:f==="multipart/form-data"?v=yield h.formData():v=yield h.text(),{data:v,error:null,response:h}}catch(a){return{data:null,error:a,response:a instanceof Jy||a instanceof Yy?a.context:void 0}}})}}var Ua={},N_={},Xp={},$h={},Kp={},Yp={},jB=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},ou=jB();const RB=ou.fetch,mN=ou.fetch.bind(ou),gN=ou.Headers,DB=ou.Request,MB=ou.Response,_u=Object.freeze(Object.defineProperty({__proto__:null,Headers:gN,Request:DB,Response:MB,default:mN,fetch:RB},Symbol.toStringTag,{value:"Module"})),BB=R8(_u);var Jp={};Object.defineProperty(Jp,"__esModule",{value:!0});let UB=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};Jp.default=UB;var xN=Di&&Di.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Yp,"__esModule",{value:!0});const zB=xN(BB),$B=xN(Jp);let WB=class{constructor(t){var r,n;this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=new Headers(t.headers),this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=(r=t.shouldThrowOnError)!==null&&r!==void 0?r:!1,this.signal=t.signal,this.isMaybeSingle=(n=t.isMaybeSingle)!==null&&n!==void 0?n:!1,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=zB.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,r){return this.headers=new Headers(this.headers),this.headers.set(t,r),this}then(t,r){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const n=this.fetch;let a=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{var s,o,l,c;let u=null,h=null,m=null,f=i.status,v=i.statusText;if(i.ok){if(this.method!=="HEAD"){const b=await i.text();b===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((s=this.headers.get("Accept"))===null||s===void 0)&&s.includes("application/vnd.pgrst.plan+text"))?h=b:h=JSON.parse(b))}const w=(o=this.headers.get("Prefer"))===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),_=(l=i.headers.get("content-range"))===null||l===void 0?void 0:l.split("/");w&&_&&_.length>1&&(m=parseInt(_[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(h)&&(h.length>1?(u={code:"PGRST116",details:`Results contain ${h.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},h=null,m=null,f=406,v="Not Acceptable"):h.length===1?h=h[0]:h=null)}else{const w=await i.text();try{u=JSON.parse(w),Array.isArray(u)&&i.status===404&&(h=[],u=null,f=200,v="OK")}catch{i.status===404&&w===""?(f=204,v="No Content"):u={message:w}}if(u&&this.isMaybeSingle&&(!((c=u==null?void 0:u.details)===null||c===void 0)&&c.includes("0 rows"))&&(u=null,f=200,v="OK"),u&&this.shouldThrowOnError)throw new $B.default(u)}return{error:u,data:h,count:m,status:f,statusText:v}});return this.shouldThrowOnError||(a=a.catch(i=>{var s,o,l;return{error:{message:`${(s=i==null?void 0:i.name)!==null&&s!==void 0?s:"FetchError"}: ${i==null?void 0:i.message}`,details:`${(o=i==null?void 0:i.stack)!==null&&o!==void 0?o:""}`,hint:"",code:`${(l=i==null?void 0:i.code)!==null&&l!==void 0?l:""}`},data:null,count:null,status:0,statusText:""}})),a.then(t,r)}returns(){return this}overrideTypes(){return this}};Yp.default=WB;var HB=Di&&Di.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Kp,"__esModule",{value:!0});const VB=HB(Yp);let qB=class extends VB.default{select(t){let r=!1;const n=(t??"*").split("").map(a=>/\s/.test(a)&&!r?"":(a==='"'&&(r=!r),a)).join("");return this.url.searchParams.set("select",n),this.headers.append("Prefer","return=representation"),this}order(t,{ascending:r=!0,nullsFirst:n,foreignTable:a,referencedTable:i=a}={}){const s=i?`${i}.order`:"order",o=this.url.searchParams.get(s);return this.url.searchParams.set(s,`${o?`${o},`:""}${t}.${r?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:r,referencedTable:n=r}={}){const a=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(a,`${t}`),this}range(t,r,{foreignTable:n,referencedTable:a=n}={}){const i=typeof a>"u"?"offset":`${a}.offset`,s=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(i,`${t}`),this.url.searchParams.set(s,`${r-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:t=!1,verbose:r=!1,settings:n=!1,buffers:a=!1,wal:i=!1,format:s="text"}={}){var o;const l=[t?"analyze":null,r?"verbose":null,n?"settings":null,a?"buffers":null,i?"wal":null].filter(Boolean).join("|"),c=(o=this.headers.get("Accept"))!==null&&o!==void 0?o:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${s}; for="${c}"; options=${l};`),s==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(t){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${t}`),this}};Kp.default=qB;var GB=Di&&Di.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty($h,"__esModule",{value:!0});const XB=GB(Kp);let KB=class extends XB.default{eq(t,r){return this.url.searchParams.append(t,`eq.${r}`),this}neq(t,r){return this.url.searchParams.append(t,`neq.${r}`),this}gt(t,r){return this.url.searchParams.append(t,`gt.${r}`),this}gte(t,r){return this.url.searchParams.append(t,`gte.${r}`),this}lt(t,r){return this.url.searchParams.append(t,`lt.${r}`),this}lte(t,r){return this.url.searchParams.append(t,`lte.${r}`),this}like(t,r){return this.url.searchParams.append(t,`like.${r}`),this}likeAllOf(t,r){return this.url.searchParams.append(t,`like(all).{${r.join(",")}}`),this}likeAnyOf(t,r){return this.url.searchParams.append(t,`like(any).{${r.join(",")}}`),this}ilike(t,r){return this.url.searchParams.append(t,`ilike.${r}`),this}ilikeAllOf(t,r){return this.url.searchParams.append(t,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(t,r){return this.url.searchParams.append(t,`ilike(any).{${r.join(",")}}`),this}is(t,r){return this.url.searchParams.append(t,`is.${r}`),this}in(t,r){const n=Array.from(new Set(r)).map(a=>typeof a=="string"&&new RegExp("[,()]").test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(t,`in.(${n})`),this}contains(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cs.{${r.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(r)}`),this}containedBy(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cd.{${r.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(r)}`),this}rangeGt(t,r){return this.url.searchParams.append(t,`sr.${r}`),this}rangeGte(t,r){return this.url.searchParams.append(t,`nxl.${r}`),this}rangeLt(t,r){return this.url.searchParams.append(t,`sl.${r}`),this}rangeLte(t,r){return this.url.searchParams.append(t,`nxr.${r}`),this}rangeAdjacent(t,r){return this.url.searchParams.append(t,`adj.${r}`),this}overlaps(t,r){return typeof r=="string"?this.url.searchParams.append(t,`ov.${r}`):this.url.searchParams.append(t,`ov.{${r.join(",")}}`),this}textSearch(t,r,{config:n,type:a}={}){let i="";a==="plain"?i="pl":a==="phrase"?i="ph":a==="websearch"&&(i="w");const s=n===void 0?"":`(${n})`;return this.url.searchParams.append(t,`${i}fts${s}.${r}`),this}match(t){return Object.entries(t).forEach(([r,n])=>{this.url.searchParams.append(r,`eq.${n}`)}),this}not(t,r,n){return this.url.searchParams.append(t,`not.${r}.${n}`),this}or(t,{foreignTable:r,referencedTable:n=r}={}){const a=n?`${n}.or`:"or";return this.url.searchParams.append(a,`(${t})`),this}filter(t,r,n){return this.url.searchParams.append(t,`${r}.${n}`),this}};$h.default=KB;var YB=Di&&Di.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Xp,"__esModule",{value:!0});const af=YB($h);let JB=class{constructor(t,{headers:r={},schema:n,fetch:a}){this.url=t,this.headers=new Headers(r),this.schema=n,this.fetch=a}select(t,{head:r=!1,count:n}={}){const a=r?"HEAD":"GET";let i=!1;const s=(t??"*").split("").map(o=>/\s/.test(o)&&!i?"":(o==='"'&&(i=!i),o)).join("");return this.url.searchParams.set("select",s),n&&this.headers.append("Prefer",`count=${n}`),new af.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(t,{count:r,defaultToNull:n=!0}={}){var a;const i="POST";if(r&&this.headers.append("Prefer",`count=${r}`),n||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const s=t.reduce((o,l)=>o.concat(Object.keys(l)),[]);if(s.length>0){const o=[...new Set(s)].map(l=>`"${l}"`);this.url.searchParams.set("columns",o.join(","))}}return new af.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}upsert(t,{onConflict:r,ignoreDuplicates:n=!1,count:a,defaultToNull:i=!0}={}){var s;const o="POST";if(this.headers.append("Prefer",`resolution=${n?"ignore":"merge"}-duplicates`),r!==void 0&&this.url.searchParams.set("on_conflict",r),a&&this.headers.append("Prefer",`count=${a}`),i||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const l=t.reduce((c,u)=>c.concat(Object.keys(u)),[]);if(l.length>0){const c=[...new Set(l)].map(u=>`"${u}"`);this.url.searchParams.set("columns",c.join(","))}}return new af.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}update(t,{count:r}={}){var n;const a="PATCH";return r&&this.headers.append("Prefer",`count=${r}`),new af.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}delete({count:t}={}){var r;const n="DELETE";return t&&this.headers.append("Prefer",`count=${t}`),new af.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}};Xp.default=JB;var vN=Di&&Di.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(N_,"__esModule",{value:!0});const ZB=vN(Xp),QB=vN($h);let eU=class _N{constructor(t,{headers:r={},schema:n,fetch:a}={}){this.url=t,this.headers=new Headers(r),this.schemaName=n,this.fetch=a}from(t){const r=new URL(`${this.url}/${t}`);return new ZB.default(r,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new _N(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:n=!1,get:a=!1,count:i}={}){var s;let o;const l=new URL(`${this.url}/rpc/${t}`);let c;n||a?(o=n?"HEAD":"GET",Object.entries(r).filter(([h,m])=>m!==void 0).map(([h,m])=>[h,Array.isArray(m)?`{${m.join(",")}}`:`${m}`]).forEach(([h,m])=>{l.searchParams.append(h,m)})):(o="POST",c=r);const u=new Headers(this.headers);return i&&u.set("Prefer",`count=${i}`),new QB.default({method:o,url:l,headers:u,schema:this.schemaName,body:c,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}};N_.default=eU;var wu=Di&&Di.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ua,"__esModule",{value:!0});Ua.PostgrestError=Ua.PostgrestBuilder=Ua.PostgrestTransformBuilder=Ua.PostgrestFilterBuilder=Ua.PostgrestQueryBuilder=Ua.PostgrestClient=void 0;const wN=wu(N_);Ua.PostgrestClient=wN.default;const yN=wu(Xp);Ua.PostgrestQueryBuilder=yN.default;const bN=wu($h);Ua.PostgrestFilterBuilder=bN.default;const kN=wu(Kp);Ua.PostgrestTransformBuilder=kN.default;const SN=wu(Yp);Ua.PostgrestBuilder=SN.default;const NN=wu(Jp);Ua.PostgrestError=NN.default;var tU=Ua.default={PostgrestClient:wN.default,PostgrestQueryBuilder:yN.default,PostgrestFilterBuilder:bN.default,PostgrestTransformBuilder:kN.default,PostgrestBuilder:SN.default,PostgrestError:NN.default};const{PostgrestClient:rU,PostgrestQueryBuilder:Cq,PostgrestFilterBuilder:Fq,PostgrestTransformBuilder:Lq,PostgrestBuilder:Pq,PostgrestError:Iq}=tU;class nU{static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const n=r.node,a=parseInt(n.replace(/^v/,"").split(".")[0]);return a>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${a} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${a} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const n=this.getWebSocketConstructor();return new n(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const aU="2.15.5",iU=`realtime-js/${aU}`,sU="1.0.0",dx=1e4,oU=1e3,lU=100;var Rf;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(Rf||(Rf={}));var Ln;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Ln||(Ln={}));var ns;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(ns||(ns={}));var px;(function(e){e.websocket="websocket"})(px||(px={}));var sc;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(sc||(sc={}));class cU{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),n=new TextDecoder;return this._decodeBroadcast(t,r,n)}_decodeBroadcast(t,r,n){const a=r.getUint8(1),i=r.getUint8(2);let s=this.HEADER_LENGTH+2;const o=n.decode(t.slice(s,s+a));s=s+a;const l=n.decode(t.slice(s,s+i));s=s+i;const c=JSON.parse(n.decode(t.slice(s,t.byteLength)));return{ref:null,topic:o,event:l,payload:c}}}class EN{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Cr;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(Cr||(Cr={}));const Zy=(e,t,r={})=>{var n;const a=(n=r.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(t).reduce((i,s)=>(i[s]=uU(s,e,t,a),i),{})},uU=(e,t,r,n)=>{const a=t.find(o=>o.name===e),i=a==null?void 0:a.type,s=r[e];return i&&!n.includes(i)?AN(i,s):mx(s)},AN=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return pU(t,r)}switch(e){case Cr.bool:return fU(t);case Cr.float4:case Cr.float8:case Cr.int2:case Cr.int4:case Cr.int8:case Cr.numeric:case Cr.oid:return hU(t);case Cr.json:case Cr.jsonb:return dU(t);case Cr.timestamp:return mU(t);case Cr.abstime:case Cr.date:case Cr.daterange:case Cr.int4range:case Cr.int8range:case Cr.money:case Cr.reltime:case Cr.text:case Cr.time:case Cr.timestamptz:case Cr.timetz:case Cr.tsrange:case Cr.tstzrange:return mx(t);default:return mx(t)}},mx=e=>e,fU=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},hU=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},dU=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},pU=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let i;const s=e.slice(1,r);try{i=JSON.parse("["+s+"]")}catch{i=s?s.split(","):[]}return i.map(o=>AN(t,o))}return e},mU=e=>typeof e=="string"?e.replace(" ","T"):e,TN=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")+"/api/broadcast"};class kg{constructor(t,r,n={},a=dx){this.channel=t,this.event=r,this.payload=n,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var Qy;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(Qy||(Qy={}));class Df{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},a=>{const{onJoin:i,onLeave:s,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Df.syncState(this.state,a,i,s),this.pendingDiffs.forEach(l=>{this.state=Df.syncDiff(this.state,l,i,s)}),this.pendingDiffs=[],o()}),this.channel._on(n.diff,{},a=>{const{onJoin:i,onLeave:s,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=Df.syncDiff(this.state,a,i,s),o())}),this.onJoin((a,i,s)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:i,newPresences:s})}),this.onLeave((a,i,s)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:i,leftPresences:s})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,a){const i=this.cloneDeep(t),s=this.transformState(r),o={},l={};return this.map(i,(c,u)=>{s[c]||(l[c]=u)}),this.map(s,(c,u)=>{const h=i[c];if(h){const m=u.map(w=>w.presence_ref),f=h.map(w=>w.presence_ref),v=u.filter(w=>f.indexOf(w.presence_ref)<0),x=h.filter(w=>m.indexOf(w.presence_ref)<0);v.length>0&&(o[c]=v),x.length>0&&(l[c]=x)}else o[c]=u}),this.syncDiff(i,{joins:o,leaves:l},n,a)}static syncDiff(t,r,n,a){const{joins:i,leaves:s}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),a||(a=()=>{}),this.map(i,(o,l)=>{var c;const u=(c=t[o])!==null&&c!==void 0?c:[];if(t[o]=this.cloneDeep(l),u.length>0){const h=t[o].map(f=>f.presence_ref),m=u.filter(f=>h.indexOf(f.presence_ref)<0);t[o].unshift(...m)}n(o,u,l)}),this.map(s,(o,l)=>{let c=t[o];if(!c)return;const u=l.map(h=>h.presence_ref);c=c.filter(h=>u.indexOf(h.presence_ref)<0),t[o]=c,a(o,c,l),c.length===0&&delete t[o]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const a=t[n];return"metas"in a?r[n]=a.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):r[n]=a,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var e4;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(e4||(e4={}));var Mf;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(Mf||(Mf={}));var ro;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(ro||(ro={}));class E_{constructor(t,r={config:{}},n){this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=Ln.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new kg(this,ns.join,this.params,this.timeout),this.rejoinTimer=new EN(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Ln.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Ln.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=Ln.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Ln.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=Ln.errored,this.rejoinTimer.scheduleTimeout())}),this._on(ns.reply,{},(a,i)=>{this._trigger(this._replyEventName(i),a)}),this.presence=new Df(this),this.broadcastEndpointURL=TN(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(t,r=this.timeout){var n,a,i;if(this.socket.isConnected()||this.socket.connect(),this.state==Ln.closed){const{config:{broadcast:s,presence:o,private:l}}=this.params,c=(a=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(f=>f.filter))!==null&&a!==void 0?a:[],u=!!this.bindings[Mf.PRESENCE]&&this.bindings[Mf.PRESENCE].length>0||((i=this.params.config.presence)===null||i===void 0?void 0:i.enabled)===!0,h={},m={broadcast:s,presence:Object.assign(Object.assign({},o),{enabled:u}),postgres_changes:c,private:l};this.socket.accessTokenValue&&(h.access_token=this.socket.accessTokenValue),this._onError(f=>t==null?void 0:t(ro.CHANNEL_ERROR,f)),this._onClose(()=>t==null?void 0:t(ro.CLOSED)),this.updateJoinPayload(Object.assign({config:m},h)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:f})=>{var v;if(this.socket.setAuth(),f===void 0){t==null||t(ro.SUBSCRIBED);return}else{const x=this.bindings.postgres_changes,w=(v=x==null?void 0:x.length)!==null&&v!==void 0?v:0,_=[];for(let b=0;b<w;b++){const y=x[b],{filter:{event:N,schema:R,table:P,filter:F}}=y,C=f&&f[b];if(C&&C.event===N&&C.schema===R&&C.table===P&&C.filter===F)_.push(Object.assign(Object.assign({},y),{id:C.id}));else{this.unsubscribe(),this.state=Ln.errored,t==null||t(ro.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=_,t&&t(ro.SUBSCRIBED);return}}).receive("error",f=>{this.state=Ln.errored,t==null||t(ro.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(f).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(ro.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this.state===Ln.joined&&t===Mf.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(t,r,n)}async send(t,r={}){var n,a;if(!this._canPush()&&t.type==="broadcast"){const{event:i,payload:s}=t,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:s,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((a=c.body)===null||a===void 0?void 0:a.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var s,o,l;const c=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((l=(o=(s=this.params)===null||s===void 0?void 0:s.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.ack)&&i("ok"),c.receive("ok",()=>i("ok")),c.receive("error",()=>i("error")),c.receive("timeout",()=>i("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Ln.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(ns.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(a=>{n=new kg(this,ns.leave,{},t),n.receive("ok",()=>{r(),a("ok")}).receive("timeout",()=>{r(),a("timed out")}).receive("error",()=>{a("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Ln.closed,this.bindings={}}async _fetchWithTimeout(t,r,n){const a=new AbortController,i=setTimeout(()=>a.abort(),n),s=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:a.signal}));return clearTimeout(i),s}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new kg(this,t,r,n);return this._canPush()?a.send():this._addToPushBuffer(a),a}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>lU){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var a,i;const s=t.toLocaleLowerCase(),{close:o,error:l,leave:c,join:u}=ns;if(n&&[o,l,c,u].indexOf(s)>=0&&n!==this._joinRef())return;let m=this._onMessage(s,r,n);if(r&&!m)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(s)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(f=>{var v,x,w;return((v=f.filter)===null||v===void 0?void 0:v.event)==="*"||((w=(x=f.filter)===null||x===void 0?void 0:x.event)===null||w===void 0?void 0:w.toLocaleLowerCase())===s}).map(f=>f.callback(m,n)):(i=this.bindings[s])===null||i===void 0||i.filter(f=>{var v,x,w,_,b,y;if(["broadcast","presence","postgres_changes"].includes(s))if("id"in f){const N=f.id,R=(v=f.filter)===null||v===void 0?void 0:v.event;return N&&((x=r.ids)===null||x===void 0?void 0:x.includes(N))&&(R==="*"||(R==null?void 0:R.toLocaleLowerCase())===((w=r.data)===null||w===void 0?void 0:w.type.toLocaleLowerCase()))}else{const N=(b=(_=f==null?void 0:f.filter)===null||_===void 0?void 0:_.event)===null||b===void 0?void 0:b.toLocaleLowerCase();return N==="*"||N===((y=r==null?void 0:r.event)===null||y===void 0?void 0:y.toLocaleLowerCase())}else return f.type.toLocaleLowerCase()===s}).map(f=>{if(typeof m=="object"&&"ids"in m){const v=m.data,{schema:x,table:w,commit_timestamp:_,type:b,errors:y}=v;m=Object.assign(Object.assign({},{schema:x,table:w,commit_timestamp:_,eventType:b,new:{},old:{},errors:y}),this._getPayloadRecords(v))}f.callback(m,n)})}_isClosed(){return this.state===Ln.closed}_isJoined(){return this.state===Ln.joined}_isJoining(){return this.state===Ln.joining}_isLeaving(){return this.state===Ln.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const a=t.toLocaleLowerCase(),i={type:a,filter:r,callback:n};return this.bindings[a]?this.bindings[a].push(i):this.bindings[a]=[i],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(a=>{var i;return!(((i=a.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===n&&E_.isEqual(a.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(ns.close,{},t)}_onError(t){this._on(ns.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Ln.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=Zy(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=Zy(t.columns,t.old_record)),r}}const Sg=()=>{},Jd={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},gU=[1e3,2e3,5e3,1e4],xU=1e4,vU=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class _U{constructor(t,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=dx,this.transport=null,this.heartbeatIntervalMs=Jd.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Sg,this.ref=0,this.reconnectTimer=null,this.logger=Sg,this.conn=null,this.sendBuffer=[],this.serializer=new cU,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=a=>{let i;return a?i=a:typeof fetch>"u"?i=(...s)=>uo(async()=>{const{default:o}=await Promise.resolve().then(()=>_u);return{default:o}},void 0).then(({default:o})=>o(...s)).catch(o=>{throw new Error(`Failed to load @supabase/node-fetch: ${o.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):i=fetch,(...s)=>i(...s)},!(!((n=r==null?void 0:r.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${px.websocket}`,this.httpEndpoint=TN(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=nU.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:sU}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},t?this.conn.close(t,r??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case Rf.connecting:return sc.Connecting;case Rf.open:return sc.Open;case Rf.closing:return sc.Closing;default:return sc.Closed}}isConnected(){return this.connectionState()===sc.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const n=`realtime:${t}`,a=this.getChannels().find(i=>i.topic===n);if(a)return a;{const i=new E_(`realtime:${t}`,r,this);return this.channels.push(i),i}}push(t){const{topic:r,event:n,payload:a,ref:i}=t,s=()=>{this.encode(t,o=>{var l;(l=this.conn)===null||l===void 0||l.send(o)})};this.log("push",`${r} ${n} (${i})`,a),this.isConnected()?s():this.sendBuffer.push(s)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(oU,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},Jd.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(c){this.log("error","error in heartbeat callback",c)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:a,payload:i,ref:s}=r,o=s?`(${s})`:"",l=i.status||"";this.log("receive",`${l} ${n} ${a} ${o}`.trim(),i),this.channels.filter(c=>c._isMember(n)).forEach(c=>c._trigger(a,i,s)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(ns.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",a=new URLSearchParams(r);return`${t}${n}${a}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([vU],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r;t?r=t:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const a={access_token:r,version:iU};r&&n.updateJoinPayload(a),n.joinedOnce&&n._isJoined()&&n._push(ns.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(n=>{try{n(r)}catch(a){this.log("error",`error in ${t} callback`,a)}})}catch(n){this.log("error",`error triggering ${t} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new EN(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Jd.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,n,a,i,s,o,l,c,u;if(this.transport=(r=t==null?void 0:t.transport)!==null&&r!==void 0?r:null,this.timeout=(n=t==null?void 0:t.timeout)!==null&&n!==void 0?n:dx,this.heartbeatIntervalMs=(a=t==null?void 0:t.heartbeatIntervalMs)!==null&&a!==void 0?a:Jd.HEARTBEAT_INTERVAL,this.worker=(i=t==null?void 0:t.worker)!==null&&i!==void 0?i:!1,this.accessToken=(s=t==null?void 0:t.accessToken)!==null&&s!==void 0?s:null,this.heartbeatCallback=(o=t==null?void 0:t.heartbeatCallback)!==null&&o!==void 0?o:Sg,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(l=t==null?void 0:t.reconnectAfterMs)!==null&&l!==void 0?l:h=>gU[h-1]||xU,this.encode=(c=t==null?void 0:t.encode)!==null&&c!==void 0?c:(h,m)=>m(JSON.stringify(h)),this.decode=(u=t==null?void 0:t.decode)!==null&&u!==void 0?u:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}class A_ extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function Pn(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class wU extends A_{constructor(t,r,n){super(t),this.name="StorageApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class gx extends A_{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}var yU=function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function o(u){try{c(n.next(u))}catch(h){s(h)}}function l(u){try{c(n.throw(u))}catch(h){s(h)}}function c(u){u.done?i(u.value):a(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};const CN=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>uo(async()=>{const{default:n}=await Promise.resolve().then(()=>_u);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},bU=()=>yU(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield uo(()=>Promise.resolve().then(()=>_u),void 0)).Response:Response}),xx=e=>{if(Array.isArray(e))return e.map(r=>xx(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const a=r.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));t[a]=xx(n)}),t},kU=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)};var Vc=function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function o(u){try{c(n.next(u))}catch(h){s(h)}}function l(u){try{c(n.throw(u))}catch(h){s(h)}}function c(u){u.done?i(u.value):a(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};const Ng=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),SU=(e,t,r)=>Vc(void 0,void 0,void 0,function*(){const n=yield bU();e instanceof n&&!(r!=null&&r.noResolveJson)?e.json().then(a=>{const i=e.status||500,s=(a==null?void 0:a.statusCode)||i+"";t(new wU(Ng(a),i,s))}).catch(a=>{t(new gx(Ng(a),a))}):t(new gx(Ng(e),e))}),NU=(e,t,r,n)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"||!n?a:(kU(n)?(a.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),a.body=JSON.stringify(n)):a.body=n,t!=null&&t.duplex&&(a.duplex=t.duplex),Object.assign(Object.assign({},a),r))};function Wh(e,t,r,n,a,i){return Vc(this,void 0,void 0,function*(){return new Promise((s,o)=>{e(r,NU(t,n,a,i)).then(l=>{if(!l.ok)throw l;return n!=null&&n.noResolveJson?l:l.json()}).then(l=>s(l)).catch(l=>SU(l,o,n))})})}function mp(e,t,r,n){return Vc(this,void 0,void 0,function*(){return Wh(e,"GET",t,r,n)})}function Ts(e,t,r,n,a){return Vc(this,void 0,void 0,function*(){return Wh(e,"POST",t,n,a,r)})}function vx(e,t,r,n,a){return Vc(this,void 0,void 0,function*(){return Wh(e,"PUT",t,n,a,r)})}function EU(e,t,r,n){return Vc(this,void 0,void 0,function*(){return Wh(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function FN(e,t,r,n,a){return Vc(this,void 0,void 0,function*(){return Wh(e,"DELETE",t,n,a,r)})}var Na=function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function o(u){try{c(n.next(u))}catch(h){s(h)}}function l(u){try{c(n.throw(u))}catch(h){s(h)}}function c(u){u.done?i(u.value):a(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};const AU={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},t4={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class TU{constructor(t,r={},n,a){this.shouldThrowOnError=!1,this.url=t,this.headers=r,this.bucketId=n,this.fetch=CN(a)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(t,r,n,a){return Na(this,void 0,void 0,function*(){try{let i;const s=Object.assign(Object.assign({},t4),a);let o=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(s.upsert)});const l=s.metadata;typeof Blob<"u"&&n instanceof Blob?(i=new FormData,i.append("cacheControl",s.cacheControl),l&&i.append("metadata",this.encodeMetadata(l)),i.append("",n)):typeof FormData<"u"&&n instanceof FormData?(i=n,i.append("cacheControl",s.cacheControl),l&&i.append("metadata",this.encodeMetadata(l))):(i=n,o["cache-control"]=`max-age=${s.cacheControl}`,o["content-type"]=s.contentType,l&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),a!=null&&a.headers&&(o=Object.assign(Object.assign({},o),a.headers));const c=this._removeEmptyFolders(r),u=this._getFinalPath(c),h=yield(t=="PUT"?vx:Ts)(this.fetch,`${this.url}/object/${u}`,i,Object.assign({headers:o},s!=null&&s.duplex?{duplex:s.duplex}:{}));return{data:{path:c,id:h.Id,fullPath:h.Key},error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Pn(i))return{data:null,error:i};throw i}})}upload(t,r,n){return Na(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,a){return Na(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(t),s=this._getFinalPath(i),o=new URL(this.url+`/object/upload/sign/${s}`);o.searchParams.set("token",r);try{let l;const c=Object.assign({upsert:t4.upsert},a),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&n instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",n)):typeof FormData<"u"&&n instanceof FormData?(l=n,l.append("cacheControl",c.cacheControl)):(l=n,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType);const h=yield vx(this.fetch,o.toString(),l,{headers:u});return{data:{path:i,fullPath:h.Key},error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(Pn(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(t,r){return Na(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const a=Object.assign({},this.headers);r!=null&&r.upsert&&(a["x-upsert"]="true");const i=yield Ts(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:a}),s=new URL(this.url+i.url),o=s.searchParams.get("token");if(!o)throw new A_("No token returned by API");return{data:{signedUrl:s.toString(),path:t,token:o},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Pn(n))return{data:null,error:n};throw n}})}update(t,r,n){return Na(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r,n){return Na(this,void 0,void 0,function*(){try{return{data:yield Ts(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Pn(a))return{data:null,error:a};throw a}})}copy(t,r,n){return Na(this,void 0,void 0,function*(){try{return{data:{path:(yield Ts(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Pn(a))return{data:null,error:a};throw a}})}createSignedUrl(t,r,n){return Na(this,void 0,void 0,function*(){try{let a=this._getFinalPath(t),i=yield Ts(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const s=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${s}`)},{data:i,error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Pn(a))return{data:null,error:a};throw a}})}createSignedUrls(t,r,n){return Na(this,void 0,void 0,function*(){try{const a=yield Ts(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),i=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:a.map(s=>Object.assign(Object.assign({},s),{signedUrl:s.signedURL?encodeURI(`${this.url}${s.signedURL}${i}`):null})),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Pn(a))return{data:null,error:a};throw a}})}download(t,r){return Na(this,void 0,void 0,function*(){const a=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),s=i?`?${i}`:"";try{const o=this._getFinalPath(t);return{data:yield(yield mp(this.fetch,`${this.url}/${a}/${o}${s}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(Pn(o))return{data:null,error:o};throw o}})}info(t){return Na(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const n=yield mp(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:xx(n),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Pn(n))return{data:null,error:n};throw n}})}exists(t){return Na(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield EU(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Pn(n)&&n instanceof gx){const a=n.originalError;if([400,404].includes(a==null?void 0:a.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,r){const n=this._getFinalPath(t),a=[],i=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";i!==""&&a.push(i);const o=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});l!==""&&a.push(l);let c=a.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${n}${c}`)}}}remove(t){return Na(this,void 0,void 0,function*(){try{return{data:yield FN(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Pn(r))return{data:null,error:r};throw r}})}list(t,r,n){return Na(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},AU),r),{prefix:t||""});return{data:yield Ts(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},n),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Pn(a))return{data:null,error:a};throw a}})}listV2(t,r){return Na(this,void 0,void 0,function*(){try{const n=Object.assign({},t);return{data:yield Ts(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Pn(n))return{data:null,error:n};throw n}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const CU="2.12.1",FU={"X-Client-Info":`storage-js/${CU}`};var o0=function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function o(u){try{c(n.next(u))}catch(h){s(h)}}function l(u){try{c(n.throw(u))}catch(h){s(h)}}function c(u){u.done?i(u.value):a(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};class LU{constructor(t,r={},n,a){this.shouldThrowOnError=!1;const i=new URL(t);a!=null&&a.useNewHostname&&/supabase\.(co|in|red)$/.test(i.hostname)&&!i.hostname.includes("storage.supabase.")&&(i.hostname=i.hostname.replace("supabase.","storage.supabase.")),this.url=i.href,this.headers=Object.assign(Object.assign({},FU),r),this.fetch=CN(n)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return o0(this,void 0,void 0,function*(){try{return{data:yield mp(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Pn(t))return{data:null,error:t};throw t}})}getBucket(t){return o0(this,void 0,void 0,function*(){try{return{data:yield mp(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Pn(r))return{data:null,error:r};throw r}})}createBucket(t,r={public:!1}){return o0(this,void 0,void 0,function*(){try{return{data:yield Ts(this.fetch,`${this.url}/bucket`,{id:t,name:t,type:r.type,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Pn(n))return{data:null,error:n};throw n}})}updateBucket(t,r){return o0(this,void 0,void 0,function*(){try{return{data:yield vx(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Pn(n))return{data:null,error:n};throw n}})}emptyBucket(t){return o0(this,void 0,void 0,function*(){try{return{data:yield Ts(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Pn(r))return{data:null,error:r};throw r}})}deleteBucket(t){return o0(this,void 0,void 0,function*(){try{return{data:yield FN(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Pn(r))return{data:null,error:r};throw r}})}}class PU extends LU{constructor(t,r={},n,a){super(t,r,n,a)}from(t){return new TU(this.url,this.headers,t,this.fetch)}}const IU="2.57.4";let gf="";typeof Deno<"u"?gf="deno":typeof document<"u"?gf="web":typeof navigator<"u"&&navigator.product==="ReactNative"?gf="react-native":gf="node";const OU={"X-Client-Info":`supabase-js-${gf}/${IU}`},jU={headers:OU},RU={schema:"public"},DU={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},MU={};var BU=function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function o(u){try{c(n.next(u))}catch(h){s(h)}}function l(u){try{c(n.throw(u))}catch(h){s(h)}}function c(u){u.done?i(u.value):a(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};const UU=e=>{let t;return e?t=e:typeof fetch>"u"?t=mN:t=fetch,(...r)=>t(...r)},zU=()=>typeof Headers>"u"?gN:Headers,$U=(e,t,r)=>{const n=UU(r),a=zU();return(i,s)=>BU(void 0,void 0,void 0,function*(){var o;const l=(o=yield t())!==null&&o!==void 0?o:e;let c=new a(s==null?void 0:s.headers);return c.has("apikey")||c.set("apikey",e),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),n(i,Object.assign(Object.assign({},s),{headers:c}))})};var WU=function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function o(u){try{c(n.next(u))}catch(h){s(h)}}function l(u){try{c(n.throw(u))}catch(h){s(h)}}function c(u){u.done?i(u.value):a(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};function HU(e){return e.endsWith("/")?e:e+"/"}function VU(e,t){var r,n;const{db:a,auth:i,realtime:s,global:o}=e,{db:l,auth:c,realtime:u,global:h}=t,m={db:Object.assign(Object.assign({},l),a),auth:Object.assign(Object.assign({},c),i),realtime:Object.assign(Object.assign({},u),s),storage:{},global:Object.assign(Object.assign(Object.assign({},h),o),{headers:Object.assign(Object.assign({},(r=h==null?void 0:h.headers)!==null&&r!==void 0?r:{}),(n=o==null?void 0:o.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>WU(this,void 0,void 0,function*(){return""})};return e.accessToken?m.accessToken=e.accessToken:delete m.accessToken,m}function qU(e){const t=e==null?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(HU(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const LN="2.71.1",x0=30*1e3,_x=3,Eg=_x*x0,GU="http://localhost:9999",XU="supabase.auth.token",KU={"X-Client-Info":`gotrue-js/${LN}`},wx="X-Supabase-Api-Version",PN={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},YU=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,JU=10*60*1e3;class T_ extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function Bt(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class ZU extends T_{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function QU(e){return Bt(e)&&e.name==="AuthApiError"}class IN extends T_{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class Pl extends T_{constructor(t,r,n,a){super(t,n,a),this.name=r,this.status=n}}class Xo extends Pl{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function ez(e){return Bt(e)&&e.name==="AuthSessionMissingError"}class Zd extends Pl{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Qd extends Pl{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class e1 extends Pl{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function tz(e){return Bt(e)&&e.name==="AuthImplicitGrantRedirectError"}class r4 extends Pl{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class yx extends Pl{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function Ag(e){return Bt(e)&&e.name==="AuthRetryableFetchError"}class n4 extends Pl{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class bx extends Pl{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const gp="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),a4=` 	
\r=`.split(""),rz=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<a4.length;t+=1)e[a4[t].charCodeAt(0)]=-2;for(let t=0;t<gp.length;t+=1)e[gp[t].charCodeAt(0)]=t;return e})();function i4(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(gp[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(gp[n]),t.queuedBits-=6}}function ON(e,t,r){const n=rz[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function s4(e){const t=[],r=s=>{t.push(String.fromCodePoint(s))},n={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},i=s=>{iz(s,n,r)};for(let s=0;s<e.length;s+=1)ON(e.charCodeAt(s),a,i);return t.join("")}function nz(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function az(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const a=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|a)+65536,r+=1}nz(n,t)}}function iz(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function sz(e){const t=[],r={queue:0,queuedBits:0},n=a=>{t.push(a)};for(let a=0;a<e.length;a+=1)ON(e.charCodeAt(a),r,n);return new Uint8Array(t)}function oz(e){const t=[];return az(e,r=>t.push(r)),new Uint8Array(t)}function lz(e){const t=[],r={queue:0,queuedBits:0},n=a=>{t.push(a)};return e.forEach(a=>i4(a,r,n)),i4(null,r,n),t.join("")}function cz(e){return Math.round(Date.now()/1e3)+e}function uz(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const es=()=>typeof window<"u"&&typeof document<"u",Ql={tested:!1,writable:!1},jN=()=>{if(!es())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Ql.tested)return Ql.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Ql.tested=!0,Ql.writable=!0}catch{Ql.tested=!0,Ql.writable=!1}return Ql.writable};function fz(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((a,i)=>{t[i]=a})}catch{}return r.searchParams.forEach((n,a)=>{t[a]=n}),t}const RN=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>uo(async()=>{const{default:n}=await Promise.resolve().then(()=>_u);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},hz=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",v0=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},ec=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},Ho=async(e,t)=>{await e.removeItem(t)};class Zp{constructor(){this.promise=new Zp.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}Zp.promiseConstructor=Promise;function Tg(e){const t=e.split(".");if(t.length!==3)throw new bx("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!YU.test(t[n]))throw new bx("JWT not in base64url format");return{header:JSON.parse(s4(t[0])),payload:JSON.parse(s4(t[1])),signature:sz(t[2]),raw:{header:t[0],payload:t[1]}}}async function dz(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function pz(e,t){return new Promise((n,a)=>{(async()=>{for(let i=0;i<1/0;i++)try{const s=await e(i);if(!t(i,null,s)){n(s);return}}catch(s){if(!t(i,s)){a(s);return}}})()})}function mz(e){return("0"+e.toString(16)).substr(-2)}function gz(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let a="";for(let i=0;i<56;i++)a+=r.charAt(Math.floor(Math.random()*n));return a}return crypto.getRandomValues(t),Array.from(t,mz).join("")}async function xz(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),a=new Uint8Array(n);return Array.from(a).map(i=>String.fromCharCode(i)).join("")}async function vz(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await xz(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function l0(e,t,r=!1){const n=gz();let a=n;r&&(a+="/PASSWORD_RECOVERY"),await v0(e,`${t}-code-verifier`,a);const i=await vz(n);return[i,n===i?"plain":"s256"]}const _z=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function wz(e){const t=e.headers.get(wx);if(!t||!t.match(_z))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function yz(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function bz(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const kz=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function c0(e){if(!kz.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Cg(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function o4(e){return JSON.parse(JSON.stringify(e))}var Sz=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};const nc=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Nz=[502,503,504];async function l4(e){var t;if(!hz(e))throw new yx(nc(e),0);if(Nz.includes(e.status))throw new yx(nc(e),e.status);let r;try{r=await e.json()}catch(i){throw new IN(nc(i),i)}let n;const a=wz(e);if(a&&a.getTime()>=PN["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new n4(nc(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new Xo}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((i,s)=>i&&typeof s=="string",!0))throw new n4(nc(r),e.status,r.weak_password.reasons);throw new ZU(nc(r),e.status||500,n)}const Ez=(e,t,r,n)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),a.body=JSON.stringify(n),Object.assign(Object.assign({},a),r))};async function Kt(e,t,r,n){var a;const i=Object.assign({},n==null?void 0:n.headers);i[wx]||(i[wx]=PN["2024-01-01"].name),n!=null&&n.jwt&&(i.Authorization=`Bearer ${n.jwt}`);const s=(a=n==null?void 0:n.query)!==null&&a!==void 0?a:{};n!=null&&n.redirectTo&&(s.redirect_to=n.redirectTo);const o=Object.keys(s).length?"?"+new URLSearchParams(s).toString():"",l=await Az(e,t,r+o,{headers:i,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(l):{data:Object.assign({},l),error:null}}async function Az(e,t,r,n,a,i){const s=Ez(t,n,a,i);let o;try{o=await e(r,Object.assign({},s))}catch(l){throw console.error(l),new yx(nc(l),0)}if(o.ok||await l4(o),n!=null&&n.noResolveJson)return o;try{return await o.json()}catch(l){await l4(l)}}function eo(e){var t;let r=null;Lz(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=cz(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function c4(e){const t=eo(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function el(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function Tz(e){return{data:e,error:null}}function Cz(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:i}=e,s=Sz(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:i},l=Object.assign({},s);return{data:{properties:o,user:l},error:null}}function Fz(e){return e}function Lz(e){return e.access_token&&e.refresh_token&&e.expires_in}const Fg=["global","local","others"];var Pz=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};class Iz{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=RN(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,r=Fg[0]){if(Fg.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Fg.join(", ")}`);try{return await Kt(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Bt(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await Kt(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:el})}catch(n){if(Bt(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=Pz(t,["options"]),a=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(a.new_email=n==null?void 0:n.newEmail,delete a.newEmail),await Kt(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:Cz,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(Bt(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await Kt(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:el})}catch(r){if(Bt(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,a,i,s,o,l;try{const c={nextPage:null,lastPage:0,total:0},u=await Kt(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(i=(a=t==null?void 0:t.perPage)===null||a===void 0?void 0:a.toString())!==null&&i!==void 0?i:""},xform:Fz});if(u.error)throw u.error;const h=await u.json(),m=(s=u.headers.get("x-total-count"))!==null&&s!==void 0?s:0,f=(l=(o=u.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return f.length>0&&(f.forEach(v=>{const x=parseInt(v.split(";")[0].split("=")[1].substring(0,1)),w=JSON.parse(v.split(";")[1].split("=")[1]);c[`${w}Page`]=x}),c.total=parseInt(m)),{data:Object.assign(Object.assign({},h),c),error:null}}catch(c){if(Bt(c))return{data:{users:[]},error:c};throw c}}async getUserById(t){c0(t);try{return await Kt(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:el})}catch(r){if(Bt(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){c0(t);try{return await Kt(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:el})}catch(n){if(Bt(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){c0(t);try{return await Kt(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:el})}catch(n){if(Bt(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){c0(t.userId);try{const{data:r,error:n}=await Kt(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:r,error:n}}catch(r){if(Bt(r))return{data:null,error:r};throw r}}async _deleteFactor(t){c0(t.userId),c0(t.id);try{return{data:await Kt(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(Bt(r))return{data:null,error:r};throw r}}}function u4(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}function Oz(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const u0={debug:!!(globalThis&&jN()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class DN extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class jz extends DN{}async function Rz(e,t,r){u0.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),u0.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async a=>{if(a){u0.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,a.name);try{return await r()}finally{u0.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,a.name)}}else{if(t===0)throw u0.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new jz(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(u0.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}Oz();const Dz={url:GU,storageKey:XU,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:KU,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function f4(e,t,r){return await r()}const f0={};class _h{constructor(t){var r,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=_h.nextInstanceID,_h.nextInstanceID+=1,this.instanceID>0&&es()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const a=Object.assign(Object.assign({},Dz),t);if(this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.persistSession=a.persistSession,this.storageKey=a.storageKey,this.autoRefreshToken=a.autoRefreshToken,this.admin=new Iz({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=RN(a.fetch),this.lock=a.lock||f4,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,a.lock?this.lock=a.lock:es()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=Rz:this.lock=f4,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(a.storage?this.storage=a.storage:jN()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=u4(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=u4(this.memoryStorage)),es()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}get jwks(){var t,r;return(r=(t=f0[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){f0[this.storageKey]=Object.assign(Object.assign({},f0[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=f0[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){f0[this.storageKey]=Object.assign(Object.assign({},f0[this.storageKey]),{cachedAt:t})}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${LN}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const r=fz(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),es()&&this.detectSessionInUrl&&n!=="none"){const{data:a,error:i}=await this._getSessionFromURL(r,n);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),tz(i)){const l=(t=i.details)===null||t===void 0?void 0:t.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:s,redirectType:o}=a;return this._debug("#_initialize()","detected session in URL",s,"redirect type",o),await this._saveSession(s),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",s):await this._notifyAllSubscribers("SIGNED_IN",s)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Bt(r)?{error:r}:{error:new IN("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,a;try{const i=await Kt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(a=t==null?void 0:t.options)===null||a===void 0?void 0:a.captchaToken}},xform:eo}),{data:s,error:o}=i;if(o||!s)return{data:{user:null,session:null},error:o};const l=s.session,c=s.user;return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(i){if(Bt(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(t){var r,n,a;try{let i;if("email"in t){const{email:u,password:h,options:m}=t;let f=null,v=null;this.flowType==="pkce"&&([f,v]=await l0(this.storage,this.storageKey)),i=await Kt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:m==null?void 0:m.emailRedirectTo,body:{email:u,password:h,data:(r=m==null?void 0:m.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:m==null?void 0:m.captchaToken},code_challenge:f,code_challenge_method:v},xform:eo})}else if("phone"in t){const{phone:u,password:h,options:m}=t;i=await Kt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:h,data:(n=m==null?void 0:m.data)!==null&&n!==void 0?n:{},channel:(a=m==null?void 0:m.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:m==null?void 0:m.captchaToken}},xform:eo})}else throw new Qd("You must provide either an email or phone number and a password");const{data:s,error:o}=i;if(o||!s)return{data:{user:null,session:null},error:o};const l=s.session,c=s.user;return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(i){if(Bt(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(t){try{let r;if("email"in t){const{email:i,password:s,options:o}=t;r=await Kt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:s,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:c4})}else if("phone"in t){const{phone:i,password:s,options:o}=t;r=await Kt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:s,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:c4})}else throw new Qd("You must provide either an email or phone number and a password");const{data:n,error:a}=r;return a?{data:{user:null,session:null},error:a}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new Zd}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:a})}catch(r){if(Bt(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(t){var r,n,a,i;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(a=t.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(i=t.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;if(r==="solana")return await this.signInWithSolana(t);throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}async signInWithSolana(t){var r,n,a,i,s,o,l,c,u,h,m,f;let v,x;if("message"in t)v=t.message,x=t.signature;else{const{chain:w,wallet:_,statement:b,options:y}=t;let N;if(es())if(typeof _=="object")N=_;else{const P=window;if("solana"in P&&typeof P.solana=="object"&&("signIn"in P.solana&&typeof P.solana.signIn=="function"||"signMessage"in P.solana&&typeof P.solana.signMessage=="function"))N=P.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof _!="object"||!(y!=null&&y.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");N=_}const R=new URL((r=y==null?void 0:y.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in N&&N.signIn){const P=await N.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},y==null?void 0:y.signInWithSolana),{version:"1",domain:R.host,uri:R.href}),b?{statement:b}:null));let F;if(Array.isArray(P)&&P[0]&&typeof P[0]=="object")F=P[0];else if(P&&typeof P=="object"&&"signedMessage"in P&&"signature"in P)F=P;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in F&&"signature"in F&&(typeof F.signedMessage=="string"||F.signedMessage instanceof Uint8Array)&&F.signature instanceof Uint8Array)v=typeof F.signedMessage=="string"?F.signedMessage:new TextDecoder().decode(F.signedMessage),x=F.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in N)||typeof N.signMessage!="function"||!("publicKey"in N)||typeof N!="object"||!N.publicKey||!("toBase58"in N.publicKey)||typeof N.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");v=[`${R.host} wants you to sign in with your Solana account:`,N.publicKey.toBase58(),...b?["",b,""]:[""],"Version: 1",`URI: ${R.href}`,`Issued At: ${(a=(n=y==null?void 0:y.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((i=y==null?void 0:y.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${y.signInWithSolana.notBefore}`]:[],...!((s=y==null?void 0:y.signInWithSolana)===null||s===void 0)&&s.expirationTime?[`Expiration Time: ${y.signInWithSolana.expirationTime}`]:[],...!((o=y==null?void 0:y.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${y.signInWithSolana.chainId}`]:[],...!((l=y==null?void 0:y.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${y.signInWithSolana.nonce}`]:[],...!((c=y==null?void 0:y.signInWithSolana)===null||c===void 0)&&c.requestId?[`Request ID: ${y.signInWithSolana.requestId}`]:[],...!((h=(u=y==null?void 0:y.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||h===void 0)&&h.length?["Resources",...y.signInWithSolana.resources.map(F=>`- ${F}`)]:[]].join(`
`);const P=await N.signMessage(new TextEncoder().encode(v),"utf8");if(!P||!(P instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");x=P}}try{const{data:w,error:_}=await Kt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:v,signature:lz(x)},!((m=t.options)===null||m===void 0)&&m.captchaToken?{gotrue_meta_security:{captcha_token:(f=t.options)===null||f===void 0?void 0:f.captchaToken}}:null),xform:eo});if(_)throw _;return!w||!w.session||!w.user?{data:{user:null,session:null},error:new Zd}:(w.session&&(await this._saveSession(w.session),await this._notifyAllSubscribers("SIGNED_IN",w.session)),{data:Object.assign({},w),error:_})}catch(w){if(Bt(w))return{data:{user:null,session:null},error:w};throw w}}async _exchangeCodeForSession(t){const r=await ec(this.storage,`${this.storageKey}-code-verifier`),[n,a]=(r??"").split("/");try{const{data:i,error:s}=await Kt(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:eo});if(await Ho(this.storage,`${this.storageKey}-code-verifier`),s)throw s;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new Zd}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:a??null}),error:s})}catch(i){if(Bt(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(t){try{const{options:r,provider:n,token:a,access_token:i,nonce:s}=t,o=await Kt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:a,access_token:i,nonce:s,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:eo}),{data:l,error:c}=o;return c?{data:{user:null,session:null},error:c}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new Zd}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:c})}catch(r){if(Bt(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(t){var r,n,a,i,s;try{if("email"in t){const{email:o,options:l}=t;let c=null,u=null;this.flowType==="pkce"&&([c,u]=await l0(this.storage,this.storageKey));const{error:h}=await Kt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(r=l==null?void 0:l.data)!==null&&r!==void 0?r:{},create_user:(n=l==null?void 0:l.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:c,code_challenge_method:u},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in t){const{phone:o,options:l}=t,{data:c,error:u}=await Kt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(a=l==null?void 0:l.data)!==null&&a!==void 0?a:{},create_user:(i=l==null?void 0:l.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(s=l==null?void 0:l.channel)!==null&&s!==void 0?s:"sms"}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:u}}throw new Qd("You must provide either an email or phone number.")}catch(o){if(Bt(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(t){var r,n;try{let a,i;"options"in t&&(a=(r=t.options)===null||r===void 0?void 0:r.redirectTo,i=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:s,error:o}=await Kt(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:i}}),redirectTo:a,xform:eo});if(o)throw o;if(!s)throw new Error("An error occurred on token verification.");const l=s.session,c=s.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(a){if(Bt(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithSSO(t){var r,n,a;try{let i=null,s=null;return this.flowType==="pkce"&&([i,s]=await l0(this.storage,this.storageKey)),await Kt(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((a=t==null?void 0:t.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:s}),headers:this.headers,xform:Tz})}catch(i){if(Bt(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new Xo;const{error:a}=await Kt(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:a}})}catch(t){if(Bt(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:a,options:i}=t,{error:s}=await Kt(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:a,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:s}}else if("phone"in t){const{phone:n,type:a,options:i}=t,{data:s,error:o}=await Kt(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:a,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:s==null?void 0:s.message_id},error:o}}throw new Qd("You must provide either an email or phone number and a type")}catch(r){if(Bt(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await ec(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<Eg:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.userStorage){const s=await ec(this.userStorage,this.storageKey+"-user");s!=null&&s.user?t.user=s.user:t.user=Cg()}if(this.storage.isServer&&t.user){let s=this.suppressGetSessionWarning;t=new Proxy(t,{get:(l,c,u)=>(!s&&c==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),s=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,c,u))})}return{data:{session:t},error:null}}const{session:a,error:i}=await this._callRefreshToken(t.refresh_token);return i?{data:{session:null},error:i}:{data:{session:a},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await Kt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:el}):await this._useSession(async r=>{var n,a,i;const{data:s,error:o}=r;if(o)throw o;return!(!((n=s.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Xo}:await Kt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(a=s.session)===null||a===void 0?void 0:a.access_token)!==null&&i!==void 0?i:void 0,xform:el})})}catch(r){if(Bt(r))return ez(r)&&(await this._removeSession(),await Ho(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:a,error:i}=n;if(i)throw i;if(!a.session)throw new Xo;const s=a.session;let o=null,l=null;this.flowType==="pkce"&&t.email!=null&&([o,l]=await l0(this.storage,this.storageKey));const{data:c,error:u}=await Kt(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:o,code_challenge_method:l}),jwt:s.access_token,xform:el});if(u)throw u;return s.user=c.user,await this._saveSession(s),await this._notifyAllSubscribers("USER_UPDATED",s),{data:{user:s.user},error:null}})}catch(n){if(Bt(n))return{data:{user:null},error:n};throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Xo;const r=Date.now()/1e3;let n=r,a=!0,i=null;const{payload:s}=Tg(t.access_token);if(s.exp&&(n=s.exp,a=n<=r),a){const{session:o,error:l}=await this._callRefreshToken(t.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!o)return{data:{user:null,session:null},error:null};i=o}else{const{data:o,error:l}=await this._getUser(t.access_token);if(l)throw l;i={access_token:t.access_token,refresh_token:t.refresh_token,user:o.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(r){if(Bt(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:s,error:o}=r;if(o)throw o;t=(n=s.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new Xo;const{session:a,error:i}=await this._callRefreshToken(t.refresh_token);return i?{data:{user:null,session:null},error:i}:a?{data:{user:a.user,session:a},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(Bt(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(t,r){try{if(!es())throw new e1("No browser detected.");if(t.error||t.error_description||t.error_code)throw new e1(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new r4("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new e1("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new r4("No code detected.");const{data:b,error:y}=await this._exchangeCodeForSession(t.code);if(y)throw y;const N=new URL(window.location.href);return N.searchParams.delete("code"),window.history.replaceState(window.history.state,"",N.toString()),{data:{session:b.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:a,access_token:i,refresh_token:s,expires_in:o,expires_at:l,token_type:c}=t;if(!i||!o||!s||!c)throw new e1("No session defined in URL");const u=Math.round(Date.now()/1e3),h=parseInt(o);let m=u+h;l&&(m=parseInt(l));const f=m-u;f*1e3<=x0&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${f}s, should have been closer to ${h}s`);const v=m-h;u-v>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",v,m,u):u-v<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",v,m,u);const{data:x,error:w}=await this._getUser(i);if(w)throw w;const _={provider_token:n,provider_refresh_token:a,access_token:i,expires_in:h,expires_at:m,refresh_token:s,token_type:c,user:x.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:_,redirectType:t.type},error:null}}catch(n){if(Bt(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await ec(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:a,error:i}=r;if(i)return{error:i};const s=(n=a.session)===null||n===void 0?void 0:n.access_token;if(s){const{error:o}=await this.admin.signOut(s,t);if(o&&!(QU(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return t!=="others"&&(await this._removeSession(),await Ho(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const r=uz(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,a;try{const{data:{session:i},error:s}=r;if(s)throw s;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",t,"session",i)}catch(i){await((a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",i),console.error(i)}})}async resetPasswordForEmail(t,r={}){let n=null,a=null;this.flowType==="pkce"&&([n,a]=await l0(this.storage,this.storageKey,!0));try{return await Kt(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:a,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(i){if(Bt(i))return{data:null,error:i};throw i}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(r){if(Bt(r))return{data:null,error:r};throw r}}async linkIdentity(t){var r;try{const{data:n,error:a}=await this._useSession(async i=>{var s,o,l,c,u;const{data:h,error:m}=i;if(m)throw m;const f=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(s=t.options)===null||s===void 0?void 0:s.redirectTo,scopes:(o=t.options)===null||o===void 0?void 0:o.scopes,queryParams:(l=t.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await Kt(this.fetch,"GET",f,{headers:this.headers,jwt:(u=(c=h.session)===null||c===void 0?void 0:c.access_token)!==null&&u!==void 0?u:void 0})});if(a)throw a;return es()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:t.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(Bt(n))return{data:{provider:t.provider,url:null},error:n};throw n}}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,a;const{data:i,error:s}=r;if(s)throw s;return await Kt(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(a=(n=i.session)===null||n===void 0?void 0:n.access_token)!==null&&a!==void 0?a:void 0})})}catch(r){if(Bt(r))return{data:null,error:r};throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await pz(async a=>(a>0&&await dz(200*Math.pow(2,a-1)),this._debug(r,"refreshing attempt",a),await Kt(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:eo})),(a,i)=>{const s=200*Math.pow(2,a);return i&&Ag(i)&&Date.now()+s-n<x0})}catch(n){if(this._debug(r,"error",n),Bt(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),es()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const a=await ec(this.storage,this.storageKey);if(a&&this.userStorage){let s=await ec(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!s&&(s={user:a.user},await v0(this.userStorage,this.storageKey+"-user",s)),a.user=(t=s==null?void 0:s.user)!==null&&t!==void 0?t:Cg()}else if(a&&!a.user&&!a.user){const s=await ec(this.storage,this.storageKey+"-user");s&&(s!=null&&s.user)?(a.user=s.user,await Ho(this.storage,this.storageKey+"-user"),await v0(this.storage,this.storageKey,a)):a.user=Cg()}if(this._debug(n,"session from storage",a),!this._isValidSession(a)){this._debug(n,"session is not valid"),a!==null&&await this._removeSession();return}const i=((r=a.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<Eg;if(this._debug(n,`session has${i?"":" not"} expired with margin of ${Eg}s`),i){if(this.autoRefreshToken&&a.refresh_token){const{error:s}=await this._callRefreshToken(a.refresh_token);s&&(console.error(s),Ag(s)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",s),await this._removeSession()))}}else if(a.user&&a.user.__isUserNotAvailableProxy===!0)try{const{data:s,error:o}=await this._getUser(a.access_token);!o&&(s!=null&&s.user)?(a.user=s.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(s){console.error("Error getting user data:",s),this._debug(n,"error getting user data, skipping SIGNED_IN notification",s)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(n,"error",a),console.error(a);return}finally{this._debug(n,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new Xo;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new Zp;const{data:i,error:s}=await this._refreshAccessToken(t);if(s)throw s;if(!i.session)throw new Xo;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const o={session:i.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(i){if(this._debug(a,"error",i),Bt(i)){const s={session:null,error:i};return Ag(i)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(s),s}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(i),i}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(t,r,n=!0){const a=`#_notifyAllSubscribers(${t})`;this._debug(a,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const i=[],s=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(t,r)}catch(l){i.push(l)}});if(await Promise.all(s),i.length>0){for(let o=0;o<i.length;o+=1)console.error(i[o]);throw i[0]}}finally{this._debug(a,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const r=Object.assign({},t),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await v0(this.userStorage,this.storageKey+"-user",{user:r.user});const a=Object.assign({},r);delete a.user;const i=o4(a);await v0(this.storage,this.storageKey,i)}else{const a=o4(r);await v0(this.storage,this.storageKey,a)}}async _removeSession(){this._debug("#_removeSession()"),await Ho(this.storage,this.storageKey),await Ho(this.storage,this.storageKey+"-code-verifier"),await Ho(this.storage,this.storageKey+"-user"),this.userStorage&&await Ho(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&es()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),x0);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((n.expires_at*1e3-t)/x0);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${x0}ms, refresh threshold is ${_x} ticks`),a<=_x&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof DN)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!es()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const a=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&a.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&a.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[i,s]=await l0(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(s)}`});a.push(o.toString())}if(n!=null&&n.queryParams){const i=new URLSearchParams(n.queryParams);a.push(i.toString())}return n!=null&&n.skipBrowserRedirect&&a.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${a.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:a,error:i}=r;return i?{data:null,error:i}:await Kt(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Bt(r))return{data:null,error:r};throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,a;const{data:i,error:s}=r;if(s)return{data:null,error:s};const o=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:l,error:c}=await Kt(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return c?{data:null,error:c}:(t.factorType==="totp"&&(!((a=l==null?void 0:l.totp)===null||a===void 0)&&a.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(r){if(Bt(r))return{data:null,error:r};throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:i}=r;if(i)return{data:null,error:i};const{data:s,error:o}=await Kt(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+s.expires_in},s)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",s),{data:s,error:o})})}catch(r){if(Bt(r))return{data:null,error:r};throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:i}=r;return i?{data:null,error:i}:await Kt(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Bt(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?{data:null,error:n}:await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){const{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};const n=(t==null?void 0:t.factors)||[],a=n.filter(s=>s.factor_type==="totp"&&s.status==="verified"),i=n.filter(s=>s.factor_type==="phone"&&s.status==="verified");return{data:{all:n,totp:a,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var r,n;const{data:{session:a},error:i}=t;if(i)return{data:null,error:i};if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:s}=Tg(a.access_token);let o=null;s.aal&&(o=s.aal);let l=o;((n=(r=a.user.factors)===null||r===void 0?void 0:r.filter(h=>h.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(l="aal2");const u=s.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:u},error:null}}))}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(o=>o.kid===t);if(n)return n;const a=Date.now();if(n=this.jwks.keys.find(o=>o.kid===t),n&&this.jwks_cached_at+JU>a)return n;const{data:i,error:s}=await Kt(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(s)throw s;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=a,n=i.keys.find(o=>o.kid===t),!n)?null:n}async getClaims(t,r={}){try{let n=t;if(!n){const{data:f,error:v}=await this.getSession();if(v||!f.session)return{data:null,error:v};n=f.session.access_token}const{header:a,payload:i,signature:s,raw:{header:o,payload:l}}=Tg(n);r!=null&&r.allowExpired||yz(i.exp);const c=!a.alg||a.alg.startsWith("HS")||!a.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(a.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!c){const{error:f}=await this.getUser(n);if(f)throw f;return{data:{claims:i,header:a,signature:s},error:null}}const u=bz(a.alg),h=await crypto.subtle.importKey("jwk",c,u,!0,["verify"]);if(!await crypto.subtle.verify(u,h,s,oz(`${o}.${l}`)))throw new bx("Invalid JWT signature");return{data:{claims:i,header:a,signature:s},error:null}}catch(n){if(Bt(n))return{data:null,error:n};throw n}}}_h.nextInstanceID=0;const Mz=_h;class Bz extends Mz{constructor(t){super(t)}}var Uz=function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function o(u){try{c(n.next(u))}catch(h){s(h)}}function l(u){try{c(n.throw(u))}catch(h){s(h)}}function c(u){u.done?i(u.value):a(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};class zz{constructor(t,r,n){var a,i,s;this.supabaseUrl=t,this.supabaseKey=r;const o=qU(t);if(!r)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",o),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",o),this.storageUrl=new URL("storage/v1",o),this.functionsUrl=new URL("functions/v1",o);const l=`sb-${o.hostname.split(".")[0]}-auth-token`,c={db:RU,realtime:MU,auth:Object.assign(Object.assign({},DU),{storageKey:l}),global:jU},u=VU(n??{},c);this.storageKey=(a=u.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(i=u.global.headers)!==null&&i!==void 0?i:{},u.accessToken?(this.accessToken=u.accessToken,this.auth=new Proxy({},{get:(h,m)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(m)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((s=u.auth)!==null&&s!==void 0?s:{},this.headers,u.global.fetch),this.fetch=$U(r,this._getAccessToken.bind(this),u.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},u.realtime)),this.rest=new rU(new URL("rest/v1",o).href,{headers:this.headers,schema:u.db.schema,fetch:this.fetch}),this.storage=new PU(this.storageUrl.href,this.headers,this.fetch,n==null?void 0:n.storage),u.accessToken||this._listenForAuthEvents()}get functions(){return new OB(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},n={}){return this.rest.rpc(t,r,n)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,r;return Uz(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:a,userStorage:i,storageKey:s,flowType:o,lock:l,debug:c},u,h){const m={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Bz({url:this.authUrl.href,headers:Object.assign(Object.assign({},m),u),storageKey:s,autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:a,userStorage:i,flowType:o,lock:l,debug:c,fetch:h,hasCustomAuthorizationHeader:Object.keys(this.headers).some(f=>f.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new _U(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(t,r,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const $z=(e,t,r)=>new zz(e,t,r);function Wz(){if(typeof window<"u"||typeof process>"u")return!1;const e=process.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}Wz()&&console.warn("⚠️  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Hz="https://cknjwwnyukkonjnayqko.supabase.co",Vz="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNrbmp3d255dWtrb25qbmF5cWtvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk2NjMzODUsImV4cCI6MjA3NTIzOTM4NX0.Ku6PHOESu1inLV1jP-NiKeLQlVd3y0qLNatF_txpAYA",Ir=$z(Hz,Vz);async function h4(e,t,r,n,a){if(n.length===0)throw new Error("No companies to save");const i=Math.round(n.reduce((b,y)=>b+y.overall_score,0)/n.length),s=n.filter(b=>b.has_gmn_profile).length,o=Math.round(s/n.length*100);let l;i>=80?l="green":i>=50?l="yellow":l="red";const c=[`${n.length-s} empresas sem perfil GMN (${100-o}%)`,`${n.filter(b=>b.overall_score<70).length} empresas precisam de otimização urgente`,`${n.filter(b=>b.review_response_rate<50).length} empresas com baixa taxa de resposta a avaliações`],u=["Criar perfis GMN para empresas sem presença online","Implementar estratégia de solicitação de avaliações","Adicionar pelo menos 10 fotos de qualidade em cada perfil","Responder todas as avaliações (meta: 80% de taxa de resposta)","Publicar 2-3 vezes por semana no GMN"],h={segmentAverage:i,positionInSegment:i>=70?"Acima da média":"Abaixo da média",keyDifferentiators:[`${o}% das empresas possui perfil GMN`,`Média de ${Math.round(n.reduce((b,y)=>b+y.total_reviews,0)/n.length)} avaliações por empresa`,`Nota média do segmento: ${(n.reduce((b,y)=>b+y.rating,0)/n.length).toFixed(1)}`]},m={segment:e,city:t,state:r,overall_score:i,compliance_status:l,opportunities:c,suggestions:u,local_comparison:h,ai_analysis:`Análise de ${n.length} empresas reais do segmento ${e} em ${t}. Score médio: ${i}/100. ${s} empresas possuem perfil GMN verificado.`,companies_analyzed:n.length},{data:f,error:v}=await Ir.from("gmn_audits").insert(m).select().single();if(v)throw console.error("Error saving audit:",v),new Error(`Failed to save audit: ${v.message}`);const x=f.id,w=n.map(b=>({audit_id:x,company_name:b.company_name,city:b.city,state:b.state,category:b.category,has_gmn_profile:b.has_gmn_profile,address:b.address,phone:b.phone,website:b.website,rating:b.rating,total_reviews:b.total_reviews,verification_status:b.verification_status,nap_consistency_score:b.nap_consistency_score,has_products:b.has_products,images_count:b.images_count,has_geotags:b.has_geotags,posts_per_week:b.posts_per_week,review_response_rate:b.review_response_rate,seo_score:b.seo_score,engagement_score:b.overall_score,improvement_points:b.improvement_points,should_invite_for_optimization:b.should_invite_for_optimization})),{error:_}=await Ir.from("gmn_empresas").insert(w);if(_)throw console.error("Error saving companies:",_),new Error(`Failed to save companies: ${_.message}`);return x}const qz=({onComplete:e})=>{const[t,r]=nt.useState(null),[n,a]=nt.useState([]),[i,s]=nt.useState(!1),[o,l]=nt.useState(null),[c,u]=nt.useState(null),[h,m]=nt.useState(0),[,f]=nt.useState(!1),[v,x]=nt.useState([]),w=nt.useRef(!1);nt.useEffect(()=>{if(i){m(0);const R=setInterval(()=>{m(P=>P+1)},1e3);return()=>clearInterval(R)}},[i]);const _=async R=>{var F;const P=(F=R.target.files)==null?void 0:F[0];if(P){r(P),u(null);try{const C=await EB(P);a(C),console.log(`Arquivo carregado: ${C.length} empresas encontradas`)}catch(C){const A=C instanceof Error?C.message:"Erro ao ler arquivo";u(A),r(null),a([])}}},b=()=>{console.log("🛑 Usuário solicitou parar o processamento"),w.current=!0,f(!0)},y=()=>{console.log("🔄 Reiniciando processamento"),w.current=!1,l(null),u(null),x([]),f(!1)},N=async()=>{var R,P,F,C,A;if(n.length!==0){s(!0),u(null),w.current=!1,f(!1),x([]);try{console.log(`🚀 Iniciando processamento de ${n.length} empresas...`);const W=[];for(let L=0;L<n.length;L++){if(w.current){console.log("⏹️ Processamento interrompido pelo usuário"),u("Processamento interrompido pelo usuário");break}l({current:L+1,total:n.length,percentage:Math.round((L+1)/n.length*100),currentCompany:n[L].company_name,status:"processing"});try{const{auditSingleCompany:I}=await uo(async()=>{const{auditSingleCompany:Q}=await import("./batchAudit-D86ja_6h.js");return{auditSingleCompany:Q}},[]),V=await I(n[L]);W.push(V),x([...W]),console.log(`✅ ${L+1}/${n.length} - ${n[L].company_name}`)}catch(I){console.error(`❌ Erro em ${n[L].company_name}:`,I),W.push({...n[L],has_gmn_profile:!1,verification_status:"Erro na análise",nap_consistency_score:0,has_products:!1,images_count:0,has_geotags:!1,posts_per_week:0,rating:0,total_reviews:0,review_response_rate:0,seo_score:0,engagement_score:0,overall_score:0,improvement_points:["Erro ao processar"],should_invite_for_optimization:!0})}L<n.length-1&&await new Promise(I=>setTimeout(I,1e3))}if(!w.current&&W.length>0){console.log("✅ Todas as empresas foram processadas!"),console.log("📊 Total de resultados:",W.length);const L=((R=n[0])==null?void 0:R.category)||"Diversos",I=((P=n[0])==null?void 0:P.city)||"Múltiplas cidades",V=(F=n[0])==null?void 0:F.state;console.log("💾 Salvando no banco de dados...");const Q=await h4(L,I,V,W);console.log(`✅ Auditoria salva com ID: ${Q}`),console.log("🎯 Chamando onComplete com",W.length,"resultados"),e(Q,W)}else if(w.current&&W.length>0){console.log("⚠️ Processamento interrompido. Mostrando resultados parciais:",W.length);const L=await h4("Parcial",((C=n[0])==null?void 0:C.city)||"N/A",(A=n[0])==null?void 0:A.state,W);e(L,W)}}catch(W){console.error("❌ Erro no processamento:",W);const L=W instanceof Error?W.message:"Erro desconhecido";u(`Erro ao processar: ${L}`)}finally{s(!1)}}};return d.jsx("div",{className:"max-w-4xl mx-auto",children:d.jsxs("div",{className:"bg-white/95 backdrop-blur-sm rounded-2xl shadow-xl border border-white/20 p-8",children:[d.jsxs("div",{className:"text-center mb-8",children:[d.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-blue-500 to-blue-700 rounded-2xl mb-4 shadow-lg",children:d.jsx(Z2,{className:"w-8 h-8 text-white"})}),d.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Auditoria em Lote"}),d.jsx("p",{className:"text-gray-600",children:"Analise centenas de empresas reais do Google Meu Negócio"})]}),!i&&!o&&d.jsxs("div",{children:[d.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-xl p-8 text-center hover:border-blue-400 transition-colors cursor-pointer",children:[d.jsx("input",{type:"file",accept:".csv,.txt,.xls,.xlsx",onChange:_,className:"hidden",id:"file-upload",disabled:i}),d.jsxs("label",{htmlFor:"file-upload",className:"cursor-pointer",children:[d.jsx(Z2,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),d.jsx("p",{className:"text-gray-700 font-medium mb-2",children:"Clique para selecionar arquivo"}),d.jsx("p",{className:"text-sm text-gray-500",children:"Formatos: CSV, XLS, XLSX"})]})]}),t&&n.length>0&&d.jsx("div",{className:"mt-6 bg-green-50 border border-green-200 rounded-lg p-4",children:d.jsxs("div",{className:"flex items-start gap-3",children:[d.jsx(J2,{className:"w-5 h-5 text-green-600 mt-0.5"}),d.jsxs("div",{children:[d.jsx("p",{className:"text-green-900 font-medium",children:"Arquivo carregado com sucesso!"}),d.jsxs("p",{className:"text-sm text-green-700 mt-1",children:[n.length," empresas encontradas"]}),d.jsxs("p",{className:"text-xs text-green-600 mt-2",children:["Tempo estimado: ",Math.ceil(n.length/10)," minutos"]})]})]})}),c&&d.jsx("div",{className:"mt-6 bg-red-50 border border-red-200 rounded-lg p-4",children:d.jsxs("div",{className:"flex items-start gap-3",children:[d.jsx(Ov,{className:"w-5 h-5 text-red-600 mt-0.5"}),d.jsxs("div",{children:[d.jsx("p",{className:"text-red-900 font-medium",children:"Erro"}),d.jsx("p",{className:"text-sm text-red-700 mt-1",children:c})]})]})}),n.length>0&&d.jsxs("button",{onClick:N,className:"w-full mt-6 bg-gradient-to-r from-blue-500 to-blue-700 text-white font-semibold py-4 px-6 rounded-xl hover:from-blue-600 hover:to-blue-800 transition-all duration-200 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5",children:["Iniciar Análise de ",n.length," Empresas"]}),d.jsxs("div",{className:"mt-8 pt-6 border-t border-gray-200",children:[d.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Formato da Planilha:"}),d.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 text-sm text-gray-700",children:[d.jsx("p",{className:"mb-3 font-semibold text-gray-800",children:"Formatos aceitos: CSV, XLS, XLSX"}),d.jsx("p",{className:"mb-2",children:"Colunas obrigatórias:"}),d.jsxs("ul",{className:"list-disc list-inside space-y-1 ml-2",children:[d.jsxs("li",{children:[d.jsx("span",{className:"font-mono font-semibold",children:"Nome da Empresa"}),", ",d.jsx("span",{className:"font-mono",children:"Empresa"}),", ou ",d.jsx("span",{className:"font-mono",children:"Razão Social"})]}),d.jsxs("li",{children:[d.jsx("span",{className:"font-mono font-semibold",children:"Cidade"})," ou ",d.jsx("span",{className:"font-mono",children:"Município"})]})]}),d.jsx("p",{className:"mt-3 mb-2",children:"Colunas opcionais (melhoram a análise):"}),d.jsxs("ul",{className:"list-disc list-inside space-y-1 ml-2",children:[d.jsxs("li",{children:[d.jsx("span",{className:"font-mono",children:"Estado"})," ou ",d.jsx("span",{className:"font-mono",children:"UF"})]}),d.jsxs("li",{children:[d.jsx("span",{className:"font-mono",children:"Categoria"})," ou ",d.jsx("span",{className:"font-mono",children:"Segmento"})]}),d.jsx("li",{children:d.jsx("span",{className:"font-mono",children:"Telefone"})}),d.jsx("li",{children:d.jsx("span",{className:"font-mono",children:"Endereço"})}),d.jsx("li",{children:d.jsx("span",{className:"font-mono",children:"Website"})})]})]})]})]}),i&&o&&d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6",children:[d.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[d.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),d.jsxs("div",{className:"flex-1",children:[d.jsx("p",{className:"text-lg font-semibold text-blue-900",children:"Processando empresas..."}),d.jsxs("p",{className:"text-sm text-blue-700 mt-1",children:[o.current," de ",o.total," empresas (",o.percentage,"%)"]})]})]}),d.jsxs("div",{className:"mb-3",children:[d.jsxs("div",{className:"flex justify-between text-sm text-blue-700 mb-1",children:[d.jsxs("span",{children:["Empresa atual: ",o.currentCompany]}),d.jsxs("span",{children:[o.percentage,"%"]})]}),d.jsx("div",{className:"w-full bg-blue-200 rounded-full h-3 overflow-hidden",children:d.jsx("div",{className:"bg-blue-600 h-full transition-all duration-500 ease-out",style:{width:`${o.percentage}%`}})})]}),d.jsxs("div",{className:"flex items-center justify-between text-xs text-blue-600 mt-4",children:[d.jsxs("div",{children:[d.jsxs("p",{children:["⏱️ Tempo decorrido: ",d.jsxs("span",{className:"font-bold",children:[Math.floor(h/60),":",(h%60).toString().padStart(2,"0")]})]}),d.jsxs("p",{className:"mt-1",children:["⏳ Tempo estimado restante: ",d.jsxs("span",{className:"font-bold",children:[Math.ceil((o.total-o.current)/10)," minutos"]})]})]}),d.jsx("div",{className:"text-right",children:d.jsxs("p",{className:"font-medium text-blue-700",children:[o.current,"/",o.total," empresas"]})})]}),d.jsx("p",{className:"text-xs text-blue-600 mt-3 font-medium",children:"⚠️ Não feche esta janela durante o processamento"}),d.jsxs("div",{className:"flex gap-3 mt-4",children:[d.jsx("button",{onClick:b,className:"flex-1 bg-red-500 hover:bg-red-600 text-white font-semibold py-3 px-4 rounded-lg transition-colors",children:"⏹️ Parar Processamento"}),d.jsx("button",{onClick:y,className:"flex-1 bg-gray-500 hover:bg-gray-600 text-white font-semibold py-3 px-4 rounded-lg transition-colors",children:"🔄 Reiniciar"})]})]}),v.length>0&&d.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:d.jsxs("p",{className:"text-sm text-green-800",children:[d.jsx("strong",{children:"✅ Processados:"})," ",v.length," resultados prontos"]})}),d.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:d.jsxs("p",{className:"text-sm text-yellow-800",children:[d.jsx("strong",{children:"Como funciona:"})," A IA está analisando cada empresa individualmente no Google Meu Negócio, verificando os 12 critérios de auditoria. Isso pode levar alguns minutos."]})})]})]})})},Gz=({results:e,onNewAudit:t})=>{console.log("🎯 BatchAuditResults renderizado com",e.length,"resultados"),console.log("📊 Primeiros 3 resultados:",e.slice(0,3));const r=e.length,n=e.filter(m=>m.has_gmn_profile).length,a=r-n,i=Math.round(e.reduce((m,f)=>m+f.overall_score,0)/r),s=e.filter(m=>m.has_gmn_profile&&m.should_invite_for_optimization).length,o=a,l=()=>{window.print()},c=()=>{var P,F;const m=new Date,f=m.toLocaleDateString("pt-BR"),v=m.toLocaleTimeString("pt-BR"),x=((P=e[0])==null?void 0:P.category)||"Diversos",w=((F=e[0])==null?void 0:F.city)||"Múltiplas cidades",_=e.map(C=>{const A=C.improvement_points,W={Empresa:C.company_name,Cidade:C.city,Estado:C.state||"","Tem Perfil GMN":C.has_gmn_profile?"Sim":"Não","Status Verificação":C.verification_status,"Score Geral":C.overall_score,"Nota Google":C.rating,"Total Avaliações":C.total_reviews,"Score NAP":C.nap_consistency_score,"Tem Produtos":C.has_products?"Sim":"Não","Qtd Imagens":C.images_count,"Tem Geotags":C.has_geotags?"Sim":"Não","Posts/Semana":C.posts_per_week,"Taxa Resposta (%)":C.review_response_rate,"Score SEO":C.seo_score,"Score Engajamento":C.engagement_score,"Convidar para Otimização":C.should_invite_for_optimization?"Sim":"Não"};for(let L=0;L<5;L++)W[`Melhoria ${L+1}`]=A[L]||"";return W}),b=Er.json_to_sheet(_),y=Er.decode_range(b["!ref"]||"A1");b["!cols"]=[{wch:31},{wch:22},{wch:6},{wch:18},{wch:18},{wch:8},{wch:8},{wch:8},{wch:8},{wch:8},{wch:8},{wch:8},{wch:8},{wch:8},{wch:8},{wch:8},{wch:10},{wch:40},{wch:40},{wch:40},{wch:40},{wch:40}];for(let C=y.s.c;C<=y.e.c;++C){const A=Er.encode_col(C)+"1";b[A]&&(b[A].s={fill:{fgColor:{rgb:"000000"}},font:{name:"Segoe UI",sz:10,color:{rgb:"FFFFFF"},bold:!0},alignment:{horizontal:"center",vertical:"center"}})}for(let C=y.s.r;C<=y.e.r;++C)for(let A=y.s.c;A<=y.e.c;++A){const W=Er.encode_cell({r:C,c:A});b[W]&&C>0&&(b[W].s={font:{name:"Segoe UI",sz:10},alignment:{wrapText:!0,vertical:"top"}})}b["!autofilter"]={ref:Er.encode_range(y)};const N=y.e.r+3;b[`A${N}`]={v:`Relatório gerado em: ${f} às ${v}`,t:"s",s:{font:{name:"Segoe UI",sz:10,bold:!0}}},b[`A${N+1}`]={v:`Segmento: ${x}`,t:"s",s:{font:{name:"Segoe UI",sz:10,bold:!0}}},b[`A${N+2}`]={v:`Cidade: ${w}`,t:"s",s:{font:{name:"Segoe UI",sz:10,bold:!0}}},y.e.r=N+2,b["!ref"]=Er.encode_range(y);const R=Er.book_new();Er.book_append_sheet(R,b,"Auditoria GMN"),fN(R,`Auditoria_GMN_${f.replace(/\//g,"-")}.xlsx`)},u=m=>m>=80?"text-green-600 bg-green-50 border-green-200":m>=60?"text-yellow-600 bg-yellow-50 border-yellow-200":"text-red-600 bg-red-50 border-red-200",h=m=>m?d.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-green-100 text-green-700 rounded-full text-xs font-medium",children:[d.jsx(nu,{className:"w-3 h-3"}),"Possui GMN"]}):d.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-red-100 text-red-700 rounded-full text-xs font-medium",children:[d.jsx(jv,{className:"w-3 h-3"}),"Sem GMN"]});return e.length===0?(console.warn("⚠️ BatchAuditResults renderizado mas results está vazio!"),d.jsxs("div",{className:"bg-white rounded-xl p-8 text-center",children:[d.jsx("p",{className:"text-gray-600",children:"Nenhum resultado disponível"}),d.jsx("button",{onClick:t,className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-lg",children:"Nova Auditoria"})]})):d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("h2",{className:"text-2xl font-bold text-white",children:"Resultados da Auditoria"}),d.jsxs("div",{className:"flex gap-3 print:hidden",children:[d.jsxs("button",{onClick:l,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors",children:[d.jsx(aS,{className:"w-4 h-4"}),"Imprimir"]}),d.jsxs("button",{onClick:c,className:"flex items-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-700 text-white font-medium rounded-lg transition-colors",children:[d.jsx(Ih,{className:"w-4 h-4"}),"Exportar Excel"]}),d.jsx("button",{onClick:t,className:"px-4 py-2 bg-white/20 hover:bg-white/30 text-white font-medium rounded-lg transition-colors backdrop-blur-sm",children:"Nova Auditoria"})]})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[d.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-lg",children:[d.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Total de Empresas"}),d.jsx("p",{className:"text-3xl font-bold text-gray-900",children:r})]}),d.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-lg",children:[d.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Com Perfil GMN"}),d.jsxs("div",{className:"flex items-baseline gap-2",children:[d.jsx("p",{className:"text-3xl font-bold text-green-600",children:n}),d.jsxs("p",{className:"text-sm text-gray-500",children:["(",Math.round(n/r*100),"%)"]})]})]}),d.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-lg",children:[d.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Sem Perfil GMN"}),d.jsxs("div",{className:"flex items-baseline gap-2",children:[d.jsx("p",{className:"text-3xl font-bold text-red-600",children:a}),d.jsxs("p",{className:"text-sm text-gray-500",children:["(",Math.round(a/r*100),"%)"]})]})]}),d.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-lg",children:[d.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Score Médio"}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("p",{className:`text-3xl font-bold ${i>=70?"text-green-600":i>=50?"text-yellow-600":"text-red-600"}`,children:i}),d.jsx("span",{className:"text-gray-500",children:"/100"})]})]})]}),d.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-lg",children:[d.jsx("div",{className:"flex items-center justify-between mb-4",children:d.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Oportunidades de Negócio"})}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[d.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 border border-blue-200",children:[d.jsx("p",{className:"text-sm text-blue-700 mb-2",children:"Criação de Perfil GMN"}),d.jsx("p",{className:"text-2xl font-bold text-blue-900",children:o}),d.jsx("p",{className:"text-xs text-blue-600 mt-1",children:"perfis sem GMN"})]}),d.jsxs("div",{className:"bg-orange-50 rounded-lg p-4 border border-orange-200",children:[d.jsx("p",{className:"text-sm text-orange-700 mb-2",children:"Otimização Necessária"}),d.jsx("p",{className:"text-2xl font-bold text-orange-900",children:s}),d.jsx("p",{className:"text-xs text-orange-600 mt-1",children:"perfis com GMN a otimizar"})]}),d.jsxs("div",{className:"bg-green-50 rounded-lg p-4 border border-green-200",children:[d.jsx("p",{className:"text-sm text-green-700 mb-2",children:"Potencial Total"}),d.jsx("p",{className:"text-2xl font-bold text-green-900",children:o+s}),d.jsx("p",{className:"text-xs text-green-600 mt-1",children:"leads qualificados"})]})]})]}),d.jsxs("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden",children:[d.jsxs("div",{className:"p-6 border-b border-gray-200",children:[d.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Empresas Analisadas"}),d.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Resultados detalhados de cada empresa"})]}),d.jsx("div",{className:"overflow-x-auto",children:d.jsxs("table",{className:"w-full",children:[d.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:d.jsxs("tr",{children:[d.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase",children:"Empresa"}),d.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase",children:"Cidade"}),d.jsx("th",{className:"px-6 py-3 text-center text-xs font-semibold text-gray-700 uppercase",children:"Status"}),d.jsx("th",{className:"px-6 py-3 text-center text-xs font-semibold text-gray-700 uppercase",children:"Score"}),d.jsx("th",{className:"px-6 py-3 text-center text-xs font-semibold text-gray-700 uppercase",children:"Nota"}),d.jsx("th",{className:"px-6 py-3 text-center text-xs font-semibold text-gray-700 uppercase",children:"Avaliações"}),d.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase",children:"Ação"})]})}),d.jsx("tbody",{className:"divide-y divide-gray-200",children:e.map((m,f)=>d.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[d.jsx("td",{className:"px-6 py-4",children:d.jsxs("div",{children:[d.jsx("p",{className:"font-medium text-gray-900",children:m.company_name}),d.jsx("p",{className:"text-xs text-gray-500",children:m.category||"Sem categoria"})]})}),d.jsxs("td",{className:"px-6 py-4 text-sm text-gray-700",children:[m.city,m.state?`, ${m.state}`:""]}),d.jsx("td",{className:"px-6 py-4 text-center",children:h(m.has_gmn_profile)}),d.jsx("td",{className:"px-6 py-4 text-center",children:d.jsx("span",{className:`inline-block px-3 py-1 rounded-full text-sm font-bold border ${u(m.overall_score)}`,children:m.overall_score})}),d.jsx("td",{className:"px-6 py-4 text-center",children:m.has_gmn_profile?d.jsxs("div",{className:"flex items-center justify-center gap-1",children:[d.jsx("span",{className:"text-yellow-500",children:"★"}),d.jsx("span",{className:"font-medium text-gray-900",children:m.rating.toFixed(1)})]}):d.jsx("span",{className:"text-gray-400",children:"-"})}),d.jsx("td",{className:"px-6 py-4 text-center text-sm text-gray-700",children:m.has_gmn_profile?m.total_reviews:"-"}),d.jsx("td",{className:"px-6 py-4",children:m.has_gmn_profile?m.should_invite_for_optimization?d.jsxs("span",{className:"inline-flex items-center gap-1 text-xs font-medium text-orange-700",children:[d.jsx(fo,{className:"w-3 h-3"}),"Otimizar"]}):d.jsxs("span",{className:"inline-flex items-center gap-1 text-xs font-medium text-green-700",children:[d.jsx(nu,{className:"w-3 h-3"}),"Bom"]}):d.jsxs("span",{className:"inline-flex items-center gap-1 text-xs font-medium text-blue-700",children:[d.jsx(fo,{className:"w-3 h-3"}),"Criar GMN"]})})]},f))})]})})]})]})},Xz=({onSubmit:e,onBack:t})=>{const[r,n]=nt.useState(""),[a,i]=nt.useState(""),[s,o]=nt.useState(""),[l,c]=nt.useState(""),u=h=>{if(h.preventDefault(),!r.trim()||!a.trim()||!s.trim()){c("Todos os campos são obrigatórios");return}c(""),e(r.trim(),a.trim(),s.trim())};return d.jsxs("div",{className:"max-w-3xl mx-auto",children:[d.jsx("button",{onClick:t,className:"mb-6 px-4 py-2 bg-white/20 hover:bg-white/30 text-white font-medium rounded-lg transition-colors backdrop-blur-sm",children:"← Voltar"}),d.jsxs("div",{className:"bg-white/95 backdrop-blur-sm rounded-2xl shadow-xl border border-white/20 p-8",children:[d.jsxs("div",{className:"text-center mb-8",children:[d.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-green-500 to-green-700 rounded-2xl mb-4 shadow-lg",children:d.jsx(fo,{className:"w-8 h-8 text-white"})}),d.jsx("h2",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Comparação Competitiva"}),d.jsx("p",{className:"text-gray-600",children:"Compare sua empresa com o líder do segmento na cidade"})]}),d.jsxs("form",{onSubmit:u,className:"space-y-6",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"companyName",className:"block text-sm font-semibold text-gray-700 mb-2",children:"Nome da Empresa"}),d.jsx("input",{type:"text",id:"companyName",value:r,onChange:h=>n(h.target.value),placeholder:"Ex: Restaurante Bella Italia",className:"w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-green-500 focus:ring-2 focus:ring-green-200 transition-all outline-none"})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"city",className:"block text-sm font-semibold text-gray-700 mb-2",children:"Cidade"}),d.jsx("input",{type:"text",id:"city",value:a,onChange:h=>i(h.target.value),placeholder:"Ex: São Paulo",className:"w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-green-500 focus:ring-2 focus:ring-green-200 transition-all outline-none"})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"segment",className:"block text-sm font-semibold text-gray-700 mb-2",children:"Segmento"}),d.jsx("input",{type:"text",id:"segment",value:s,onChange:h=>o(h.target.value),placeholder:"Ex: Restaurante Italiano",className:"w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-green-500 focus:ring-2 focus:ring-green-200 transition-all outline-none"})]}),l&&d.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:d.jsxs("div",{className:"flex items-start gap-3",children:[d.jsx(Ov,{className:"w-5 h-5 text-red-600 mt-0.5"}),d.jsxs("div",{children:[d.jsx("p",{className:"text-red-900 font-medium",children:"Erro"}),d.jsx("p",{className:"text-sm text-red-700 mt-1",children:l})]})]})}),d.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:d.jsxs("p",{className:"text-sm text-blue-800",children:[d.jsx("strong",{children:"Como funciona:"}),' Vamos buscar o líder do segmento "',s||"...",'" em "',a||"...",'" e comparar com "',r||"...",'" em 12 critérios diferentes, fornecendo sugestões detalhadas para ultrapassar a concorrência.']})}),d.jsx("button",{type:"submit",className:"w-full bg-gradient-to-r from-green-500 to-green-700 text-white font-semibold py-4 px-6 rounded-xl hover:from-green-600 hover:to-green-800 transition-all duration-200 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5",children:"Analisar e Comparar"})]})]})]})};function C_(){return"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"}function Kz(){return C_().trim().length>0}const Yz="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";function Jz(){try{const e=C_();if(e&&e.length>20)return console.log("✅ Usando API Key do config:",e.substring(0,20)+"..."),e}catch(e){console.warn("⚠️ Erro ao buscar chave do config:",e)}return console.log("🔄 Usando chave fallback"),Yz}console.log("OpenAI API Key configurada:",Kz()?"Sim (tamanho: "+C_().length+")":"NÃO");async function Vo(e,t,r=!0){var u,h;const n=Jz();if(!n||n.length<20)throw new Error("Chave da API OpenAI não configurada. Por favor, configure a variável VITE_OPENAI_API_KEY no arquivo .env");const a=e.includes("Retorne apenas o texto")||e.includes("sem JSON"),i=r&&!a,s={model:"gpt-4o-mini",messages:[{role:"system",content:i?"Você é um especialista em auditoria de Google Meu Negócio. Responda SEMPRE em formato JSON válido.":"Você é um especialista em auditoria de Google Meu Negócio."},{role:"user",content:e}],temperature:.3,max_tokens:2e3};i&&(s.response_format={type:"json_object"});const o=await fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`},body:JSON.stringify(s)});if(!o.ok){const m=await o.json().catch(()=>({}));throw new Error(`OpenAI API error: ${o.status} - ${JSON.stringify(m)}`)}const c=(h=(u=(await o.json()).choices[0])==null?void 0:u.message)==null?void 0:h.content;if(!c)throw new Error("No content received from OpenAI");return c.trim()}async function Zz(e,t,r){var I;console.log(`🔍 Buscando líder do segmento "${r}" em "${t}"...`);const n=`Encontre a empresa líder do segmento "${r}" em "${t}" no Google Meu Negócio.

Retorne APENAS um JSON com o nome da empresa líder:
{
  "leader_name": "Nome Completo da Empresa Líder"
}`,a=await Vo(n),s=JSON.parse(a).leader_name;console.log(`👑 Líder identificado: ${s}`),console.log(`📊 Analisando ${e}...`);const o=`Você é analista de GMN. Crie uma análise REALISTA e VARIADA de "${e}" em "${t}", segmento "${r}".

IMPORTANTE - DADOS DEVEM SER DIFERENTES E REALISTAS:
- Esta é a empresa ANALISADA (normalmente tem scores MENORES que o líder)
- Rating: varie entre 3.5 a 4.5 (use decimais diferentes como 3.8, 4.2)
- Reviews: varie entre 30-180 (números ESPECÍFICOS, não redondos)
- Images: varie entre 15-65
- Overall score: entre 50-75 para empresa analisada
- NÃO invente email/telefone - use null
- Endereço: apenas cidade e bairro estimado

Retorne APENAS JSON:
{
  "has_gmn_profile": true,
  "verification_status": "Verificado",
  "rating": 4.1,
  "total_reviews": 87,
  "nap_consistency_score": 65,
  "has_products": true,
  "images_count": 32,
  "has_geotags": true,
  "posts_per_week": 1,
  "review_response_rate": 55,
  "seo_score": 60,
  "engagement_score": 58,
  "overall_score": 62,
  "email": null,
  "phone": null,
  "whatsapp": null,
  "address": "${t}, Centro",
  "gmn_url": "https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(e+" "+t)}",
  "website": null,
  "instagram": null,
  "facebook": null,
  "waze": false,
  "uber": false,
  "99": false,
  "ifood": false
}`,l=await Vo(o),c=JSON.parse(l);console.log(`📊 Analisando ${s} (líder)...`);const u=`Você é analista de GMN. Crie uma análise REALISTA do LÍDER "${s}" em "${t}", segmento "${r}".

IMPORTANTE - EMPRESA LÍDER TEM MELHORES SCORES:
- Esta é a empresa LÍDER (deve ter scores MAIORES)
- Rating: entre 4.4 a 4.9 (use decimais específicos como 4.7, 4.8)
- Reviews: entre 120-350 (números ESPECÍFICOS e DIFERENTES da empresa analisada)
- Images: entre 45-95 (DIFERENTE da outra empresa)
- Overall score: entre 75-88 para líder
- NÃO invente email/telefone - use null
- Dados DEVEM ser DIFERENTES dos da empresa analisada

Retorne APENAS JSON com dados DIFERENTES:
{
  "has_gmn_profile": true,
  "verification_status": "Verificado",
  "rating": 4.6,
  "total_reviews": 218,
  "nap_consistency_score": 88,
  "has_products": true,
  "images_count": 67,
  "has_geotags": true,
  "posts_per_week": 3,
  "review_response_rate": 92,
  "seo_score": 85,
  "engagement_score": 82,
  "overall_score": 81,
  "email": null,
  "phone": null,
  "whatsapp": null,
  "address": "${t}, região nobre",
  "gmn_url": "https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(s+" "+t)}",
  "website": null,
  "instagram": null,
  "facebook": null,
  "waze": true,
  "uber": true,
  "99": true,
  "ifood": true
}`,h=await Vo(u),m=JSON.parse(h);console.log("⚖️ Gerando comparação detalhada...");const f=`Compare "${e}" (empresa) com "${s}" (líder do segmento) em 12 critérios.

Dados da Empresa:
${JSON.stringify(c,null,2)}

Dados do Líder:
${JSON.stringify(m,null,2)}

Retorne um JSON com comparação detalhada em 12 critérios:
{
  "criteria": [
    {
      "name": "Perfil Verificado",
      "company_score": number (0-10),
      "leader_score": number (0-10),
      "gap": number,
      "improvements": ["sugestão 1", "sugestão 2", "sugestão 3"],
      "priority": "high" | "medium" | "low"
    },
    {
      "name": "Avaliações e Nota",
      "company_score": number (0-10),
      "leader_score": number (0-10),
      "gap": number,
      "improvements": ["sugestão 1", "sugestão 2"],
      "priority": "high" | "medium" | "low"
    },
    {
      "name": "Consistência NAP",
      "company_score": number (0-10),
      "leader_score": number (0-10),
      "gap": number,
      "improvements": ["sugestão 1", "sugestão 2"],
      "priority": "high" | "medium" | "low"
    },
    {
      "name": "Produtos/Serviços",
      "company_score": number (0-10),
      "leader_score": number (0-10),
      "gap": number,
      "improvements": ["sugestão 1", "sugestão 2"],
      "priority": "high" | "medium" | "low"
    },
    {
      "name": "Galeria de Imagens",
      "company_score": number (0-10),
      "leader_score": number (0-10),
      "gap": number,
      "improvements": ["sugestão 1", "sugestão 2"],
      "priority": "high" | "medium" | "low"
    },
    {
      "name": "Geolocalização",
      "company_score": number (0-10),
      "leader_score": number (0-10),
      "gap": number,
      "improvements": ["sugestão 1", "sugestão 2"],
      "priority": "high" | "medium" | "low"
    },
    {
      "name": "Frequência de Posts",
      "company_score": number (0-10),
      "leader_score": number (0-10),
      "gap": number,
      "improvements": ["sugestão 1", "sugestão 2"],
      "priority": "high" | "medium" | "low"
    },
    {
      "name": "Resposta a Avaliações",
      "company_score": number (0-10),
      "leader_score": number (0-10),
      "gap": number,
      "improvements": ["sugestão 1", "sugestão 2"],
      "priority": "high" | "medium" | "low"
    },
    {
      "name": "Otimização SEO Local",
      "company_score": number (0-10),
      "leader_score": number (0-10),
      "gap": number,
      "improvements": ["sugestão 1", "sugestão 2"],
      "priority": "high" | "medium" | "low"
    },
    {
      "name": "Engajamento do Público",
      "company_score": number (0-10),
      "leader_score": number (0-10),
      "gap": number,
      "improvements": ["sugestão 1", "sugestão 2"],
      "priority": "high" | "medium" | "low"
    },
    {
      "name": "Horário de Funcionamento",
      "company_score": number (0-10),
      "leader_score": number (0-10),
      "gap": number,
      "improvements": ["sugestão 1", "sugestão 2"],
      "priority": "high" | "medium" | "low"
    },
    {
      "name": "Atributos e Facilidades",
      "company_score": number (0-10),
      "leader_score": number (0-10),
      "gap": number,
      "improvements": ["sugestão 1", "sugestão 2"],
      "priority": "high" | "medium" | "low"
    }
  ],
  "strategic_recommendations": [
    "Recomendação estratégica detalhada 1 (mínimo 50 caracteres)",
    "Recomendação estratégica detalhada 2 (mínimo 50 caracteres)",
    "Recomendação estratégica detalhada 3 (mínimo 50 caracteres)",
    "Recomendação estratégica detalhada 4 (mínimo 50 caracteres)",
    "Recomendação estratégica detalhada 5 (mínimo 50 caracteres)"
  ],
  "quick_wins": [
    "Vitória rápida detalhada 1 que pode ser implementada em 30 dias",
    "Vitória rápida detalhada 2 que pode ser implementada em 30 dias",
    "Vitória rápida detalhada 3 que pode ser implementada em 30 dias",
    "Vitória rápida detalhada 4 que pode ser implementada em 30 dias",
    "Vitória rápida detalhada 5 que pode ser implementada em 30 dias"
  ],
  "long_term_goals": [
    "Meta de longo prazo detalhada 1 (90+ dias) com descrição completa",
    "Meta de longo prazo detalhada 2 (90+ dias) com descrição completa",
    "Meta de longo prazo detalhada 3 (90+ dias) com descrição completa",
    "Meta de longo prazo detalhada 4 (90+ dias) com descrição completa"
  ]
}

IMPORTANTE: PREENCHA TODOS OS ARRAYS ACIMA COM CONTEÚDO REAL E DETALHADO!`,v=await Vo(f);console.log("📋 Resposta da API (comparison):",v);let x;try{x=JSON.parse(v),console.log("✅ Critérios parseados:",((I=x.criteria)==null?void 0:I.length)||0)}catch(V){throw console.error("❌ Erro ao fazer parse da resposta:",V),new Error("A API retornou dados inválidos para a comparação.")}console.log("📝 Gerando síntese executiva...");const w=`Crie uma SÍNTESE EXECUTIVA comparando "${e}" com "${s}" (líder do segmento).

Dados da Empresa:
${JSON.stringify(c,null,2)}

Dados do Líder:
${JSON.stringify(m,null,2)}

Diferença de Score: ${c.overall_score-m.overall_score}

Crie uma síntese com MÁXIMO 1000 caracteres destacando:
- Posição atual da empresa em relação ao líder
- Principais pontos fortes e fracos
- Gap mais crítico
- Perspectiva geral de melhoria

Retorne apenas o texto da síntese, sem JSON.`,_=await Vo(w);console.log("🗺️ Gerando roadmap de melhorias...");const b=`Crie um ROADMAP DIDÁTICO (passo a passo) das melhorias que podem levar "${e}" ao TOP 3 do segmento.

Critérios analisados:
${JSON.stringify(x.criteria,null,2)}

Crie uma lista de 8 a 12 passos em ordem de IMPORTÂNCIA DECRESCENTE (do mais importante ao menos importante).
Cada passo deve ser claro, objetivo e acionável.

Retorne APENAS um JSON:
{
  "roadmap": ["Passo 1: descrição detalhada", "Passo 2: descrição detalhada", ...]
}`,y=await Vo(b),N=JSON.parse(y);console.log("📋 Gerando análises de gap...");const R=`Crie um comentário objetivo explicando o que faz "${e}" estar atrás de "${s}".

Dados comparativos:
Empresa: Score ${c.overall_score}/100, ${c.rating} estrelas, ${c.total_reviews} avaliações
Líder: Score ${m.overall_score}/100, ${m.rating} estrelas, ${m.total_reviews} avaliações

Crie um comentário com MÁXIMO 1000 caracteres explicando claramente os principais fatores que fazem a empresa estar atrás.
Retorne apenas o texto do comentário, sem JSON.`,P=await Vo(R),F=`Analise os critérios de comparação e explique objetivamente o que faz "${e}" estar atrás de "${s}".

Critérios:
${JSON.stringify(x.criteria,null,2)}

Crie um comentário com MÁXIMO 1000 caracteres destacando os critérios mais críticos e seu impacto.
Retorne apenas o texto do comentário, sem JSON.`,C=await Vo(F),A=c.overall_score-m.overall_score,W=(x.criteria||[]).map(V=>({name:V.name,company_score:Number(V.company_score)||0,leader_score:Number(V.leader_score)||0,gap:Number(V.gap)||Number(V.leader_score)-Number(V.company_score)||0,improvements:Array.isArray(V.improvements)?V.improvements:[],priority:V.priority||"medium"}));if(!W||W.length===0)throw new Error("Não foi possível obter critérios de comparação. A API pode não ter retornado dados válidos.");console.log(`✅ Comparação concluída com ${W.length} critérios`);let L="";return c.overall_score>=80?L="1º-3º posição":c.overall_score>=65?L="4º-7º posição":c.overall_score>=50?L="8º-15º posição":L="Abaixo do top 15",{company_name:e,company_data:{...c,website:`https://www.${e.toLowerCase().replace(/\s+/g,"")}.com.br`,gmn_url:`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(e+" "+t)}`},leader_name:s,leader_data:m,gmn_position:L,criteria_comparison:W,overall_gap:Math.abs(A),strategic_recommendations:x.strategic_recommendations||[],quick_wins:x.quick_wins||[],long_term_goals:x.long_term_goals||[],executive_summary:_,improvement_roadmap:N.roadmap||[],summary_gap_analysis:P,criteria_gap_analysis:C}}async function Qz(e,t,r,n){const a={company_name:e.company_name,leader_name:e.leader_name,city:t,segment:r,overall_gap:e.overall_gap,comparison_data:e},{error:i}=await Ir.from("competitive_comparisons").insert(a);if(i)throw console.error("Erro ao salvar comparação:",i),i}async function e$(){const{data:e,error:t}=await Ir.from("competitive_comparisons").select("*").order("created_at",{ascending:!1}).limit(50);if(t)throw console.error("Erro ao buscar histórico:",t),t;return e||[]}const t$=({companyName:e,city:t,segment:r,onComplete:n,onBack:a})=>{const[i,s]=nt.useState("Iniciando análise..."),[o,l]=nt.useState(null),[c,u]=nt.useState(0),[h,m]=nt.useState(0),[f]=nt.useState(Date.now());nt.useEffect(()=>{const x=setInterval(()=>{m(Math.floor((Date.now()-f)/1e3))},1e3);return()=>clearInterval(x)},[f]);const v=async()=>{try{s("Buscando líder do segmento..."),u(10),await new Promise(w=>setTimeout(w,1e3)),u(25),s("Analisando sua empresa..."),await new Promise(w=>setTimeout(w,1e3)),u(50),s("Analisando empresa líder..."),await new Promise(w=>setTimeout(w,1e3)),u(75),s("Gerando comparação detalhada...");const x=await Zz(e,t,r);u(90),s("Salvando análise..."),await Qz(x,t,r),u(95),s("Análise concluída!"),await new Promise(w=>setTimeout(w,500)),u(100),n(x)}catch(x){console.error("Erro na comparação:",x);const w=x instanceof Error?x.message:"Erro desconhecido";w.includes("API key")||w.includes("401")?l("Chave da API OpenAI inválida ou expirada. Configure uma chave válida no arquivo .env (VITE_OPENAI_API_KEY)."):w.includes("rate limit")?l("Limite de requisições atingido. Aguarde alguns minutos e tente novamente."):w.includes("timeout")?l("Tempo limite excedido. Tente novamente ou reduza o tamanho da análise."):l(`Erro ao realizar a comparação: ${w}`)}};return nt.useEffect(()=>{v()},[]),d.jsx("div",{className:"max-w-2xl mx-auto",children:d.jsx("div",{className:"bg-white/95 backdrop-blur-sm rounded-2xl shadow-xl border border-white/20 p-8",children:d.jsxs("div",{className:"text-center",children:[d.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-green-500 to-green-700 rounded-2xl mb-6 shadow-lg",children:d.jsx(fo,{className:"w-8 h-8 text-white"})}),d.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Análise em Andamento"}),d.jsxs("p",{className:"text-gray-600 mb-8",children:["Comparando ",e," com o líder do segmento"]}),o?d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:d.jsx("p",{className:"text-red-800 font-medium",children:o})}),d.jsx("button",{onClick:a,className:"px-6 py-3 bg-gradient-to-r from-blue-500 to-blue-700 text-white font-semibold rounded-lg hover:from-blue-600 hover:to-blue-800 transition-all",children:"Voltar e Tentar Novamente"})]}):d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"flex justify-center mb-6",children:d.jsx(rS,{className:"w-12 h-12 text-green-600 animate-spin"})}),d.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 mb-6",children:d.jsx("p",{className:"text-green-800 font-medium",children:i})}),d.jsxs("div",{className:"mb-6",children:[d.jsxs("div",{className:"flex items-center justify-between mb-2",children:[d.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"Progresso"}),d.jsxs("span",{className:"text-lg font-bold text-green-600",children:[c,"%"]})]}),d.jsx("div",{className:"w-full bg-gray-200 rounded-full h-4 overflow-hidden shadow-inner",children:d.jsx("div",{className:"bg-gradient-to-r from-green-500 to-green-600 h-4 rounded-full transition-all duration-500 ease-out relative overflow-hidden",style:{width:`${c}%`},children:d.jsx("div",{className:"absolute inset-0 bg-white/20 animate-pulse"})})})]}),d.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:d.jsxs("div",{className:"flex items-center justify-center gap-2 text-blue-800",children:[d.jsx(Qk,{className:"w-5 h-5"}),d.jsx("span",{className:"font-semibold",children:"Tempo decorrido:"}),d.jsxs("span",{className:"text-xl font-bold",children:[Math.floor(h/60),":",(h%60).toString().padStart(2,"0")]})]})}),d.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[d.jsxs("p",{children:["📍 Cidade: ",t]}),d.jsxs("p",{children:["🏢 Segmento: ",r]}),d.jsx("p",{children:"⏱️ Tempo estimado: 2-3 minutos"})]})]})]})})})};function MN(e){const t=Er.book_new(),r=[["COMPARAÇÃO COMPETITIVA - GOOGLE MEU NEGÓCIO"],[],["Empresa Analisada:",e.company_name.toUpperCase()],["Líder do Segmento:",e.leader_name.toUpperCase()],["Diferença de Score:",e.overall_gap],[],["CRITÉRIOS",e.company_name,e.leader_name],["Email",e.company_data.email||"Não disponível",e.leader_data.email||"Não disponível"],["Telefone",e.company_data.phone||"Não disponível",e.leader_data.phone||"Não disponível"],["WhatsApp",e.company_data.whatsapp||"Não disponível",e.leader_data.whatsapp||"Não disponível"],["Endereço",e.company_data.address||"Não disponível",e.leader_data.address||"Não disponível"],["Score Geral",e.company_data.overall_score,e.leader_data.overall_score],["Avaliação",e.company_data.rating,e.leader_data.rating],["Total de Avaliações",e.company_data.total_reviews,e.leader_data.total_reviews],["Status de Verificação",e.company_data.verification_status,e.leader_data.verification_status],["Score NAP",e.company_data.nap_consistency_score,e.leader_data.nap_consistency_score],["Possui Produtos",e.company_data.has_products?"Sim":"Não",e.leader_data.has_products?"Sim":"Não"],["Quantidade de Imagens",e.company_data.images_count,e.leader_data.images_count],["Posts por Semana",e.company_data.posts_per_week,e.leader_data.posts_per_week],["Taxa de Resposta",e.company_data.review_response_rate,e.leader_data.review_response_rate],["Score SEO",e.company_data.seo_score,e.leader_data.seo_score],["Score de Engajamento",e.company_data.engagement_score,e.leader_data.engagement_score],[],["ANÁLISE DO GAP"],[e.summary_gap_analysis]],n=Er.aoa_to_sheet(r);n["!cols"]=[{wch:25},{wch:35},{wch:35}],Er.decode_range(n["!ref"]||"A1"),n["!autofilter"]={ref:"A3:C3"};for(let P=1;P<=r.length;P++)["A","B","C"].forEach(F=>{const C=`${F}${P}`;n[C]&&(n[C].s||(n[C].s={}),n[C].s.alignment={wrapText:!0,vertical:"top",horizontal:"center"},n[C].s.font={name:"Segoe UI",sz:10},P===1&&(n[C].s.fill={fgColor:{rgb:"2980B9"}},n[C].s.font={name:"Segoe UI",sz:14,color:{rgb:"FFFFFF"},bold:!0}))});const i=`A${r.length-1}`;n[i]&&n[i].s&&(n[i].s.alignment={wrapText:!0,vertical:"top",horizontal:"left"}),n["!margins"]||(n["!margins"]={left:.3,right:.3,top:.3,bottom:.3,header:.2,footer:.2}),n["!printOptions"]||(n["!printOptions"]={}),n["!printOptions"].orientation="landscape",n["!printOptions"].scale=80,Er.book_append_sheet(t,n,"Resumo");const s=[["COMPARAÇÃO POR CRITÉRIO"],[],["Critério","Score Empresa","Score Líder","Gap","Prioridade","Sugestões de Melhoria"]];e.criteria_comparison.forEach(P=>{s.push([P.name,P.company_score.toString(),P.leader_score.toString(),P.gap.toString(),P.priority==="high"?"Alta":P.priority==="medium"?"Média":"Baixa",P.improvements.join(`
`)])}),s.push([]),s.push(["ANÁLISE DO GAP"]),s.push([e.criteria_gap_analysis]);const o=Er.aoa_to_sheet(s);o["!cols"]=[{wch:25},{wch:15},{wch:15},{wch:10},{wch:12},{wch:45}],Er.decode_range(o["!ref"]||"A1"),o["!autofilter"]={ref:"A3:F3"};for(let P=1;P<=s.length;P++)["A","B","C","D","E","F"].forEach(F=>{const C=`${F}${P}`;if(o[C]){o[C].s||(o[C].s={});const A=F==="F"?{wrapText:!0,vertical:"top",horizontal:"left"}:{wrapText:!0,vertical:"top",horizontal:"center"};o[C].s.alignment=A,o[C].s.font={name:"Segoe UI",sz:10},P===3&&(o[C].s.fill={fgColor:{rgb:"000000"}},o[C].s.font={name:"Segoe UI",sz:10,color:{rgb:"FFFFFF"},bold:!0})}});const l=s.length-2;l>0&&(o["!merges"]||(o["!merges"]=[]),o["!merges"].push({s:{r:l-1,c:0},e:{r:l-1,c:4}}));const u=`A${s.length-1}`;o[u]&&o[u].s&&(o[u].s.alignment={wrapText:!0,vertical:"top",horizontal:"left"}),o["!margins"]||(o["!margins"]={left:.3,right:.3,top:.3,bottom:.3,header:.2,footer:.2}),o["!printOptions"]||(o["!printOptions"]={}),o["!printOptions"].orientation="landscape",o["!printOptions"].scale=80,Er.book_append_sheet(t,o,"Critérios");const h=[["VITÓRIAS RÁPIDAS"],[],...e.quick_wins.map(P=>[P]),[],["RECOMENDAÇÕES ESTRATÉGICAS"],[],...e.strategic_recommendations.map(P=>[P]),[],["METAS DE LONGO PRAZO"],[],...e.long_term_goals.map(P=>[P])],m=Er.aoa_to_sheet(h);m["!cols"]=[{wch:45}],Er.decode_range(m["!ref"]||"A1"),m["!autofilter"]={ref:"A1:A1"};for(let P=1;P<=h.length;P++){const F=`A${P}`;m[F]&&(m[F].s||(m[F].s={}),m[F].s.alignment={wrapText:!0,vertical:"top",horizontal:"center"},m[F].s.font={name:"Segoe UI",sz:10},(P===1||h[P-1][0]==="RECOMENDAÇÕES ESTRATÉGICAS"||h[P-1][0]==="METAS DE LONGO PRAZO")&&(m[F].s.fill={fgColor:{rgb:"000000"}},m[F].s.font={name:"Segoe UI",sz:10,color:{rgb:"FFFFFF"},bold:!0}))}m["!margins"]||(m["!margins"]={left:.3,right:.3,top:.3,bottom:.3,header:.2,footer:.2}),m["!printOptions"]||(m["!printOptions"]={}),m["!printOptions"].orientation="landscape",m["!printOptions"].scale=80,Er.book_append_sheet(t,m,"Recomendações");const f=[["AVALIAÇÃO COMENTADA"],[],["SÍNTESE DA EMPRESA ANALISADA EM RELAÇÃO À EMPRESA LÍDER"],[],[],[],["SÍNTESE DIDÁTICA - MELHORIAS PARA CHEGAR AO TOP 3"],["Passo a passo em ordem de importância decrescente:"],[]];e.improvement_roadmap.forEach((P,F)=>{f.push([`${F+1}. ${P}`])});const v=Er.aoa_to_sheet(f);v["!cols"]=[{wch:120}],Er.decode_range(v["!ref"]||"A1"),v["!autofilter"]={ref:"A1:A1"},v.A4={t:"s",v:e.executive_summary,s:{alignment:{wrapText:!0,vertical:"top",horizontal:"left"}}},v["!rows"]||(v["!rows"]=[]),v["!rows"][3]={hpt:100};for(let P=1;P<=f.length;P++){const F=`A${P}`;v[F]&&P!==4&&(v[F].s||(v[F].s={}),v[F].s.alignment={wrapText:!0,vertical:"top",horizontal:"center"},v[F].s.font={name:"Segoe UI",sz:10},(P===1||P===3||P===7)&&(v[F].s.fill={fgColor:{rgb:"000000"}},v[F].s.font={name:"Segoe UI",sz:10,color:{rgb:"FFFFFF"},bold:!0}))}for(let P=10;P<=f.length;P++){const F=`A${P}`;v[F]&&v[F].s&&(v[F].s.alignment={wrapText:!0,vertical:"top",horizontal:"left"})}v["!margins"]||(v["!margins"]={left:.3,right:.3,top:.3,bottom:.3,header:.2,footer:.2}),v["!printOptions"]||(v["!printOptions"]={}),v["!printOptions"].orientation="landscape",v["!printOptions"].scale=80,Er.book_append_sheet(t,v,"AVALIAÇÃO COMENTADA");const w=new Date().toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"});t.Props||(t.Props={}),t.Props.Comments=`Gerado em: ${w}`;const _=`Comparacao_${e.company_name.replace(/[^a-zA-Z0-9]/g,"_")}_${new Date().toISOString().split("T")[0]}.xlsx`,b=w_(t,{bookType:"xlsx",type:"array",cellStyles:!0}),y=new Blob([b],{type:"application/octet-stream"}),N=URL.createObjectURL(y),R=document.createElement("a");R.href=N,R.download=_,document.body.appendChild(R),R.click(),document.body.removeChild(R),URL.revokeObjectURL(N)}function vr(e){"@babel/helpers - typeof";return vr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vr(e)}var hs=Uint8Array,fi=Uint16Array,F_=Int32Array,L_=new hs([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),P_=new hs([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),d4=new hs([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),BN=function(e,t){for(var r=new fi(31),n=0;n<31;++n)r[n]=t+=1<<e[n-1];for(var a=new F_(r[30]),n=1;n<30;++n)for(var i=r[n];i<r[n+1];++i)a[i]=i-r[n]<<5|n;return{b:r,r:a}},UN=BN(L_,2),r$=UN.b,kx=UN.r;r$[28]=258,kx[258]=28;var n$=BN(P_,0),p4=n$.r,Sx=new fi(32768);for(var jr=0;jr<32768;++jr){var qo=(jr&43690)>>1|(jr&21845)<<1;qo=(qo&52428)>>2|(qo&13107)<<2,qo=(qo&61680)>>4|(qo&3855)<<4,Sx[jr]=((qo&65280)>>8|(qo&255)<<8)>>1}var Bf=function(e,t,r){for(var n=e.length,a=0,i=new fi(t);a<n;++a)e[a]&&++i[e[a]-1];var s=new fi(t);for(a=1;a<t;++a)s[a]=s[a-1]+i[a-1]<<1;var o;if(r){o=new fi(1<<t);var l=15-t;for(a=0;a<n;++a)if(e[a])for(var c=a<<4|e[a],u=t-e[a],h=s[e[a]-1]++<<u,m=h|(1<<u)-1;h<=m;++h)o[Sx[h]>>l]=c}else for(o=new fi(n),a=0;a<n;++a)e[a]&&(o[a]=Sx[s[e[a]-1]++]>>15-e[a]);return o},Oc=new hs(288);for(var jr=0;jr<144;++jr)Oc[jr]=8;for(var jr=144;jr<256;++jr)Oc[jr]=9;for(var jr=256;jr<280;++jr)Oc[jr]=7;for(var jr=280;jr<288;++jr)Oc[jr]=8;var xp=new hs(32);for(var jr=0;jr<32;++jr)xp[jr]=5;var a$=Bf(Oc,9,0),i$=Bf(xp,5,0),zN=function(e){return(e+7)/8|0},s$=function(e,t,r){return(r==null||r>e.length)&&(r=e.length),new hs(e.subarray(t,r))},Zs=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8},sf=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8,e[n+2]|=r>>16},Lg=function(e,t){for(var r=[],n=0;n<e.length;++n)e[n]&&r.push({s:n,f:e[n]});var a=r.length,i=r.slice();if(!a)return{t:WN,l:0};if(a==1){var s=new hs(r[0].s+1);return s[r[0].s]=1,{t:s,l:1}}r.sort(function(R,P){return R.f-P.f}),r.push({s:-1,f:25001});var o=r[0],l=r[1],c=0,u=1,h=2;for(r[0]={s:-1,f:o.f+l.f,l:o,r:l};u!=a-1;)o=r[r[c].f<r[h].f?c++:h++],l=r[c!=u&&r[c].f<r[h].f?c++:h++],r[u++]={s:-1,f:o.f+l.f,l:o,r:l};for(var m=i[0].s,n=1;n<a;++n)i[n].s>m&&(m=i[n].s);var f=new fi(m+1),v=Nx(r[u-1],f,0);if(v>t){var n=0,x=0,w=v-t,_=1<<w;for(i.sort(function(P,F){return f[F.s]-f[P.s]||P.f-F.f});n<a;++n){var b=i[n].s;if(f[b]>t)x+=_-(1<<v-f[b]),f[b]=t;else break}for(x>>=w;x>0;){var y=i[n].s;f[y]<t?x-=1<<t-f[y]++-1:++n}for(;n>=0&&x;--n){var N=i[n].s;f[N]==t&&(--f[N],++x)}v=t}return{t:new hs(f),l:v}},Nx=function(e,t,r){return e.s==-1?Math.max(Nx(e.l,t,r+1),Nx(e.r,t,r+1)):t[e.s]=r},m4=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new fi(++t),n=0,a=e[0],i=1,s=function(l){r[n++]=l},o=1;o<=t;++o)if(e[o]==a&&o!=t)++i;else{if(!a&&i>2){for(;i>138;i-=138)s(32754);i>2&&(s(i>10?i-11<<5|28690:i-3<<5|12305),i=0)}else if(i>3){for(s(a),--i;i>6;i-=6)s(8304);i>2&&(s(i-3<<5|8208),i=0)}for(;i--;)s(a);i=1,a=e[o]}return{c:r.subarray(0,n),n:t}},of=function(e,t){for(var r=0,n=0;n<t.length;++n)r+=e[n]*t[n];return r},$N=function(e,t,r){var n=r.length,a=zN(t+2);e[a]=n&255,e[a+1]=n>>8,e[a+2]=e[a]^255,e[a+3]=e[a+1]^255;for(var i=0;i<n;++i)e[a+i+4]=r[i];return(a+4+n)*8},g4=function(e,t,r,n,a,i,s,o,l,c,u){Zs(t,u++,r),++a[256];for(var h=Lg(a,15),m=h.t,f=h.l,v=Lg(i,15),x=v.t,w=v.l,_=m4(m),b=_.c,y=_.n,N=m4(x),R=N.c,P=N.n,F=new fi(19),C=0;C<b.length;++C)++F[b[C]&31];for(var C=0;C<R.length;++C)++F[R[C]&31];for(var A=Lg(F,7),W=A.t,L=A.l,I=19;I>4&&!W[d4[I-1]];--I);var V=c+5<<3,Q=of(a,Oc)+of(i,xp)+s,ue=of(a,m)+of(i,x)+s+14+3*I+of(F,W)+2*F[16]+3*F[17]+7*F[18];if(l>=0&&V<=Q&&V<=ue)return $N(t,u,e.subarray(l,l+c));var me,pe,oe,G;if(Zs(t,u,1+(ue<Q)),u+=2,ue<Q){me=Bf(m,f,0),pe=m,oe=Bf(x,w,0),G=x;var ve=Bf(W,L,0);Zs(t,u,y-257),Zs(t,u+5,P-1),Zs(t,u+10,I-4),u+=14;for(var C=0;C<I;++C)Zs(t,u+3*C,W[d4[C]]);u+=3*I;for(var _e=[b,R],E=0;E<2;++E)for(var j=_e[E],C=0;C<j.length;++C){var O=j[C]&31;Zs(t,u,ve[O]),u+=W[O],O>15&&(Zs(t,u,j[C]>>5&127),u+=j[C]>>12)}}else me=a$,pe=Oc,oe=i$,G=xp;for(var C=0;C<o;++C){var B=n[C];if(B>255){var O=B>>18&31;sf(t,u,me[O+257]),u+=pe[O+257],O>7&&(Zs(t,u,B>>23&31),u+=L_[O]);var Y=B&31;sf(t,u,oe[Y]),u+=G[Y],Y>3&&(sf(t,u,B>>5&8191),u+=P_[Y])}else sf(t,u,me[B]),u+=pe[B]}return sf(t,u,me[256]),u+pe[256]},o$=new F_([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),WN=new hs(0),l$=function(e,t,r,n,a,i){var s=i.z||e.length,o=new hs(n+s+5*(1+Math.ceil(s/7e3))+a),l=o.subarray(n,o.length-a),c=i.l,u=(i.r||0)&7;if(t){u&&(l[0]=i.r>>3);for(var h=o$[t-1],m=h>>13,f=h&8191,v=(1<<r)-1,x=i.p||new fi(32768),w=i.h||new fi(v+1),_=Math.ceil(r/3),b=2*_,y=function(be){return(e[be]^e[be+1]<<_^e[be+2]<<b)&v},N=new F_(25e3),R=new fi(288),P=new fi(32),F=0,C=0,A=i.i||0,W=0,L=i.w||0,I=0;A+2<s;++A){var V=y(A),Q=A&32767,ue=w[V];if(x[Q]=ue,w[V]=Q,L<=A){var me=s-A;if((F>7e3||W>24576)&&(me>423||!c)){u=g4(e,l,0,N,R,P,C,W,I,A-I,u),W=F=C=0,I=A;for(var pe=0;pe<286;++pe)R[pe]=0;for(var pe=0;pe<30;++pe)P[pe]=0}var oe=2,G=0,ve=f,_e=Q-ue&32767;if(me>2&&V==y(A-_e))for(var E=Math.min(m,me)-1,j=Math.min(32767,A),O=Math.min(258,me);_e<=j&&--ve&&Q!=ue;){if(e[A+oe]==e[A+oe-_e]){for(var B=0;B<O&&e[A+B]==e[A+B-_e];++B);if(B>oe){if(oe=B,G=_e,B>E)break;for(var Y=Math.min(_e,B-2),le=0,pe=0;pe<Y;++pe){var fe=A-_e+pe&32767,ce=x[fe],de=fe-ce&32767;de>le&&(le=de,ue=fe)}}}Q=ue,ue=x[Q],_e+=Q-ue&32767}if(G){N[W++]=268435456|kx[oe]<<18|p4[G];var Ce=kx[oe]&31,X=p4[G]&31;C+=L_[Ce]+P_[X],++R[257+Ce],++P[X],L=A+oe,++F}else N[W++]=e[A],++R[e[A]]}}for(A=Math.max(A,L);A<s;++A)N[W++]=e[A],++R[e[A]];u=g4(e,l,c,N,R,P,C,W,I,A-I,u),c||(i.r=u&7|l[u/8|0]<<3,u-=7,i.h=w,i.p=x,i.i=A,i.w=L)}else{for(var A=i.w||0;A<s+c;A+=65535){var $e=A+65535;$e>=s&&(l[u/8|0]=c,$e=s),u=$N(l,u+1,e.subarray(A,$e))}i.i=s}return s$(o,0,n+zN(u)+a)},HN=function(){var e=1,t=0;return{p:function(r){for(var n=e,a=t,i=r.length|0,s=0;s!=i;){for(var o=Math.min(s+2655,i);s<o;++s)a+=n+=r[s];n=(n&65535)+15*(n>>16),a=(a&65535)+15*(a>>16)}e=n,t=a},d:function(){return e%=65521,t%=65521,(e&255)<<24|(e&65280)<<8|(t&255)<<8|t>>8}}},c$=function(e,t,r,n,a){if(!a&&(a={l:1},t.dictionary)){var i=t.dictionary.subarray(-32768),s=new hs(i.length+e.length);s.set(i),s.set(e,i.length),e=s,a.w=i.length}return l$(e,t.level==null?6:t.level,t.mem==null?a.l?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):20:12+t.mem,r,n,a)},VN=function(e,t,r){for(;r;++t)e[t]=r,r>>>=8},u$=function(e,t){var r=t.level,n=r==0?0:r<6?1:r==9?3:2;if(e[0]=120,e[1]=n<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var a=HN();a.p(t.dictionary),VN(e,2,a.d())}};function Ex(e,t){t||(t={});var r=HN();r.p(e);var n=c$(e,t,t.dictionary?6:2,4);return u$(n,t),VN(n,n.length-4,r.d()),n}var f$=typeof TextDecoder<"u"&&new TextDecoder,h$=0;try{f$.decode(WN,{stream:!0}),h$=1}catch{}function d$(e){if(Array.isArray(e))return e}function p$(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(l=(n=i.call(r)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(u){c=!0,a=u}finally{try{if(!l&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw a}}return o}}function x4(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function m$(e,t){if(e){if(typeof e=="string")return x4(e,t);var r={}.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?x4(e,t):void 0}}function g$(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function v4(e,t){return d$(e)||p$(e,t)||m$(e,t)||g$()}function _4(e,t="utf8"){return new TextDecoder(t).decode(e)}const x$=new TextEncoder;function v$(e){return x$.encode(e)}const _$=1024*8,w$=(()=>{const e=new Uint8Array(4),t=new Uint32Array(e.buffer);return!((t[0]=1)&e[0])})(),Pg={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class I_{constructor(t=_$,r={}){mr(this,"buffer");mr(this,"byteLength");mr(this,"byteOffset");mr(this,"length");mr(this,"offset");mr(this,"lastWrittenByte");mr(this,"littleEndian");mr(this,"_data");mr(this,"_mark");mr(this,"_marks");let n=!1;typeof t=="number"?t=new ArrayBuffer(t):(n=!0,this.lastWrittenByte=t.byteLength);const a=r.offset?r.offset>>>0:0,i=t.byteLength-a;let s=a;(ArrayBuffer.isView(t)||t instanceof I_)&&(t.byteLength!==t.buffer.byteLength&&(s=t.byteOffset+a),t=t.buffer),n?this.lastWrittenByte=i:this.lastWrittenByte=0,this.buffer=t,this.length=i,this.byteLength=i,this.byteOffset=s,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,s,i),this._mark=0,this._marks=[]}available(t=1){return this.offset+t<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(t=1){return this.offset+=t,this}back(t=1){return this.offset-=t,this}seek(t){return this.offset=t,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const t=this._marks.pop();if(t===void 0)throw new Error("Mark stack empty");return this.seek(t),this}rewind(){return this.offset=0,this}ensureAvailable(t=1){if(!this.available(t)){const n=(this.offset+t)*2,a=new Uint8Array(n);a.set(new Uint8Array(this.buffer)),this.buffer=a.buffer,this.length=n,this.byteLength=n,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(t=1){return this.readArray(t,"uint8")}readArray(t,r){const n=Pg[r].BYTES_PER_ELEMENT*t,a=this.byteOffset+this.offset,i=this.buffer.slice(a,a+n);if(this.littleEndian===w$&&r!=="uint8"&&r!=="int8"){const o=new Uint8Array(this.buffer.slice(a,a+n));o.reverse();const l=new Pg[r](o.buffer);return this.offset+=n,l.reverse(),l}const s=new Pg[r](i);return this.offset+=n,s}readInt16(){const t=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,t}readUint16(){const t=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,t}readInt32(){const t=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,t}readUint32(){const t=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat32(){const t=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat64(){const t=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,t}readBigInt64(){const t=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,t}readBigUint64(){const t=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,t}readChar(){return String.fromCharCode(this.readInt8())}readChars(t=1){let r="";for(let n=0;n<t;n++)r+=this.readChar();return r}readUtf8(t=1){return _4(this.readBytes(t))}decodeText(t=1,r="utf8"){return _4(this.readBytes(t),r)}writeBoolean(t){return this.writeUint8(t?255:0),this}writeInt8(t){return this.ensureAvailable(1),this._data.setInt8(this.offset++,t),this._updateLastWrittenByte(),this}writeUint8(t){return this.ensureAvailable(1),this._data.setUint8(this.offset++,t),this._updateLastWrittenByte(),this}writeByte(t){return this.writeUint8(t)}writeBytes(t){this.ensureAvailable(t.length);for(let r=0;r<t.length;r++)this._data.setUint8(this.offset++,t[r]);return this._updateLastWrittenByte(),this}writeInt16(t){return this.ensureAvailable(2),this._data.setInt16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(t){return this.ensureAvailable(2),this._data.setUint16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(t){return this.ensureAvailable(4),this._data.setInt32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(t){return this.ensureAvailable(4),this._data.setUint32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(t){return this.ensureAvailable(4),this._data.setFloat32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(t){return this.ensureAvailable(8),this._data.setFloat64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(t){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(t){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(t){return this.writeUint8(t.charCodeAt(0))}writeChars(t){for(let r=0;r<t.length;r++)this.writeUint8(t.charCodeAt(r));return this}writeUtf8(t){return this.writeBytes(v$(t))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}/*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */const y$=4,w4=0,y4=1,b$=2;function yu(e){let t=e.length;for(;--t>=0;)e[t]=0}const k$=0,qN=1,S$=2,N$=3,E$=258,O_=29,Hh=256,wh=Hh+1+O_,V0=30,j_=19,GN=2*wh+1,hc=15,Ig=16,A$=7,R_=256,XN=16,KN=17,YN=18,Ax=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),S1=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),T$=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),JN=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),C$=512,ao=new Array((wh+2)*2);yu(ao);const Uf=new Array(V0*2);yu(Uf);const yh=new Array(C$);yu(yh);const bh=new Array(E$-N$+1);yu(bh);const D_=new Array(O_);yu(D_);const vp=new Array(V0);yu(vp);function Og(e,t,r,n,a){this.static_tree=e,this.extra_bits=t,this.extra_base=r,this.elems=n,this.max_length=a,this.has_stree=e&&e.length}let ZN,QN,eE;function jg(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}const tE=e=>e<256?yh[e]:yh[256+(e>>>7)],kh=(e,t)=>{e.pending_buf[e.pending++]=t&255,e.pending_buf[e.pending++]=t>>>8&255},$a=(e,t,r)=>{e.bi_valid>Ig-r?(e.bi_buf|=t<<e.bi_valid&65535,kh(e,e.bi_buf),e.bi_buf=t>>Ig-e.bi_valid,e.bi_valid+=r-Ig):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=r)},Fs=(e,t,r)=>{$a(e,r[t*2],r[t*2+1])},rE=(e,t)=>{let r=0;do r|=e&1,e>>>=1,r<<=1;while(--t>0);return r>>>1},F$=e=>{e.bi_valid===16?(kh(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=e.bi_buf&255,e.bi_buf>>=8,e.bi_valid-=8)},L$=(e,t)=>{const r=t.dyn_tree,n=t.max_code,a=t.stat_desc.static_tree,i=t.stat_desc.has_stree,s=t.stat_desc.extra_bits,o=t.stat_desc.extra_base,l=t.stat_desc.max_length;let c,u,h,m,f,v,x=0;for(m=0;m<=hc;m++)e.bl_count[m]=0;for(r[e.heap[e.heap_max]*2+1]=0,c=e.heap_max+1;c<GN;c++)u=e.heap[c],m=r[r[u*2+1]*2+1]+1,m>l&&(m=l,x++),r[u*2+1]=m,!(u>n)&&(e.bl_count[m]++,f=0,u>=o&&(f=s[u-o]),v=r[u*2],e.opt_len+=v*(m+f),i&&(e.static_len+=v*(a[u*2+1]+f)));if(x!==0){do{for(m=l-1;e.bl_count[m]===0;)m--;e.bl_count[m]--,e.bl_count[m+1]+=2,e.bl_count[l]--,x-=2}while(x>0);for(m=l;m!==0;m--)for(u=e.bl_count[m];u!==0;)h=e.heap[--c],!(h>n)&&(r[h*2+1]!==m&&(e.opt_len+=(m-r[h*2+1])*r[h*2],r[h*2+1]=m),u--)}},nE=(e,t,r)=>{const n=new Array(hc+1);let a=0,i,s;for(i=1;i<=hc;i++)a=a+r[i-1]<<1,n[i]=a;for(s=0;s<=t;s++){let o=e[s*2+1];o!==0&&(e[s*2]=rE(n[o]++,o))}},P$=()=>{let e,t,r,n,a;const i=new Array(hc+1);for(r=0,n=0;n<O_-1;n++)for(D_[n]=r,e=0;e<1<<Ax[n];e++)bh[r++]=n;for(bh[r-1]=n,a=0,n=0;n<16;n++)for(vp[n]=a,e=0;e<1<<S1[n];e++)yh[a++]=n;for(a>>=7;n<V0;n++)for(vp[n]=a<<7,e=0;e<1<<S1[n]-7;e++)yh[256+a++]=n;for(t=0;t<=hc;t++)i[t]=0;for(e=0;e<=143;)ao[e*2+1]=8,e++,i[8]++;for(;e<=255;)ao[e*2+1]=9,e++,i[9]++;for(;e<=279;)ao[e*2+1]=7,e++,i[7]++;for(;e<=287;)ao[e*2+1]=8,e++,i[8]++;for(nE(ao,wh+1,i),e=0;e<V0;e++)Uf[e*2+1]=5,Uf[e*2]=rE(e,5);ZN=new Og(ao,Ax,Hh+1,wh,hc),QN=new Og(Uf,S1,0,V0,hc),eE=new Og(new Array(0),T$,0,j_,A$)},aE=e=>{let t;for(t=0;t<wh;t++)e.dyn_ltree[t*2]=0;for(t=0;t<V0;t++)e.dyn_dtree[t*2]=0;for(t=0;t<j_;t++)e.bl_tree[t*2]=0;e.dyn_ltree[R_*2]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},iE=e=>{e.bi_valid>8?kh(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},b4=(e,t,r,n)=>{const a=t*2,i=r*2;return e[a]<e[i]||e[a]===e[i]&&n[t]<=n[r]},Rg=(e,t,r)=>{const n=e.heap[r];let a=r<<1;for(;a<=e.heap_len&&(a<e.heap_len&&b4(t,e.heap[a+1],e.heap[a],e.depth)&&a++,!b4(t,n,e.heap[a],e.depth));)e.heap[r]=e.heap[a],r=a,a<<=1;e.heap[r]=n},k4=(e,t,r)=>{let n,a,i=0,s,o;if(e.sym_next!==0)do n=e.pending_buf[e.sym_buf+i++]&255,n+=(e.pending_buf[e.sym_buf+i++]&255)<<8,a=e.pending_buf[e.sym_buf+i++],n===0?Fs(e,a,t):(s=bh[a],Fs(e,s+Hh+1,t),o=Ax[s],o!==0&&(a-=D_[s],$a(e,a,o)),n--,s=tE(n),Fs(e,s,r),o=S1[s],o!==0&&(n-=vp[s],$a(e,n,o)));while(i<e.sym_next);Fs(e,R_,t)},Tx=(e,t)=>{const r=t.dyn_tree,n=t.stat_desc.static_tree,a=t.stat_desc.has_stree,i=t.stat_desc.elems;let s,o,l=-1,c;for(e.heap_len=0,e.heap_max=GN,s=0;s<i;s++)r[s*2]!==0?(e.heap[++e.heap_len]=l=s,e.depth[s]=0):r[s*2+1]=0;for(;e.heap_len<2;)c=e.heap[++e.heap_len]=l<2?++l:0,r[c*2]=1,e.depth[c]=0,e.opt_len--,a&&(e.static_len-=n[c*2+1]);for(t.max_code=l,s=e.heap_len>>1;s>=1;s--)Rg(e,r,s);c=i;do s=e.heap[1],e.heap[1]=e.heap[e.heap_len--],Rg(e,r,1),o=e.heap[1],e.heap[--e.heap_max]=s,e.heap[--e.heap_max]=o,r[c*2]=r[s*2]+r[o*2],e.depth[c]=(e.depth[s]>=e.depth[o]?e.depth[s]:e.depth[o])+1,r[s*2+1]=r[o*2+1]=c,e.heap[1]=c++,Rg(e,r,1);while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],L$(e,t),nE(r,l,e.bl_count)},S4=(e,t,r)=>{let n,a=-1,i,s=t[0*2+1],o=0,l=7,c=4;for(s===0&&(l=138,c=3),t[(r+1)*2+1]=65535,n=0;n<=r;n++)i=s,s=t[(n+1)*2+1],!(++o<l&&i===s)&&(o<c?e.bl_tree[i*2]+=o:i!==0?(i!==a&&e.bl_tree[i*2]++,e.bl_tree[XN*2]++):o<=10?e.bl_tree[KN*2]++:e.bl_tree[YN*2]++,o=0,a=i,s===0?(l=138,c=3):i===s?(l=6,c=3):(l=7,c=4))},N4=(e,t,r)=>{let n,a=-1,i,s=t[0*2+1],o=0,l=7,c=4;for(s===0&&(l=138,c=3),n=0;n<=r;n++)if(i=s,s=t[(n+1)*2+1],!(++o<l&&i===s)){if(o<c)do Fs(e,i,e.bl_tree);while(--o!==0);else i!==0?(i!==a&&(Fs(e,i,e.bl_tree),o--),Fs(e,XN,e.bl_tree),$a(e,o-3,2)):o<=10?(Fs(e,KN,e.bl_tree),$a(e,o-3,3)):(Fs(e,YN,e.bl_tree),$a(e,o-11,7));o=0,a=i,s===0?(l=138,c=3):i===s?(l=6,c=3):(l=7,c=4)}},I$=e=>{let t;for(S4(e,e.dyn_ltree,e.l_desc.max_code),S4(e,e.dyn_dtree,e.d_desc.max_code),Tx(e,e.bl_desc),t=j_-1;t>=3&&e.bl_tree[JN[t]*2+1]===0;t--);return e.opt_len+=3*(t+1)+5+5+4,t},O$=(e,t,r,n)=>{let a;for($a(e,t-257,5),$a(e,r-1,5),$a(e,n-4,4),a=0;a<n;a++)$a(e,e.bl_tree[JN[a]*2+1],3);N4(e,e.dyn_ltree,t-1),N4(e,e.dyn_dtree,r-1)},j$=e=>{let t=4093624447,r;for(r=0;r<=31;r++,t>>>=1)if(t&1&&e.dyn_ltree[r*2]!==0)return w4;if(e.dyn_ltree[9*2]!==0||e.dyn_ltree[10*2]!==0||e.dyn_ltree[13*2]!==0)return y4;for(r=32;r<Hh;r++)if(e.dyn_ltree[r*2]!==0)return y4;return w4};let E4=!1;const R$=e=>{E4||(P$(),E4=!0),e.l_desc=new jg(e.dyn_ltree,ZN),e.d_desc=new jg(e.dyn_dtree,QN),e.bl_desc=new jg(e.bl_tree,eE),e.bi_buf=0,e.bi_valid=0,aE(e)},sE=(e,t,r,n)=>{$a(e,(k$<<1)+(n?1:0),3),iE(e),kh(e,r),kh(e,~r),r&&e.pending_buf.set(e.window.subarray(t,t+r),e.pending),e.pending+=r},D$=e=>{$a(e,qN<<1,3),Fs(e,R_,ao),F$(e)},M$=(e,t,r,n)=>{let a,i,s=0;e.level>0?(e.strm.data_type===b$&&(e.strm.data_type=j$(e)),Tx(e,e.l_desc),Tx(e,e.d_desc),s=I$(e),a=e.opt_len+3+7>>>3,i=e.static_len+3+7>>>3,i<=a&&(a=i)):a=i=r+5,r+4<=a&&t!==-1?sE(e,t,r,n):e.strategy===y$||i===a?($a(e,(qN<<1)+(n?1:0),3),k4(e,ao,Uf)):($a(e,(S$<<1)+(n?1:0),3),O$(e,e.l_desc.max_code+1,e.d_desc.max_code+1,s+1),k4(e,e.dyn_ltree,e.dyn_dtree)),aE(e),n&&iE(e)},B$=(e,t,r)=>(e.pending_buf[e.sym_buf+e.sym_next++]=t,e.pending_buf[e.sym_buf+e.sym_next++]=t>>8,e.pending_buf[e.sym_buf+e.sym_next++]=r,t===0?e.dyn_ltree[r*2]++:(e.matches++,t--,e.dyn_ltree[(bh[r]+Hh+1)*2]++,e.dyn_dtree[tE(t)*2]++),e.sym_next===e.sym_end);var U$=R$,z$=sE,$$=M$,W$=B$,H$=D$,V$={_tr_init:U$,_tr_stored_block:z$,_tr_flush_block:$$,_tr_tally:W$,_tr_align:H$};const q$=(e,t,r,n)=>{let a=e&65535|0,i=e>>>16&65535|0,s=0;for(;r!==0;){s=r>2e3?2e3:r,r-=s;do a=a+t[n++]|0,i=i+a|0;while(--s);a%=65521,i%=65521}return a|i<<16|0};var Sh=q$;const G$=()=>{let e,t=[];for(var r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=e&1?3988292384^e>>>1:e>>>1;t[r]=e}return t},X$=new Uint32Array(G$()),K$=(e,t,r,n)=>{const a=X$,i=n+r;e^=-1;for(let s=n;s<i;s++)e=e>>>8^a[(e^t[s])&255];return e^-1};var Mn=K$,lu={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Vh={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:Y$,_tr_stored_block:Cx,_tr_flush_block:J$,_tr_tally:gl,_tr_align:Z$}=V$,{Z_NO_FLUSH:xl,Z_PARTIAL_FLUSH:Q$,Z_FULL_FLUSH:eW,Z_FINISH:Ii,Z_BLOCK:A4,Z_OK:Jn,Z_STREAM_END:T4,Z_STREAM_ERROR:js,Z_DATA_ERROR:tW,Z_BUF_ERROR:Dg,Z_DEFAULT_COMPRESSION:rW,Z_FILTERED:nW,Z_HUFFMAN_ONLY:t1,Z_RLE:aW,Z_FIXED:iW,Z_DEFAULT_STRATEGY:sW,Z_UNKNOWN:oW,Z_DEFLATED:Qp}=Vh,lW=9,cW=15,uW=8,fW=29,hW=256,Fx=hW+1+fW,dW=30,pW=19,mW=2*Fx+1,gW=15,Qt=3,sl=258,Rs=sl+Qt+1,xW=32,cu=42,M_=57,Lx=69,Px=73,Ix=91,Ox=103,dc=113,xf=666,Ca=1,bu=2,jc=3,ku=4,vW=3,pc=(e,t)=>(e.msg=lu[t],t),C4=e=>e*2-(e>4?9:0),tl=e=>{let t=e.length;for(;--t>=0;)e[t]=0},_W=e=>{let t,r,n,a=e.w_size;t=e.hash_size,n=t;do r=e.head[--n],e.head[n]=r>=a?r-a:0;while(--t);t=a,n=t;do r=e.prev[--n],e.prev[n]=r>=a?r-a:0;while(--t)};let wW=(e,t,r)=>(t<<e.hash_shift^r)&e.hash_mask,vl=wW;const ai=e=>{const t=e.state;let r=t.pending;r>e.avail_out&&(r=e.avail_out),r!==0&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+r),e.next_out),e.next_out+=r,t.pending_out+=r,e.total_out+=r,e.avail_out-=r,t.pending-=r,t.pending===0&&(t.pending_out=0))},hi=(e,t)=>{J$(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,ai(e.strm)},cr=(e,t)=>{e.pending_buf[e.pending++]=t},lf=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=t&255},jx=(e,t,r,n)=>{let a=e.avail_in;return a>n&&(a=n),a===0?0:(e.avail_in-=a,t.set(e.input.subarray(e.next_in,e.next_in+a),r),e.state.wrap===1?e.adler=Sh(e.adler,t,a,r):e.state.wrap===2&&(e.adler=Mn(e.adler,t,a,r)),e.next_in+=a,e.total_in+=a,a)},oE=(e,t)=>{let r=e.max_chain_length,n=e.strstart,a,i,s=e.prev_length,o=e.nice_match;const l=e.strstart>e.w_size-Rs?e.strstart-(e.w_size-Rs):0,c=e.window,u=e.w_mask,h=e.prev,m=e.strstart+sl;let f=c[n+s-1],v=c[n+s];e.prev_length>=e.good_match&&(r>>=2),o>e.lookahead&&(o=e.lookahead);do if(a=t,!(c[a+s]!==v||c[a+s-1]!==f||c[a]!==c[n]||c[++a]!==c[n+1])){n+=2,a++;do;while(c[++n]===c[++a]&&c[++n]===c[++a]&&c[++n]===c[++a]&&c[++n]===c[++a]&&c[++n]===c[++a]&&c[++n]===c[++a]&&c[++n]===c[++a]&&c[++n]===c[++a]&&n<m);if(i=sl-(m-n),n=m-sl,i>s){if(e.match_start=t,s=i,i>=o)break;f=c[n+s-1],v=c[n+s]}}while((t=h[t&u])>l&&--r!==0);return s<=e.lookahead?s:e.lookahead},uu=e=>{const t=e.w_size;let r,n,a;do{if(n=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-Rs)&&(e.window.set(e.window.subarray(t,t+t-n),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,e.insert>e.strstart&&(e.insert=e.strstart),_W(e),n+=t),e.strm.avail_in===0)break;if(r=jx(e.strm,e.window,e.strstart+e.lookahead,n),e.lookahead+=r,e.lookahead+e.insert>=Qt)for(a=e.strstart-e.insert,e.ins_h=e.window[a],e.ins_h=vl(e,e.ins_h,e.window[a+1]);e.insert&&(e.ins_h=vl(e,e.ins_h,e.window[a+Qt-1]),e.prev[a&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=a,a++,e.insert--,!(e.lookahead+e.insert<Qt)););}while(e.lookahead<Rs&&e.strm.avail_in!==0)},lE=(e,t)=>{let r=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,n,a,i,s=0,o=e.strm.avail_in;do{if(n=65535,i=e.bi_valid+42>>3,e.strm.avail_out<i||(i=e.strm.avail_out-i,a=e.strstart-e.block_start,n>a+e.strm.avail_in&&(n=a+e.strm.avail_in),n>i&&(n=i),n<r&&(n===0&&t!==Ii||t===xl||n!==a+e.strm.avail_in)))break;s=t===Ii&&n===a+e.strm.avail_in?1:0,Cx(e,0,0,s),e.pending_buf[e.pending-4]=n,e.pending_buf[e.pending-3]=n>>8,e.pending_buf[e.pending-2]=~n,e.pending_buf[e.pending-1]=~n>>8,ai(e.strm),a&&(a>n&&(a=n),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+a),e.strm.next_out),e.strm.next_out+=a,e.strm.avail_out-=a,e.strm.total_out+=a,e.block_start+=a,n-=a),n&&(jx(e.strm,e.strm.output,e.strm.next_out,n),e.strm.next_out+=n,e.strm.avail_out-=n,e.strm.total_out+=n)}while(s===0);return o-=e.strm.avail_in,o&&(o>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=o&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-o,e.strm.next_in),e.strstart),e.strstart+=o,e.insert+=o>e.w_size-e.insert?e.w_size-e.insert:o),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),s?ku:t!==xl&&t!==Ii&&e.strm.avail_in===0&&e.strstart===e.block_start?bu:(i=e.window_size-e.strstart,e.strm.avail_in>i&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,i+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),i>e.strm.avail_in&&(i=e.strm.avail_in),i&&(jx(e.strm,e.window,e.strstart,i),e.strstart+=i,e.insert+=i>e.w_size-e.insert?e.w_size-e.insert:i),e.high_water<e.strstart&&(e.high_water=e.strstart),i=e.bi_valid+42>>3,i=e.pending_buf_size-i>65535?65535:e.pending_buf_size-i,r=i>e.w_size?e.w_size:i,a=e.strstart-e.block_start,(a>=r||(a||t===Ii)&&t!==xl&&e.strm.avail_in===0&&a<=i)&&(n=a>i?i:a,s=t===Ii&&e.strm.avail_in===0&&n===a?1:0,Cx(e,e.block_start,n,s),e.block_start+=n,ai(e.strm)),s?jc:Ca)},Mg=(e,t)=>{let r,n;for(;;){if(e.lookahead<Rs){if(uu(e),e.lookahead<Rs&&t===xl)return Ca;if(e.lookahead===0)break}if(r=0,e.lookahead>=Qt&&(e.ins_h=vl(e,e.ins_h,e.window[e.strstart+Qt-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),r!==0&&e.strstart-r<=e.w_size-Rs&&(e.match_length=oE(e,r)),e.match_length>=Qt)if(n=gl(e,e.strstart-e.match_start,e.match_length-Qt),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=Qt){e.match_length--;do e.strstart++,e.ins_h=vl(e,e.ins_h,e.window[e.strstart+Qt-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(--e.match_length!==0);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=vl(e,e.ins_h,e.window[e.strstart+1]);else n=gl(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(n&&(hi(e,!1),e.strm.avail_out===0))return Ca}return e.insert=e.strstart<Qt-1?e.strstart:Qt-1,t===Ii?(hi(e,!0),e.strm.avail_out===0?jc:ku):e.sym_next&&(hi(e,!1),e.strm.avail_out===0)?Ca:bu},h0=(e,t)=>{let r,n,a;for(;;){if(e.lookahead<Rs){if(uu(e),e.lookahead<Rs&&t===xl)return Ca;if(e.lookahead===0)break}if(r=0,e.lookahead>=Qt&&(e.ins_h=vl(e,e.ins_h,e.window[e.strstart+Qt-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=Qt-1,r!==0&&e.prev_length<e.max_lazy_match&&e.strstart-r<=e.w_size-Rs&&(e.match_length=oE(e,r),e.match_length<=5&&(e.strategy===nW||e.match_length===Qt&&e.strstart-e.match_start>4096)&&(e.match_length=Qt-1)),e.prev_length>=Qt&&e.match_length<=e.prev_length){a=e.strstart+e.lookahead-Qt,n=gl(e,e.strstart-1-e.prev_match,e.prev_length-Qt),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=a&&(e.ins_h=vl(e,e.ins_h,e.window[e.strstart+Qt-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(--e.prev_length!==0);if(e.match_available=0,e.match_length=Qt-1,e.strstart++,n&&(hi(e,!1),e.strm.avail_out===0))return Ca}else if(e.match_available){if(n=gl(e,0,e.window[e.strstart-1]),n&&hi(e,!1),e.strstart++,e.lookahead--,e.strm.avail_out===0)return Ca}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(n=gl(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<Qt-1?e.strstart:Qt-1,t===Ii?(hi(e,!0),e.strm.avail_out===0?jc:ku):e.sym_next&&(hi(e,!1),e.strm.avail_out===0)?Ca:bu},yW=(e,t)=>{let r,n,a,i;const s=e.window;for(;;){if(e.lookahead<=sl){if(uu(e),e.lookahead<=sl&&t===xl)return Ca;if(e.lookahead===0)break}if(e.match_length=0,e.lookahead>=Qt&&e.strstart>0&&(a=e.strstart-1,n=s[a],n===s[++a]&&n===s[++a]&&n===s[++a])){i=e.strstart+sl;do;while(n===s[++a]&&n===s[++a]&&n===s[++a]&&n===s[++a]&&n===s[++a]&&n===s[++a]&&n===s[++a]&&n===s[++a]&&a<i);e.match_length=sl-(i-a),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=Qt?(r=gl(e,1,e.match_length-Qt),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(r=gl(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),r&&(hi(e,!1),e.strm.avail_out===0))return Ca}return e.insert=0,t===Ii?(hi(e,!0),e.strm.avail_out===0?jc:ku):e.sym_next&&(hi(e,!1),e.strm.avail_out===0)?Ca:bu},bW=(e,t)=>{let r;for(;;){if(e.lookahead===0&&(uu(e),e.lookahead===0)){if(t===xl)return Ca;break}if(e.match_length=0,r=gl(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,r&&(hi(e,!1),e.strm.avail_out===0))return Ca}return e.insert=0,t===Ii?(hi(e,!0),e.strm.avail_out===0?jc:ku):e.sym_next&&(hi(e,!1),e.strm.avail_out===0)?Ca:bu};function ks(e,t,r,n,a){this.good_length=e,this.max_lazy=t,this.nice_length=r,this.max_chain=n,this.func=a}const vf=[new ks(0,0,0,0,lE),new ks(4,4,8,4,Mg),new ks(4,5,16,8,Mg),new ks(4,6,32,32,Mg),new ks(4,4,16,16,h0),new ks(8,16,32,32,h0),new ks(8,16,128,128,h0),new ks(8,32,128,256,h0),new ks(32,128,258,1024,h0),new ks(32,258,258,4096,h0)],kW=e=>{e.window_size=2*e.w_size,tl(e.head),e.max_lazy_match=vf[e.level].max_lazy,e.good_match=vf[e.level].good_length,e.nice_match=vf[e.level].nice_length,e.max_chain_length=vf[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=Qt-1,e.match_available=0,e.ins_h=0};function SW(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Qp,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(mW*2),this.dyn_dtree=new Uint16Array((2*dW+1)*2),this.bl_tree=new Uint16Array((2*pW+1)*2),tl(this.dyn_ltree),tl(this.dyn_dtree),tl(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(gW+1),this.heap=new Uint16Array(2*Fx+1),tl(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*Fx+1),tl(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const qh=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.status!==cu&&t.status!==M_&&t.status!==Lx&&t.status!==Px&&t.status!==Ix&&t.status!==Ox&&t.status!==dc&&t.status!==xf?1:0},cE=e=>{if(qh(e))return pc(e,js);e.total_in=e.total_out=0,e.data_type=oW;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap===2?M_:t.wrap?cu:dc,e.adler=t.wrap===2?0:1,t.last_flush=-2,Y$(t),Jn},uE=e=>{const t=cE(e);return t===Jn&&kW(e.state),t},NW=(e,t)=>qh(e)||e.state.wrap!==2?js:(e.state.gzhead=t,Jn),fE=(e,t,r,n,a,i)=>{if(!e)return js;let s=1;if(t===rW&&(t=6),n<0?(s=0,n=-n):n>15&&(s=2,n-=16),a<1||a>lW||r!==Qp||n<8||n>15||t<0||t>9||i<0||i>iW||n===8&&s!==1)return pc(e,js);n===8&&(n=9);const o=new SW;return e.state=o,o.strm=e,o.status=cu,o.wrap=s,o.gzhead=null,o.w_bits=n,o.w_size=1<<o.w_bits,o.w_mask=o.w_size-1,o.hash_bits=a+7,o.hash_size=1<<o.hash_bits,o.hash_mask=o.hash_size-1,o.hash_shift=~~((o.hash_bits+Qt-1)/Qt),o.window=new Uint8Array(o.w_size*2),o.head=new Uint16Array(o.hash_size),o.prev=new Uint16Array(o.w_size),o.lit_bufsize=1<<a+6,o.pending_buf_size=o.lit_bufsize*4,o.pending_buf=new Uint8Array(o.pending_buf_size),o.sym_buf=o.lit_bufsize,o.sym_end=(o.lit_bufsize-1)*3,o.level=t,o.strategy=i,o.method=r,uE(e)},EW=(e,t)=>fE(e,t,Qp,cW,uW,sW),AW=(e,t)=>{if(qh(e)||t>A4||t<0)return e?pc(e,js):js;const r=e.state;if(!e.output||e.avail_in!==0&&!e.input||r.status===xf&&t!==Ii)return pc(e,e.avail_out===0?Dg:js);const n=r.last_flush;if(r.last_flush=t,r.pending!==0){if(ai(e),e.avail_out===0)return r.last_flush=-1,Jn}else if(e.avail_in===0&&C4(t)<=C4(n)&&t!==Ii)return pc(e,Dg);if(r.status===xf&&e.avail_in!==0)return pc(e,Dg);if(r.status===cu&&r.wrap===0&&(r.status=dc),r.status===cu){let a=Qp+(r.w_bits-8<<4)<<8,i=-1;if(r.strategy>=t1||r.level<2?i=0:r.level<6?i=1:r.level===6?i=2:i=3,a|=i<<6,r.strstart!==0&&(a|=xW),a+=31-a%31,lf(r,a),r.strstart!==0&&(lf(r,e.adler>>>16),lf(r,e.adler&65535)),e.adler=1,r.status=dc,ai(e),r.pending!==0)return r.last_flush=-1,Jn}if(r.status===M_){if(e.adler=0,cr(r,31),cr(r,139),cr(r,8),r.gzhead)cr(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),cr(r,r.gzhead.time&255),cr(r,r.gzhead.time>>8&255),cr(r,r.gzhead.time>>16&255),cr(r,r.gzhead.time>>24&255),cr(r,r.level===9?2:r.strategy>=t1||r.level<2?4:0),cr(r,r.gzhead.os&255),r.gzhead.extra&&r.gzhead.extra.length&&(cr(r,r.gzhead.extra.length&255),cr(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(e.adler=Mn(e.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=Lx;else if(cr(r,0),cr(r,0),cr(r,0),cr(r,0),cr(r,0),cr(r,r.level===9?2:r.strategy>=t1||r.level<2?4:0),cr(r,vW),r.status=dc,ai(e),r.pending!==0)return r.last_flush=-1,Jn}if(r.status===Lx){if(r.gzhead.extra){let a=r.pending,i=(r.gzhead.extra.length&65535)-r.gzindex;for(;r.pending+i>r.pending_buf_size;){let o=r.pending_buf_size-r.pending;if(r.pending_buf.set(r.gzhead.extra.subarray(r.gzindex,r.gzindex+o),r.pending),r.pending=r.pending_buf_size,r.gzhead.hcrc&&r.pending>a&&(e.adler=Mn(e.adler,r.pending_buf,r.pending-a,a)),r.gzindex+=o,ai(e),r.pending!==0)return r.last_flush=-1,Jn;a=0,i-=o}let s=new Uint8Array(r.gzhead.extra);r.pending_buf.set(s.subarray(r.gzindex,r.gzindex+i),r.pending),r.pending+=i,r.gzhead.hcrc&&r.pending>a&&(e.adler=Mn(e.adler,r.pending_buf,r.pending-a,a)),r.gzindex=0}r.status=Px}if(r.status===Px){if(r.gzhead.name){let a=r.pending,i;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>a&&(e.adler=Mn(e.adler,r.pending_buf,r.pending-a,a)),ai(e),r.pending!==0)return r.last_flush=-1,Jn;a=0}r.gzindex<r.gzhead.name.length?i=r.gzhead.name.charCodeAt(r.gzindex++)&255:i=0,cr(r,i)}while(i!==0);r.gzhead.hcrc&&r.pending>a&&(e.adler=Mn(e.adler,r.pending_buf,r.pending-a,a)),r.gzindex=0}r.status=Ix}if(r.status===Ix){if(r.gzhead.comment){let a=r.pending,i;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>a&&(e.adler=Mn(e.adler,r.pending_buf,r.pending-a,a)),ai(e),r.pending!==0)return r.last_flush=-1,Jn;a=0}r.gzindex<r.gzhead.comment.length?i=r.gzhead.comment.charCodeAt(r.gzindex++)&255:i=0,cr(r,i)}while(i!==0);r.gzhead.hcrc&&r.pending>a&&(e.adler=Mn(e.adler,r.pending_buf,r.pending-a,a))}r.status=Ox}if(r.status===Ox){if(r.gzhead.hcrc){if(r.pending+2>r.pending_buf_size&&(ai(e),r.pending!==0))return r.last_flush=-1,Jn;cr(r,e.adler&255),cr(r,e.adler>>8&255),e.adler=0}if(r.status=dc,ai(e),r.pending!==0)return r.last_flush=-1,Jn}if(e.avail_in!==0||r.lookahead!==0||t!==xl&&r.status!==xf){let a=r.level===0?lE(r,t):r.strategy===t1?bW(r,t):r.strategy===aW?yW(r,t):vf[r.level].func(r,t);if((a===jc||a===ku)&&(r.status=xf),a===Ca||a===jc)return e.avail_out===0&&(r.last_flush=-1),Jn;if(a===bu&&(t===Q$?Z$(r):t!==A4&&(Cx(r,0,0,!1),t===eW&&(tl(r.head),r.lookahead===0&&(r.strstart=0,r.block_start=0,r.insert=0))),ai(e),e.avail_out===0))return r.last_flush=-1,Jn}return t!==Ii?Jn:r.wrap<=0?T4:(r.wrap===2?(cr(r,e.adler&255),cr(r,e.adler>>8&255),cr(r,e.adler>>16&255),cr(r,e.adler>>24&255),cr(r,e.total_in&255),cr(r,e.total_in>>8&255),cr(r,e.total_in>>16&255),cr(r,e.total_in>>24&255)):(lf(r,e.adler>>>16),lf(r,e.adler&65535)),ai(e),r.wrap>0&&(r.wrap=-r.wrap),r.pending!==0?Jn:T4)},TW=e=>{if(qh(e))return js;const t=e.state.status;return e.state=null,t===dc?pc(e,tW):Jn},CW=(e,t)=>{let r=t.length;if(qh(e))return js;const n=e.state,a=n.wrap;if(a===2||a===1&&n.status!==cu||n.lookahead)return js;if(a===1&&(e.adler=Sh(e.adler,t,r,0)),n.wrap=0,r>=n.w_size){a===0&&(tl(n.head),n.strstart=0,n.block_start=0,n.insert=0);let l=new Uint8Array(n.w_size);l.set(t.subarray(r-n.w_size,r),0),t=l,r=n.w_size}const i=e.avail_in,s=e.next_in,o=e.input;for(e.avail_in=r,e.next_in=0,e.input=t,uu(n);n.lookahead>=Qt;){let l=n.strstart,c=n.lookahead-(Qt-1);do n.ins_h=vl(n,n.ins_h,n.window[l+Qt-1]),n.prev[l&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=l,l++;while(--c);n.strstart=l,n.lookahead=Qt-1,uu(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=Qt-1,n.match_available=0,e.next_in=s,e.input=o,e.avail_in=i,n.wrap=a,Jn};var FW=EW,LW=fE,PW=uE,IW=cE,OW=NW,jW=AW,RW=TW,DW=CW,MW="pako deflate (from Nodeca project)",zf={deflateInit:FW,deflateInit2:LW,deflateReset:PW,deflateResetKeep:IW,deflateSetHeader:OW,deflate:jW,deflateEnd:RW,deflateSetDictionary:DW,deflateInfo:MW};const BW=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var UW=function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const r=t.shift();if(r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(const n in r)BW(r,n)&&(e[n]=r[n])}}return e},zW=e=>{let t=0;for(let n=0,a=e.length;n<a;n++)t+=e[n].length;const r=new Uint8Array(t);for(let n=0,a=0,i=e.length;n<i;n++){let s=e[n];r.set(s,a),a+=s.length}return r},em={assign:UW,flattenChunks:zW};let hE=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{hE=!1}const Nh=new Uint8Array(256);for(let e=0;e<256;e++)Nh[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;Nh[254]=Nh[254]=1;var $W=e=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(e);let t,r,n,a,i,s=e.length,o=0;for(a=0;a<s;a++)r=e.charCodeAt(a),(r&64512)===55296&&a+1<s&&(n=e.charCodeAt(a+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),a++)),o+=r<128?1:r<2048?2:r<65536?3:4;for(t=new Uint8Array(o),i=0,a=0;i<o;a++)r=e.charCodeAt(a),(r&64512)===55296&&a+1<s&&(n=e.charCodeAt(a+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),a++)),r<128?t[i++]=r:r<2048?(t[i++]=192|r>>>6,t[i++]=128|r&63):r<65536?(t[i++]=224|r>>>12,t[i++]=128|r>>>6&63,t[i++]=128|r&63):(t[i++]=240|r>>>18,t[i++]=128|r>>>12&63,t[i++]=128|r>>>6&63,t[i++]=128|r&63);return t};const WW=(e,t)=>{if(t<65534&&e.subarray&&hE)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let r="";for(let n=0;n<t;n++)r+=String.fromCharCode(e[n]);return r};var HW=(e,t)=>{const r=t||e.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(e.subarray(0,t));let n,a;const i=new Array(r*2);for(a=0,n=0;n<r;){let s=e[n++];if(s<128){i[a++]=s;continue}let o=Nh[s];if(o>4){i[a++]=65533,n+=o-1;continue}for(s&=o===2?31:o===3?15:7;o>1&&n<r;)s=s<<6|e[n++]&63,o--;if(o>1){i[a++]=65533;continue}s<65536?i[a++]=s:(s-=65536,i[a++]=55296|s>>10&1023,i[a++]=56320|s&1023)}return WW(i,a)},VW=(e,t)=>{t=t||e.length,t>e.length&&(t=e.length);let r=t-1;for(;r>=0&&(e[r]&192)===128;)r--;return r<0||r===0?t:r+Nh[e[r]]>t?r:t},Eh={string2buf:$W,buf2string:HW,utf8border:VW};function qW(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var dE=qW;const pE=Object.prototype.toString,{Z_NO_FLUSH:GW,Z_SYNC_FLUSH:XW,Z_FULL_FLUSH:KW,Z_FINISH:YW,Z_OK:_p,Z_STREAM_END:JW,Z_DEFAULT_COMPRESSION:ZW,Z_DEFAULT_STRATEGY:QW,Z_DEFLATED:eH}=Vh;function B_(e){this.options=em.assign({level:ZW,method:eH,chunkSize:16384,windowBits:15,memLevel:8,strategy:QW},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new dE,this.strm.avail_out=0;let r=zf.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(r!==_p)throw new Error(lu[r]);if(t.header&&zf.deflateSetHeader(this.strm,t.header),t.dictionary){let n;if(typeof t.dictionary=="string"?n=Eh.string2buf(t.dictionary):pE.call(t.dictionary)==="[object ArrayBuffer]"?n=new Uint8Array(t.dictionary):n=t.dictionary,r=zf.deflateSetDictionary(this.strm,n),r!==_p)throw new Error(lu[r]);this._dict_set=!0}}B_.prototype.push=function(e,t){const r=this.strm,n=this.options.chunkSize;let a,i;if(this.ended)return!1;for(t===~~t?i=t:i=t===!0?YW:GW,typeof e=="string"?r.input=Eh.string2buf(e):pE.call(e)==="[object ArrayBuffer]"?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;){if(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),(i===XW||i===KW)&&r.avail_out<=6){this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;continue}if(a=zf.deflate(r,i),a===JW)return r.next_out>0&&this.onData(r.output.subarray(0,r.next_out)),a=zf.deflateEnd(this.strm),this.onEnd(a),this.ended=!0,a===_p;if(r.avail_out===0){this.onData(r.output);continue}if(i>0&&r.next_out>0){this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;continue}if(r.avail_in===0)break}return!0};B_.prototype.onData=function(e){this.chunks.push(e)};B_.prototype.onEnd=function(e){e===_p&&(this.result=em.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};const r1=16209,tH=16191;var rH=function(t,r){let n,a,i,s,o,l,c,u,h,m,f,v,x,w,_,b,y,N,R,P,F,C,A,W;const L=t.state;n=t.next_in,A=t.input,a=n+(t.avail_in-5),i=t.next_out,W=t.output,s=i-(r-t.avail_out),o=i+(t.avail_out-257),l=L.dmax,c=L.wsize,u=L.whave,h=L.wnext,m=L.window,f=L.hold,v=L.bits,x=L.lencode,w=L.distcode,_=(1<<L.lenbits)-1,b=(1<<L.distbits)-1;e:do{v<15&&(f+=A[n++]<<v,v+=8,f+=A[n++]<<v,v+=8),y=x[f&_];t:for(;;){if(N=y>>>24,f>>>=N,v-=N,N=y>>>16&255,N===0)W[i++]=y&65535;else if(N&16){R=y&65535,N&=15,N&&(v<N&&(f+=A[n++]<<v,v+=8),R+=f&(1<<N)-1,f>>>=N,v-=N),v<15&&(f+=A[n++]<<v,v+=8,f+=A[n++]<<v,v+=8),y=w[f&b];r:for(;;){if(N=y>>>24,f>>>=N,v-=N,N=y>>>16&255,N&16){if(P=y&65535,N&=15,v<N&&(f+=A[n++]<<v,v+=8,v<N&&(f+=A[n++]<<v,v+=8)),P+=f&(1<<N)-1,P>l){t.msg="invalid distance too far back",L.mode=r1;break e}if(f>>>=N,v-=N,N=i-s,P>N){if(N=P-N,N>u&&L.sane){t.msg="invalid distance too far back",L.mode=r1;break e}if(F=0,C=m,h===0){if(F+=c-N,N<R){R-=N;do W[i++]=m[F++];while(--N);F=i-P,C=W}}else if(h<N){if(F+=c+h-N,N-=h,N<R){R-=N;do W[i++]=m[F++];while(--N);if(F=0,h<R){N=h,R-=N;do W[i++]=m[F++];while(--N);F=i-P,C=W}}}else if(F+=h-N,N<R){R-=N;do W[i++]=m[F++];while(--N);F=i-P,C=W}for(;R>2;)W[i++]=C[F++],W[i++]=C[F++],W[i++]=C[F++],R-=3;R&&(W[i++]=C[F++],R>1&&(W[i++]=C[F++]))}else{F=i-P;do W[i++]=W[F++],W[i++]=W[F++],W[i++]=W[F++],R-=3;while(R>2);R&&(W[i++]=W[F++],R>1&&(W[i++]=W[F++]))}}else if(N&64){t.msg="invalid distance code",L.mode=r1;break e}else{y=w[(y&65535)+(f&(1<<N)-1)];continue r}break}}else if(N&64)if(N&32){L.mode=tH;break e}else{t.msg="invalid literal/length code",L.mode=r1;break e}else{y=x[(y&65535)+(f&(1<<N)-1)];continue t}break}}while(n<a&&i<o);R=v>>3,n-=R,v-=R<<3,f&=(1<<v)-1,t.next_in=n,t.next_out=i,t.avail_in=n<a?5+(a-n):5-(n-a),t.avail_out=i<o?257+(o-i):257-(i-o),L.hold=f,L.bits=v};const d0=15,F4=852,L4=592,P4=0,Bg=1,I4=2,nH=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),aH=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),iH=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),sH=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),oH=(e,t,r,n,a,i,s,o)=>{const l=o.bits;let c=0,u=0,h=0,m=0,f=0,v=0,x=0,w=0,_=0,b=0,y,N,R,P,F,C=null,A;const W=new Uint16Array(d0+1),L=new Uint16Array(d0+1);let I=null,V,Q,ue;for(c=0;c<=d0;c++)W[c]=0;for(u=0;u<n;u++)W[t[r+u]]++;for(f=l,m=d0;m>=1&&W[m]===0;m--);if(f>m&&(f=m),m===0)return a[i++]=1<<24|64<<16|0,a[i++]=1<<24|64<<16|0,o.bits=1,0;for(h=1;h<m&&W[h]===0;h++);for(f<h&&(f=h),w=1,c=1;c<=d0;c++)if(w<<=1,w-=W[c],w<0)return-1;if(w>0&&(e===P4||m!==1))return-1;for(L[1]=0,c=1;c<d0;c++)L[c+1]=L[c]+W[c];for(u=0;u<n;u++)t[r+u]!==0&&(s[L[t[r+u]]++]=u);if(e===P4?(C=I=s,A=20):e===Bg?(C=nH,I=aH,A=257):(C=iH,I=sH,A=0),b=0,u=0,c=h,F=i,v=f,x=0,R=-1,_=1<<f,P=_-1,e===Bg&&_>F4||e===I4&&_>L4)return 1;for(;;){V=c-x,s[u]+1<A?(Q=0,ue=s[u]):s[u]>=A?(Q=I[s[u]-A],ue=C[s[u]-A]):(Q=96,ue=0),y=1<<c-x,N=1<<v,h=N;do N-=y,a[F+(b>>x)+N]=V<<24|Q<<16|ue|0;while(N!==0);for(y=1<<c-1;b&y;)y>>=1;if(y!==0?(b&=y-1,b+=y):b=0,u++,--W[c]===0){if(c===m)break;c=t[r+s[u]]}if(c>f&&(b&P)!==R){for(x===0&&(x=f),F+=h,v=c-x,w=1<<v;v+x<m&&(w-=W[v+x],!(w<=0));)v++,w<<=1;if(_+=1<<v,e===Bg&&_>F4||e===I4&&_>L4)return 1;R=b&P,a[R]=f<<24|v<<16|F-i|0}}return b!==0&&(a[F+b]=c-x<<24|64<<16|0),o.bits=f,0};var $f=oH;const lH=0,mE=1,gE=2,{Z_FINISH:O4,Z_BLOCK:cH,Z_TREES:n1,Z_OK:Rc,Z_STREAM_END:uH,Z_NEED_DICT:fH,Z_STREAM_ERROR:zi,Z_DATA_ERROR:xE,Z_MEM_ERROR:vE,Z_BUF_ERROR:hH,Z_DEFLATED:j4}=Vh,tm=16180,R4=16181,D4=16182,M4=16183,B4=16184,U4=16185,z4=16186,$4=16187,W4=16188,H4=16189,wp=16190,Qs=16191,Ug=16192,V4=16193,zg=16194,q4=16195,G4=16196,X4=16197,K4=16198,a1=16199,i1=16200,Y4=16201,J4=16202,Z4=16203,Q4=16204,eb=16205,$g=16206,tb=16207,rb=16208,zr=16209,_E=16210,wE=16211,dH=852,pH=592,mH=15,gH=mH,nb=e=>(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24);function xH(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const qc=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<tm||t.mode>wE?1:0},yE=e=>{if(qc(e))return zi;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=t.wrap&1),t.mode=tm,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(dH),t.distcode=t.distdyn=new Int32Array(pH),t.sane=1,t.back=-1,Rc},bE=e=>{if(qc(e))return zi;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,yE(e)},kE=(e,t)=>{let r;if(qc(e))return zi;const n=e.state;return t<0?(r=0,t=-t):(r=(t>>4)+5,t<48&&(t&=15)),t&&(t<8||t>15)?zi:(n.window!==null&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,bE(e))},SE=(e,t)=>{if(!e)return zi;const r=new xH;e.state=r,r.strm=e,r.window=null,r.mode=tm;const n=kE(e,t);return n!==Rc&&(e.state=null),n},vH=e=>SE(e,gH);let ab=!0,Wg,Hg;const _H=e=>{if(ab){Wg=new Int32Array(512),Hg=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for($f(mE,e.lens,0,288,Wg,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;$f(gE,e.lens,0,32,Hg,0,e.work,{bits:5}),ab=!1}e.lencode=Wg,e.lenbits=9,e.distcode=Hg,e.distbits=5},NE=(e,t,r,n)=>{let a;const i=e.state;return i.window===null&&(i.wsize=1<<i.wbits,i.wnext=0,i.whave=0,i.window=new Uint8Array(i.wsize)),n>=i.wsize?(i.window.set(t.subarray(r-i.wsize,r),0),i.wnext=0,i.whave=i.wsize):(a=i.wsize-i.wnext,a>n&&(a=n),i.window.set(t.subarray(r-n,r-n+a),i.wnext),n-=a,n?(i.window.set(t.subarray(r-n,r),0),i.wnext=n,i.whave=i.wsize):(i.wnext+=a,i.wnext===i.wsize&&(i.wnext=0),i.whave<i.wsize&&(i.whave+=a))),0},wH=(e,t)=>{let r,n,a,i,s,o,l,c,u,h,m,f,v,x,w=0,_,b,y,N,R,P,F,C;const A=new Uint8Array(4);let W,L;const I=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(qc(e)||!e.output||!e.input&&e.avail_in!==0)return zi;r=e.state,r.mode===Qs&&(r.mode=Ug),s=e.next_out,a=e.output,l=e.avail_out,i=e.next_in,n=e.input,o=e.avail_in,c=r.hold,u=r.bits,h=o,m=l,C=Rc;e:for(;;)switch(r.mode){case tm:if(r.wrap===0){r.mode=Ug;break}for(;u<16;){if(o===0)break e;o--,c+=n[i++]<<u,u+=8}if(r.wrap&2&&c===35615){r.wbits===0&&(r.wbits=15),r.check=0,A[0]=c&255,A[1]=c>>>8&255,r.check=Mn(r.check,A,2,0),c=0,u=0,r.mode=R4;break}if(r.head&&(r.head.done=!1),!(r.wrap&1)||(((c&255)<<8)+(c>>8))%31){e.msg="incorrect header check",r.mode=zr;break}if((c&15)!==j4){e.msg="unknown compression method",r.mode=zr;break}if(c>>>=4,u-=4,F=(c&15)+8,r.wbits===0&&(r.wbits=F),F>15||F>r.wbits){e.msg="invalid window size",r.mode=zr;break}r.dmax=1<<r.wbits,r.flags=0,e.adler=r.check=1,r.mode=c&512?H4:Qs,c=0,u=0;break;case R4:for(;u<16;){if(o===0)break e;o--,c+=n[i++]<<u,u+=8}if(r.flags=c,(r.flags&255)!==j4){e.msg="unknown compression method",r.mode=zr;break}if(r.flags&57344){e.msg="unknown header flags set",r.mode=zr;break}r.head&&(r.head.text=c>>8&1),r.flags&512&&r.wrap&4&&(A[0]=c&255,A[1]=c>>>8&255,r.check=Mn(r.check,A,2,0)),c=0,u=0,r.mode=D4;case D4:for(;u<32;){if(o===0)break e;o--,c+=n[i++]<<u,u+=8}r.head&&(r.head.time=c),r.flags&512&&r.wrap&4&&(A[0]=c&255,A[1]=c>>>8&255,A[2]=c>>>16&255,A[3]=c>>>24&255,r.check=Mn(r.check,A,4,0)),c=0,u=0,r.mode=M4;case M4:for(;u<16;){if(o===0)break e;o--,c+=n[i++]<<u,u+=8}r.head&&(r.head.xflags=c&255,r.head.os=c>>8),r.flags&512&&r.wrap&4&&(A[0]=c&255,A[1]=c>>>8&255,r.check=Mn(r.check,A,2,0)),c=0,u=0,r.mode=B4;case B4:if(r.flags&1024){for(;u<16;){if(o===0)break e;o--,c+=n[i++]<<u,u+=8}r.length=c,r.head&&(r.head.extra_len=c),r.flags&512&&r.wrap&4&&(A[0]=c&255,A[1]=c>>>8&255,r.check=Mn(r.check,A,2,0)),c=0,u=0}else r.head&&(r.head.extra=null);r.mode=U4;case U4:if(r.flags&1024&&(f=r.length,f>o&&(f=o),f&&(r.head&&(F=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(i,i+f),F)),r.flags&512&&r.wrap&4&&(r.check=Mn(r.check,n,f,i)),o-=f,i+=f,r.length-=f),r.length))break e;r.length=0,r.mode=z4;case z4:if(r.flags&2048){if(o===0)break e;f=0;do F=n[i+f++],r.head&&F&&r.length<65536&&(r.head.name+=String.fromCharCode(F));while(F&&f<o);if(r.flags&512&&r.wrap&4&&(r.check=Mn(r.check,n,f,i)),o-=f,i+=f,F)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=$4;case $4:if(r.flags&4096){if(o===0)break e;f=0;do F=n[i+f++],r.head&&F&&r.length<65536&&(r.head.comment+=String.fromCharCode(F));while(F&&f<o);if(r.flags&512&&r.wrap&4&&(r.check=Mn(r.check,n,f,i)),o-=f,i+=f,F)break e}else r.head&&(r.head.comment=null);r.mode=W4;case W4:if(r.flags&512){for(;u<16;){if(o===0)break e;o--,c+=n[i++]<<u,u+=8}if(r.wrap&4&&c!==(r.check&65535)){e.msg="header crc mismatch",r.mode=zr;break}c=0,u=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=Qs;break;case H4:for(;u<32;){if(o===0)break e;o--,c+=n[i++]<<u,u+=8}e.adler=r.check=nb(c),c=0,u=0,r.mode=wp;case wp:if(r.havedict===0)return e.next_out=s,e.avail_out=l,e.next_in=i,e.avail_in=o,r.hold=c,r.bits=u,fH;e.adler=r.check=1,r.mode=Qs;case Qs:if(t===cH||t===n1)break e;case Ug:if(r.last){c>>>=u&7,u-=u&7,r.mode=$g;break}for(;u<3;){if(o===0)break e;o--,c+=n[i++]<<u,u+=8}switch(r.last=c&1,c>>>=1,u-=1,c&3){case 0:r.mode=V4;break;case 1:if(_H(r),r.mode=a1,t===n1){c>>>=2,u-=2;break e}break;case 2:r.mode=G4;break;case 3:e.msg="invalid block type",r.mode=zr}c>>>=2,u-=2;break;case V4:for(c>>>=u&7,u-=u&7;u<32;){if(o===0)break e;o--,c+=n[i++]<<u,u+=8}if((c&65535)!==(c>>>16^65535)){e.msg="invalid stored block lengths",r.mode=zr;break}if(r.length=c&65535,c=0,u=0,r.mode=zg,t===n1)break e;case zg:r.mode=q4;case q4:if(f=r.length,f){if(f>o&&(f=o),f>l&&(f=l),f===0)break e;a.set(n.subarray(i,i+f),s),o-=f,i+=f,l-=f,s+=f,r.length-=f;break}r.mode=Qs;break;case G4:for(;u<14;){if(o===0)break e;o--,c+=n[i++]<<u,u+=8}if(r.nlen=(c&31)+257,c>>>=5,u-=5,r.ndist=(c&31)+1,c>>>=5,u-=5,r.ncode=(c&15)+4,c>>>=4,u-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=zr;break}r.have=0,r.mode=X4;case X4:for(;r.have<r.ncode;){for(;u<3;){if(o===0)break e;o--,c+=n[i++]<<u,u+=8}r.lens[I[r.have++]]=c&7,c>>>=3,u-=3}for(;r.have<19;)r.lens[I[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,W={bits:r.lenbits},C=$f(lH,r.lens,0,19,r.lencode,0,r.work,W),r.lenbits=W.bits,C){e.msg="invalid code lengths set",r.mode=zr;break}r.have=0,r.mode=K4;case K4:for(;r.have<r.nlen+r.ndist;){for(;w=r.lencode[c&(1<<r.lenbits)-1],_=w>>>24,b=w>>>16&255,y=w&65535,!(_<=u);){if(o===0)break e;o--,c+=n[i++]<<u,u+=8}if(y<16)c>>>=_,u-=_,r.lens[r.have++]=y;else{if(y===16){for(L=_+2;u<L;){if(o===0)break e;o--,c+=n[i++]<<u,u+=8}if(c>>>=_,u-=_,r.have===0){e.msg="invalid bit length repeat",r.mode=zr;break}F=r.lens[r.have-1],f=3+(c&3),c>>>=2,u-=2}else if(y===17){for(L=_+3;u<L;){if(o===0)break e;o--,c+=n[i++]<<u,u+=8}c>>>=_,u-=_,F=0,f=3+(c&7),c>>>=3,u-=3}else{for(L=_+7;u<L;){if(o===0)break e;o--,c+=n[i++]<<u,u+=8}c>>>=_,u-=_,F=0,f=11+(c&127),c>>>=7,u-=7}if(r.have+f>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=zr;break}for(;f--;)r.lens[r.have++]=F}}if(r.mode===zr)break;if(r.lens[256]===0){e.msg="invalid code -- missing end-of-block",r.mode=zr;break}if(r.lenbits=9,W={bits:r.lenbits},C=$f(mE,r.lens,0,r.nlen,r.lencode,0,r.work,W),r.lenbits=W.bits,C){e.msg="invalid literal/lengths set",r.mode=zr;break}if(r.distbits=6,r.distcode=r.distdyn,W={bits:r.distbits},C=$f(gE,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,W),r.distbits=W.bits,C){e.msg="invalid distances set",r.mode=zr;break}if(r.mode=a1,t===n1)break e;case a1:r.mode=i1;case i1:if(o>=6&&l>=258){e.next_out=s,e.avail_out=l,e.next_in=i,e.avail_in=o,r.hold=c,r.bits=u,rH(e,m),s=e.next_out,a=e.output,l=e.avail_out,i=e.next_in,n=e.input,o=e.avail_in,c=r.hold,u=r.bits,r.mode===Qs&&(r.back=-1);break}for(r.back=0;w=r.lencode[c&(1<<r.lenbits)-1],_=w>>>24,b=w>>>16&255,y=w&65535,!(_<=u);){if(o===0)break e;o--,c+=n[i++]<<u,u+=8}if(b&&!(b&240)){for(N=_,R=b,P=y;w=r.lencode[P+((c&(1<<N+R)-1)>>N)],_=w>>>24,b=w>>>16&255,y=w&65535,!(N+_<=u);){if(o===0)break e;o--,c+=n[i++]<<u,u+=8}c>>>=N,u-=N,r.back+=N}if(c>>>=_,u-=_,r.back+=_,r.length=y,b===0){r.mode=eb;break}if(b&32){r.back=-1,r.mode=Qs;break}if(b&64){e.msg="invalid literal/length code",r.mode=zr;break}r.extra=b&15,r.mode=Y4;case Y4:if(r.extra){for(L=r.extra;u<L;){if(o===0)break e;o--,c+=n[i++]<<u,u+=8}r.length+=c&(1<<r.extra)-1,c>>>=r.extra,u-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=J4;case J4:for(;w=r.distcode[c&(1<<r.distbits)-1],_=w>>>24,b=w>>>16&255,y=w&65535,!(_<=u);){if(o===0)break e;o--,c+=n[i++]<<u,u+=8}if(!(b&240)){for(N=_,R=b,P=y;w=r.distcode[P+((c&(1<<N+R)-1)>>N)],_=w>>>24,b=w>>>16&255,y=w&65535,!(N+_<=u);){if(o===0)break e;o--,c+=n[i++]<<u,u+=8}c>>>=N,u-=N,r.back+=N}if(c>>>=_,u-=_,r.back+=_,b&64){e.msg="invalid distance code",r.mode=zr;break}r.offset=y,r.extra=b&15,r.mode=Z4;case Z4:if(r.extra){for(L=r.extra;u<L;){if(o===0)break e;o--,c+=n[i++]<<u,u+=8}r.offset+=c&(1<<r.extra)-1,c>>>=r.extra,u-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=zr;break}r.mode=Q4;case Q4:if(l===0)break e;if(f=m-l,r.offset>f){if(f=r.offset-f,f>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=zr;break}f>r.wnext?(f-=r.wnext,v=r.wsize-f):v=r.wnext-f,f>r.length&&(f=r.length),x=r.window}else x=a,v=s-r.offset,f=r.length;f>l&&(f=l),l-=f,r.length-=f;do a[s++]=x[v++];while(--f);r.length===0&&(r.mode=i1);break;case eb:if(l===0)break e;a[s++]=r.length,l--,r.mode=i1;break;case $g:if(r.wrap){for(;u<32;){if(o===0)break e;o--,c|=n[i++]<<u,u+=8}if(m-=l,e.total_out+=m,r.total+=m,r.wrap&4&&m&&(e.adler=r.check=r.flags?Mn(r.check,a,m,s-m):Sh(r.check,a,m,s-m)),m=l,r.wrap&4&&(r.flags?c:nb(c))!==r.check){e.msg="incorrect data check",r.mode=zr;break}c=0,u=0}r.mode=tb;case tb:if(r.wrap&&r.flags){for(;u<32;){if(o===0)break e;o--,c+=n[i++]<<u,u+=8}if(r.wrap&4&&c!==(r.total&4294967295)){e.msg="incorrect length check",r.mode=zr;break}c=0,u=0}r.mode=rb;case rb:C=uH;break e;case zr:C=xE;break e;case _E:return vE;case wE:default:return zi}return e.next_out=s,e.avail_out=l,e.next_in=i,e.avail_in=o,r.hold=c,r.bits=u,(r.wsize||m!==e.avail_out&&r.mode<zr&&(r.mode<$g||t!==O4))&&NE(e,e.output,e.next_out,m-e.avail_out),h-=e.avail_in,m-=e.avail_out,e.total_in+=h,e.total_out+=m,r.total+=m,r.wrap&4&&m&&(e.adler=r.check=r.flags?Mn(r.check,a,m,e.next_out-m):Sh(r.check,a,m,e.next_out-m)),e.data_type=r.bits+(r.last?64:0)+(r.mode===Qs?128:0)+(r.mode===a1||r.mode===zg?256:0),(h===0&&m===0||t===O4)&&C===Rc&&(C=hH),C},yH=e=>{if(qc(e))return zi;let t=e.state;return t.window&&(t.window=null),e.state=null,Rc},bH=(e,t)=>{if(qc(e))return zi;const r=e.state;return r.wrap&2?(r.head=t,t.done=!1,Rc):zi},kH=(e,t)=>{const r=t.length;let n,a,i;return qc(e)||(n=e.state,n.wrap!==0&&n.mode!==wp)?zi:n.mode===wp&&(a=1,a=Sh(a,t,r,0),a!==n.check)?xE:(i=NE(e,t,r,r),i?(n.mode=_E,vE):(n.havedict=1,Rc))};var SH=bE,NH=kE,EH=yE,AH=vH,TH=SE,CH=wH,FH=yH,LH=bH,PH=kH,IH="pako inflate (from Nodeca project)",io={inflateReset:SH,inflateReset2:NH,inflateResetKeep:EH,inflateInit:AH,inflateInit2:TH,inflate:CH,inflateEnd:FH,inflateGetHeader:LH,inflateSetDictionary:PH,inflateInfo:IH};function OH(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var jH=OH;const EE=Object.prototype.toString,{Z_NO_FLUSH:RH,Z_FINISH:DH,Z_OK:Ah,Z_STREAM_END:Vg,Z_NEED_DICT:qg,Z_STREAM_ERROR:MH,Z_DATA_ERROR:ib,Z_MEM_ERROR:BH}=Vh;function Gh(e){this.options=em.assign({chunkSize:1024*64,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(e&&e.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15||(t.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new dE,this.strm.avail_out=0;let r=io.inflateInit2(this.strm,t.windowBits);if(r!==Ah)throw new Error(lu[r]);if(this.header=new jH,io.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=Eh.string2buf(t.dictionary):EE.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=io.inflateSetDictionary(this.strm,t.dictionary),r!==Ah)))throw new Error(lu[r])}Gh.prototype.push=function(e,t){const r=this.strm,n=this.options.chunkSize,a=this.options.dictionary;let i,s,o;if(this.ended)return!1;for(t===~~t?s=t:s=t===!0?DH:RH,EE.call(e)==="[object ArrayBuffer]"?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),i=io.inflate(r,s),i===qg&&a&&(i=io.inflateSetDictionary(r,a),i===Ah?i=io.inflate(r,s):i===ib&&(i=qg));r.avail_in>0&&i===Vg&&r.state.wrap>0&&e[r.next_in]!==0;)io.inflateReset(r),i=io.inflate(r,s);switch(i){case MH:case ib:case qg:case BH:return this.onEnd(i),this.ended=!0,!1}if(o=r.avail_out,r.next_out&&(r.avail_out===0||i===Vg))if(this.options.to==="string"){let l=Eh.utf8border(r.output,r.next_out),c=r.next_out-l,u=Eh.buf2string(r.output,l);r.next_out=c,r.avail_out=n-c,c&&r.output.set(r.output.subarray(l,l+c),0),this.onData(u)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(!(i===Ah&&o===0)){if(i===Vg)return i=io.inflateEnd(this.strm),this.onEnd(i),this.ended=!0,!0;if(r.avail_in===0)break}}return!0};Gh.prototype.onData=function(e){this.chunks.push(e)};Gh.prototype.onEnd=function(e){e===Ah&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=em.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function U_(e,t){const r=new Gh(t);if(r.push(e),r.err)throw r.msg||lu[r.err];return r.result}function UH(e,t){return t=t||{},t.raw=!0,U_(e,t)}var zH=Gh,$H=U_,WH=UH,HH=U_,VH=Vh,qH={Inflate:zH,inflate:$H,inflateRaw:WH,ungzip:HH,constants:VH};const{Inflate:GH,inflate:XH,inflateRaw:Oq,ungzip:jq}=qH;var sb=GH,KH=XH;const AE=[];for(let e=0;e<256;e++){let t=e;for(let r=0;r<8;r++)t&1?t=3988292384^t>>>1:t=t>>>1;AE[e]=t}const ob=4294967295;function YH(e,t,r){let n=e;for(let a=0;a<r;a++)n=AE[(n^t[a])&255]^n>>>8;return n}function JH(e,t){return(YH(ob,e,t)^ob)>>>0}function lb(e,t,r){const n=e.readUint32(),a=JH(new Uint8Array(e.buffer,e.byteOffset+e.offset-t-4,t),t);if(a!==n)throw new Error(`CRC mismatch for chunk ${r}. Expected ${n}, found ${a}`)}function TE(e,t,r){for(let n=0;n<r;n++)t[n]=e[n]}function CE(e,t,r,n){let a=0;for(;a<n;a++)t[a]=e[a];for(;a<r;a++)t[a]=e[a]+t[a-n]&255}function FE(e,t,r,n){let a=0;if(r.length===0)for(;a<n;a++)t[a]=e[a];else for(;a<n;a++)t[a]=e[a]+r[a]&255}function LE(e,t,r,n,a){let i=0;if(r.length===0){for(;i<a;i++)t[i]=e[i];for(;i<n;i++)t[i]=e[i]+(t[i-a]>>1)&255}else{for(;i<a;i++)t[i]=e[i]+(r[i]>>1)&255;for(;i<n;i++)t[i]=e[i]+(t[i-a]+r[i]>>1)&255}}function PE(e,t,r,n,a){let i=0;if(r.length===0){for(;i<a;i++)t[i]=e[i];for(;i<n;i++)t[i]=e[i]+t[i-a]&255}else{for(;i<a;i++)t[i]=e[i]+r[i]&255;for(;i<n;i++)t[i]=e[i]+ZH(t[i-a],r[i],r[i-a])&255}}function ZH(e,t,r){const n=e+t-r,a=Math.abs(n-e),i=Math.abs(n-t),s=Math.abs(n-r);return a<=i&&a<=s?e:i<=s?t:r}function QH(e,t,r,n,a,i){switch(e){case 0:TE(t,r,a);break;case 1:CE(t,r,a,i);break;case 2:FE(t,r,n,a);break;case 3:LE(t,r,n,a,i);break;case 4:PE(t,r,n,a,i);break;default:throw new Error(`Unsupported filter: ${e}`)}}const eV=new Uint16Array([255]),tV=new Uint8Array(eV.buffer),rV=tV[0]===255;function nV(e){const{data:t,width:r,height:n,channels:a,depth:i}=e,s=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],o=Math.ceil(i/8)*a,l=new Uint8Array(n*r*o);let c=0;for(let u=0;u<7;u++){const h=s[u],m=Math.ceil((r-h.x)/h.xStep),f=Math.ceil((n-h.y)/h.yStep);if(m<=0||f<=0)continue;const v=m*o,x=new Uint8Array(v);for(let w=0;w<f;w++){const _=t[c++],b=t.subarray(c,c+v);c+=v;const y=new Uint8Array(v);QH(_,b,y,x,v,o),x.set(y);for(let N=0;N<m;N++){const R=h.x+N*h.xStep,P=h.y+w*h.yStep;if(!(R>=r||P>=n))for(let F=0;F<o;F++)l[(P*r+R)*o+F]=y[N*o+F]}}}if(i===16){const u=new Uint16Array(l.buffer);if(rV)for(let h=0;h<u.length;h++)u[h]=aV(u[h]);return u}else return l}function aV(e){return(e&255)<<8|e>>8&255}const iV=new Uint16Array([255]),sV=new Uint8Array(iV.buffer),oV=sV[0]===255,lV=new Uint8Array(0);function cb(e){const{data:t,width:r,height:n,channels:a,depth:i}=e,s=Math.ceil(i/8)*a,o=Math.ceil(i/8*a*r),l=new Uint8Array(n*o);let c=lV,u=0,h,m;for(let f=0;f<n;f++){switch(h=t.subarray(u+1,u+1+o),m=l.subarray(f*o,(f+1)*o),t[u]){case 0:TE(h,m,o);break;case 1:CE(h,m,o,s);break;case 2:FE(h,m,c,o);break;case 3:LE(h,m,c,o,s);break;case 4:PE(h,m,c,o,s);break;default:throw new Error(`Unsupported filter: ${t[u]}`)}c=m,u+=o+1}if(i===16){const f=new Uint16Array(l.buffer);if(oV)for(let v=0;v<f.length;v++)f[v]=cV(f[v]);return f}else return l}function cV(e){return(e&255)<<8|e>>8&255}const N1=Uint8Array.of(137,80,78,71,13,10,26,10);function ub(e){if(!uV(e.readBytes(N1.length)))throw new Error("wrong PNG signature")}function uV(e){if(e.length<N1.length)return!1;for(let t=0;t<N1.length;t++)if(e[t]!==N1[t])return!1;return!0}const fV="tEXt",hV=0,IE=new TextDecoder("latin1");function dV(e){if(mV(e),e.length===0||e.length>79)throw new Error("keyword length must be between 1 and 79")}const pV=/^[\u0000-\u00FF]*$/;function mV(e){if(!pV.test(e))throw new Error("invalid latin1 text")}function gV(e,t,r){const n=OE(t);e[n]=xV(t,r-n.length-1)}function OE(e){for(e.mark();e.readByte()!==hV;);const t=e.offset;e.reset();const r=IE.decode(e.readBytes(t-e.offset-1));return e.skip(1),dV(r),r}function xV(e,t){return IE.decode(e.readBytes(t))}const ni={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},Gg={UNKNOWN:-1,DEFLATE:0},fb={UNKNOWN:-1,ADAPTIVE:0},Xg={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},s1={NONE:0,BACKGROUND:1,PREVIOUS:2},Kg={SOURCE:0,OVER:1};class vV extends I_{constructor(r,n={}){super(r);mr(this,"_checkCrc");mr(this,"_inflator");mr(this,"_png");mr(this,"_apng");mr(this,"_end");mr(this,"_hasPalette");mr(this,"_palette");mr(this,"_hasTransparency");mr(this,"_transparency");mr(this,"_compressionMethod");mr(this,"_filterMethod");mr(this,"_interlaceMethod");mr(this,"_colorType");mr(this,"_isAnimated");mr(this,"_numberOfFrames");mr(this,"_numberOfPlays");mr(this,"_frames");mr(this,"_writingDataChunks");const{checkCrc:a=!1}=n;this._checkCrc=a,this._inflator=new sb,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=Gg.UNKNOWN,this._filterMethod=fb.UNKNOWN,this._interlaceMethod=Xg.UNKNOWN,this._colorType=ni.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(ub(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeChunk(r,n)}return this.decodeImage(),this._png}decodeApng(){for(ub(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeApngChunk(r,n)}return this.decodeApngImage(),this._apng}decodeChunk(r,n){const a=this.offset;switch(n){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(r);break;case"IDAT":this.decodeIDAT(r);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(r);break;case"iCCP":this.decodeiCCP(r);break;case fV:gV(this._png.text,this,r);break;case"pHYs":this.decodepHYs();break;default:this.skip(r);break}if(this.offset-a!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?lb(this,r+4,n):this.skip(4)}decodeApngChunk(r,n){const a=this.offset;switch(n!=="fdAT"&&n!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),n){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(r);break;default:this.decodeChunk(r,n),this.offset=a+r;break}if(this.offset-a!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?lb(this,r+4,n):this.skip(4)}decodeIHDR(){const r=this._png;r.width=this.readUint32(),r.height=this.readUint32(),r.depth=_V(this.readUint8());const n=this.readUint8();this._colorType=n;let a;switch(n){case ni.GREYSCALE:a=1;break;case ni.TRUECOLOUR:a=3;break;case ni.INDEXED_COLOUR:a=1;break;case ni.GREYSCALE_ALPHA:a=2;break;case ni.TRUECOLOUR_ALPHA:a=4;break;case ni.UNKNOWN:default:throw new Error(`Unknown color type: ${n}`)}if(this._png.channels=a,this._compressionMethod=this.readUint8(),this._compressionMethod!==Gg.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const r={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(r)}decodePLTE(r){if(r%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${r}`);const n=r/3;this._hasPalette=!0;const a=[];this._palette=a;for(let i=0;i<n;i++)a.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(r){this._writingDataChunks=!0;const n=r,a=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,a,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodeFDAT(r){this._writingDataChunks=!0;let n=r,a=this.offset+this.byteOffset;if(a+=4,n-=4,this._inflator.push(new Uint8Array(this.buffer,a,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodetRNS(r){switch(this._colorType){case ni.GREYSCALE:case ni.TRUECOLOUR:{if(r%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${r}`);if(r/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${r/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(r/2);for(let n=0;n<r/2;n++)this._transparency[n]=this.readUint16();break}case ni.INDEXED_COLOUR:{if(r>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${r} vs ${this._palette.length})`);let n=0;for(;n<r;n++){const a=this.readByte();this._palette[n].push(a)}for(;n<this._palette.length;n++)this._palette[n].push(255);break}case ni.UNKNOWN:case ni.GREYSCALE_ALPHA:case ni.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(r){const n=OE(this),a=this.readUint8();if(a!==Gg.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${a}`);const i=this.readBytes(r-n.length-2);this._png.iccEmbeddedProfile={name:n,profile:KH(i)}}decodepHYs(){const r=this.readUint32(),n=this.readUint32(),a=this.readByte();this._png.resolution={x:r,y:n,unit:a}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let r=0;r<this._numberOfFrames;r++){const n={sequenceNumber:this._frames[r].sequenceNumber,delayNumber:this._frames[r].delayNumber,delayDenominator:this._frames[r].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},a=this._frames.at(r);if(a){if(a.data=cb({data:a.data,width:a.width,height:a.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),r===0||a.xOffset===0&&a.yOffset===0&&a.width===this._png.width&&a.height===this._png.height)n.data=a.data;else{const i=this._apng.frames.at(r-1);this.disposeFrame(a,i,n),this.addFrameDataToCanvas(n,a)}this._apng.frames.push(n)}}return this._apng}disposeFrame(r,n,a){switch(r.disposeOp){case s1.NONE:break;case s1.BACKGROUND:for(let i=0;i<this._png.height;i++)for(let s=0;s<this._png.width;s++){const o=(i*r.width+s)*this._png.channels;for(let l=0;l<this._png.channels;l++)a.data[o+l]=0}break;case s1.PREVIOUS:a.data.set(n.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(r,n){const a=1<<this._png.depth,i=(s,o)=>{const l=((s+n.yOffset)*this._png.width+n.xOffset+o)*this._png.channels,c=(s*n.width+o)*this._png.channels;return{index:l,frameIndex:c}};switch(n.blendOp){case Kg.SOURCE:for(let s=0;s<n.height;s++)for(let o=0;o<n.width;o++){const{index:l,frameIndex:c}=i(s,o);for(let u=0;u<this._png.channels;u++)r.data[l+u]=n.data[c+u]}break;case Kg.OVER:for(let s=0;s<n.height;s++)for(let o=0;o<n.width;o++){const{index:l,frameIndex:c}=i(s,o);for(let u=0;u<this._png.channels;u++){const h=n.data[c+this._png.channels-1]/a,m=u%(this._png.channels-1)===0?1:n.data[c+u],f=Math.floor(h*m+(1-h)*r.data[l+u]);r.data[l+u]+=f}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){var n;if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const r=this._isAnimated?((n=this._frames)==null?void 0:n.at(0)).data:this._inflator.result;if(this._filterMethod!==fb.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===Xg.NO_INTERLACE)this._png.data=cb({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===Xg.ADAM7)this._png.data=nV({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const r=this._inflator.result,n=this._frames.at(-1);n?n.data=r:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:s1.NONE,blendOp:Kg.SOURCE,data:r}),this._inflator=new sb,this._writingDataChunks=!1}}function _V(e){if(e!==1&&e!==2&&e!==4&&e!==8&&e!==16)throw new Error(`invalid bit depth: ${e}`);return e}var hb;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.METRE=1]="METRE"})(hb||(hb={}));function wV(e,t){return new vV(e,t).decode()}var Ft=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function Yg(){Ft.console&&typeof Ft.console.log=="function"&&Ft.console.log.apply(Ft.console,arguments)}var Nr={log:Yg,warn:function(e){Ft.console&&(typeof Ft.console.warn=="function"?Ft.console.warn.apply(Ft.console,arguments):Yg.call(null,arguments))},error:function(e){Ft.console&&(typeof Ft.console.error=="function"?Ft.console.error.apply(Ft.console,arguments):Yg(e))}};function Jg(e,t,r){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){ac(n.response,t,r)},n.onerror=function(){Nr.error("could not download file")},n.send()}function db(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch{}return t.status>=200&&t.status<=299}function o1(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var ac=Ft.saveAs||((typeof window>"u"?"undefined":vr(window))!=="object"||window!==Ft?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(e,t,r){var n=Ft.URL||Ft.webkitURL,a=document.createElement("a");t=t||e.name||"download",a.download=t,a.rel="noopener",typeof e=="string"?(a.href=e,a.origin!==location.origin?db(a.href)?Jg(e,t,r):o1(a,a.target="_blank"):o1(a)):(a.href=n.createObjectURL(e),setTimeout(function(){n.revokeObjectURL(a.href)},4e4),setTimeout(function(){o1(a)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,r){if(t=t||e.name||"download",typeof e=="string")if(db(e))Jg(e,t,r);else{var n=document.createElement("a");n.href=e,n.target="_blank",setTimeout(function(){o1(n)})}else navigator.msSaveOrOpenBlob(function(a,i){return i===void 0?i={autoBom:!1}:vr(i)!=="object"&&(Nr.warn("Deprecated: Expected third argument to be a object"),i={autoBom:!i}),i.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a.type)?new Blob(["\uFEFF",a],{type:a.type}):a}(e,r),t)}:function(e,t,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof e=="string")return Jg(e,t,r);var a=e.type==="application/octet-stream",i=/constructor/i.test(Ft.HTMLElement)||Ft.safari,s=/CriOS\/[\d]+/.test(navigator.userAgent);if((s||a&&i)&&(typeof FileReader>"u"?"undefined":vr(FileReader))==="object"){var o=new FileReader;o.onloadend=function(){var u=o.result;u=s?u:u.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=u:location=u,n=null},o.readAsDataURL(e)}else{var l=Ft.URL||Ft.webkitURL,c=l.createObjectURL(e);n?n.location=c:location.href=c,n=null,setTimeout(function(){l.revokeObjectURL(c)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function jE(e){var t;e=e||"",this.ok=!1,e.charAt(0)=="#"&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(o){return[parseInt(o[1]),parseInt(o[2]),parseInt(o[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(o){return[parseInt(o[1],16),parseInt(o[2],16),parseInt(o[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(o){return[parseInt(o[1]+o[1],16),parseInt(o[2]+o[2],16),parseInt(o[3]+o[3],16)]}}],n=0;n<r.length;n++){var a=r[n].re,i=r[n].process,s=a.exec(e);s&&(t=i(s),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var o=this.r.toString(16),l=this.g.toString(16),c=this.b.toString(16);return o.length==1&&(o="0"+o),l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),"#"+o+l+c}}var E1=Ft.atob.bind(Ft),pb=Ft.btoa.bind(Ft);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function Zg(e,t){var r=e[0],n=e[1],a=e[2],i=e[3];r=ca(r,n,a,i,t[0],7,-680876936),i=ca(i,r,n,a,t[1],12,-389564586),a=ca(a,i,r,n,t[2],17,606105819),n=ca(n,a,i,r,t[3],22,-1044525330),r=ca(r,n,a,i,t[4],7,-176418897),i=ca(i,r,n,a,t[5],12,1200080426),a=ca(a,i,r,n,t[6],17,-1473231341),n=ca(n,a,i,r,t[7],22,-45705983),r=ca(r,n,a,i,t[8],7,1770035416),i=ca(i,r,n,a,t[9],12,-1958414417),a=ca(a,i,r,n,t[10],17,-42063),n=ca(n,a,i,r,t[11],22,-1990404162),r=ca(r,n,a,i,t[12],7,1804603682),i=ca(i,r,n,a,t[13],12,-40341101),a=ca(a,i,r,n,t[14],17,-1502002290),r=ua(r,n=ca(n,a,i,r,t[15],22,1236535329),a,i,t[1],5,-165796510),i=ua(i,r,n,a,t[6],9,-1069501632),a=ua(a,i,r,n,t[11],14,643717713),n=ua(n,a,i,r,t[0],20,-373897302),r=ua(r,n,a,i,t[5],5,-701558691),i=ua(i,r,n,a,t[10],9,38016083),a=ua(a,i,r,n,t[15],14,-660478335),n=ua(n,a,i,r,t[4],20,-405537848),r=ua(r,n,a,i,t[9],5,568446438),i=ua(i,r,n,a,t[14],9,-1019803690),a=ua(a,i,r,n,t[3],14,-187363961),n=ua(n,a,i,r,t[8],20,1163531501),r=ua(r,n,a,i,t[13],5,-1444681467),i=ua(i,r,n,a,t[2],9,-51403784),a=ua(a,i,r,n,t[7],14,1735328473),r=fa(r,n=ua(n,a,i,r,t[12],20,-1926607734),a,i,t[5],4,-378558),i=fa(i,r,n,a,t[8],11,-2022574463),a=fa(a,i,r,n,t[11],16,1839030562),n=fa(n,a,i,r,t[14],23,-35309556),r=fa(r,n,a,i,t[1],4,-1530992060),i=fa(i,r,n,a,t[4],11,1272893353),a=fa(a,i,r,n,t[7],16,-155497632),n=fa(n,a,i,r,t[10],23,-1094730640),r=fa(r,n,a,i,t[13],4,681279174),i=fa(i,r,n,a,t[0],11,-358537222),a=fa(a,i,r,n,t[3],16,-722521979),n=fa(n,a,i,r,t[6],23,76029189),r=fa(r,n,a,i,t[9],4,-640364487),i=fa(i,r,n,a,t[12],11,-421815835),a=fa(a,i,r,n,t[15],16,530742520),r=ha(r,n=fa(n,a,i,r,t[2],23,-995338651),a,i,t[0],6,-198630844),i=ha(i,r,n,a,t[7],10,1126891415),a=ha(a,i,r,n,t[14],15,-1416354905),n=ha(n,a,i,r,t[5],21,-57434055),r=ha(r,n,a,i,t[12],6,1700485571),i=ha(i,r,n,a,t[3],10,-1894986606),a=ha(a,i,r,n,t[10],15,-1051523),n=ha(n,a,i,r,t[1],21,-2054922799),r=ha(r,n,a,i,t[8],6,1873313359),i=ha(i,r,n,a,t[15],10,-30611744),a=ha(a,i,r,n,t[6],15,-1560198380),n=ha(n,a,i,r,t[13],21,1309151649),r=ha(r,n,a,i,t[4],6,-145523070),i=ha(i,r,n,a,t[11],10,-1120210379),a=ha(a,i,r,n,t[2],15,718787259),n=ha(n,a,i,r,t[9],21,-343485551),e[0]=ol(r,e[0]),e[1]=ol(n,e[1]),e[2]=ol(a,e[2]),e[3]=ol(i,e[3])}function rm(e,t,r,n,a,i){return t=ol(ol(t,e),ol(n,i)),ol(t<<a|t>>>32-a,r)}function ca(e,t,r,n,a,i,s){return rm(t&r|~t&n,e,t,a,i,s)}function ua(e,t,r,n,a,i,s){return rm(t&n|r&~n,e,t,a,i,s)}function fa(e,t,r,n,a,i,s){return rm(t^r^n,e,t,a,i,s)}function ha(e,t,r,n,a,i,s){return rm(r^(t|~n),e,t,a,i,s)}function RE(e){var t,r=e.length,n=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)Zg(n,yV(e.substring(t-64,t)));e=e.substring(t-64);var a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)a[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(a[t>>2]|=128<<(t%4<<3),t>55)for(Zg(n,a),t=0;t<16;t++)a[t]=0;return a[14]=8*r,Zg(n,a),n}function yV(e){var t,r=[];for(t=0;t<64;t+=4)r[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return r}var mb="0123456789abcdef".split("");function bV(e){for(var t="",r=0;r<4;r++)t+=mb[e>>8*r+4&15]+mb[e>>8*r&15];return t}function kV(e){return String.fromCharCode(255&e,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function Rx(e){return RE(e).map(kV).join("")}var SV=function(e){for(var t=0;t<e.length;t++)e[t]=bV(e[t]);return e.join("")}(RE("hello"))!="5d41402abc4b2a76b9719d911017c592";function ol(e,t){if(SV){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}return e+t&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function Dx(e,t){var r,n,a,i;if(e!==r){for(var s=(a=e,i=1+(256/e.length|0),new Array(i+1).join(a)),o=[],l=0;l<256;l++)o[l]=l;var c=0;for(l=0;l<256;l++){var u=o[l];c=(c+u+s.charCodeAt(l))%256,o[l]=o[c],o[c]=u}r=e,n=o}else o=n;var h=t.length,m=0,f=0,v="";for(l=0;l<h;l++)f=(f+(u=o[m=(m+1)%256]))%256,o[m]=o[f],o[f]=u,s=o[(o[m]+o[f])%256],v+=String.fromCharCode(t.charCodeAt(l)^s);return v}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var gb={print:4,modify:8,copy:16,"annot-forms":32};function _0(e,t,r,n){this.v=1,this.r=2;var a=192;e.forEach(function(o){if(gb.perm!==void 0)throw new Error("Invalid permission: "+o);a+=gb[o]}),this.padding="(¿N^NuAd\0NVÿú\b..\0¶Ðh>/\f©þdSiz";var i=(t+this.padding).substr(0,32),s=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(i,s),this.P=-(1+(255^a)),this.encryptionKey=Rx(i+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=Dx(this.encryptionKey,this.padding)}function w0(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var t="",r=e.length,n=0;n<r;n++){var a=e.charCodeAt(n);t+=a<33||a===35||a===37||a===40||a===41||a===47||a===60||a===62||a===91||a===93||a===123||a===125||a>126?"#"+("0"+a.toString(16)).slice(-2):e[n]}return t}function xb(e){if(vr(e)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(r,n,a){if(a=a||!1,typeof r!="string"||typeof n!="function"||typeof a!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(r)||(t[r]={});var i=Math.random().toString(35);return t[r][i]=[n,!!a],i},this.unsubscribe=function(r){for(var n in t)if(t[n][r])return delete t[n][r],Object.keys(t[n]).length===0&&delete t[n],!0;return!1},this.publish=function(r){if(t.hasOwnProperty(r)){var n=Array.prototype.slice.call(arguments,1),a=[];for(var i in t[r]){var s=t[r][i];try{s[0].apply(e,n)}catch(o){Ft.console&&Nr.error("jsPDF PubSub Error",o.message,o)}s[1]&&a.push(i)}a.length&&a.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function yp(e){if(!(this instanceof yp))return new yp(e);var t="opacity,stroke-opacity".split(",");for(var r in e)e.hasOwnProperty(r)&&t.indexOf(r)>=0&&(this[r]=e[r]);this.id="",this.objectNumber=-1}function DE(e,t){this.gState=e,this.matrix=t,this.id="",this.objectNumber=-1}function oc(e,t,r,n,a){if(!(this instanceof oc))return new oc(e,t,r,n,a);this.type=e==="axial"?2:3,this.coords=t,this.colors=r,DE.call(this,n,a)}function O0(e,t,r,n,a){if(!(this instanceof O0))return new O0(e,t,r,n,a);this.boundingBox=e,this.xStep=t,this.yStep=r,this.stream="",this.cloneIndex=0,DE.call(this,n,a)}function xt(e){var t,r=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],a=arguments[2],i=arguments[3],s=[],o=1,l=16,c="S",u=null;vr(e=e||{})==="object"&&(r=e.orientation,n=e.unit||n,a=e.format||a,i=e.compress||e.compressPdf||i,(u=e.encryption||null)!==null&&(u.userPassword=u.userPassword||"",u.ownerPassword=u.ownerPassword||"",u.userPermissions=u.userPermissions||[]),o=typeof e.userUnit=="number"?Math.abs(e.userUnit):1,e.precision!==void 0&&(t=e.precision),e.floatPrecision!==void 0&&(l=e.floatPrecision),c=e.defaultPathOperation||"S"),s=e.filters||(i===!0?["FlateEncode"]:s),n=n||"mm",r=(""+(r||"P")).toLowerCase();var h=e.putOnlyUsedFonts||!1,m={},f={internal:{},__private__:{}};f.__private__.PubSub=xb;var v="1.3",x=f.__private__.getPdfVersion=function(){return v};f.__private__.setPdfVersion=function(k){v=k};var w={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};f.__private__.getPageFormats=function(){return w};var _=f.__private__.getPageFormat=function(k){return w[k]};a=a||"a4";var b="compat",y="advanced",N=b;function R(){this.saveGraphicsState(),ee(new bt(qe,0,0,-qe,0,zl()*qe).toString()+" cm"),this.setFontSize(this.getFontSize()/qe),c="n",N=y}function P(){this.restoreGraphicsState(),c="S",N=b}var F=f.__private__.combineFontStyleAndFontWeight=function(k,D){if(k=="bold"&&D=="normal"||k=="bold"&&D==400||k=="normal"&&D=="italic"||k=="bold"&&D=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return D&&(k=D==400||D==="normal"?k==="italic"?"italic":"normal":D!=700&&D!=="bold"||k!=="normal"?(D==700?"bold":D)+""+k:"bold"),k};f.advancedAPI=function(k){var D=N===b;return D&&R.call(this),typeof k!="function"||(k(this),D&&P.call(this)),this},f.compatAPI=function(k){var D=N===y;return D&&P.call(this),typeof k!="function"||(k(this),D&&R.call(this)),this},f.isAdvancedAPI=function(){return N===y};var C,A=function(k){if(N!==y)throw new Error(k+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},W=f.roundToPrecision=f.__private__.roundToPrecision=function(k,D){var ie=t||D;if(isNaN(k)||isNaN(ie))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return k.toFixed(ie).replace(/0+$/,"")};C=f.hpf=f.__private__.hpf=typeof l=="number"?function(k){if(isNaN(k))throw new Error("Invalid argument passed to jsPDF.hpf");return W(k,l)}:l==="smart"?function(k){if(isNaN(k))throw new Error("Invalid argument passed to jsPDF.hpf");return W(k,k>-1&&k<1?16:5)}:function(k){if(isNaN(k))throw new Error("Invalid argument passed to jsPDF.hpf");return W(k,16)};var L=f.f2=f.__private__.f2=function(k){if(isNaN(k))throw new Error("Invalid argument passed to jsPDF.f2");return W(k,2)},I=f.__private__.f3=function(k){if(isNaN(k))throw new Error("Invalid argument passed to jsPDF.f3");return W(k,3)},V=f.scale=f.__private__.scale=function(k){if(isNaN(k))throw new Error("Invalid argument passed to jsPDF.scale");return N===b?k*qe:N===y?k:void 0},Q=function(k){return V(function(D){return N===b?zl()-D:N===y?D:void 0}(k))};f.__private__.setPrecision=f.setPrecision=function(k){typeof parseInt(k,10)=="number"&&(t=parseInt(k,10))};var ue,me="00000000000000000000000000000000",pe=f.__private__.getFileId=function(){return me},oe=f.__private__.setFileId=function(k){return me=k!==void 0&&/^[a-fA-F0-9]{32}$/.test(k)?k.toUpperCase():me.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),u!==null&&(sn=new _0(u.userPermissions,u.userPassword,u.ownerPassword,me)),me};f.setFileId=function(k){return oe(k),this},f.getFileId=function(){return pe()};var G=f.__private__.convertDateToPDFDate=function(k){var D=k.getTimezoneOffset(),ie=D<0?"+":"-",he=Math.floor(Math.abs(D/60)),we=Math.abs(D%60),Oe=[ie,O(he),"'",O(we),"'"].join("");return["D:",k.getFullYear(),O(k.getMonth()+1),O(k.getDate()),O(k.getHours()),O(k.getMinutes()),O(k.getSeconds()),Oe].join("")},ve=f.__private__.convertPDFDateToDate=function(k){var D=parseInt(k.substr(2,4),10),ie=parseInt(k.substr(6,2),10)-1,he=parseInt(k.substr(8,2),10),we=parseInt(k.substr(10,2),10),Oe=parseInt(k.substr(12,2),10),Ue=parseInt(k.substr(14,2),10);return new Date(D,ie,he,we,Oe,Ue,0)},_e=f.__private__.setCreationDate=function(k){var D;if(k===void 0&&(k=new Date),k instanceof Date)D=G(k);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(k))throw new Error("Invalid argument passed to jsPDF.setCreationDate");D=k}return ue=D},E=f.__private__.getCreationDate=function(k){var D=ue;return k==="jsDate"&&(D=ve(ue)),D};f.setCreationDate=function(k){return _e(k),this},f.getCreationDate=function(k){return E(k)};var j,O=f.__private__.padd2=function(k){return("0"+parseInt(k)).slice(-2)},B=f.__private__.padd2Hex=function(k){return("00"+(k=k.toString())).substr(k.length)},Y=0,le=[],fe=[],ce=0,de=[],Ce=[],X=!1,$e=fe;f.__private__.setCustomOutputDestination=function(k){X=!0,$e=k};var be=function(k){X||($e=k)};f.__private__.resetCustomOutputDestination=function(){X=!1,$e=fe};var ee=f.__private__.out=function(k){return k=k.toString(),ce+=k.length+1,$e.push(k),$e},et=f.__private__.write=function(k){return ee(arguments.length===1?k.toString():Array.prototype.join.call(arguments," "))},Re=f.__private__.getArrayBuffer=function(k){for(var D=k.length,ie=new ArrayBuffer(D),he=new Uint8Array(ie);D--;)he[D]=k.charCodeAt(D);return ie},tt=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];f.__private__.getStandardFonts=function(){return tt};var Me=e.fontSize||16;f.__private__.setFontSize=f.setFontSize=function(k){return Me=N===y?k/qe:k,this};var at,Ye=f.__private__.getFontSize=f.getFontSize=function(){return N===b?Me:Me*qe},At=e.R2L||!1;f.__private__.setR2L=f.setR2L=function(k){return At=k,this},f.__private__.getR2L=f.getR2L=function(){return At};var ut,Ot=f.__private__.setZoomMode=function(k){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(k))at=k;else if(isNaN(k)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(k)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+k+'" is not recognized.');at=k}else at=parseInt(k,10)};f.__private__.getZoomMode=function(){return at};var _t,wt=f.__private__.setPageMode=function(k){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(k)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+k+'" is not recognized.');ut=k};f.__private__.getPageMode=function(){return ut};var er=f.__private__.setLayoutMode=function(k){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(k)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+k+'" is not recognized.');_t=k};f.__private__.getLayoutMode=function(){return _t},f.__private__.setDisplayMode=f.setDisplayMode=function(k,D,ie){return Ot(k),er(D),wt(ie),this};var mt={title:"",subject:"",author:"",keywords:"",creator:""};f.__private__.getDocumentProperty=function(k){if(Object.keys(mt).indexOf(k)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return mt[k]},f.__private__.getDocumentProperties=function(){return mt},f.__private__.setDocumentProperties=f.setProperties=f.setDocumentProperties=function(k){for(var D in mt)mt.hasOwnProperty(D)&&k[D]&&(mt[D]=k[D]);return this},f.__private__.setDocumentProperty=function(k,D){if(Object.keys(mt).indexOf(k)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return mt[k]=D};var it,qe,Ze,Ht,kt,st={},Lt={},fr=[],yt={},Gt={},Pt={},Br={},an=null,hr=0,St=[],sr=new xb(f),Us=e.hotfixes||[],Dn={},Wi={},vi=[],bt=function k(D,ie,he,we,Oe,Ue){if(!(this instanceof k))return new k(D,ie,he,we,Oe,Ue);isNaN(D)&&(D=1),isNaN(ie)&&(ie=0),isNaN(he)&&(he=0),isNaN(we)&&(we=1),isNaN(Oe)&&(Oe=0),isNaN(Ue)&&(Ue=0),this._matrix=[D,ie,he,we,Oe,Ue]};Object.defineProperty(bt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(k){this._matrix[0]=k}}),Object.defineProperty(bt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(k){this._matrix[1]=k}}),Object.defineProperty(bt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(k){this._matrix[2]=k}}),Object.defineProperty(bt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(k){this._matrix[3]=k}}),Object.defineProperty(bt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(k){this._matrix[4]=k}}),Object.defineProperty(bt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(k){this._matrix[5]=k}}),Object.defineProperty(bt.prototype,"a",{get:function(){return this._matrix[0]},set:function(k){this._matrix[0]=k}}),Object.defineProperty(bt.prototype,"b",{get:function(){return this._matrix[1]},set:function(k){this._matrix[1]=k}}),Object.defineProperty(bt.prototype,"c",{get:function(){return this._matrix[2]},set:function(k){this._matrix[2]=k}}),Object.defineProperty(bt.prototype,"d",{get:function(){return this._matrix[3]},set:function(k){this._matrix[3]=k}}),Object.defineProperty(bt.prototype,"e",{get:function(){return this._matrix[4]},set:function(k){this._matrix[4]=k}}),Object.defineProperty(bt.prototype,"f",{get:function(){return this._matrix[5]},set:function(k){this._matrix[5]=k}}),Object.defineProperty(bt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(bt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(bt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(bt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),bt.prototype.join=function(k){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(C).join(k)},bt.prototype.multiply=function(k){var D=k.sx*this.sx+k.shy*this.shx,ie=k.sx*this.shy+k.shy*this.sy,he=k.shx*this.sx+k.sy*this.shx,we=k.shx*this.shy+k.sy*this.sy,Oe=k.tx*this.sx+k.ty*this.shx+this.tx,Ue=k.tx*this.shy+k.ty*this.sy+this.ty;return new bt(D,ie,he,we,Oe,Ue)},bt.prototype.decompose=function(){var k=this.sx,D=this.shy,ie=this.shx,he=this.sy,we=this.tx,Oe=this.ty,Ue=Math.sqrt(k*k+D*D),ft=(k/=Ue)*ie+(D/=Ue)*he;ie-=k*ft,he-=D*ft;var pt=Math.sqrt(ie*ie+he*he);return ft/=pt,k*(he/=pt)<D*(ie/=pt)&&(k=-k,D=-D,ft=-ft,Ue=-Ue),{scale:new bt(Ue,0,0,pt,0,0),translate:new bt(1,0,0,1,we,Oe),rotate:new bt(k,D,-D,k,0,0),skew:new bt(1,0,ft,1,0,0)}},bt.prototype.toString=function(k){return this.join(" ")},bt.prototype.inversed=function(){var k=this.sx,D=this.shy,ie=this.shx,he=this.sy,we=this.tx,Oe=this.ty,Ue=1/(k*he-D*ie),ft=he*Ue,pt=-D*Ue,It=-ie*Ue,Rt=k*Ue;return new bt(ft,pt,It,Rt,-ft*we-It*Oe,-pt*we-Rt*Oe)},bt.prototype.applyToPoint=function(k){var D=k.x*this.sx+k.y*this.shx+this.tx,ie=k.x*this.shy+k.y*this.sy+this.ty;return new Bl(D,ie)},bt.prototype.applyToRectangle=function(k){var D=this.applyToPoint(k),ie=this.applyToPoint(new Bl(k.x+k.w,k.y+k.h));return new Lu(D.x,D.y,ie.x-D.x,ie.y-D.y)},bt.prototype.clone=function(){var k=this.sx,D=this.shy,ie=this.shx,he=this.sy,we=this.tx,Oe=this.ty;return new bt(k,D,ie,he,we,Oe)},f.Matrix=bt;var Hi=f.matrixMult=function(k,D){return D.multiply(k)},Vi=new bt(1,0,0,1,0,0);f.unitMatrix=f.identityMatrix=Vi;var ra=function(k,D){if(!Gt[k]){var ie=(D instanceof oc?"Sh":"P")+(Object.keys(yt).length+1).toString(10);D.id=ie,Gt[k]=ie,yt[ie]=D,sr.publish("addPattern",D)}};f.ShadingPattern=oc,f.TilingPattern=O0,f.addShadingPattern=function(k,D){return A("addShadingPattern()"),ra(k,D),this},f.beginTilingPattern=function(k){A("beginTilingPattern()"),Pu(k.boundingBox[0],k.boundingBox[1],k.boundingBox[2]-k.boundingBox[0],k.boundingBox[3]-k.boundingBox[1],k.matrix)},f.endTilingPattern=function(k,D){A("endTilingPattern()"),D.stream=Ce[j].join(`
`),ra(k,D),sr.publish("endTilingPattern",D),vi.pop().restore()};var Oa,Ur=f.__private__.newObject=function(){var k=vn();return U(k,!0),k},vn=f.__private__.newObjectDeferred=function(){return Y++,le[Y]=function(){return ce},Y},U=function(k,D){return D=typeof D=="boolean"&&D,le[k]=ce,D&&ee(k+" 0 obj"),k},ne=f.__private__.newAdditionalObject=function(){var k={objId:vn(),content:""};return de.push(k),k},K=vn(),Z=vn(),ae=f.__private__.decodeColorString=function(k){var D=k.split(" ");if(D.length!==2||D[1]!=="g"&&D[1]!=="G")D.length!==5||D[4]!=="k"&&D[4]!=="K"||(D=[(1-D[0])*(1-D[3]),(1-D[1])*(1-D[3]),(1-D[2])*(1-D[3]),"r"]);else{var ie=parseFloat(D[0]);D=[ie,ie,ie,"r"]}for(var he="#",we=0;we<3;we++)he+=("0"+Math.floor(255*parseFloat(D[we])).toString(16)).slice(-2);return he},se=f.__private__.encodeColorString=function(k){var D;typeof k=="string"&&(k={ch1:k});var ie=k.ch1,he=k.ch2,we=k.ch3,Oe=k.ch4,Ue=k.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof ie=="string"&&ie.charAt(0)!=="#"){var ft=new jE(ie);if(ft.ok)ie=ft.toHex();else if(!/^\d*\.?\d*$/.test(ie))throw new Error('Invalid color "'+ie+'" passed to jsPDF.encodeColorString.')}if(typeof ie=="string"&&/^#[0-9A-Fa-f]{3}$/.test(ie)&&(ie="#"+ie[1]+ie[1]+ie[2]+ie[2]+ie[3]+ie[3]),typeof ie=="string"&&/^#[0-9A-Fa-f]{6}$/.test(ie)){var pt=parseInt(ie.substr(1),16);ie=pt>>16&255,he=pt>>8&255,we=255&pt}if(he===void 0||Oe===void 0&&ie===he&&he===we)D=typeof ie=="string"?ie+" "+Ue[0]:k.precision===2?L(ie/255)+" "+Ue[0]:I(ie/255)+" "+Ue[0];else if(Oe===void 0||vr(Oe)==="object"){if(Oe&&!isNaN(Oe.a)&&Oe.a===0)return["1.","1.","1.",Ue[1]].join(" ");D=typeof ie=="string"?[ie,he,we,Ue[1]].join(" "):k.precision===2?[L(ie/255),L(he/255),L(we/255),Ue[1]].join(" "):[I(ie/255),I(he/255),I(we/255),Ue[1]].join(" ")}else D=typeof ie=="string"?[ie,he,we,Oe,Ue[2]].join(" "):k.precision===2?[L(ie),L(he),L(we),L(Oe),Ue[2]].join(" "):[I(ie),I(he),I(we),I(Oe),Ue[2]].join(" ");return D},ke=f.__private__.getFilters=function(){return s},Fe=f.__private__.putStream=function(k){var D=(k=k||{}).data||"",ie=k.filters||ke(),he=k.alreadyAppliedFilters||[],we=k.addLength1||!1,Oe=D.length,Ue=k.objectId,ft=function(En){return En};if(u!==null&&Ue===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");u!==null&&(ft=sn.encryptor(Ue,0));var pt={};ie===!0&&(ie=["FlateEncode"]);var It=k.additionalKeyValues||[],Rt=(pt=xt.API.processDataByFilters!==void 0?xt.API.processDataByFilters(D,ie):{data:D,reverseChain:[]}).reverseChain+(Array.isArray(he)?he.join(" "):he.toString());if(pt.data.length!==0&&(It.push({key:"Length",value:pt.data.length}),we===!0&&It.push({key:"Length1",value:Oe})),Rt.length!=0)if(Rt.split("/").length-1==1)It.push({key:"Filter",value:Rt});else{It.push({key:"Filter",value:"["+Rt+"]"});for(var lr=0;lr<It.length;lr+=1)if(It[lr].key==="DecodeParms"){for(var Wr=[],wn=0;wn<pt.reverseChain.split("/").length-1;wn+=1)Wr.push("null");Wr.push(It[lr].value),It[lr].value="["+Wr.join(" ")+"]"}}ee("<<");for(var Ar=0;Ar<It.length;Ar++)ee("/"+It[Ar].key+" "+It[Ar].value);ee(">>"),pt.data.length!==0&&(ee("stream"),ee(ft(pt.data)),ee("endstream"))},Se=f.__private__.putPage=function(k){var D=k.number,ie=k.data,he=k.objId,we=k.contentsObjId;U(he,!0),ee("<</Type /Page"),ee("/Parent "+k.rootDictionaryObjId+" 0 R"),ee("/Resources "+k.resourceDictionaryObjId+" 0 R"),ee("/MediaBox ["+parseFloat(C(k.mediaBox.bottomLeftX))+" "+parseFloat(C(k.mediaBox.bottomLeftY))+" "+C(k.mediaBox.topRightX)+" "+C(k.mediaBox.topRightY)+"]"),k.cropBox!==null&&ee("/CropBox ["+C(k.cropBox.bottomLeftX)+" "+C(k.cropBox.bottomLeftY)+" "+C(k.cropBox.topRightX)+" "+C(k.cropBox.topRightY)+"]"),k.bleedBox!==null&&ee("/BleedBox ["+C(k.bleedBox.bottomLeftX)+" "+C(k.bleedBox.bottomLeftY)+" "+C(k.bleedBox.topRightX)+" "+C(k.bleedBox.topRightY)+"]"),k.trimBox!==null&&ee("/TrimBox ["+C(k.trimBox.bottomLeftX)+" "+C(k.trimBox.bottomLeftY)+" "+C(k.trimBox.topRightX)+" "+C(k.trimBox.topRightY)+"]"),k.artBox!==null&&ee("/ArtBox ["+C(k.artBox.bottomLeftX)+" "+C(k.artBox.bottomLeftY)+" "+C(k.artBox.topRightX)+" "+C(k.artBox.topRightY)+"]"),typeof k.userUnit=="number"&&k.userUnit!==1&&ee("/UserUnit "+k.userUnit),sr.publish("putPage",{objId:he,pageContext:St[D],pageNumber:D,page:ie}),ee("/Contents "+we+" 0 R"),ee(">>"),ee("endobj");var Oe=ie.join(`
`);return N===y&&(Oe+=`
Q`),U(we,!0),Fe({data:Oe,filters:ke(),objectId:we}),ee("endobj"),he},Ne=f.__private__.putPages=function(){var k,D,ie=[];for(k=1;k<=hr;k++)St[k].objId=vn(),St[k].contentsObjId=vn();for(k=1;k<=hr;k++)ie.push(Se({number:k,data:Ce[k],objId:St[k].objId,contentsObjId:St[k].contentsObjId,mediaBox:St[k].mediaBox,cropBox:St[k].cropBox,bleedBox:St[k].bleedBox,trimBox:St[k].trimBox,artBox:St[k].artBox,userUnit:St[k].userUnit,rootDictionaryObjId:K,resourceDictionaryObjId:Z}));U(K,!0),ee("<</Type /Pages");var he="/Kids [";for(D=0;D<hr;D++)he+=ie[D]+" 0 R ";ee(he+"]"),ee("/Count "+hr),ee(">>"),ee("endobj"),sr.publish("postPutPages")},Te=function(k){sr.publish("putFont",{font:k,out:ee,newObject:Ur,putStream:Fe}),k.isAlreadyPutted!==!0&&(k.objectNumber=Ur(),ee("<<"),ee("/Type /Font"),ee("/BaseFont /"+w0(k.postScriptName)),ee("/Subtype /Type1"),typeof k.encoding=="string"&&ee("/Encoding /"+k.encoding),ee("/FirstChar 32"),ee("/LastChar 255"),ee(">>"),ee("endobj"))},ze=function(k){k.objectNumber=Ur();var D=[];D.push({key:"Type",value:"/XObject"}),D.push({key:"Subtype",value:"/Form"}),D.push({key:"BBox",value:"["+[C(k.x),C(k.y),C(k.x+k.width),C(k.y+k.height)].join(" ")+"]"}),D.push({key:"Matrix",value:"["+k.matrix.toString()+"]"});var ie=k.pages[1].join(`
`);Fe({data:ie,additionalKeyValues:D,objectId:k.objectNumber}),ee("endobj")},Ge=function(k,D){D||(D=21);var ie=Ur(),he=function(Ue,ft){var pt,It=[],Rt=1/(ft-1);for(pt=0;pt<1;pt+=Rt)It.push(pt);if(It.push(1),Ue[0].offset!=0){var lr={offset:0,color:Ue[0].color};Ue.unshift(lr)}if(Ue[Ue.length-1].offset!=1){var Wr={offset:1,color:Ue[Ue.length-1].color};Ue.push(Wr)}for(var wn="",Ar=0,En=0;En<It.length;En++){for(pt=It[En];pt>Ue[Ar+1].offset;)Ar++;var yn=Ue[Ar].offset,Vn=(pt-yn)/(Ue[Ar+1].offset-yn),wi=Ue[Ar].color,ja=Ue[Ar+1].color;wn+=B(Math.round((1-Vn)*wi[0]+Vn*ja[0]).toString(16))+B(Math.round((1-Vn)*wi[1]+Vn*ja[1]).toString(16))+B(Math.round((1-Vn)*wi[2]+Vn*ja[2]).toString(16))}return wn.trim()}(k.colors,D),we=[];we.push({key:"FunctionType",value:"0"}),we.push({key:"Domain",value:"[0.0 1.0]"}),we.push({key:"Size",value:"["+D+"]"}),we.push({key:"BitsPerSample",value:"8"}),we.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),we.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Fe({data:he,additionalKeyValues:we,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:ie}),ee("endobj"),k.objectNumber=Ur(),ee("<< /ShadingType "+k.type),ee("/ColorSpace /DeviceRGB");var Oe="/Coords ["+C(parseFloat(k.coords[0]))+" "+C(parseFloat(k.coords[1]))+" ";k.type===2?Oe+=C(parseFloat(k.coords[2]))+" "+C(parseFloat(k.coords[3])):Oe+=C(parseFloat(k.coords[2]))+" "+C(parseFloat(k.coords[3]))+" "+C(parseFloat(k.coords[4]))+" "+C(parseFloat(k.coords[5])),ee(Oe+="]"),k.matrix&&ee("/Matrix ["+k.matrix.toString()+"]"),ee("/Function "+ie+" 0 R"),ee("/Extend [true true]"),ee(">>"),ee("endobj")},rt=function(k,D){var ie=vn(),he=Ur();D.push({resourcesOid:ie,objectOid:he}),k.objectNumber=he;var we=[];we.push({key:"Type",value:"/Pattern"}),we.push({key:"PatternType",value:"1"}),we.push({key:"PaintType",value:"1"}),we.push({key:"TilingType",value:"1"}),we.push({key:"BBox",value:"["+k.boundingBox.map(C).join(" ")+"]"}),we.push({key:"XStep",value:C(k.xStep)}),we.push({key:"YStep",value:C(k.yStep)}),we.push({key:"Resources",value:ie+" 0 R"}),k.matrix&&we.push({key:"Matrix",value:"["+k.matrix.toString()+"]"}),Fe({data:k.stream,additionalKeyValues:we,objectId:k.objectNumber}),ee("endobj")},Ve=function(k){for(var D in k.objectNumber=Ur(),ee("<<"),k)switch(D){case"opacity":ee("/ca "+L(k[D]));break;case"stroke-opacity":ee("/CA "+L(k[D]))}ee(">>"),ee("endobj")},Qe=function(k){U(k.resourcesOid,!0),ee("<<"),ee("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),function(){for(var D in ee("/Font <<"),st)st.hasOwnProperty(D)&&(h===!1||h===!0&&m.hasOwnProperty(D))&&ee("/"+D+" "+st[D].objectNumber+" 0 R");ee(">>")}(),function(){if(Object.keys(yt).length>0){for(var D in ee("/Shading <<"),yt)yt.hasOwnProperty(D)&&yt[D]instanceof oc&&yt[D].objectNumber>=0&&ee("/"+D+" "+yt[D].objectNumber+" 0 R");sr.publish("putShadingPatternDict"),ee(">>")}}(),function(D){if(Object.keys(yt).length>0){for(var ie in ee("/Pattern <<"),yt)yt.hasOwnProperty(ie)&&yt[ie]instanceof f.TilingPattern&&yt[ie].objectNumber>=0&&yt[ie].objectNumber<D&&ee("/"+ie+" "+yt[ie].objectNumber+" 0 R");sr.publish("putTilingPatternDict"),ee(">>")}}(k.objectOid),function(){if(Object.keys(Pt).length>0){var D;for(D in ee("/ExtGState <<"),Pt)Pt.hasOwnProperty(D)&&Pt[D].objectNumber>=0&&ee("/"+D+" "+Pt[D].objectNumber+" 0 R");sr.publish("putGStateDict"),ee(">>")}}(),function(){for(var D in ee("/XObject <<"),Dn)Dn.hasOwnProperty(D)&&Dn[D].objectNumber>=0&&ee("/"+D+" "+Dn[D].objectNumber+" 0 R");sr.publish("putXobjectDict"),ee(">>")}(),ee(">>"),ee("endobj")},Tt=function(k){Lt[k.fontName]=Lt[k.fontName]||{},Lt[k.fontName][k.fontStyle]=k.id},yr=function(k,D,ie,he,we){var Oe={id:"F"+(Object.keys(st).length+1).toString(10),postScriptName:k,fontName:D,fontStyle:ie,encoding:he,isStandardFont:we||!1,metadata:{}};return sr.publish("addFont",{font:Oe,instance:this}),st[Oe.id]=Oe,Tt(Oe),Oe.id},Jt=f.__private__.pdfEscape=f.pdfEscape=function(k,D){return function(ie,he){var we,Oe,Ue,ft,pt,It,Rt,lr,Wr;if(Ue=(he=he||{}).sourceEncoding||"Unicode",pt=he.outputEncoding,(he.autoencode||pt)&&st[it].metadata&&st[it].metadata[Ue]&&st[it].metadata[Ue].encoding&&(ft=st[it].metadata[Ue].encoding,!pt&&st[it].encoding&&(pt=st[it].encoding),!pt&&ft.codePages&&(pt=ft.codePages[0]),typeof pt=="string"&&(pt=ft[pt]),pt)){for(Rt=!1,It=[],we=0,Oe=ie.length;we<Oe;we++)(lr=pt[ie.charCodeAt(we)])?It.push(String.fromCharCode(lr)):It.push(ie[we]),It[we].charCodeAt(0)>>8&&(Rt=!0);ie=It.join("")}for(we=ie.length;Rt===void 0&&we!==0;)ie.charCodeAt(we-1)>>8&&(Rt=!0),we--;if(!Rt)return ie;for(It=he.noBOM?[]:[254,255],we=0,Oe=ie.length;we<Oe;we++){if((Wr=(lr=ie.charCodeAt(we))>>8)>>8)throw new Error("Character at position "+we+" of string '"+ie+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");It.push(Wr),It.push(lr-(Wr<<8))}return String.fromCharCode.apply(void 0,It)}(k,D).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Kr=f.__private__.beginPage=function(k){Ce[++hr]=[],St[hr]={objId:0,contentsObjId:0,userUnit:Number(o),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(k[0]),topRightY:Number(k[1])}},gs(hr),be(Ce[j])},ms=function(k,D){var ie,he,we;switch(r=D||r,typeof k=="string"&&(ie=_(k.toLowerCase()),Array.isArray(ie)&&(he=ie[0],we=ie[1])),Array.isArray(k)&&(he=k[0]*qe,we=k[1]*qe),isNaN(he)&&(he=a[0],we=a[1]),(he>14400||we>14400)&&(Nr.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),he=Math.min(14400,he),we=Math.min(14400,we)),a=[he,we],r.substr(0,1)){case"l":we>he&&(a=[we,he]);break;case"p":he>we&&(a=[we,he])}Kr(a),hm(Au),ee(Xc),Cu!==0&&ee(Cu+" J"),Fu!==0&&ee(Fu+" j"),sr.publish("addPage",{pageNumber:hr})},qi=function(k){k>0&&k<=hr&&(Ce.splice(k,1),St.splice(k,1),hr--,j>hr&&(j=hr),this.setPage(j))},gs=function(k){k>0&&k<=hr&&(j=k)},_i=f.__private__.getNumberOfPages=f.getNumberOfPages=function(){return Ce.length-1},No=function(k,D,ie){var he,we=void 0;return ie=ie||{},k=k!==void 0?k:st[it].fontName,D=D!==void 0?D:st[it].fontStyle,he=k.toLowerCase(),Lt[he]!==void 0&&Lt[he][D]!==void 0?we=Lt[he][D]:Lt[k]!==void 0&&Lt[k][D]!==void 0?we=Lt[k][D]:ie.disableWarning===!1&&Nr.warn("Unable to look up font label for font '"+k+"', '"+D+"'. Refer to getFontList() for available fonts."),we||ie.noFallback||(we=Lt.times[D])==null&&(we=Lt.times.normal),we},na=f.__private__.putInfo=function(){var k=Ur(),D=function(he){return he};for(var ie in u!==null&&(D=sn.encryptor(k,0)),ee("<<"),ee("/Producer ("+Jt(D("jsPDF "+xt.version))+")"),mt)mt.hasOwnProperty(ie)&&mt[ie]&&ee("/"+ie.substr(0,1).toUpperCase()+ie.substr(1)+" ("+Jt(D(mt[ie]))+")");ee("/CreationDate ("+Jt(D(ue))+")"),ee(">>"),ee("endobj")},am=f.__private__.putCatalog=function(k){var D=(k=k||{}).rootDictionaryObjId||K;switch(Ur(),ee("<<"),ee("/Type /Catalog"),ee("/Pages "+D+" 0 R"),at||(at="fullwidth"),at){case"fullwidth":ee("/OpenAction [3 0 R /FitH null]");break;case"fullheight":ee("/OpenAction [3 0 R /FitV null]");break;case"fullpage":ee("/OpenAction [3 0 R /Fit]");break;case"original":ee("/OpenAction [3 0 R /XYZ null null 1]");break;default:var ie=""+at;ie.substr(ie.length-1)==="%"&&(at=parseInt(at)/100),typeof at=="number"&&ee("/OpenAction [3 0 R /XYZ null null "+L(at)+"]")}switch(_t||(_t="continuous"),_t){case"continuous":ee("/PageLayout /OneColumn");break;case"single":ee("/PageLayout /SinglePage");break;case"two":case"twoleft":ee("/PageLayout /TwoColumnLeft");break;case"tworight":ee("/PageLayout /TwoColumnRight")}ut&&ee("/PageMode /"+ut),sr.publish("putCatalog"),ee(">>"),ee("endobj")},_n=f.__private__.putTrailer=function(){ee("trailer"),ee("<<"),ee("/Size "+(Y+1)),ee("/Root "+Y+" 0 R"),ee("/Info "+(Y-1)+" 0 R"),u!==null&&ee("/Encrypt "+sn.oid+" 0 R"),ee("/ID [ <"+me+"> <"+me+"> ]"),ee(">>")},Xh=f.__private__.putHeader=function(){ee("%PDF-"+v),ee("%ºß¬à")},Kh=f.__private__.putXRef=function(){var k="0000000000";ee("xref"),ee("0 "+(Y+1)),ee("0000000000 65535 f ");for(var D=1;D<=Y;D++)typeof le[D]=="function"?ee((k+le[D]()).slice(-10)+" 00000 n "):le[D]!==void 0?ee((k+le[D]).slice(-10)+" 00000 n "):ee("0000000000 00000 n ")},zs=f.__private__.buildDocument=function(){var k;Y=0,ce=0,fe=[],le=[],de=[],K=vn(),Z=vn(),be(fe),sr.publish("buildDocument"),Xh(),Ne(),function(){sr.publish("putAdditionalObjects");for(var ie=0;ie<de.length;ie++){var he=de[ie];U(he.objId,!0),ee(he.content),ee("endobj")}sr.publish("postPutAdditionalObjects")}(),k=[],function(){for(var ie in st)st.hasOwnProperty(ie)&&(h===!1||h===!0&&m.hasOwnProperty(ie))&&Te(st[ie])}(),function(){var ie;for(ie in Pt)Pt.hasOwnProperty(ie)&&Ve(Pt[ie])}(),function(){for(var ie in Dn)Dn.hasOwnProperty(ie)&&ze(Dn[ie])}(),function(ie){var he;for(he in yt)yt.hasOwnProperty(he)&&(yt[he]instanceof oc?Ge(yt[he]):yt[he]instanceof O0&&rt(yt[he],ie))}(k),sr.publish("putResources"),k.forEach(Qe),Qe({resourcesOid:Z,objectOid:Number.MAX_SAFE_INTEGER}),sr.publish("postPutResources"),u!==null&&(sn.oid=Ur(),ee("<<"),ee("/Filter /Standard"),ee("/V "+sn.v),ee("/R "+sn.r),ee("/U <"+sn.toHexString(sn.U)+">"),ee("/O <"+sn.toHexString(sn.O)+">"),ee("/P "+sn.P),ee(">>"),ee("endobj")),na(),am();var D=ce;return Kh(),_n(),ee("startxref"),ee(""+D),ee("%%EOF"),be(Ce[j]),fe.join(`
`)},Il=f.__private__.getBlob=function(k){return new Blob([Re(k)],{type:"application/pdf"})},Gi=f.output=f.__private__.output=(Oa=function(k,D){switch(typeof(D=D||{})=="string"?D={filename:D}:D.filename=D.filename||"generated.pdf",k){case void 0:return zs();case"save":f.save(D.filename);break;case"arraybuffer":return Re(zs());case"blob":return Il(zs());case"bloburi":case"bloburl":if(Ft.URL!==void 0&&typeof Ft.URL.createObjectURL=="function")return Ft.URL&&Ft.URL.createObjectURL(Il(zs()))||void 0;Nr.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var ie="",he=zs();try{ie=pb(he)}catch{ie=pb(unescape(encodeURIComponent(he)))}return"data:application/pdf;filename="+D.filename+";base64,"+ie;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Ft)==="[object Window]"){var we="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Oe=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';D.pdfObjectUrl&&(we=D.pdfObjectUrl,Oe="");var Ue='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+we+'"'+Oe+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(D)+");<\/script></body></html>",ft=Ft.open();return ft!==null&&ft.document.write(Ue),ft}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Ft)==="[object Window]"){var pt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(D.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+D.filename+'" width="500px" height="400px" /></body></html>',It=Ft.open();if(It!==null){It.document.write(pt);var Rt=this;It.document.documentElement.querySelector("#pdfViewer").onload=function(){It.document.title=D.filename,It.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Rt.output("bloburl"))}}return It}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Ft)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var lr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",D)+'"></iframe></body></html>',Wr=Ft.open();if(Wr!==null&&(Wr.document.write(lr),Wr.document.title=D.filename),Wr||typeof safari>"u")return Wr;break;case"datauri":case"dataurl":return Ft.document.location.href=this.output("datauristring",D);default:return null}},Oa.foo=function(){try{return Oa.apply(this,arguments)}catch(ie){var k=ie.stack||"";~k.indexOf(" at ")&&(k=k.split(" at ")[1]);var D="Error in function "+k.split(`
`)[0].split("<")[0]+": "+ie.message;if(!Ft.console)throw new Error(D);Ft.console.error(D,ie),Ft.alert&&alert(D)}},Oa.foo.bar=Oa,Oa.foo),Ol=function(k){return Array.isArray(Us)===!0&&Us.indexOf(k)>-1};switch(n){case"pt":qe=1;break;case"mm":qe=72/25.4;break;case"cm":qe=72/2.54;break;case"in":qe=72;break;case"px":qe=Ol("px_scaling")==1?.75:96/72;break;case"pc":case"em":qe=12;break;case"ex":qe=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);qe=n}var sn=null;_e(),oe();var Su=f.__private__.getPageInfo=f.getPageInfo=function(k){if(isNaN(k)||k%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:St[k].objId,pageNumber:k,pageContext:St[k]}},im=f.__private__.getPageInfoByObjId=function(k){if(isNaN(k)||k%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var D in St)if(St[D].objId===k)break;return Su(D)},sm=f.__private__.getCurrentPageInfo=f.getCurrentPageInfo=function(){return{objId:St[j].objId,pageNumber:j,pageContext:St[j]}};f.addPage=function(){return ms.apply(this,arguments),this},f.setPage=function(){return gs.apply(this,arguments),be.call(this,Ce[j]),this},f.insertPage=function(k){return this.addPage(),this.movePage(j,k),this},f.movePage=function(k,D){var ie,he;if(k>D){ie=Ce[k],he=St[k];for(var we=k;we>D;we--)Ce[we]=Ce[we-1],St[we]=St[we-1];Ce[D]=ie,St[D]=he,this.setPage(D)}else if(k<D){ie=Ce[k],he=St[k];for(var Oe=k;Oe<D;Oe++)Ce[Oe]=Ce[Oe+1],St[Oe]=St[Oe+1];Ce[D]=ie,St[D]=he,this.setPage(D)}return this},f.deletePage=function(){return qi.apply(this,arguments),this},f.__private__.text=f.text=function(k,D,ie,he,we){var Oe,Ue,ft,pt,It,Rt,lr,Wr,wn,Ar=(he=he||{}).scope||this;if(typeof k=="number"&&typeof D=="number"&&(typeof ie=="string"||Array.isArray(ie))){var En=ie;ie=D,D=k,k=En}if(arguments[3]instanceof bt==0?(ft=arguments[4],pt=arguments[5],vr(lr=arguments[3])==="object"&&lr!==null||(typeof ft=="string"&&(pt=ft,ft=null),typeof lr=="string"&&(pt=lr,lr=null),typeof lr=="number"&&(ft=lr,lr=null),he={flags:lr,angle:ft,align:pt})):(A("The transform parameter of text() with a Matrix value"),wn=we),isNaN(D)||isNaN(ie)||k==null)throw new Error("Invalid arguments passed to jsPDF.text");if(k.length===0)return Ar;var yn,Vn="",wi=typeof he.lineHeightFactor=="number"?he.lineHeightFactor:Rl,ja=Ar.internal.scaleFactor;function nd(ur){return ur=ur.split("	").join(Array(he.TabLen||9).join(" ")),Jt(ur,lr)}function Zc(ur){for(var kr,ln=ur.concat(),An=[],Xs=ln.length;Xs--;)typeof(kr=ln.shift())=="string"?An.push(kr):Array.isArray(ur)&&(kr.length===1||kr[1]===void 0&&kr[2]===void 0)?An.push(kr[0]):An.push([kr[0],kr[1],kr[2]]);return An}function $l(ur,kr){var ln;if(typeof ur=="string")ln=kr(ur)[0];else if(Array.isArray(ur)){for(var An,Xs,$u=ur.concat(),t0=[],sd=$u.length;sd--;)typeof(An=$u.shift())=="string"?t0.push(kr(An)[0]):Array.isArray(An)&&typeof An[0]=="string"&&(Xs=kr(An[0],An[1],An[2]),t0.push([Xs[0],Xs[1],Xs[2]]));ln=t0}return ln}var To=!1,Wl=!0;if(typeof k=="string")To=!0;else if(Array.isArray(k)){var Hl=k.concat();Ue=[];for(var Vl,aa=Hl.length;aa--;)(typeof(Vl=Hl.shift())!="string"||Array.isArray(Vl)&&typeof Vl[0]!="string")&&(Wl=!1);To=Wl}if(To===!1)throw new Error('Type of text must be string or Array. "'+k+'" is not recognized.');typeof k=="string"&&(k=k.match(/[\r?\n]/)?k.split(/\r\n|\r|\n/g):[k]);var ql=Me/Ar.internal.scaleFactor,Gl=ql*(wi-1);switch(he.baseline){case"bottom":ie-=Gl;break;case"top":ie+=ql-Gl;break;case"hanging":ie+=ql-2*Gl;break;case"middle":ie+=ql/2-Gl}if((Rt=he.maxWidth||0)>0&&(typeof k=="string"?k=Ar.splitTextToSize(k,Rt):Object.prototype.toString.call(k)==="[object Array]"&&(k=k.reduce(function(ur,kr){return ur.concat(Ar.splitTextToSize(kr,Rt))},[]))),Oe={text:k,x:D,y:ie,options:he,mutex:{pdfEscape:Jt,activeFontKey:it,fonts:st,activeFontSize:Me}},sr.publish("preProcessText",Oe),k=Oe.text,ft=(he=Oe.options).angle,wn instanceof bt==0&&ft&&typeof ft=="number"){ft*=Math.PI/180,he.rotationDirection===0&&(ft=-ft),N===y&&(ft=-ft);var Iu=Math.cos(ft),Ou=Math.sin(ft);wn=new bt(Iu,Ou,-Ou,Iu,0,0)}else ft&&ft instanceof bt&&(wn=ft);N!==y||wn||(wn=Vi),(It=he.charSpace||Yc)!==void 0&&(Vn+=C(V(It))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(Wr=he.horizontalScale)!==void 0&&(Vn+=C(100*Wr)+` Tz
`),he.lang;var Yr=-1,qs=he.renderingMode!==void 0?he.renderingMode:he.stroke,Qc=Ar.internal.getCurrentPageInfo().pageContext;switch(qs){case 0:case!1:case"fill":Yr=0;break;case 1:case!0:case"stroke":Yr=1;break;case 2:case"fillThenStroke":Yr=2;break;case 3:case"invisible":Yr=3;break;case 4:case"fillAndAddForClipping":Yr=4;break;case 5:case"strokeAndAddPathForClipping":Yr=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Yr=6;break;case 7:case"addToPathForClipping":Yr=7}var ad=Qc.usedRenderingMode!==void 0?Qc.usedRenderingMode:-1;Yr!==-1?Vn+=Yr+` Tr
`:ad!==-1&&(Vn+=`0 Tr
`),Yr!==-1&&(Qc.usedRenderingMode=Yr),pt=he.align||"left";var yi,Xl=Me*wi,ju=Ar.internal.pageSize.getWidth(),Ru=st[it];It=he.charSpace||Yc,Rt=he.maxWidth||0,lr=Object.assign({autoencode:!0,noBOM:!0},he.flags);var Co=[],Kl=function(ur){return Ar.getStringUnitWidth(ur,{font:Ru,charSpace:It,fontSize:Me,doKerning:!1})*Me/ja};if(Object.prototype.toString.call(k)==="[object Array]"){var Ka;Ue=Zc(k),pt!=="left"&&(yi=Ue.map(Kl));var Ya,Fo=0;if(pt==="right"){D-=yi[0],k=[],aa=Ue.length;for(var Gs=0;Gs<aa;Gs++)Gs===0?(Ya=$s(D),Ka=Ws(ie)):(Ya=V(Fo-yi[Gs]),Ka=-Xl),k.push([Ue[Gs],Ya,Ka]),Fo=yi[Gs]}else if(pt==="center"){D-=yi[0]/2,k=[],aa=Ue.length;for(var Lo=0;Lo<aa;Lo++)Lo===0?(Ya=$s(D),Ka=Ws(ie)):(Ya=V((Fo-yi[Lo])/2),Ka=-Xl),k.push([Ue[Lo],Ya,Ka]),Fo=yi[Lo]}else if(pt==="left"){k=[],aa=Ue.length;for(var Du=0;Du<aa;Du++)k.push(Ue[Du])}else if(pt==="justify"&&Ru.encoding==="Identity-H"){k=[],aa=Ue.length,Rt=Rt!==0?Rt:ju;for(var e0=0,on=0;on<aa;on++)if(Ka=on===0?Ws(ie):-Xl,Ya=on===0?$s(D):e0,on<aa-1){var id=V((Rt-yi[on])/(Ue[on].split(" ").length-1)),vs=Ue[on].split(" ");k.push([vs[0]+" ",Ya,Ka]),e0=0;for(var _s=1;_s<vs.length;_s++){var Mu=(Kl(vs[_s-1]+" "+vs[_s])-Kl(vs[_s]))*ja+id;_s==vs.length-1?k.push([vs[_s],Mu,0]):k.push([vs[_s]+" ",Mu,0]),e0-=Mu}}else k.push([Ue[on],Ya,Ka]);k.push(["",e0,0])}else{if(pt!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(k=[],aa=Ue.length,Rt=Rt!==0?Rt:ju,on=0;on<aa;on++){Ka=on===0?Ws(ie):-Xl,Ya=on===0?$s(D):0;var Bu=Ue[on].split(" ").length-1,Uu=Bu>0?(Rt-yi[on])/Bu:0;on<aa-1?Co.push(C(V(Uu))):Co.push(0),k.push([Ue[on],Ya,Ka])}}}(typeof he.R2L=="boolean"?he.R2L:At)===!0&&(k=$l(k,function(ur,kr,ln){return[ur.split("").reverse().join(""),kr,ln]})),Oe={text:k,x:D,y:ie,options:he,mutex:{pdfEscape:Jt,activeFontKey:it,fonts:st,activeFontSize:Me}},sr.publish("postProcessText",Oe),k=Oe.text,yn=Oe.mutex.isHex||!1;var zu=st[it].encoding;zu!=="WinAnsiEncoding"&&zu!=="StandardEncoding"||(k=$l(k,function(ur,kr,ln){return[nd(ur),kr,ln]})),Ue=Zc(k),k=[];for(var Po,Io,Oo,Yl=Array.isArray(Ue[0])?1:0,jo="",Jl=function(ur,kr,ln){var An="";return ln instanceof bt?(ln=typeof he.angle=="number"?Hi(ln,new bt(1,0,0,1,ur,kr)):Hi(new bt(1,0,0,1,ur,kr),ln),N===y&&(ln=Hi(new bt(1,0,0,-1,0,0),ln)),An=ln.join(" ")+` Tm
`):An=C(ur)+" "+C(kr)+` Td
`,An},bi=0;bi<Ue.length;bi++){switch(jo="",Yl){case 1:Oo=(yn?"<":"(")+Ue[bi][0]+(yn?">":")"),Po=parseFloat(Ue[bi][1]),Io=parseFloat(Ue[bi][2]);break;case 0:Oo=(yn?"<":"(")+Ue[bi]+(yn?">":")"),Po=$s(D),Io=Ws(ie)}Co!==void 0&&Co[bi]!==void 0&&(jo=Co[bi]+` Tw
`),bi===0?k.push(jo+Jl(Po,Io,wn)+Oo):Yl===0?k.push(jo+Oo):Yl===1&&k.push(jo+Jl(Po,Io,wn)+Oo)}k=Yl===0?k.join(` Tj
T* `):k.join(` Tj
`),k+=` Tj
`;var ws=`BT
/`;return ws+=it+" "+Me+` Tf
`,ws+=C(Me*wi)+` TL
`,ws+=Dl+`
`,ws+=Vn,ws+=k,ee(ws+="ET"),m[it]=!0,Ar};var om=f.__private__.clip=f.clip=function(k){return ee(k==="evenodd"?"W*":"W"),this};f.clipEvenOdd=function(){return om("evenodd")},f.__private__.discardPath=f.discardPath=function(){return ee("n"),this};var xs=f.__private__.isValidStyle=function(k){var D=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(k)!==-1&&(D=!0),D};f.__private__.setDefaultPathOperation=f.setDefaultPathOperation=function(k){return xs(k)&&(c=k),this};var Yh=f.__private__.getStyle=f.getStyle=function(k){var D=c;switch(k){case"D":case"S":D="S";break;case"F":D="f";break;case"FD":case"DF":D="B";break;case"f":case"f*":case"B":case"B*":D=k}return D},Jh=f.close=function(){return ee("h"),this};f.stroke=function(){return ee("S"),this},f.fill=function(k){return Eo("f",k),this},f.fillEvenOdd=function(k){return Eo("f*",k),this},f.fillStroke=function(k){return Eo("B",k),this},f.fillStrokeEvenOdd=function(k){return Eo("B*",k),this};var Eo=function(k,D){vr(D)==="object"?cm(D,k):ee(k)},Nu=function(k){k===null||N===y&&k===void 0||(k=Yh(k),ee(k))};function lm(k,D,ie,he,we){var Oe=new O0(D||this.boundingBox,ie||this.xStep,he||this.yStep,this.gState,we||this.matrix);Oe.stream=this.stream;var Ue=k+"$$"+this.cloneIndex+++"$$";return ra(Ue,Oe),Oe}var cm=function(k,D){var ie=Gt[k.key],he=yt[ie];if(he instanceof oc)ee("q"),ee(um(D)),he.gState&&f.setGState(he.gState),ee(k.matrix.toString()+" cm"),ee("/"+ie+" sh"),ee("Q");else if(he instanceof O0){var we=new bt(1,0,0,-1,0,zl());k.matrix&&(we=we.multiply(k.matrix||Vi),ie=lm.call(he,k.key,k.boundingBox,k.xStep,k.yStep,we).id),ee("q"),ee("/Pattern cs"),ee("/"+ie+" scn"),he.gState&&f.setGState(he.gState),ee(D),ee("Q")}},um=function(k){switch(k){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},Eu=f.moveTo=function(k,D){return ee(C(V(k))+" "+C(Q(D))+" m"),this},jl=f.lineTo=function(k,D){return ee(C(V(k))+" "+C(Q(D))+" l"),this},Ao=f.curveTo=function(k,D,ie,he,we,Oe){return ee([C(V(k)),C(Q(D)),C(V(ie)),C(Q(he)),C(V(we)),C(Q(Oe)),"c"].join(" ")),this};f.__private__.line=f.line=function(k,D,ie,he,we){if(isNaN(k)||isNaN(D)||isNaN(ie)||isNaN(he)||!xs(we))throw new Error("Invalid arguments passed to jsPDF.line");return N===b?this.lines([[ie-k,he-D]],k,D,[1,1],we||"S"):this.lines([[ie-k,he-D]],k,D,[1,1]).stroke()},f.__private__.lines=f.lines=function(k,D,ie,he,we,Oe){var Ue,ft,pt,It,Rt,lr,Wr,wn,Ar,En,yn,Vn;if(typeof k=="number"&&(Vn=ie,ie=D,D=k,k=Vn),he=he||[1,1],Oe=Oe||!1,isNaN(D)||isNaN(ie)||!Array.isArray(k)||!Array.isArray(he)||!xs(we)||typeof Oe!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Eu(D,ie),Ue=he[0],ft=he[1],It=k.length,En=D,yn=ie,pt=0;pt<It;pt++)(Rt=k[pt]).length===2?(En=Rt[0]*Ue+En,yn=Rt[1]*ft+yn,jl(En,yn)):(lr=Rt[0]*Ue+En,Wr=Rt[1]*ft+yn,wn=Rt[2]*Ue+En,Ar=Rt[3]*ft+yn,En=Rt[4]*Ue+En,yn=Rt[5]*ft+yn,Ao(lr,Wr,wn,Ar,En,yn));return Oe&&Jh(),Nu(we),this},f.path=function(k){for(var D=0;D<k.length;D++){var ie=k[D],he=ie.c;switch(ie.op){case"m":Eu(he[0],he[1]);break;case"l":jl(he[0],he[1]);break;case"c":Ao.apply(this,he);break;case"h":Jh()}}return this},f.__private__.rect=f.rect=function(k,D,ie,he,we){if(isNaN(k)||isNaN(D)||isNaN(ie)||isNaN(he)||!xs(we))throw new Error("Invalid arguments passed to jsPDF.rect");return N===b&&(he=-he),ee([C(V(k)),C(Q(D)),C(V(ie)),C(V(he)),"re"].join(" ")),Nu(we),this},f.__private__.triangle=f.triangle=function(k,D,ie,he,we,Oe,Ue){if(isNaN(k)||isNaN(D)||isNaN(ie)||isNaN(he)||isNaN(we)||isNaN(Oe)||!xs(Ue))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[ie-k,he-D],[we-ie,Oe-he],[k-we,D-Oe]],k,D,[1,1],Ue,!0),this},f.__private__.roundedRect=f.roundedRect=function(k,D,ie,he,we,Oe,Ue){if(isNaN(k)||isNaN(D)||isNaN(ie)||isNaN(he)||isNaN(we)||isNaN(Oe)||!xs(Ue))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var ft=4/3*(Math.SQRT2-1);return we=Math.min(we,.5*ie),Oe=Math.min(Oe,.5*he),this.lines([[ie-2*we,0],[we*ft,0,we,Oe-Oe*ft,we,Oe],[0,he-2*Oe],[0,Oe*ft,-we*ft,Oe,-we,Oe],[2*we-ie,0],[-we*ft,0,-we,-Oe*ft,-we,-Oe],[0,2*Oe-he],[0,-Oe*ft,we*ft,-Oe,we,-Oe]],k+we,D,[1,1],Ue,!0),this},f.__private__.ellipse=f.ellipse=function(k,D,ie,he,we){if(isNaN(k)||isNaN(D)||isNaN(ie)||isNaN(he)||!xs(we))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Oe=4/3*(Math.SQRT2-1)*ie,Ue=4/3*(Math.SQRT2-1)*he;return Eu(k+ie,D),Ao(k+ie,D-Ue,k+Oe,D-he,k,D-he),Ao(k-Oe,D-he,k-ie,D-Ue,k-ie,D),Ao(k-ie,D+Ue,k-Oe,D+he,k,D+he),Ao(k+Oe,D+he,k+ie,D+Ue,k+ie,D),Nu(we),this},f.__private__.circle=f.circle=function(k,D,ie,he){if(isNaN(k)||isNaN(D)||isNaN(ie)||!xs(he))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(k,D,ie,ie,he)},f.setFont=function(k,D,ie){return ie&&(D=F(D,ie)),it=No(k,D,{disableWarning:!1}),this};var fm=f.__private__.getFont=f.getFont=function(){return st[No.apply(f,arguments)]};f.__private__.getFontList=f.getFontList=function(){var k,D,ie={};for(k in Lt)if(Lt.hasOwnProperty(k))for(D in ie[k]=[],Lt[k])Lt[k].hasOwnProperty(D)&&ie[k].push(D);return ie},f.addFont=function(k,D,ie,he,we){var Oe=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Oe.indexOf(arguments[3])!==-1?we=arguments[3]:arguments[3]&&Oe.indexOf(arguments[3])==-1&&(ie=F(ie,he)),yr.call(this,k,D,ie,we=we||"Identity-H")};var Rl,Au=e.lineWidth||.200025,jt=f.__private__.getLineWidth=f.getLineWidth=function(){return Au},hm=f.__private__.setLineWidth=f.setLineWidth=function(k){return Au=k,ee(C(V(k))+" w"),this};f.__private__.setLineDash=xt.API.setLineDash=xt.API.setLineDashPattern=function(k,D){if(k=k||[],D=D||0,isNaN(D)||!Array.isArray(k))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return k=k.map(function(ie){return C(V(ie))}).join(" "),D=C(V(D)),ee("["+k+"] "+D+" d"),this};var dm=f.__private__.getLineHeight=f.getLineHeight=function(){return Me*Rl};f.__private__.getLineHeight=f.getLineHeight=function(){return Me*Rl};var pm=f.__private__.setLineHeightFactor=f.setLineHeightFactor=function(k){return typeof(k=k||1.15)=="number"&&(Rl=k),this},mm=f.__private__.getLineHeightFactor=f.getLineHeightFactor=function(){return Rl};pm(e.lineHeight);var $s=f.__private__.getHorizontalCoordinate=function(k){return V(k)},Ws=f.__private__.getVerticalCoordinate=function(k){return N===y?k:St[j].mediaBox.topRightY-St[j].mediaBox.bottomLeftY-V(k)},gm=f.__private__.getHorizontalCoordinateString=f.getHorizontalCoordinateString=function(k){return C($s(k))},xm=f.__private__.getVerticalCoordinateString=f.getVerticalCoordinateString=function(k){return C(Ws(k))},Xc=e.strokeColor||"0 G";f.__private__.getStrokeColor=f.getDrawColor=function(){return ae(Xc)},f.__private__.setStrokeColor=f.setDrawColor=function(k,D,ie,he){return Xc=se({ch1:k,ch2:D,ch3:ie,ch4:he,pdfColorType:"draw",precision:2}),ee(Xc),this};var Tu=e.fillColor||"0 g";f.__private__.getFillColor=f.getFillColor=function(){return ae(Tu)},f.__private__.setFillColor=f.setFillColor=function(k,D,ie,he){return Tu=se({ch1:k,ch2:D,ch3:ie,ch4:he,pdfColorType:"fill",precision:2}),ee(Tu),this};var Dl=e.textColor||"0 g",Kc=f.__private__.getTextColor=f.getTextColor=function(){return ae(Dl)};f.__private__.setTextColor=f.setTextColor=function(k,D,ie,he){return Dl=se({ch1:k,ch2:D,ch3:ie,ch4:he,pdfColorType:"text",precision:3}),this};var Yc=e.charSpace,vm=f.__private__.getCharSpace=f.getCharSpace=function(){return parseFloat(Yc||0)};f.__private__.setCharSpace=f.setCharSpace=function(k){if(isNaN(k))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Yc=k,this};var Cu=0;f.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},f.__private__.setLineCap=f.setLineCap=function(k){var D=f.CapJoinStyles[k];if(D===void 0)throw new Error("Line cap style of '"+k+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Cu=D,ee(D+" J"),this};var Fu=0;f.__private__.setLineJoin=f.setLineJoin=function(k){var D=f.CapJoinStyles[k];if(D===void 0)throw new Error("Line join style of '"+k+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Fu=D,ee(D+" j"),this},f.__private__.setLineMiterLimit=f.__private__.setMiterLimit=f.setLineMiterLimit=f.setMiterLimit=function(k){if(k=k||0,isNaN(k))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return ee(C(V(k))+" M"),this},f.GState=yp,f.setGState=function(k){(k=typeof k=="string"?Pt[Br[k]]:Ml(null,k)).equals(an)||(ee("/"+k.id+" gs"),an=k)};var Ml=function(k,D){if(!k||!Br[k]){var ie=!1;for(var he in Pt)if(Pt.hasOwnProperty(he)&&Pt[he].equals(D)){ie=!0;break}if(ie)D=Pt[he];else{var we="GS"+(Object.keys(Pt).length+1).toString(10);Pt[we]=D,D.id=we}return k&&(Br[k]=D.id),sr.publish("addGState",D),D}};f.addGState=function(k,D){return Ml(k,D),this},f.saveGraphicsState=function(){return ee("q"),fr.push({key:it,size:Me,color:Dl}),this},f.restoreGraphicsState=function(){ee("Q");var k=fr.pop();return it=k.key,Me=k.size,Dl=k.color,an=null,this},f.setCurrentTransformationMatrix=function(k){return ee(k.toString()+" cm"),this},f.comment=function(k){return ee("#"+k),this};var Bl=function(k,D){var ie=k||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return ie},set:function(Oe){isNaN(Oe)||(ie=parseFloat(Oe))}});var he=D||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return he},set:function(Oe){isNaN(Oe)||(he=parseFloat(Oe))}});var we="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return we},set:function(Oe){we=Oe.toString()}}),this},Lu=function(k,D,ie,he){Bl.call(this,k,D),this.type="rect";var we=ie||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return we},set:function(Ue){isNaN(Ue)||(we=parseFloat(Ue))}});var Oe=he||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Oe},set:function(Ue){isNaN(Ue)||(Oe=parseFloat(Ue))}}),this},Jc=function(){this.page=hr,this.currentPage=j,this.pages=Ce.slice(0),this.pagesContext=St.slice(0),this.x=Ze,this.y=Ht,this.matrix=kt,this.width=Zh(j),this.height=Hs(j),this.outputDestination=$e,this.id="",this.objectNumber=-1};Jc.prototype.restore=function(){hr=this.page,j=this.currentPage,St=this.pagesContext,Ce=this.pages,Ze=this.x,Ht=this.y,kt=this.matrix,Qh(j,this.width),Vs(j,this.height),$e=this.outputDestination};var Pu=function(k,D,ie,he,we){vi.push(new Jc),hr=j=0,Ce=[],Ze=k,Ht=D,kt=we,Kr([ie,he])};for(var Ul in f.beginFormObject=function(k,D,ie,he,we){return Pu(k,D,ie,he,we),this},f.endFormObject=function(k){return function(D){if(Wi[D])vi.pop().restore();else{var ie=new Jc,he="Xo"+(Object.keys(Dn).length+1).toString(10);ie.id=he,Wi[D]=he,Dn[he]=ie,sr.publish("addFormObject",ie),vi.pop().restore()}}(k),this},f.doFormObject=function(k,D){var ie=Dn[Wi[k]];return ee("q"),ee(D.toString()+" cm"),ee("/"+ie.id+" Do"),ee("Q"),this},f.getFormObject=function(k){var D=Dn[Wi[k]];return{x:D.x,y:D.y,width:D.width,height:D.height,matrix:D.matrix}},f.save=function(k,D){return k=k||"generated.pdf",(D=D||{}).returnPromise=D.returnPromise||!1,D.returnPromise===!1?(ac(Il(zs()),k),typeof ac.unload=="function"&&Ft.setTimeout&&setTimeout(ac.unload,911),this):new Promise(function(ie,he){try{var we=ac(Il(zs()),k);typeof ac.unload=="function"&&Ft.setTimeout&&setTimeout(ac.unload,911),ie(we)}catch(Oe){he(Oe.message)}})},xt.API)xt.API.hasOwnProperty(Ul)&&(Ul==="events"&&xt.API.events.length?function(k,D){var ie,he,we;for(we=D.length-1;we!==-1;we--)ie=D[we][0],he=D[we][1],k.subscribe.apply(k,[ie].concat(typeof he=="function"?[he]:he))}(sr,xt.API.events):f[Ul]=xt.API[Ul]);function Zh(k){return St[k].mediaBox.topRightX-St[k].mediaBox.bottomLeftX}function Qh(k,D){St[k].mediaBox.topRightX=D+St[k].mediaBox.bottomLeftX}function Hs(k){return St[k].mediaBox.topRightY-St[k].mediaBox.bottomLeftY}function Vs(k,D){St[k].mediaBox.topRightY=D+St[k].mediaBox.bottomLeftY}var ed=f.getPageWidth=function(k){return Zh(k=k||j)/qe},td=f.setPageWidth=function(k,D){Qh(k,D*qe)},zl=f.getPageHeight=function(k){return Hs(k=k||j)/qe},rd=f.setPageHeight=function(k,D){Vs(k,D*qe)};return f.internal={pdfEscape:Jt,getStyle:Yh,getFont:fm,getFontSize:Ye,getCharSpace:vm,getTextColor:Kc,getLineHeight:dm,getLineHeightFactor:mm,getLineWidth:jt,write:et,getHorizontalCoordinate:$s,getVerticalCoordinate:Ws,getCoordinateString:gm,getVerticalCoordinateString:xm,collections:{},newObject:Ur,newAdditionalObject:ne,newObjectDeferred:vn,newObjectDeferredBegin:U,getFilters:ke,putStream:Fe,events:sr,scaleFactor:qe,pageSize:{getWidth:function(){return ed(j)},setWidth:function(k){td(j,k)},getHeight:function(){return zl(j)},setHeight:function(k){rd(j,k)}},encryptionOptions:u,encryption:sn,getEncryptor:function(k){return u!==null?sn.encryptor(k,0):function(D){return D}},output:Gi,getNumberOfPages:_i,pages:Ce,out:ee,f2:L,f3:I,getPageInfo:Su,getPageInfoByObjId:im,getCurrentPageInfo:sm,getPDFVersion:x,Point:Bl,Rectangle:Lu,Matrix:bt,hasHotfix:Ol},Object.defineProperty(f.internal.pageSize,"width",{get:function(){return ed(j)},set:function(k){td(j,k)},enumerable:!0,configurable:!0}),Object.defineProperty(f.internal.pageSize,"height",{get:function(){return zl(j)},set:function(k){rd(j,k)},enumerable:!0,configurable:!0}),(function(k){for(var D=0,ie=tt.length;D<ie;D++){var he=yr.call(this,k[D][0],k[D][1],k[D][2],tt[D][3],!0);h===!1&&(m[he]=!0);var we=k[D][0].split("-");Tt({id:he,fontName:we[0],fontStyle:we[1]||""})}sr.publish("addFonts",{fonts:st,dictionary:Lt})}).call(f,tt),it="F1",ms(a,r),sr.publish("initialized"),f}_0.prototype.lsbFirstWord=function(e){return String.fromCharCode(255&e,e>>8&255,e>>16&255,e>>24&255)},_0.prototype.toHexString=function(e){return e.split("").map(function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)}).join("")},_0.prototype.hexToBytes=function(e){for(var t=[],r=0;r<e.length;r+=2)t.push(String.fromCharCode(parseInt(e.substr(r,2),16)));return t.join("")},_0.prototype.processOwnerPassword=function(e,t){return Dx(Rx(t).substr(0,5),e)},_0.prototype.encryptor=function(e,t){var r=Rx(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&t,t>>8&255)).substr(0,10);return function(n){return Dx(r,n)}},yp.prototype.equals=function(e){var t,r="id,objectNumber,equals";if(!e||vr(e)!==vr(this))return!1;var n=0;for(t in this)if(!(r.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!e.hasOwnProperty(t)||this[t]!==e[t])return!1;n++}for(t in e)e.hasOwnProperty(t)&&r.indexOf(t)<0&&n--;return n===0},xt.API={events:[]},xt.version="3.0.3";var Qr=xt.API,z_=1,Gc=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},p0=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Dt=function(e){return e.toFixed(2)},Go=function(e){return e.toFixed(5)};Qr.__acroform__={};var Xa=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e},vb=function(e){return e*z_},Es=function(e){var t=new BE,r=ct.internal.getHeight(e)||0,n=ct.internal.getWidth(e)||0;return t.BBox=[0,0,Number(Dt(n)),Number(Dt(r))],t},NV=Qr.__acroform__.setBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|1<<t},EV=Qr.__acroform__.clearBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&~(1<<t)},AV=Qr.__acroform__.getBit=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return e&1<<t?1:0},dn=Qr.__acroform__.getBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return AV(e,t-1)},pn=Qr.__acroform__.setBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return NV(e,t-1)},mn=Qr.__acroform__.clearBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return EV(e,t-1)},TV=Qr.__acroform__.calculateCoordinates=function(e,t){var r=t.internal.getHorizontalCoordinate,n=t.internal.getVerticalCoordinate,a=e[0],i=e[1],s=e[2],o=e[3],l={};return l.lowerLeft_X=r(a)||0,l.lowerLeft_Y=n(i+o)||0,l.upperRight_X=r(a+s)||0,l.upperRight_Y=n(i)||0,[Number(Dt(l.lowerLeft_X)),Number(Dt(l.lowerLeft_Y)),Number(Dt(l.upperRight_X)),Number(Dt(l.upperRight_Y))]},CV=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var t=[],r=e._V||e.DV,n=Mx(e,r),a=e.scope.internal.getFont(e.fontName,e.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(e.scope.__private__.encodeColorString(e.color)),t.push("/"+a+" "+Dt(n.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(n.text),t.push("ET"),t.push("Q"),t.push("EMC");var i=Es(e);return i.scope=e.scope,i.stream=t.join(`
`),i}},Mx=function(e,t){var r=e.fontSize===0?e.maxFontSize:e.fontSize,n={text:"",fontSize:""},a=(t=(t=t.substr(0,1)=="("?t.substr(1):t).substr(t.length-1)==")"?t.substr(0,t.length-1):t).split(" ");a=e.multiline?a.map(function(L){return L.split(`
`)}):a.map(function(L){return[L]});var i=r,s=ct.internal.getHeight(e)||0;s=s<0?-s:s;var o=ct.internal.getWidth(e)||0;o=o<0?-o:o;var l=function(L,I,V){if(L+1<a.length){var Q=I+" "+a[L+1][0];return l1(Q,e,V).width<=o-4}return!1};i++;e:for(;i>0;){t="",i--;var c,u,h=l1("3",e,i).height,m=e.multiline?s-i:(s-h)/2,f=m+=2,v=0,x=0,w=0;if(i<=0){t=`(...) Tj
`,t+="% Width of Text: "+l1(t,e,i=12).width+", FieldWidth:"+o+`
`;break}for(var _="",b=0,y=0;y<a.length;y++)if(a.hasOwnProperty(y)){var N=!1;if(a[y].length!==1&&w!==a[y].length-1){if((h+2)*(b+2)+2>s)continue e;_+=a[y][w],N=!0,x=y,y--}else{_=(_+=a[y][w]+" ").substr(_.length-1)==" "?_.substr(0,_.length-1):_;var R=parseInt(y),P=l(R,_,i),F=y>=a.length-1;if(P&&!F){_+=" ",w=0;continue}if(P||F){if(F)x=R;else if(e.multiline&&(h+2)*(b+2)+2>s)continue e}else{if(!e.multiline||(h+2)*(b+2)+2>s)continue e;x=R}}for(var C="",A=v;A<=x;A++){var W=a[A];if(e.multiline){if(A===x){C+=W[w]+" ",w=(w+1)%W.length;continue}if(A===v){C+=W[W.length-1]+" ";continue}}C+=W[0]+" "}switch(C=C.substr(C.length-1)==" "?C.substr(0,C.length-1):C,u=l1(C,e,i).width,e.textAlign){case"right":c=o-u-2;break;case"center":c=(o-u)/2;break;default:c=2}t+=Dt(c)+" "+Dt(f)+` Td
`,t+="("+Gc(C)+`) Tj
`,t+=-Dt(c)+` 0 Td
`,f=-(i+2),u=0,v=N?x:x+1,b++,_=""}break}return n.text=t,n.fontSize=i,n},l1=function(e,t,r){var n=t.scope.internal.getFont(t.fontName,t.fontStyle),a=t.scope.getStringUnitWidth(e,{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:t.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:a}},FV={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},LV=function(e,t){var r={type:"reference",object:e};t.internal.getPageInfo(e.page).pageContext.annotations.find(function(n){return n.type===r.type&&n.object===r.object})===void 0&&t.internal.getPageInfo(e.page).pageContext.annotations.push(r)},PV=function(e,t){if(t.scope=e,e.internal!==void 0&&(e.internal.acroformPlugin===void 0||e.internal.acroformPlugin.isInitialized===!1)){if(ds.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(FV)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");z_=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new UE,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(e)}),e.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var a in n)if(n.hasOwnProperty(a)){var i=n[a];i.objId=void 0,i.hasAnnotation&&LV(i,r)}})(e)}),e.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(e)}),e.internal.events.subscribe("postPutPages",function(r){(function(n,a){var i=!n;for(var s in n||(a.internal.newObjectDeferredBegin(a.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),a.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||a.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(s)){var o=n[s],l=[],c=o.Rect;if(o.Rect&&(o.Rect=TV(o.Rect,a)),a.internal.newObjectDeferredBegin(o.objId,!0),o.DA=ct.createDefaultAppearanceStream(o),vr(o)==="object"&&typeof o.getKeyValueListForStream=="function"&&(l=o.getKeyValueListForStream()),o.Rect=c,o.hasAppearanceStream&&!o.appearanceStreamContent){var u=CV(o);l.push({key:"AP",value:"<</N "+u+">>"}),a.internal.acroformPlugin.xForms.push(u)}if(o.appearanceStreamContent){var h="";for(var m in o.appearanceStreamContent)if(o.appearanceStreamContent.hasOwnProperty(m)){var f=o.appearanceStreamContent[m];if(h+="/"+m+" ",h+="<<",Object.keys(f).length>=1||Array.isArray(f)){for(var s in f)if(f.hasOwnProperty(s)){var v=f[s];typeof v=="function"&&(v=v.call(a,o)),h+="/"+s+" "+v+" ",a.internal.acroformPlugin.xForms.indexOf(v)>=0||a.internal.acroformPlugin.xForms.push(v)}}else typeof(v=f)=="function"&&(v=v.call(a,o)),h+="/"+s+" "+v,a.internal.acroformPlugin.xForms.indexOf(v)>=0||a.internal.acroformPlugin.xForms.push(v);h+=">>"}l.push({key:"AP",value:`<<
`+h+">>"})}a.internal.putStream({additionalKeyValues:l,objectId:o.objId}),a.internal.out("endobj")}i&&function(x,w){for(var _ in x)if(x.hasOwnProperty(_)){var b=_,y=x[_];w.internal.newObjectDeferredBegin(y.objId,!0),vr(y)==="object"&&typeof y.putStream=="function"&&y.putStream(),delete x[b]}}(a.internal.acroformPlugin.xForms,a)})(r,e)}),e.internal.acroformPlugin.isInitialized=!0}},ME=Qr.__acroform__.arrayToPdfArray=function(e,t,r){var n=function(s){return s};if(Array.isArray(e)){for(var a="[",i=0;i<e.length;i++)switch(i!==0&&(a+=" "),vr(e[i])){case"boolean":case"number":case"object":a+=e[i].toString();break;case"string":e[i].substr(0,1)!=="/"?(t!==void 0&&r&&(n=r.internal.getEncryptor(t)),a+="("+Gc(n(e[i].toString()))+")"):a+=e[i].toString()}return a+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},Qg=function(e,t,r){var n=function(a){return a};return t!==void 0&&r&&(n=r.internal.getEncryptor(t)),(e=e||"").toString(),"("+Gc(n(e))+")"},Ps=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Ps.prototype.toString=function(){return this.objId+" 0 R"},Ps.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},Ps.prototype.getKeyValueListForStream=function(){var e=[],t=Object.getOwnPropertyNames(this).filter(function(i){return i!="content"&&i!="appearanceStreamContent"&&i!="scope"&&i!="objId"&&i.substring(0,1)!="_"});for(var r in t)if(Object.getOwnPropertyDescriptor(this,t[r]).configurable===!1){var n=t[r],a=this[n];a&&(Array.isArray(a)?e.push({key:n,value:ME(a,this.objId,this.scope)}):a instanceof Ps?(a.scope=this.scope,e.push({key:n,value:a.objId+" 0 R"})):typeof a!="function"&&e.push({key:n,value:a}))}return e};var BE=function(){Ps.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){e=r.trim()},get:function(){return e||null}})};Xa(BE,Ps);var UE=function(){Ps.call(this);var e,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var r=function(n){return n};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+Gc(r(e))+")"}},set:function(r){e=r}})};Xa(UE,Ps);var ds=function e(){Ps.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(_){if(isNaN(_))throw new Error('Invalid value "'+_+'" for attribute F supplied.');t=_}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!dn(t,3)},set:function(_){_?this.F=pn(t,3):this.F=mn(t,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(_){if(isNaN(_))throw new Error('Invalid value "'+_+'" for attribute Ff supplied.');r=_}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(_){n=_!==void 0?_:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(_){n[0]=_}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(_){n[1]=_}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(_){n[2]=_}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(_){n[3]=_}});var a="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return a},set:function(_){switch(_){case"/Btn":case"/Tx":case"/Ch":case"/Sig":a=_;break;default:throw new Error('Invalid value "'+_+'" for attribute FT supplied.')}}});var i=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!i||i.length<1){if(this instanceof bp)return;i="FieldObject"+e.FieldNum++}var _=function(b){return b};return this.scope&&(_=this.scope.internal.getEncryptor(this.objId)),"("+Gc(_(i))+")"},set:function(_){i=_.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return i},set:function(_){i=_}});var s="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return s},set:function(_){s=_}});var o="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return o},set:function(_){o=_}});var l=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return l},set:function(_){l=_}});var c=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return c===void 0?50/z_:c},set:function(_){c=_}});var u="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return u},set:function(_){u=_}});var h="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!h||this instanceof bp||this instanceof bc))return Qg(h,this.objId,this.scope)},set:function(_){_=_.toString(),h=_}});var m=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(m)return this instanceof zn==0?Qg(m,this.objId,this.scope):m},set:function(_){_=_.toString(),m=this instanceof zn==0?_.substr(0,1)==="("?p0(_.substr(1,_.length-2)):p0(_):_}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof zn==1?p0(m.substr(1,m.length-1)):m},set:function(_){_=_.toString(),m=this instanceof zn==1?"/"+_:_}});var f=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(f)return f},set:function(_){this.V=_}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(f)return this instanceof zn==0?Qg(f,this.objId,this.scope):f},set:function(_){_=_.toString(),f=this instanceof zn==0?_.substr(0,1)==="("?p0(_.substr(1,_.length-2)):p0(_):_}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof zn==1?p0(f.substr(1,f.length-1)):f},set:function(_){_=_.toString(),f=this instanceof zn==1?"/"+_:_}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var v,x=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return x},set:function(_){_=!!_,x=_}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(v)return v},set:function(_){v=_}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,1)},set:function(_){_?this.Ff=pn(this.Ff,1):this.Ff=mn(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,2)},set:function(_){_?this.Ff=pn(this.Ff,2):this.Ff=mn(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,3)},set:function(_){_?this.Ff=pn(this.Ff,3):this.Ff=mn(this.Ff,3)}});var w=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(w!==null)return w},set:function(_){if([0,1,2].indexOf(_)===-1)throw new Error('Invalid value "'+_+'" for attribute Q supplied.');w=_}}),Object.defineProperty(this,"textAlign",{get:function(){var _;switch(w){case 0:default:_="left";break;case 1:_="center";break;case 2:_="right"}return _},configurable:!0,enumerable:!0,set:function(_){switch(_){case"right":case 2:w=2;break;case"center":case 1:w=1;break;default:w=0}}})};Xa(ds,Ps);var q0=function(){ds.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(r){e=r}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return ME(t,this.objId,this.scope)},set:function(r){var n,a;a=[],typeof(n=r)=="string"&&(a=function(i,s,o){o||(o=1);for(var l,c=[];l=s.exec(i);)c.push(l[o]);return c}(n,/\((.*?)\)/g)),t=a}}),this.getOptions=function(){return t},this.setOptions=function(r){t=r,this.sort&&t.sort()},this.addOption=function(r){r=(r=r||"").toString(),t.push(r),this.sort&&t.sort()},this.removeOption=function(r,n){for(n=n||!1,r=(r=r||"").toString();t.indexOf(r)!==-1&&(t.splice(t.indexOf(r),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,18)},set:function(r){r?this.Ff=pn(this.Ff,18):this.Ff=mn(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=pn(this.Ff,19):this.Ff=mn(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,20)},set:function(r){r?(this.Ff=pn(this.Ff,20),t.sort()):this.Ff=mn(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,22)},set:function(r){r?this.Ff=pn(this.Ff,22):this.Ff=mn(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,23)},set:function(r){r?this.Ff=pn(this.Ff,23):this.Ff=mn(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,27)},set:function(r){r?this.Ff=pn(this.Ff,27):this.Ff=mn(this.Ff,27)}}),this.hasAppearanceStream=!1};Xa(q0,ds);var G0=function(){q0.call(this),this.fontName="helvetica",this.combo=!1};Xa(G0,q0);var X0=function(){G0.call(this),this.combo=!0};Xa(X0,G0);var A1=function(){X0.call(this),this.edit=!0};Xa(A1,X0);var zn=function(){ds.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,15)},set:function(r){r?this.Ff=pn(this.Ff,15):this.Ff=mn(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,16)},set:function(r){r?this.Ff=pn(this.Ff,16):this.Ff=mn(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,17)},set:function(r){r?this.Ff=pn(this.Ff,17):this.Ff=mn(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,26)},set:function(r){r?this.Ff=pn(this.Ff,26):this.Ff=mn(this.Ff,26)}});var e,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(i){return i};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(t).length!==0){var n,a=[];for(n in a.push("<<"),t)a.push("/"+n+" ("+Gc(r(t[n]))+")");return a.push(">>"),a.join(`
`)}},set:function(r){vr(r)==="object"&&(t=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(r){typeof r=="string"&&(t.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(r){e="/"+r}})};Xa(zn,ds);var T1=function(){zn.call(this),this.pushButton=!0};Xa(T1,zn);var K0=function(){zn.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t!==void 0?t:[]}})};Xa(K0,zn);var bp=function(){var e,t;ds.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(a){e=a}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(a){t=a}});var r,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var a=function(o){return o};this.scope&&(a=this.scope.internal.getEncryptor(this.objId));var i,s=[];for(i in s.push("<<"),n)s.push("/"+i+" ("+Gc(a(n[i]))+")");return s.push(">>"),s.join(`
`)},set:function(a){vr(a)==="object"&&(n=a)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(a){typeof a=="string"&&(n.CA=a)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(a){r=a}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(a){r="/"+a}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=ct.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Xa(bp,ds),K0.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var r=this.Kids[t];r.appearanceStreamContent=e.createAppearanceStream(r.optionName),r.caption=e.getCA()}},K0.prototype.createOption=function(e){var t=new bp;return t.Parent=this,t.optionName=e,this.Kids.push(t),IV.call(this.scope,t),t};var C1=function(){zn.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=ct.CheckBox.createAppearanceStream()};Xa(C1,zn);var bc=function(){ds.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,13)},set:function(t){t?this.Ff=pn(this.Ff,13):this.Ff=mn(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,21)},set:function(t){t?this.Ff=pn(this.Ff,21):this.Ff=mn(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,23)},set:function(t){t?this.Ff=pn(this.Ff,23):this.Ff=mn(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,24)},set:function(t){t?this.Ff=pn(this.Ff,24):this.Ff=mn(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,25)},set:function(t){t?this.Ff=pn(this.Ff,25):this.Ff=mn(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,26)},set:function(t){t?this.Ff=pn(this.Ff,26):this.Ff=mn(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){Number.isInteger(t)&&(e=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Xa(bc,ds);var F1=function(){bc.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,14)},set:function(e){e?this.Ff=pn(this.Ff,14):this.Ff=mn(this.Ff,14)}}),this.password=!0};Xa(F1,bc);var ct={CheckBox:{createAppearanceStream:function(){return{N:{On:ct.CheckBox.YesNormal},D:{On:ct.CheckBox.YesPushDown,Off:ct.CheckBox.OffPushDown}}},YesPushDown:function(e){var t=Es(e);t.scope=e.scope;var r=[],n=e.scope.internal.getFont(e.fontName,e.fontStyle).id,a=e.scope.__private__.encodeColorString(e.color),i=Mx(e,e.caption);return r.push("0.749023 g"),r.push("0 0 "+Dt(ct.internal.getWidth(e))+" "+Dt(ct.internal.getHeight(e))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+n+" "+Dt(i.fontSize)+" Tf "+a),r.push("BT"),r.push(i.text),r.push("ET"),r.push("Q"),r.push("EMC"),t.stream=r.join(`
`),t},YesNormal:function(e){var t=Es(e);t.scope=e.scope;var r=e.scope.internal.getFont(e.fontName,e.fontStyle).id,n=e.scope.__private__.encodeColorString(e.color),a=[],i=ct.internal.getHeight(e),s=ct.internal.getWidth(e),o=Mx(e,e.caption);return a.push("1 g"),a.push("0 0 "+Dt(s)+" "+Dt(i)+" re"),a.push("f"),a.push("q"),a.push("0 0 1 rg"),a.push("0 0 "+Dt(s-1)+" "+Dt(i-1)+" re"),a.push("W"),a.push("n"),a.push("0 g"),a.push("BT"),a.push("/"+r+" "+Dt(o.fontSize)+" Tf "+n),a.push(o.text),a.push("ET"),a.push("Q"),t.stream=a.join(`
`),t},OffPushDown:function(e){var t=Es(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Dt(ct.internal.getWidth(e))+" "+Dt(ct.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}},RadioButton:{Circle:{createAppearanceStream:function(e){var t={D:{Off:ct.RadioButton.Circle.OffPushDown},N:{}};return t.N[e]=ct.RadioButton.Circle.YesNormal,t.D[e]=ct.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(e){var t=Es(e);t.scope=e.scope;var r=[],n=ct.internal.getWidth(e)<=ct.internal.getHeight(e)?ct.internal.getWidth(e)/4:ct.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var a=ct.internal.Bezier_C,i=Number((n*a).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+Go(ct.internal.getWidth(e)/2)+" "+Go(ct.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+i+" "+i+" "+n+" 0 "+n+" c"),r.push("-"+i+" "+n+" -"+n+" "+i+" -"+n+" 0 c"),r.push("-"+n+" -"+i+" -"+i+" -"+n+" 0 -"+n+" c"),r.push(i+" -"+n+" "+n+" -"+i+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=Es(e);t.scope=e.scope;var r=[],n=ct.internal.getWidth(e)<=ct.internal.getHeight(e)?ct.internal.getWidth(e)/4:ct.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var a=Number((2*n).toFixed(5)),i=Number((a*ct.internal.Bezier_C).toFixed(5)),s=Number((n*ct.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Go(ct.internal.getWidth(e)/2)+" "+Go(ct.internal.getHeight(e)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+i+" "+i+" "+a+" 0 "+a+" c"),r.push("-"+i+" "+a+" -"+a+" "+i+" -"+a+" 0 c"),r.push("-"+a+" -"+i+" -"+i+" -"+a+" 0 -"+a+" c"),r.push(i+" -"+a+" "+a+" -"+i+" "+a+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+Go(ct.internal.getWidth(e)/2)+" "+Go(ct.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),r.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),r.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),r.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},OffPushDown:function(e){var t=Es(e);t.scope=e.scope;var r=[],n=ct.internal.getWidth(e)<=ct.internal.getHeight(e)?ct.internal.getWidth(e)/4:ct.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var a=Number((2*n).toFixed(5)),i=Number((a*ct.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Go(ct.internal.getWidth(e)/2)+" "+Go(ct.internal.getHeight(e)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+i+" "+i+" "+a+" 0 "+a+" c"),r.push("-"+i+" "+a+" -"+a+" "+i+" -"+a+" 0 c"),r.push("-"+a+" -"+i+" -"+i+" -"+a+" 0 -"+a+" c"),r.push(i+" -"+a+" "+a+" -"+i+" "+a+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t}},Cross:{createAppearanceStream:function(e){var t={D:{Off:ct.RadioButton.Cross.OffPushDown},N:{}};return t.N[e]=ct.RadioButton.Cross.YesNormal,t.D[e]=ct.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(e){var t=Es(e);t.scope=e.scope;var r=[],n=ct.internal.calculateCross(e);return r.push("q"),r.push("1 1 "+Dt(ct.internal.getWidth(e)-2)+" "+Dt(ct.internal.getHeight(e)-2)+" re"),r.push("W"),r.push("n"),r.push(Dt(n.x1.x)+" "+Dt(n.x1.y)+" m"),r.push(Dt(n.x2.x)+" "+Dt(n.x2.y)+" l"),r.push(Dt(n.x4.x)+" "+Dt(n.x4.y)+" m"),r.push(Dt(n.x3.x)+" "+Dt(n.x3.y)+" l"),r.push("s"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=Es(e);t.scope=e.scope;var r=ct.internal.calculateCross(e),n=[];return n.push("0.749023 g"),n.push("0 0 "+Dt(ct.internal.getWidth(e))+" "+Dt(ct.internal.getHeight(e))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+Dt(ct.internal.getWidth(e)-2)+" "+Dt(ct.internal.getHeight(e)-2)+" re"),n.push("W"),n.push("n"),n.push(Dt(r.x1.x)+" "+Dt(r.x1.y)+" m"),n.push(Dt(r.x2.x)+" "+Dt(r.x2.y)+" l"),n.push(Dt(r.x4.x)+" "+Dt(r.x4.y)+" m"),n.push(Dt(r.x3.x)+" "+Dt(r.x3.y)+" l"),n.push("s"),n.push("Q"),t.stream=n.join(`
`),t},OffPushDown:function(e){var t=Es(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Dt(ct.internal.getWidth(e))+" "+Dt(ct.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}}},createDefaultAppearanceStream:function(e){var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,r=e.scope.__private__.encodeColorString(e.color);return"/"+t+" "+e.fontSize+" Tf "+r}};ct.internal={Bezier_C:.551915024494,calculateCross:function(e){var t=ct.internal.getWidth(e),r=ct.internal.getHeight(e),n=Math.min(t,r);return{x1:{x:(t-n)/2,y:(r-n)/2+n},x2:{x:(t-n)/2+n,y:(r-n)/2},x3:{x:(t-n)/2,y:(r-n)/2},x4:{x:(t-n)/2+n,y:(r-n)/2+n}}}},ct.internal.getWidth=function(e){var t=0;return vr(e)==="object"&&(t=vb(e.Rect[2])),t},ct.internal.getHeight=function(e){var t=0;return vr(e)==="object"&&(t=vb(e.Rect[3])),t};var IV=Qr.addField=function(e){if(PV(this,e),!(e instanceof ds))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=e).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};Qr.AcroFormChoiceField=q0,Qr.AcroFormListBox=G0,Qr.AcroFormComboBox=X0,Qr.AcroFormEditBox=A1,Qr.AcroFormButton=zn,Qr.AcroFormPushButton=T1,Qr.AcroFormRadioButton=K0,Qr.AcroFormCheckBox=C1,Qr.AcroFormTextField=bc,Qr.AcroFormPasswordField=F1,Qr.AcroFormAppearance=ct,Qr.AcroForm={ChoiceField:q0,ListBox:G0,ComboBox:X0,EditBox:A1,Button:zn,PushButton:T1,RadioButton:K0,CheckBox:C1,TextField:bc,PasswordField:F1,Appearance:ct},xt.AcroForm={ChoiceField:q0,ListBox:G0,ComboBox:X0,EditBox:A1,Button:zn,PushButton:T1,RadioButton:K0,CheckBox:C1,TextField:bc,PasswordField:F1,Appearance:ct};function zE(e){return e.reduce(function(t,r,n){return t[r]=n,t},{})}(function(e){var t="addImage_";e.__addimage__={};var r="UNKNOWN",n={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},a=e.__addimage__.getImageFileTypeByImageData=function(L,I){var V,Q,ue,me,pe,oe=r;if((I=I||r)==="RGBA"||L.data!==void 0&&L.data instanceof Uint8ClampedArray&&"height"in L&&"width"in L)return"RGBA";if(P(L))for(pe in n)for(ue=n[pe],V=0;V<ue.length;V+=1){for(me=!0,Q=0;Q<ue[V].length;Q+=1)if(ue[V][Q]!==void 0&&ue[V][Q]!==L[Q]){me=!1;break}if(me===!0){oe=pe;break}}else for(pe in n)for(ue=n[pe],V=0;V<ue.length;V+=1){for(me=!0,Q=0;Q<ue[V].length;Q+=1)if(ue[V][Q]!==void 0&&ue[V][Q]!==L.charCodeAt(Q)){me=!1;break}if(me===!0){oe=pe;break}}return oe===r&&I!==r&&(oe=I),oe},i=function L(I){for(var V=this.internal.write,Q=this.internal.putStream,ue=(0,this.internal.getFilters)();ue.indexOf("FlateEncode")!==-1;)ue.splice(ue.indexOf("FlateEncode"),1);I.objectId=this.internal.newObject();var me=[];if(me.push({key:"Type",value:"/XObject"}),me.push({key:"Subtype",value:"/Image"}),me.push({key:"Width",value:I.width}),me.push({key:"Height",value:I.height}),I.colorSpace===_.INDEXED?me.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(I.palette.length/3-1)+" "+("sMask"in I&&I.sMask!==void 0?I.objectId+2:I.objectId+1)+" 0 R]"}):(me.push({key:"ColorSpace",value:"/"+I.colorSpace}),I.colorSpace===_.DEVICE_CMYK&&me.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),me.push({key:"BitsPerComponent",value:I.bitsPerComponent}),"decodeParameters"in I&&I.decodeParameters!==void 0&&me.push({key:"DecodeParms",value:"<<"+I.decodeParameters+">>"}),"transparency"in I&&Array.isArray(I.transparency)&&I.transparency.length>0){for(var pe="",oe=0,G=I.transparency.length;oe<G;oe++)pe+=I.transparency[oe]+" "+I.transparency[oe]+" ";me.push({key:"Mask",value:"["+pe+"]"})}I.sMask!==void 0&&me.push({key:"SMask",value:I.objectId+1+" 0 R"});var ve=I.filter!==void 0?["/"+I.filter]:void 0;if(Q({data:I.data,additionalKeyValues:me,alreadyAppliedFilters:ve,objectId:I.objectId}),V("endobj"),"sMask"in I&&I.sMask!==void 0){var _e,E=(_e=I.sMaskBitsPerComponent)!==null&&_e!==void 0?_e:I.bitsPerComponent,j={width:I.width,height:I.height,colorSpace:"DeviceGray",bitsPerComponent:E,data:I.sMask};"filter"in I&&(j.decodeParameters="/Predictor ".concat(I.predictor," /Colors 1 /BitsPerComponent ").concat(E," /Columns ").concat(I.width),j.filter=I.filter),L.call(this,j)}if(I.colorSpace===_.INDEXED){var O=this.internal.newObject();Q({data:C(new Uint8Array(I.palette)),objectId:O}),V("endobj")}},s=function(){var L=this.internal.collections[t+"images"];for(var I in L)i.call(this,L[I])},o=function(){var L,I=this.internal.collections[t+"images"],V=this.internal.write;for(var Q in I)V("/I"+(L=I[Q]).index,L.objectId,"0","R")},l=function(){this.internal.collections[t+"images"]||(this.internal.collections[t+"images"]={},this.internal.events.subscribe("putResources",s),this.internal.events.subscribe("putXobjectDict",o))},c=function(){var L=this.internal.collections[t+"images"];return l.call(this),L},u=function(){return Object.keys(this.internal.collections[t+"images"]).length},h=function(L){return typeof e["process"+L.toUpperCase()]=="function"},m=function(L){return vr(L)==="object"&&L.nodeType===1},f=function(L,I){if(L.nodeName==="IMG"&&L.hasAttribute("src")){var V=""+L.getAttribute("src");if(V.indexOf("data:image/")===0)return E1(unescape(V).split("base64,").pop());var Q=e.loadFile(V,!0);if(Q!==void 0)return Q}if(L.nodeName==="CANVAS"){if(L.width===0||L.height===0)throw new Error("Given canvas must have data. Canvas width: "+L.width+", height: "+L.height);var ue;switch(I){case"PNG":ue="image/png";break;case"WEBP":ue="image/webp";break;default:ue="image/jpeg"}return E1(L.toDataURL(ue,1).split("base64,").pop())}},v=function(L){var I=this.internal.collections[t+"images"];if(I){for(var V in I)if(L===I[V].alias)return I[V]}},x=function(L,I,V){return L||I||(L=-96,I=-96),L<0&&(L=-1*V.width*72/L/this.internal.scaleFactor),I<0&&(I=-1*V.height*72/I/this.internal.scaleFactor),L===0&&(L=I*V.width/V.height),I===0&&(I=L*V.height/V.width),[L,I]},w=function(L,I,V,Q,ue,me){var pe=x.call(this,V,Q,ue),oe=this.internal.getCoordinateString,G=this.internal.getVerticalCoordinateString,ve=c.call(this);if(V=pe[0],Q=pe[1],ve[ue.index]=ue,me){me*=Math.PI/180;var _e=Math.cos(me),E=Math.sin(me),j=function(B){return B.toFixed(4)},O=[j(_e),j(E),j(-1*E),j(_e),0,0,"cm"]}this.internal.write("q"),me?(this.internal.write([1,"0","0",1,oe(L),G(I+Q),"cm"].join(" ")),this.internal.write(O.join(" ")),this.internal.write([oe(V),"0","0",oe(Q),"0","0","cm"].join(" "))):this.internal.write([oe(V),"0","0",oe(Q),oe(L),G(I+Q),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+ue.index+" Do"),this.internal.write("Q")},_=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var b=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},y=e.__addimage__.sHashCode=function(L){var I,V,Q=0;if(typeof L=="string")for(V=L.length,I=0;I<V;I++)Q=(Q<<5)-Q+L.charCodeAt(I),Q|=0;else if(P(L))for(V=L.byteLength/2,I=0;I<V;I++)Q=(Q<<5)-Q+L[I],Q|=0;return Q},N=e.__addimage__.validateStringAsBase64=function(L){(L=L||"").toString().trim();var I=!0;return L.length===0&&(I=!1),L.length%4!=0&&(I=!1),/^[A-Za-z0-9+/]+$/.test(L.substr(0,L.length-2))===!1&&(I=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(L.substr(-2))===!1&&(I=!1),I},R=e.__addimage__.extractImageFromDataUrl=function(L){if(L==null||!(L=L.trim()).startsWith("data:"))return null;var I=L.indexOf(",");return I<0?null:L.substring(0,I).trim().endsWith("base64")?L.substring(I+1):null};e.__addimage__.isArrayBuffer=function(L){return L instanceof ArrayBuffer};var P=e.__addimage__.isArrayBufferView=function(L){return L instanceof Int8Array||L instanceof Uint8Array||L instanceof Uint8ClampedArray||L instanceof Int16Array||L instanceof Uint16Array||L instanceof Int32Array||L instanceof Uint32Array||L instanceof Float32Array||L instanceof Float64Array},F=e.__addimage__.binaryStringToUint8Array=function(L){for(var I=L.length,V=new Uint8Array(I),Q=0;Q<I;Q++)V[Q]=L.charCodeAt(Q);return V},C=e.__addimage__.arrayBufferToBinaryString=function(L){for(var I="",V=P(L)?L:new Uint8Array(L),Q=0;Q<V.length;Q+=8192)I+=String.fromCharCode.apply(null,V.subarray(Q,Q+8192));return I};e.addImage=function(){var L,I,V,Q,ue,me,pe,oe,G;if(typeof arguments[1]=="number"?(I=r,V=arguments[1],Q=arguments[2],ue=arguments[3],me=arguments[4],pe=arguments[5],oe=arguments[6],G=arguments[7]):(I=arguments[1],V=arguments[2],Q=arguments[3],ue=arguments[4],me=arguments[5],pe=arguments[6],oe=arguments[7],G=arguments[8]),vr(L=arguments[0])==="object"&&!m(L)&&"imageData"in L){var ve=L;L=ve.imageData,I=ve.format||I||r,V=ve.x||V||0,Q=ve.y||Q||0,ue=ve.w||ve.width||ue,me=ve.h||ve.height||me,pe=ve.alias||pe,oe=ve.compression||oe,G=ve.rotation||ve.angle||G}var _e=this.internal.getFilters();if(oe===void 0&&_e.indexOf("FlateEncode")!==-1&&(oe="SLOW"),isNaN(V)||isNaN(Q))throw new Error("Invalid coordinates passed to jsPDF.addImage");l.call(this);var E=A.call(this,L,I,pe,oe);return w.call(this,V,Q,ue,me,E,G),this};var A=function(L,I,V,Q){var ue,me,pe;if(typeof L=="string"&&a(L)===r){L=unescape(L);var oe=W(L,!1);(oe!==""||(oe=e.loadFile(L,!0))!==void 0)&&(L=oe)}if(m(L)&&(L=f(L,I)),I=a(L,I),!h(I))throw new Error("addImage does not support files of type '"+I+"', please ensure that a plugin for '"+I+"' support is added.");if(((pe=V)==null||pe.length===0)&&(V=function(G){return typeof G=="string"||P(G)?y(G):P(G.data)?y(G.data):null}(L)),(ue=v.call(this,V))||(L instanceof Uint8Array||I==="RGBA"||(me=L,L=F(L)),ue=this["process"+I.toUpperCase()](L,u.call(this),V,function(G){return G&&typeof G=="string"&&(G=G.toUpperCase()),G in e.image_compression?G:b.NONE}(Q),me)),!ue)throw new Error("An unknown error occurred whilst processing the image.");return ue},W=e.__addimage__.convertBase64ToBinaryString=function(L,I){I=typeof I!="boolean"||I;var V,Q="";if(typeof L=="string"){var ue;V=(ue=R(L))!==null&&ue!==void 0?ue:L;try{Q=E1(V)}catch(me){if(I)throw N(V)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+me.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return Q};e.getImageProperties=function(L){var I,V,Q="";if(m(L)&&(L=f(L)),typeof L=="string"&&a(L)===r&&((Q=W(L,!1))===""&&(Q=e.loadFile(L)||""),L=Q),V=a(L),!h(V))throw new Error("addImage does not support files of type '"+V+"', please ensure that a plugin for '"+V+"' support is added.");if(L instanceof Uint8Array||(L=F(L)),!(I=this["process"+V.toUpperCase()](L)))throw new Error("An unknown error occurred whilst processing the image");return I.fileType=V,I}})(xt.API),function(e){var t=function(r){if(r!==void 0&&r!="")return!0};xt.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(r){for(var n,a,i,s=this.internal.getCoordinateString,o=this.internal.getVerticalCoordinateString,l=this.internal.getPageInfoByObjId(r.objId),c=r.pageContext.annotations,u=!1,h=0;h<c.length&&!u;h++)switch((n=c[h]).type){case"link":(t(n.options.url)||t(n.options.pageNumber))&&(u=!0);break;case"reference":case"text":case"freetext":u=!0}if(u!=0){this.internal.write("/Annots [");for(var m=0;m<c.length;m++){n=c[m];var f=this.internal.pdfEscape,v=this.internal.getEncryptor(r.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var x=this.internal.newAdditionalObject(),w=this.internal.newAdditionalObject(),_=this.internal.getEncryptor(x.objId),b=n.title||"Note";i="<</Type /Annot /Subtype /Text "+(a="/Rect ["+s(n.bounds.x)+" "+o(n.bounds.y+n.bounds.h)+" "+s(n.bounds.x+n.bounds.w)+" "+o(n.bounds.y)+"] ")+"/Contents ("+f(_(n.contents))+")",i+=" /Popup "+w.objId+" 0 R",i+=" /P "+l.objId+" 0 R",i+=" /T ("+f(_(b))+") >>",x.content=i;var y=x.objId+" 0 R";i="<</Type /Annot /Subtype /Popup "+(a="/Rect ["+s(n.bounds.x+30)+" "+o(n.bounds.y+n.bounds.h)+" "+s(n.bounds.x+n.bounds.w+30)+" "+o(n.bounds.y)+"] ")+" /Parent "+y,n.open&&(i+=" /Open true"),i+=" >>",w.content=i,this.internal.write(x.objId,"0 R",w.objId,"0 R");break;case"freetext":a="/Rect ["+s(n.bounds.x)+" "+o(n.bounds.y)+" "+s(n.bounds.x+n.bounds.w)+" "+o(n.bounds.y+n.bounds.h)+"] ";var N=n.color||"#000000";i="<</Type /Annot /Subtype /FreeText "+a+"/Contents ("+f(v(n.contents))+")",i+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+N+")",i+=" /Border [0 0 0]",i+=" >>",this.internal.write(i);break;case"link":if(n.options.name){var R=this.annotations._nameMap[n.options.name];n.options.pageNumber=R.page,n.options.top=R.y}else n.options.top||(n.options.top=0);if(a="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",i="",n.options.url)i="<</Type /Annot /Subtype /Link "+a+"/Border [0 0 0] /A <</S /URI /URI ("+f(v(n.options.url))+") >>";else if(n.options.pageNumber)switch(i="<</Type /Annot /Subtype /Link "+a+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":i+=" /Fit]";break;case"FitH":i+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,i+=" /FitV "+n.options.left+"]";break;default:var P=o(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),i+=" /XYZ "+n.options.left+" "+P+" "+n.options.zoom+"]"}i!=""&&(i+=" >>",this.internal.write(i))}}this.internal.write("]")}}]),e.createAnnotation=function(r){var n=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":n.pageContext.annotations.push(r)}},e.link=function(r,n,a,i,s){var o=this.internal.getCurrentPageInfo(),l=this.internal.getCoordinateString,c=this.internal.getVerticalCoordinateString;o.pageContext.annotations.push({finalBounds:{x:l(r),y:c(n),w:l(r+a),h:c(n+i)},options:s,type:"link"})},e.textWithLink=function(r,n,a,i){var s,o,l=this.getTextWidth(r),c=this.internal.getLineHeight()/this.internal.scaleFactor;if(i.maxWidth!==void 0){o=i.maxWidth;var u=this.splitTextToSize(r,o).length;s=Math.ceil(c*u)}else o=l,s=c;return this.text(r,n,a,i),a+=.2*c,i.align==="center"&&(n-=l/2),i.align==="right"&&(n-=l),this.link(n,a-c,o,s,i),l},e.getTextWidth=function(r){var n=this.internal.getFontSize();return this.getStringUnitWidth(r)*n/this.internal.scaleFactor}}(xt.API),function(e){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},a=[1570,1571,1573,1575];e.__arabicParser__={};var i=e.__arabicParser__.isInArabicSubstitutionA=function(x){return t[x.charCodeAt(0)]!==void 0},s=e.__arabicParser__.isArabicLetter=function(x){return typeof x=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(x)},o=e.__arabicParser__.isArabicEndLetter=function(x){return s(x)&&i(x)&&t[x.charCodeAt(0)].length<=2},l=e.__arabicParser__.isArabicAlfLetter=function(x){return s(x)&&a.indexOf(x.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(x){return s(x)&&i(x)&&t[x.charCodeAt(0)].length>=1};var c=e.__arabicParser__.arabicLetterHasFinalForm=function(x){return s(x)&&i(x)&&t[x.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(x){return s(x)&&i(x)&&t[x.charCodeAt(0)].length>=3};var u=e.__arabicParser__.arabicLetterHasMedialForm=function(x){return s(x)&&i(x)&&t[x.charCodeAt(0)].length==4},h=e.__arabicParser__.resolveLigatures=function(x){var w=0,_=r,b="",y=0;for(w=0;w<x.length;w+=1)_[x.charCodeAt(w)]!==void 0?(y++,typeof(_=_[x.charCodeAt(w)])=="number"&&(b+=String.fromCharCode(_),_=r,y=0),w===x.length-1&&(_=r,b+=x.charAt(w-(y-1)),w-=y-1,y=0)):(_=r,b+=x.charAt(w-y),w-=y,y=0);return b};e.__arabicParser__.isArabicDiacritic=function(x){return x!==void 0&&n[x.charCodeAt(0)]!==void 0};var m=e.__arabicParser__.getCorrectForm=function(x,w,_){return s(x)?i(x)===!1?-1:!c(x)||!s(w)&&!s(_)||!s(_)&&o(w)||o(x)&&!s(w)||o(x)&&l(w)||o(x)&&o(w)?0:u(x)&&s(w)&&!o(w)&&s(_)&&c(_)?3:o(x)||!s(_)?1:2:-1},f=function(x){var w=0,_=0,b=0,y="",N="",R="",P=(x=x||"").split("\\s+"),F=[];for(w=0;w<P.length;w+=1){for(F.push(""),_=0;_<P[w].length;_+=1)y=P[w][_],N=P[w][_-1],R=P[w][_+1],s(y)?(b=m(y,N,R),F[w]+=b!==-1?String.fromCharCode(t[y.charCodeAt(0)][b]):y):F[w]+=y;F[w]=h(F[w])}return F.join(" ")},v=e.__arabicParser__.processArabic=e.processArabic=function(){var x,w=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,_=[];if(Array.isArray(w)){var b=0;for(_=[],b=0;b<w.length;b+=1)Array.isArray(w[b])?_.push([f(w[b][0]),w[b][1],w[b][2]]):_.push([f(w[b])]);x=_}else x=f(w);return typeof arguments[0]=="string"?x:(arguments[0].text=x,arguments[0])};e.events.push(["preProcessText",v])}(xt.API),xt.API.autoPrint=function(e){var t;return(e=e||{}).variant=e.variant||"non-conform",e.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})),this},function(e){var t=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(o){r=o}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(o){n=isNaN(o)||Number.isInteger(o)===!1||o<0?150:o,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var a=300;Object.defineProperty(this,"height",{get:function(){return a},set:function(o){a=isNaN(o)||Number.isInteger(o)===!1||o<0?300:o,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=a+1)}});var i=[];Object.defineProperty(this,"childNodes",{get:function(){return i},set:function(o){i=o}});var s={};Object.defineProperty(this,"style",{get:function(){return s},set:function(o){s=o}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(r,n){var a;if((r=r||"2d")!=="2d")return null;for(a in n)this.pdf.context2d.hasOwnProperty(a)&&(this.pdf.context2d[a]=n[a]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])}(xt.API),function(e){var t={left:0,top:0,bottom:0,right:0},r=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),a.call(this))},a=function(){this.internal.__cell__.lastCell=new i,this.internal.__cell__.pages=1},i=function(){var l=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return l},set:function(x){l=x}});var c=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return c},set:function(x){c=x}});var u=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return u},set:function(x){u=x}});var h=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return h},set:function(x){h=x}});var m=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return m},set:function(x){m=x}});var f=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return f},set:function(x){f=x}});var v=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return v},set:function(x){v=x}}),this};i.prototype.clone=function(){return new i(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},i.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(l){return n.call(this),this.internal.__cell__.headerFunction=typeof l=="function"?l:void 0,this},e.getTextDimensions=function(l,c){n.call(this);var u=(c=c||{}).fontSize||this.getFontSize(),h=c.font||this.getFont(),m=c.scaleFactor||this.internal.scaleFactor,f=0,v=0,x=0,w=this;if(!Array.isArray(l)&&typeof l!="string"){if(typeof l!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");l=String(l)}var _=c.maxWidth;_>0?typeof l=="string"?l=this.splitTextToSize(l,_):Object.prototype.toString.call(l)==="[object Array]"&&(l=l.reduce(function(y,N){return y.concat(w.splitTextToSize(N,_))},[])):l=Array.isArray(l)?l:[l];for(var b=0;b<l.length;b++)f<(x=this.getStringUnitWidth(l[b],{font:h})*u)&&(f=x);return f!==0&&(v=l.length),{w:f/=m,h:Math.max((v*u*this.getLineHeightFactor()-u*(this.getLineHeightFactor()-1))/m,0)}},e.cellAddPage=function(){n.call(this),this.addPage();var l=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new i(l.left,l.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var s=e.cell=function(){var l;l=arguments[0]instanceof i?arguments[0]:new i(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),n.call(this);var c=this.internal.__cell__.lastCell,u=this.internal.__cell__.padding,h=this.internal.__cell__.margins||t,m=this.internal.__cell__.tableHeaderRow,f=this.internal.__cell__.printHeaders;return c.lineNumber!==void 0&&(c.lineNumber===l.lineNumber?(l.x=(c.x||0)+(c.width||0),l.y=c.y||0):c.y+c.height+l.height+h.bottom>this.getPageHeight()?(this.cellAddPage(),l.y=h.top,f&&m&&(this.printHeaderRow(l.lineNumber,!0),l.y+=m[0].height)):l.y=c.y+c.height||l.y),l.text[0]!==void 0&&(this.rect(l.x,l.y,l.width,l.height,r===!0?"FD":void 0),l.align==="right"?this.text(l.text,l.x+l.width-u,l.y+u,{align:"right",baseline:"top"}):l.align==="center"?this.text(l.text,l.x+l.width/2,l.y+u,{align:"center",baseline:"top",maxWidth:l.width-u-u}):this.text(l.text,l.x+u,l.y+u,{align:"left",baseline:"top",maxWidth:l.width-u-u})),this.internal.__cell__.lastCell=l,this};e.table=function(l,c,u,h,m){if(n.call(this),!u)throw new Error("No data for PDF table.");var f,v,x,w,_=[],b=[],y=[],N={},R={},P=[],F=[],C=(m=m||{}).autoSize||!1,A=m.printHeaders!==!1,W=m.css&&m.css["font-size"]!==void 0?16*m.css["font-size"]:m.fontSize||12,L=m.margins||Object.assign({width:this.getPageWidth()},t),I=typeof m.padding=="number"?m.padding:3,V=m.headerBackgroundColor||"#c8c8c8",Q=m.headerTextColor||"#000";if(a.call(this),this.internal.__cell__.printHeaders=A,this.internal.__cell__.margins=L,this.internal.__cell__.table_font_size=W,this.internal.__cell__.padding=I,this.internal.__cell__.headerBackgroundColor=V,this.internal.__cell__.headerTextColor=Q,this.setFontSize(W),h==null)b=_=Object.keys(u[0]),y=_.map(function(){return"left"});else if(Array.isArray(h)&&vr(h[0])==="object")for(_=h.map(function(ve){return ve.name}),b=h.map(function(ve){return ve.prompt||ve.name||""}),y=h.map(function(ve){return ve.align||"left"}),f=0;f<h.length;f+=1)R[h[f].name]=.7499990551181103*h[f].width;else Array.isArray(h)&&typeof h[0]=="string"&&(b=_=h,y=_.map(function(){return"left"}));if(C||Array.isArray(h)&&typeof h[0]=="string")for(f=0;f<_.length;f+=1){for(N[w=_[f]]=u.map(function(ve){return ve[w]}),this.setFont(void 0,"bold"),P.push(this.getTextDimensions(b[f],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),v=N[w],this.setFont(void 0,"normal"),x=0;x<v.length;x+=1)P.push(this.getTextDimensions(v[x],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);R[w]=Math.max.apply(null,P)+I+I,P=[]}if(A){var ue={};for(f=0;f<_.length;f+=1)ue[_[f]]={},ue[_[f]].text=b[f],ue[_[f]].align=y[f];var me=o.call(this,ue,R);F=_.map(function(ve){return new i(l,c,R[ve],me,ue[ve].text,void 0,ue[ve].align)}),this.setTableHeaderRow(F),this.printHeaderRow(1,!1)}var pe=h.reduce(function(ve,_e){return ve[_e.name]=_e.align,ve},{});for(f=0;f<u.length;f+=1){"rowStart"in m&&m.rowStart instanceof Function&&m.rowStart({row:f,data:u[f]},this);var oe=o.call(this,u[f],R);for(x=0;x<_.length;x+=1){var G=u[f][_[x]];"cellStart"in m&&m.cellStart instanceof Function&&m.cellStart({row:f,col:x,data:G},this),s.call(this,new i(l,c,R[_[x]],oe,G,f+2,pe[_[x]]))}}return this.internal.__cell__.table_x=l,this.internal.__cell__.table_y=c,this};var o=function(l,c){var u=this.internal.__cell__.padding,h=this.internal.__cell__.table_font_size,m=this.internal.scaleFactor;return Object.keys(l).map(function(f){var v=l[f];return this.splitTextToSize(v.hasOwnProperty("text")?v.text:v,c[f]-u-u)},this).map(function(f){return this.getLineHeightFactor()*f.length*h/m+u+u},this).reduce(function(f,v){return Math.max(f,v)},0)};e.setTableHeaderRow=function(l){n.call(this),this.internal.__cell__.tableHeaderRow=l},e.printHeaderRow=function(l,c){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var u;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var h=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new i(h[0],h[1],h[2],h[3],void 0,-1)}this.setFont(void 0,"bold");for(var m=[],f=0;f<this.internal.__cell__.tableHeaderRow.length;f+=1){u=this.internal.__cell__.tableHeaderRow[f].clone(),c&&(u.y=this.internal.__cell__.margins.top||0,m.push(u)),u.lineNumber=l;var v=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),s.call(this,u),this.setTextColor(v)}m.length>0&&this.setTableHeaderRow(m),this.setFont(void 0,"normal"),r=!1}}(xt.API);var $E={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},WE=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],Bx=zE(WE),HE=[100,200,300,400,500,600,700,800,900],OV=zE(HE);function e2(e){var t=e.family.replace(/"|'/g,"").toLowerCase(),r=function(i){return $E[i=i||"normal"]?i:"normal"}(e.style),n=function(i){return i?typeof i=="number"?i>=100&&i<=900&&i%100==0?i:400:/^\d00$/.test(i)?parseInt(i):i==="bold"?700:400:400}(e.weight),a=function(i){return typeof Bx[i=i||"normal"]=="number"?i:"normal"}(e.stretch);return{family:t,style:r,weight:n,stretch:a,src:e.src||[],ref:e.ref||{name:t,style:[a,r,n].join(" ")}}}function _b(e,t,r,n){var a;for(a=r;a>=0&&a<t.length;a+=n)if(e[t[a]])return e[t[a]];for(a=r;a>=0&&a<t.length;a-=n)if(e[t[a]])return e[t[a]]}var jV={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},wb={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function yb(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function bb(e){return e.trimLeft()}function RV(e,t){for(var r=0;r<e.length;){if(e.charAt(r)===t)return[e.substring(0,r),e.substring(r+1)];r+=1}return null}function DV(e){var t=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return t===null?null:[t[0],e.substring(t[0].length)]}var c1,kb,Sb,m0,u1,Nb,Eb,Ab,t2=["times"];function Tb(e,t,r,n,a){var i=4,s=Fb;switch(a){case xt.API.image_compression.FAST:i=1,s=Cb;break;case xt.API.image_compression.MEDIUM:i=6,s=Lb;break;case xt.API.image_compression.SLOW:i=9,s=Pb}e=function(l,c,u,h){for(var m,f=l.length/c,v=new Uint8Array(l.length+f),x=[MV,Cb,Fb,Lb,Pb],w=0;w<f;w+=1){var _=w*c,b=l.subarray(_,_+c);if(h)v.set(h(b,u,m),_+w);else{for(var y=x.length,N=[],R=0;R<y;R+=1)N[R]=x[R](b,u,m);var P=UV(N.concat());v.set(N[P],_+w)}m=b}return v}(e,t,Math.ceil(r*n/8),s);var o=Ex(e,{level:i});return xt.API.__addimage__.arrayBufferToBinaryString(o)}function MV(e){var t=Array.apply([],e);return t.unshift(0),t}function Cb(e,t){var r=e.length,n=[];n[0]=1;for(var a=0;a<r;a+=1){var i=e[a-t]||0;n[a+1]=e[a]-i+256&255}return n}function Fb(e,t,r){var n=e.length,a=[];a[0]=2;for(var i=0;i<n;i+=1){var s=r&&r[i]||0;a[i+1]=e[i]-s+256&255}return a}function Lb(e,t,r){var n=e.length,a=[];a[0]=3;for(var i=0;i<n;i+=1){var s=e[i-t]||0,o=r&&r[i]||0;a[i+1]=e[i]+256-(s+o>>>1)&255}return a}function Pb(e,t,r){var n=e.length,a=[];a[0]=4;for(var i=0;i<n;i+=1){var s=BV(e[i-t]||0,r&&r[i]||0,r&&r[i-t]||0);a[i+1]=e[i]-s+256&255}return a}function BV(e,t,r){if(e===t&&t===r)return e;var n=Math.abs(t-r),a=Math.abs(e-r),i=Math.abs(e+t-r-r);return n<=a&&n<=i?e:a<=i?t:r}function UV(e){var t=e.map(function(r){return r.reduce(function(n,a){return n+Math.abs(a)},0)});return t.indexOf(Math.min.apply(null,t))}function r2(e,t,r){var n=t*r,a=Math.floor(n/8),i=16-(n-8*a+r),s=(1<<r)-1;return VE(e,a)>>i&s}function Ib(e,t,r,n){var a=r*n,i=Math.floor(a/8),s=16-(a-8*i+n),o=(1<<n)-1,l=(t&o)<<s;(function(c,u,h){if(u+1<c.byteLength)c.setUint16(u,h,!1);else{var m=h>>8&255;c.setUint8(u,m)}})(e,i,VE(e,i)&~(o<<s)&65535|l)}function VE(e,t){return t+1<e.byteLength?e.getUint16(t,!1):e.getUint8(t)<<8}function zV(e){var t=0;if(e[t++]!==71||e[t++]!==73||e[t++]!==70||e[t++]!==56||(e[t++]+1&253)!=56||e[t++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=e[t++]|e[t++]<<8,n=e[t++]|e[t++]<<8,a=e[t++],i=a>>7,s=1<<1+(7&a);e[t++],e[t++];var o=null,l=null;i&&(o=t,l=s,t+=3*s);var c=!0,u=[],h=0,m=null,f=0,v=null;for(this.width=r,this.height=n;c&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(e[t]!==11||e[t+1]==78&&e[t+2]==69&&e[t+3]==84&&e[t+4]==83&&e[t+5]==67&&e[t+6]==65&&e[t+7]==80&&e[t+8]==69&&e[t+9]==50&&e[t+10]==46&&e[t+11]==48&&e[t+12]==3&&e[t+13]==1&&e[t+16]==0)t+=14,v=e[t++]|e[t++]<<8,t++;else for(t+=12;;){if(!((L=e[t++])>=0))throw Error("Invalid block size");if(L===0)break;t+=L}break;case 249:if(e[t++]!==4||e[t+4]!==0)throw new Error("Invalid graphics extension block.");var x=e[t++];h=e[t++]|e[t++]<<8,m=e[t++],1&x||(m=null),f=x>>2&7,t++;break;case 254:for(;;){if(!((L=e[t++])>=0))throw Error("Invalid block size");if(L===0)break;t+=L}break;default:throw new Error("Unknown graphic control label: 0x"+e[t-1].toString(16))}break;case 44:var w=e[t++]|e[t++]<<8,_=e[t++]|e[t++]<<8,b=e[t++]|e[t++]<<8,y=e[t++]|e[t++]<<8,N=e[t++],R=N>>6&1,P=1<<1+(7&N),F=o,C=l,A=!1;N>>7&&(A=!0,F=t,C=P,t+=3*P);var W=t;for(t++;;){var L;if(!((L=e[t++])>=0))throw Error("Invalid block size");if(L===0)break;t+=L}u.push({x:w,y:_,width:b,height:y,has_local_palette:A,palette_offset:F,palette_size:C,data_offset:W,data_length:t-W,transparent_index:m,interlaced:!!R,delay:h,disposal:f});break;case 59:c=!1;break;default:throw new Error("Unknown gif block: 0x"+e[t-1].toString(16))}this.numFrames=function(){return u.length},this.loopCount=function(){return v},this.frameInfo=function(I){if(I<0||I>=u.length)throw new Error("Frame index out of range.");return u[I]},this.decodeAndBlitFrameBGRA=function(I,V){var Q=this.frameInfo(I),ue=Q.width*Q.height,me=new Uint8Array(ue);Ob(e,Q.data_offset,me,ue);var pe=Q.palette_offset,oe=Q.transparent_index;oe===null&&(oe=256);var G=Q.width,ve=r-G,_e=G,E=4*(Q.y*r+Q.x),j=4*((Q.y+Q.height)*r+Q.x),O=E,B=4*ve;Q.interlaced===!0&&(B+=4*r*7);for(var Y=8,le=0,fe=me.length;le<fe;++le){var ce=me[le];if(_e===0&&(_e=G,(O+=B)>=j&&(B=4*ve+4*r*(Y-1),O=E+(G+ve)*(Y<<1),Y>>=1)),ce===oe)O+=4;else{var de=e[pe+3*ce],Ce=e[pe+3*ce+1],X=e[pe+3*ce+2];V[O++]=X,V[O++]=Ce,V[O++]=de,V[O++]=255}--_e}},this.decodeAndBlitFrameRGBA=function(I,V){var Q=this.frameInfo(I),ue=Q.width*Q.height,me=new Uint8Array(ue);Ob(e,Q.data_offset,me,ue);var pe=Q.palette_offset,oe=Q.transparent_index;oe===null&&(oe=256);var G=Q.width,ve=r-G,_e=G,E=4*(Q.y*r+Q.x),j=4*((Q.y+Q.height)*r+Q.x),O=E,B=4*ve;Q.interlaced===!0&&(B+=4*r*7);for(var Y=8,le=0,fe=me.length;le<fe;++le){var ce=me[le];if(_e===0&&(_e=G,(O+=B)>=j&&(B=4*ve+4*r*(Y-1),O=E+(G+ve)*(Y<<1),Y>>=1)),ce===oe)O+=4;else{var de=e[pe+3*ce],Ce=e[pe+3*ce+1],X=e[pe+3*ce+2];V[O++]=de,V[O++]=Ce,V[O++]=X,V[O++]=255}--_e}}}function Ob(e,t,r,n){for(var a=e[t++],i=1<<a,s=i+1,o=s+1,l=a+1,c=(1<<l)-1,u=0,h=0,m=0,f=e[t++],v=new Int32Array(4096),x=null;;){for(;u<16&&f!==0;)h|=e[t++]<<u,u+=8,f===1?f=e[t++]:--f;if(u<l)break;var w=h&c;if(h>>=l,u-=l,w!==i){if(w===s)break;for(var _=w<o?w:x,b=0,y=_;y>i;)y=v[y]>>8,++b;var N=y;if(m+b+(_!==w?1:0)>n)return void Nr.log("Warning, gif stream longer than expected.");r[m++]=N;var R=m+=b;for(_!==w&&(r[m++]=N),y=_;b--;)y=v[y],r[--R]=255&y,y>>=8;x!==null&&o<4096&&(v[o++]=x<<8|N,o>=c+1&&l<12&&(++l,c=c<<1|1)),x=w}else o=s+1,c=(1<<(l=a+1))-1,x=null}return m!==n&&Nr.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function n2(e){var t,r,n,a,i,s=Math.floor,o=new Array(64),l=new Array(64),c=new Array(64),u=new Array(64),h=new Array(65535),m=new Array(65535),f=new Array(64),v=new Array(64),x=[],w=0,_=7,b=new Array(64),y=new Array(64),N=new Array(64),R=new Array(256),P=new Array(2048),F=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],C=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],A=[0,1,2,3,4,5,6,7,8,9,10,11],W=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],L=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],I=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],V=[0,1,2,3,4,5,6,7,8,9,10,11],Q=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],ue=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function me(E,j){for(var O=0,B=0,Y=new Array,le=1;le<=16;le++){for(var fe=1;fe<=E[le];fe++)Y[j[B]]=[],Y[j[B]][0]=O,Y[j[B]][1]=le,B++,O++;O*=2}return Y}function pe(E){for(var j=E[0],O=E[1]-1;O>=0;)j&1<<O&&(w|=1<<_),O--,--_<0&&(w==255?(oe(255),oe(0)):oe(w),_=7,w=0)}function oe(E){x.push(E)}function G(E){oe(E>>8&255),oe(255&E)}function ve(E,j,O,B,Y){for(var le,fe=Y[0],ce=Y[240],de=function(Me,at){var Ye,At,ut,Ot,_t,wt,er,mt,it,qe,Ze=0;for(it=0;it<8;++it){Ye=Me[Ze],At=Me[Ze+1],ut=Me[Ze+2],Ot=Me[Ze+3],_t=Me[Ze+4],wt=Me[Ze+5],er=Me[Ze+6];var Ht=Ye+(mt=Me[Ze+7]),kt=Ye-mt,st=At+er,Lt=At-er,fr=ut+wt,yt=ut-wt,Gt=Ot+_t,Pt=Ot-_t,Br=Ht+Gt,an=Ht-Gt,hr=st+fr,St=st-fr;Me[Ze]=Br+hr,Me[Ze+4]=Br-hr;var sr=.707106781*(St+an);Me[Ze+2]=an+sr,Me[Ze+6]=an-sr;var Us=.382683433*((Br=Pt+yt)-(St=Lt+kt)),Dn=.5411961*Br+Us,Wi=1.306562965*St+Us,vi=.707106781*(hr=yt+Lt),bt=kt+vi,Hi=kt-vi;Me[Ze+5]=Hi+Dn,Me[Ze+3]=Hi-Dn,Me[Ze+1]=bt+Wi,Me[Ze+7]=bt-Wi,Ze+=8}for(Ze=0,it=0;it<8;++it){Ye=Me[Ze],At=Me[Ze+8],ut=Me[Ze+16],Ot=Me[Ze+24],_t=Me[Ze+32],wt=Me[Ze+40],er=Me[Ze+48];var Vi=Ye+(mt=Me[Ze+56]),ra=Ye-mt,Oa=At+er,Ur=At-er,vn=ut+wt,U=ut-wt,ne=Ot+_t,K=Ot-_t,Z=Vi+ne,ae=Vi-ne,se=Oa+vn,ke=Oa-vn;Me[Ze]=Z+se,Me[Ze+32]=Z-se;var Fe=.707106781*(ke+ae);Me[Ze+16]=ae+Fe,Me[Ze+48]=ae-Fe;var Se=.382683433*((Z=K+U)-(ke=Ur+ra)),Ne=.5411961*Z+Se,Te=1.306562965*ke+Se,ze=.707106781*(se=U+Ur),Ge=ra+ze,rt=ra-ze;Me[Ze+40]=rt+Ne,Me[Ze+24]=rt-Ne,Me[Ze+8]=Ge+Te,Me[Ze+56]=Ge-Te,Ze++}for(it=0;it<64;++it)qe=Me[it]*at[it],f[it]=qe>0?qe+.5|0:qe-.5|0;return f}(E,j),Ce=0;Ce<64;++Ce)v[F[Ce]]=de[Ce];var X=v[0]-O;O=v[0],X==0?pe(B[0]):(pe(B[m[le=32767+X]]),pe(h[le]));for(var $e=63;$e>0&&v[$e]==0;)$e--;if($e==0)return pe(fe),O;for(var be,ee=1;ee<=$e;){for(var et=ee;v[ee]==0&&ee<=$e;)++ee;var Re=ee-et;if(Re>=16){be=Re>>4;for(var tt=1;tt<=be;++tt)pe(ce);Re&=15}le=32767+v[ee],pe(Y[(Re<<4)+m[le]]),pe(h[le]),ee++}return $e!=63&&pe(fe),O}function _e(E){E=Math.min(Math.max(E,1),100),i!=E&&(function(j){for(var O=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],B=0;B<64;B++){var Y=s((O[B]*j+50)/100);Y=Math.min(Math.max(Y,1),255),o[F[B]]=Y}for(var le=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],fe=0;fe<64;fe++){var ce=s((le[fe]*j+50)/100);ce=Math.min(Math.max(ce,1),255),l[F[fe]]=ce}for(var de=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Ce=0,X=0;X<8;X++)for(var $e=0;$e<8;$e++)c[Ce]=1/(o[F[Ce]]*de[X]*de[$e]*8),u[Ce]=1/(l[F[Ce]]*de[X]*de[$e]*8),Ce++}(E<50?Math.floor(5e3/E):Math.floor(200-2*E)),i=E)}this.encode=function(E,j){j&&_e(j),x=new Array,w=0,_=7,G(65496),G(65504),G(16),oe(74),oe(70),oe(73),oe(70),oe(0),oe(1),oe(1),oe(0),G(1),G(1),oe(0),oe(0),function(){G(65499),G(132),oe(0);for(var At=0;At<64;At++)oe(o[At]);oe(1);for(var ut=0;ut<64;ut++)oe(l[ut])}(),function(At,ut){G(65472),G(17),oe(8),G(ut),G(At),oe(3),oe(1),oe(17),oe(0),oe(2),oe(17),oe(1),oe(3),oe(17),oe(1)}(E.width,E.height),function(){G(65476),G(418),oe(0);for(var At=0;At<16;At++)oe(C[At+1]);for(var ut=0;ut<=11;ut++)oe(A[ut]);oe(16);for(var Ot=0;Ot<16;Ot++)oe(W[Ot+1]);for(var _t=0;_t<=161;_t++)oe(L[_t]);oe(1);for(var wt=0;wt<16;wt++)oe(I[wt+1]);for(var er=0;er<=11;er++)oe(V[er]);oe(17);for(var mt=0;mt<16;mt++)oe(Q[mt+1]);for(var it=0;it<=161;it++)oe(ue[it])}(),G(65498),G(12),oe(3),oe(1),oe(0),oe(2),oe(17),oe(3),oe(17),oe(0),oe(63),oe(0);var O=0,B=0,Y=0;w=0,_=7,this.encode.displayName="_encode_";for(var le,fe,ce,de,Ce,X,$e,be,ee,et=E.data,Re=E.width,tt=E.height,Me=4*Re,at=0;at<tt;){for(le=0;le<Me;){for(Ce=Me*at+le,$e=-1,be=0,ee=0;ee<64;ee++)X=Ce+(be=ee>>3)*Me+($e=4*(7&ee)),at+be>=tt&&(X-=Me*(at+1+be-tt)),le+$e>=Me&&(X-=le+$e-Me+4),fe=et[X++],ce=et[X++],de=et[X++],b[ee]=(P[fe]+P[ce+256|0]+P[de+512|0]>>16)-128,y[ee]=(P[fe+768|0]+P[ce+1024|0]+P[de+1280|0]>>16)-128,N[ee]=(P[fe+1280|0]+P[ce+1536|0]+P[de+1792|0]>>16)-128;O=ve(b,c,O,t,n),B=ve(y,u,B,r,a),Y=ve(N,u,Y,r,a),le+=32}at+=8}if(_>=0){var Ye=[];Ye[1]=_+1,Ye[0]=(1<<_+1)-1,pe(Ye)}return G(65497),new Uint8Array(x)},e=e||50,function(){for(var E=String.fromCharCode,j=0;j<256;j++)R[j]=E(j)}(),t=me(C,A),r=me(I,V),n=me(W,L),a=me(Q,ue),function(){for(var E=1,j=2,O=1;O<=15;O++){for(var B=E;B<j;B++)m[32767+B]=O,h[32767+B]=[],h[32767+B][1]=O,h[32767+B][0]=B;for(var Y=-(j-1);Y<=-E;Y++)m[32767+Y]=O,h[32767+Y]=[],h[32767+Y][1]=O,h[32767+Y][0]=j-1+Y;E<<=1,j<<=1}}(),function(){for(var E=0;E<256;E++)P[E]=19595*E,P[E+256|0]=38470*E,P[E+512|0]=7471*E+32768,P[E+768|0]=-11059*E,P[E+1024|0]=-21709*E,P[E+1280|0]=32768*E+8421375,P[E+1536|0]=-27439*E,P[E+1792|0]=-5329*E}(),_e(e)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function Qi(e,t){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function jb(e){function t(A){if(!A)throw Error("assert :P")}function r(A,W,L){for(var I=0;4>I;I++)if(A[W+I]!=L.charCodeAt(I))return!0;return!1}function n(A,W,L,I,V){for(var Q=0;Q<V;Q++)A[W+Q]=L[I+Q]}function a(A,W,L,I){for(var V=0;V<I;V++)A[W+V]=L}function i(A){return new Int32Array(A)}function s(A,W){for(var L=[],I=0;I<A;I++)L.push(new W);return L}function o(A,W){var L=[];return function I(V,Q,ue){for(var me=ue[Q],pe=0;pe<me&&(V.push(ue.length>Q+1?[]:new W),!(ue.length<Q+1));pe++)I(V[pe],Q+1,ue)}(L,0,A),L}var l=function(){var A=this;function W(p,g){for(var S=1<<g-1>>>0;p&S;)S>>>=1;return S?(p&S-1)+S:p}function L(p,g,S,T,M){t(!(T%S));do p[g+(T-=S)]=M;while(0<T)}function I(p,g,S,T,M){if(t(2328>=M),512>=M)var z=i(512);else if((z=i(M))==null)return 0;return function(H,q,J,te,ge,Ae){var re,xe,ye=q,Pe=1<<J,Ee=i(16),Ie=i(16);for(t(ge!=0),t(te!=null),t(H!=null),t(0<J),xe=0;xe<ge;++xe){if(15<te[xe])return 0;++Ee[te[xe]]}if(Ee[0]==ge)return 0;for(Ie[1]=0,re=1;15>re;++re){if(Ee[re]>1<<re)return 0;Ie[re+1]=Ie[re]+Ee[re]}for(xe=0;xe<ge;++xe)re=te[xe],0<te[xe]&&(Ae[Ie[re]++]=xe);if(Ie[15]==1)return(te=new V).g=0,te.value=Ae[0],L(H,ye,1,Pe,te),Pe;var je,We=-1,Be=Pe-1,gt=0,lt=1,zt=1,ht=1<<J;for(xe=0,re=1,ge=2;re<=J;++re,ge<<=1){if(lt+=zt<<=1,0>(zt-=Ee[re]))return 0;for(;0<Ee[re];--Ee[re])(te=new V).g=re,te.value=Ae[xe++],L(H,ye+gt,ge,ht,te),gt=W(gt,re)}for(re=J+1,ge=2;15>=re;++re,ge<<=1){if(lt+=zt<<=1,0>(zt-=Ee[re]))return 0;for(;0<Ee[re];--Ee[re]){if(te=new V,(gt&Be)!=We){for(ye+=ht,je=1<<(We=re)-J;15>We&&!(0>=(je-=Ee[We]));)++We,je<<=1;Pe+=ht=1<<(je=We-J),H[q+(We=gt&Be)].g=je+J,H[q+We].value=ye-q-We}te.g=re-J,te.value=Ae[xe++],L(H,ye+(gt>>J),ge,ht,te),gt=W(gt,re)}}return lt!=2*Ie[15]-1?0:Pe}(p,g,S,T,M,z)}function V(){this.value=this.g=0}function Q(){this.value=this.g=0}function ue(){this.G=s(5,V),this.H=i(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=s(Kl,Q)}function me(p,g,S,T){t(p!=null),t(g!=null),t(2147483648>T),p.Ca=254,p.I=0,p.b=-8,p.Ka=0,p.oa=g,p.pa=S,p.Jd=g,p.Yc=S+T,p.Zc=4<=T?S+T-4+1:S,fe(p)}function pe(p,g){for(var S=0;0<g--;)S|=de(p,128)<<g;return S}function oe(p,g){var S=pe(p,g);return ce(p)?-S:S}function G(p,g,S,T){var M,z=0;for(t(p!=null),t(g!=null),t(4294967288>T),p.Sb=T,p.Ra=0,p.u=0,p.h=0,4<T&&(T=4),M=0;M<T;++M)z+=g[S+M]<<8*M;p.Ra=z,p.bb=T,p.oa=g,p.pa=S}function ve(p){for(;8<=p.u&&p.bb<p.Sb;)p.Ra>>>=8,p.Ra+=p.oa[p.pa+p.bb]<<Fo-8>>>0,++p.bb,p.u-=8;B(p)&&(p.h=1,p.u=0)}function _e(p,g){if(t(0<=g),!p.h&&g<=Ya){var S=O(p)&Ka[g];return p.u+=g,ve(p),S}return p.h=1,p.u=0}function E(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function j(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function O(p){return p.Ra>>>(p.u&Fo-1)>>>0}function B(p){return t(p.bb<=p.Sb),p.h||p.bb==p.Sb&&p.u>Fo}function Y(p,g){p.u=g,p.h=B(p)}function le(p){p.u>=Gs&&(t(p.u>=Gs),ve(p))}function fe(p){t(p!=null&&p.oa!=null),p.pa<p.Zc?(p.I=(p.oa[p.pa++]|p.I<<8)>>>0,p.b+=8):(t(p!=null&&p.oa!=null),p.pa<p.Yc?(p.b+=8,p.I=p.oa[p.pa++]|p.I<<8):p.Ka?p.b=0:(p.I<<=8,p.b+=8,p.Ka=1))}function ce(p){return pe(p,1)}function de(p,g){var S=p.Ca;0>p.b&&fe(p);var T=p.b,M=S*g>>>8,z=(p.I>>>T>M)+0;for(z?(S-=M,p.I-=M+1<<T>>>0):S=M+1,T=S,M=0;256<=T;)M+=8,T>>=8;return T=7^M+Lo[T],p.b-=T,p.Ca=(S<<T)-1,z}function Ce(p,g,S){p[g+0]=S>>24&255,p[g+1]=S>>16&255,p[g+2]=S>>8&255,p[g+3]=255&S}function X(p,g){return p[g+0]|p[g+1]<<8}function $e(p,g){return X(p,g)|p[g+2]<<16}function be(p,g){return X(p,g)|X(p,g+2)<<16}function ee(p,g){var S=1<<g;return t(p!=null),t(0<g),p.X=i(S),p.X==null?0:(p.Mb=32-g,p.Xa=g,1)}function et(p,g){t(p!=null),t(g!=null),t(p.Xa==g.Xa),n(g.X,0,p.X,0,1<<g.Xa)}function Re(){this.X=[],this.Xa=this.Mb=0}function tt(p,g,S,T){t(S!=null),t(T!=null);var M=S[0],z=T[0];return M==0&&(M=(p*z+g/2)/g),z==0&&(z=(g*M+p/2)/p),0>=M||0>=z?0:(S[0]=M,T[0]=z,1)}function Me(p,g){return p+(1<<g)-1>>>g}function at(p,g){return((4278255360&p)+(4278255360&g)>>>0&4278255360)+((16711935&p)+(16711935&g)>>>0&16711935)>>>0}function Ye(p,g){A[g]=function(S,T,M,z,H,q,J){var te;for(te=0;te<H;++te){var ge=A[p](q[J+te-1],M,z+te);q[J+te]=at(S[T+te],ge)}}}function At(){this.ud=this.hd=this.jd=0}function ut(p,g){return((4278124286&(p^g))>>>1)+(p&g)>>>0}function Ot(p){return 0<=p&&256>p?p:0>p?0:255<p?255:void 0}function _t(p,g){return Ot(p+(p-g+.5>>1))}function wt(p,g,S){return Math.abs(g-S)-Math.abs(p-S)}function er(p,g,S,T,M,z,H){for(T=z[H-1],S=0;S<M;++S)z[H+S]=T=at(p[g+S],T)}function mt(p,g,S,T,M){var z;for(z=0;z<S;++z){var H=p[g+z],q=H>>8&255,J=16711935&(J=(J=16711935&H)+((q<<16)+q));T[M+z]=(4278255360&H)+J>>>0}}function it(p,g){g.jd=255&p,g.hd=p>>8&255,g.ud=p>>16&255}function qe(p,g,S,T,M,z){var H;for(H=0;H<T;++H){var q=g[S+H],J=q>>>8,te=q,ge=255&(ge=(ge=q>>>16)+((p.jd<<24>>24)*(J<<24>>24)>>>5));te=255&(te=(te+=(p.hd<<24>>24)*(J<<24>>24)>>>5)+((p.ud<<24>>24)*(ge<<24>>24)>>>5)),M[z+H]=(4278255360&q)+(ge<<16)+te}}function Ze(p,g,S,T,M){A[g]=function(z,H,q,J,te,ge,Ae,re,xe){for(J=Ae;J<re;++J)for(Ae=0;Ae<xe;++Ae)te[ge++]=M(q[T(z[H++])])},A[p]=function(z,H,q,J,te,ge,Ae){var re=8>>z.b,xe=z.Ea,ye=z.K[0],Pe=z.w;if(8>re)for(z=(1<<z.b)-1,Pe=(1<<re)-1;H<q;++H){var Ee,Ie=0;for(Ee=0;Ee<xe;++Ee)Ee&z||(Ie=T(J[te++])),ge[Ae++]=M(ye[Ie&Pe]),Ie>>=re}else A["VP8LMapColor"+S](J,te,ye,Pe,ge,Ae,H,q,xe)}}function Ht(p,g,S,T,M){for(S=g+S;g<S;){var z=p[g++];T[M++]=z>>16&255,T[M++]=z>>8&255,T[M++]=255&z}}function kt(p,g,S,T,M){for(S=g+S;g<S;){var z=p[g++];T[M++]=z>>16&255,T[M++]=z>>8&255,T[M++]=255&z,T[M++]=z>>24&255}}function st(p,g,S,T,M){for(S=g+S;g<S;){var z=(H=p[g++])>>16&240|H>>12&15,H=240&H|H>>28&15;T[M++]=z,T[M++]=H}}function Lt(p,g,S,T,M){for(S=g+S;g<S;){var z=(H=p[g++])>>16&248|H>>13&7,H=H>>5&224|H>>3&31;T[M++]=z,T[M++]=H}}function fr(p,g,S,T,M){for(S=g+S;g<S;){var z=p[g++];T[M++]=255&z,T[M++]=z>>8&255,T[M++]=z>>16&255}}function yt(p,g,S,T,M,z){if(z==0)for(S=g+S;g<S;)Ce(T,((z=p[g++])[0]>>24|z[1]>>8&65280|z[2]<<8&16711680|z[3]<<24)>>>0),M+=32;else n(T,M,p,g,S)}function Gt(p,g){A[g][0]=A[p+"0"],A[g][1]=A[p+"1"],A[g][2]=A[p+"2"],A[g][3]=A[p+"3"],A[g][4]=A[p+"4"],A[g][5]=A[p+"5"],A[g][6]=A[p+"6"],A[g][7]=A[p+"7"],A[g][8]=A[p+"8"],A[g][9]=A[p+"9"],A[g][10]=A[p+"10"],A[g][11]=A[p+"11"],A[g][12]=A[p+"12"],A[g][13]=A[p+"13"],A[g][14]=A[p+"0"],A[g][15]=A[p+"0"]}function Pt(p){return p==ym||p==bm||p==hd||p==km}function Br(){this.eb=[],this.size=this.A=this.fb=0}function an(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function hr(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new Br,this.f.kb=new an,this.sd=null}function St(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function sr(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Us(p){return alert("todo:WebPSamplerProcessPlane"),p.T}function Dn(p,g){var S=p.T,T=g.ba.f.RGBA,M=T.eb,z=T.fb+p.ka*T.A,H=Si[g.ba.S],q=p.y,J=p.O,te=p.f,ge=p.N,Ae=p.ea,re=p.W,xe=g.cc,ye=g.dc,Pe=g.Mc,Ee=g.Nc,Ie=p.ka,je=p.ka+p.T,We=p.U,Be=We+1>>1;for(Ie==0?H(q,J,null,null,te,ge,Ae,re,te,ge,Ae,re,M,z,null,null,We):(H(g.ec,g.fc,q,J,xe,ye,Pe,Ee,te,ge,Ae,re,M,z-T.A,M,z,We),++S);Ie+2<je;Ie+=2)xe=te,ye=ge,Pe=Ae,Ee=re,ge+=p.Rc,re+=p.Rc,z+=2*T.A,H(q,(J+=2*p.fa)-p.fa,q,J,xe,ye,Pe,Ee,te,ge,Ae,re,M,z-T.A,M,z,We);return J+=p.fa,p.j+je<p.o?(n(g.ec,g.fc,q,J,We),n(g.cc,g.dc,te,ge,Be),n(g.Mc,g.Nc,Ae,re,Be),S--):1&je||H(q,J,null,null,te,ge,Ae,re,te,ge,Ae,re,M,z+T.A,null,null,We),S}function Wi(p,g,S){var T=p.F,M=[p.J];if(T!=null){var z=p.U,H=g.ba.S,q=H==fd||H==hd;g=g.ba.f.RGBA;var J=[0],te=p.ka;J[0]=p.T,p.Kb&&(te==0?--J[0]:(--te,M[0]-=p.width),p.j+p.ka+p.T==p.o&&(J[0]=p.o-p.j-te));var ge=g.eb;te=g.fb+te*g.A,p=K_(T,M[0],p.width,z,J,ge,te+(q?0:3),g.A),t(S==J),p&&Pt(H)&&Wu(ge,te,q,z,J,g.A)}return 0}function vi(p){var g=p.ma,S=g.ba.S,T=11>S,M=S==cd||S==ud||S==fd||S==wm||S==12||Pt(S);if(g.memory=null,g.Ib=null,g.Jb=null,g.Nd=null,!ju(g.Oa,p,M?11:12))return 0;if(M&&Pt(S)&&nd(),p.da)alert("todo:use_scaling");else{if(T){if(g.Ib=Us,p.Kb){if(S=p.U+1>>1,g.memory=i(p.U+2*S),g.memory==null)return 0;g.ec=g.memory,g.fc=0,g.cc=g.ec,g.dc=g.fc+p.U,g.Mc=g.cc,g.Nc=g.dc+S,g.Ib=Dn,nd()}}else alert("todo:EmitYUV");M&&(g.Jb=Wi,T&&wi())}if(T&&!h5){for(p=0;256>p;++p)m8[p]=89858*(p-128)+pd>>dd,v8[p]=-22014*(p-128)+pd,x8[p]=-45773*(p-128),g8[p]=113618*(p-128)+pd>>dd;for(p=Vu;p<Em;++p)g=76283*(p-16)+pd>>dd,_8[p-Vu]=Yr(g,255),w8[p-Vu]=Yr(g+8>>4,15);h5=1}return 1}function bt(p){var g=p.ma,S=p.U,T=p.T;return t(!(1&p.ka)),0>=S||0>=T?0:(S=g.Ib(p,g),g.Jb!=null&&g.Jb(p,g,S),g.Dc+=S,1)}function Hi(p){p.ma.memory=null}function Vi(p,g,S,T){return _e(p,8)!=47?0:(g[0]=_e(p,14)+1,S[0]=_e(p,14)+1,T[0]=_e(p,1),_e(p,3)!=0?0:!p.h)}function ra(p,g){if(4>p)return p+1;var S=p-2>>1;return(2+(1&p)<<S)+_e(g,S)+1}function Oa(p,g){return 120<g?g-120:1<=(S=((S=t8[g-1])>>4)*p+(8-(15&S)))?S:1;var S}function Ur(p,g,S){var T=O(S),M=p[g+=255&T].g-8;return 0<M&&(Y(S,S.u+8),T=O(S),g+=p[g].value,g+=T&(1<<M)-1),Y(S,S.u+p[g].g),p[g].value}function vn(p,g,S){return S.g+=p.g,S.value+=p.value<<g>>>0,t(8>=S.g),p.g}function U(p,g,S){var T=p.xc;return t((g=T==0?0:p.vc[p.md*(S>>T)+(g>>T)])<p.Wb),p.Ya[g]}function ne(p,g,S,T){var M=p.ab,z=p.c*g,H=p.C;g=H+g;var q=S,J=T;for(T=p.Ta,S=p.Ua;0<M--;){var te=p.gc[M],ge=H,Ae=g,re=q,xe=J,ye=(J=T,q=S,te.Ea);switch(t(ge<Ae),t(Ae<=te.nc),te.hc){case 2:on(re,xe,(Ae-ge)*ye,J,q);break;case 0:var Pe=ge,Ee=Ae,Ie=J,je=q,We=(ht=te).Ea;Pe==0&&(Du(re,xe,null,null,1,Ie,je),er(re,xe+1,0,0,We-1,Ie,je+1),xe+=We,je+=We,++Pe);for(var Be=1<<ht.b,gt=Be-1,lt=Me(We,ht.b),zt=ht.K,ht=ht.w+(Pe>>ht.b)*lt;Pe<Ee;){var Zt=zt,Tn=ht,$t=1;for(e0(re,xe,Ie,je-We,1,Ie,je);$t<We;){var dt=($t&~gt)+Be;dt>We&&(dt=We),(0,Bu[Zt[Tn++]>>8&15])(re,xe+ +$t,Ie,je+$t-We,dt-$t,Ie,je+$t),$t=dt}xe+=We,je+=We,++Pe&gt||(ht+=lt)}Ae!=te.nc&&n(J,q-ye,J,q+(Ae-ge-1)*ye,ye);break;case 1:for(ye=re,Ee=xe,We=(re=te.Ea)-(je=re&~(Ie=(xe=1<<te.b)-1)),Pe=Me(re,te.b),Be=te.K,te=te.w+(ge>>te.b)*Pe;ge<Ae;){for(gt=Be,lt=te,zt=new At,ht=Ee+je,Zt=Ee+re;Ee<ht;)it(gt[lt++],zt),Uu(zt,ye,Ee,xe,J,q),Ee+=xe,q+=xe;Ee<Zt&&(it(gt[lt++],zt),Uu(zt,ye,Ee,We,J,q),Ee+=We,q+=We),++ge&Ie||(te+=Pe)}break;case 3:if(re==J&&xe==q&&0<te.b){for(Ee=J,re=ye=q+(Ae-ge)*ye-(je=(Ae-ge)*Me(te.Ea,te.b)),xe=J,Ie=q,Pe=[],je=(We=je)-1;0<=je;--je)Pe[je]=xe[Ie+je];for(je=We-1;0<=je;--je)Ee[re+je]=Pe[je];id(te,ge,Ae,J,ye,J,q)}else id(te,ge,Ae,re,xe,J,q)}q=T,J=S}J!=S&&n(T,S,q,J,z)}function K(p,g){var S=p.V,T=p.Ba+p.c*p.C,M=g-p.C;if(t(g<=p.l.o),t(16>=M),0<M){var z=p.l,H=p.Ta,q=p.Ua,J=z.width;if(ne(p,M,S,T),M=q=[q],t((S=p.C)<(T=g)),t(z.v<z.va),T>z.o&&(T=z.o),S<z.j){var te=z.j-S;S=z.j,M[0]+=te*J}if(S>=T?S=0:(M[0]+=4*z.v,z.ka=S-z.j,z.U=z.va-z.v,z.T=T-S,S=1),S){if(q=q[0],11>(S=p.ca).S){var ge=S.f.RGBA,Ae=(T=S.S,M=z.U,z=z.T,te=ge.eb,ge.A),re=z;for(ge=ge.fb+p.Ma*ge.A;0<re--;){var xe=H,ye=q,Pe=M,Ee=te,Ie=ge;switch(T){case ld:zu(xe,ye,Pe,Ee,Ie);break;case cd:Po(xe,ye,Pe,Ee,Ie);break;case ym:Po(xe,ye,Pe,Ee,Ie),Wu(Ee,Ie,0,Pe,1,0);break;case r5:Yl(xe,ye,Pe,Ee,Ie);break;case ud:yt(xe,ye,Pe,Ee,Ie,1);break;case bm:yt(xe,ye,Pe,Ee,Ie,1),Wu(Ee,Ie,0,Pe,1,0);break;case fd:yt(xe,ye,Pe,Ee,Ie,0);break;case hd:yt(xe,ye,Pe,Ee,Ie,0),Wu(Ee,Ie,1,Pe,1,0);break;case wm:Io(xe,ye,Pe,Ee,Ie);break;case km:Io(xe,ye,Pe,Ee,Ie),X_(Ee,Ie,Pe,1,0);break;case n5:Oo(xe,ye,Pe,Ee,Ie);break;default:t(0)}q+=J,ge+=Ae}p.Ma+=z}else alert("todo:EmitRescaledRowsYUVA");t(p.Ma<=S.height)}}p.C=g,t(p.C<=p.i)}function Z(p){var g;if(0<p.ua)return 0;for(g=0;g<p.Wb;++g){var S=p.Ya[g].G,T=p.Ya[g].H;if(0<S[1][T[1]+0].g||0<S[2][T[2]+0].g||0<S[3][T[3]+0].g)return 0}return 1}function ae(p,g,S,T,M,z){if(p.Z!=0){var H=p.qd,q=p.rd;for(t(Do[p.Z]!=null);g<S;++g)Do[p.Z](H,q,T,M,T,M,z),H=T,q=M,M+=z;p.qd=H,p.rd=q}}function se(p,g){var S=p.l.ma,T=S.Z==0||S.Z==1?p.l.j:p.C;if(T=p.C<T?T:p.C,t(g<=p.l.o),g>T){var M=p.l.width,z=S.ca,H=S.tb+M*T,q=p.V,J=p.Ba+p.c*T,te=p.gc;t(p.ab==1),t(te[0].hc==3),_s(te[0],T,g,q,J,z,H),ae(S,T,g,z,H,M)}p.C=p.Ma=g}function ke(p,g,S,T,M,z,H){var q=p.$/T,J=p.$%T,te=p.m,ge=p.s,Ae=S+p.$,re=Ae;M=S+T*M;var xe=S+T*z,ye=280+ge.ua,Pe=p.Pb?q:16777216,Ee=0<ge.ua?ge.Wa:null,Ie=ge.wc,je=Ae<xe?U(ge,J,q):null;t(p.C<z),t(xe<=M);var We=!1;e:for(;;){for(;We||Ae<xe;){var Be=0;if(q>=Pe){var gt=Ae-S;t((Pe=p).Pb),Pe.wd=Pe.m,Pe.xd=gt,0<Pe.s.ua&&et(Pe.s.Wa,Pe.s.vb),Pe=q+n8}if(J&Ie||(je=U(ge,J,q)),t(je!=null),je.Qb&&(g[Ae]=je.qb,We=!0),!We)if(le(te),je.jc){Be=te,gt=g;var lt=Ae,zt=je.pd[O(Be)&Kl-1];t(je.jc),256>zt.g?(Y(Be,Be.u+zt.g),gt[lt]=zt.value,Be=0):(Y(Be,Be.u+zt.g-256),t(256<=zt.value),Be=zt.value),Be==0&&(We=!0)}else Be=Ur(je.G[0],je.H[0],te);if(te.h)break;if(We||256>Be){if(!We)if(je.nd)g[Ae]=(je.qb|Be<<8)>>>0;else{if(le(te),We=Ur(je.G[1],je.H[1],te),le(te),gt=Ur(je.G[2],je.H[2],te),lt=Ur(je.G[3],je.H[3],te),te.h)break;g[Ae]=(lt<<24|We<<16|Be<<8|gt)>>>0}if(We=!1,++Ae,++J>=T&&(J=0,++q,H!=null&&q<=z&&!(q%16)&&H(p,q),Ee!=null))for(;re<Ae;)Be=g[re++],Ee.X[(506832829*Be&4294967295)>>>Ee.Mb]=Be}else if(280>Be){if(Be=ra(Be-256,te),gt=Ur(je.G[4],je.H[4],te),le(te),gt=Oa(T,gt=ra(gt,te)),te.h)break;if(Ae-S<gt||M-Ae<Be)break e;for(lt=0;lt<Be;++lt)g[Ae+lt]=g[Ae+lt-gt];for(Ae+=Be,J+=Be;J>=T;)J-=T,++q,H!=null&&q<=z&&!(q%16)&&H(p,q);if(t(Ae<=M),J&Ie&&(je=U(ge,J,q)),Ee!=null)for(;re<Ae;)Be=g[re++],Ee.X[(506832829*Be&4294967295)>>>Ee.Mb]=Be}else{if(!(Be<ye))break e;for(We=Be-280,t(Ee!=null);re<Ae;)Be=g[re++],Ee.X[(506832829*Be&4294967295)>>>Ee.Mb]=Be;Be=Ae,t(!(We>>>(gt=Ee).Xa)),g[Be]=gt.X[We],We=!0}We||t(te.h==B(te))}if(p.Pb&&te.h&&Ae<M)t(p.m.h),p.a=5,p.m=p.wd,p.$=p.xd,0<p.s.ua&&et(p.s.vb,p.s.Wa);else{if(te.h)break e;H!=null&&H(p,q>z?z:q),p.a=0,p.$=Ae-S}return 1}return p.a=3,0}function Fe(p){t(p!=null),p.vc=null,p.yc=null,p.Ya=null;var g=p.Wa;g!=null&&(g.X=null),p.vb=null,t(p!=null)}function Se(){var p=new pt;return p==null?null:(p.a=0,p.xb=s5,Gt("Predictor","VP8LPredictors"),Gt("Predictor","VP8LPredictors_C"),Gt("PredictorAdd","VP8LPredictorsAdd"),Gt("PredictorAdd","VP8LPredictorsAdd_C"),on=mt,Uu=qe,zu=Ht,Po=kt,Io=st,Oo=Lt,Yl=fr,A.VP8LMapColor32b=vs,A.VP8LMapColor8b=Mu,p)}function Ne(p,g,S,T,M){var z=1,H=[p],q=[g],J=T.m,te=T.s,ge=null,Ae=0;e:for(;;){if(S)for(;z&&_e(J,1);){var re=H,xe=q,ye=T,Pe=1,Ee=ye.m,Ie=ye.gc[ye.ab],je=_e(Ee,2);if(ye.Oc&1<<je)z=0;else{switch(ye.Oc|=1<<je,Ie.hc=je,Ie.Ea=re[0],Ie.nc=xe[0],Ie.K=[null],++ye.ab,t(4>=ye.ab),je){case 0:case 1:Ie.b=_e(Ee,3)+2,Pe=Ne(Me(Ie.Ea,Ie.b),Me(Ie.nc,Ie.b),0,ye,Ie.K),Ie.K=Ie.K[0];break;case 3:var We,Be=_e(Ee,8)+1,gt=16<Be?0:4<Be?1:2<Be?2:3;if(re[0]=Me(Ie.Ea,gt),Ie.b=gt,We=Pe=Ne(Be,1,0,ye,Ie.K)){var lt,zt=Be,ht=Ie,Zt=1<<(8>>ht.b),Tn=i(Zt);if(Tn==null)We=0;else{var $t=ht.K[0],dt=ht.w;for(Tn[0]=ht.K[0][0],lt=1;lt<1*zt;++lt)Tn[lt]=at($t[dt+lt],Tn[lt-1]);for(;lt<4*Zt;++lt)Tn[lt]=0;ht.K[0]=null,ht.K[0]=Tn,We=1}}Pe=We;break;case 2:break;default:t(0)}z=Pe}}if(H=H[0],q=q[0],z&&_e(J,1)&&!(z=1<=(Ae=_e(J,4))&&11>=Ae)){T.a=3;break e}var Je;if(Je=z)t:{var cn,Mt,tr,Lr=T,qn=H,ba=q,Jr=Ae,ia=S,ka=Lr.m,Cn=Lr.s,rr=[null],dr=1,Zr=0,pr=r8[Jr];r:for(;;){if(ia&&_e(ka,1)){var Gn=_e(ka,3)+2,Ki=Me(qn,Gn),un=Me(ba,Gn),Ra=Ki*un;if(!Ne(Ki,un,0,Lr,rr))break r;for(rr=rr[0],Cn.xc=Gn,cn=0;cn<Ra;++cn){var Sr=rr[cn]>>8&65535;rr[cn]=Sr,Sr>=dr&&(dr=Sr+1)}}if(ka.h)break r;for(Mt=0;5>Mt;++Mt){var Fn=a5[Mt];!Mt&&0<Jr&&(Fn+=1<<Jr),Zr<Fn&&(Zr=Fn)}var Za=s(dr*pr,V),Sa=dr,Qa=s(Sa,ue);if(Qa==null)var ei=null;else t(65536>=Sa),ei=Qa;var Da=i(Zr);if(ei==null||Da==null||Za==null){Lr.a=1;break r}var ti=Za;for(cn=tr=0;cn<dr;++cn){var Tr=ei[cn],ri=Tr.G,Yi=Tr.H,Zl=0,Ys=1,Xn=0;for(Mt=0;5>Mt;++Mt){Fn=a5[Mt],ri[Mt]=ti,Yi[Mt]=tr,!Mt&&0<Jr&&(Fn+=1<<Jr);a:{var gd,Am=Fn,xd=Lr,qu=Da,k8=ti,S8=tr,Tm=0,Mo=xd.m,N8=_e(Mo,1);if(a(qu,0,0,Am),N8){var E8=_e(Mo,1)+1,A8=_e(Mo,1),m5=_e(Mo,A8==0?1:8);qu[m5]=1,E8==2&&(qu[m5=_e(Mo,8)]=1);var vd=1}else{var g5=i(19),x5=_e(Mo,4)+4;if(19<x5){xd.a=3;var _d=0;break a}for(gd=0;gd<x5;++gd)g5[e8[gd]]=_e(Mo,3);var Cm=void 0,Gu=void 0,v5=xd,T8=g5,wd=Am,_5=qu,Fm=0,Bo=v5.m,w5=8,y5=s(128,V);n:for(;I(y5,0,7,T8,19);){if(_e(Bo,1)){var C8=2+2*_e(Bo,3);if((Cm=2+_e(Bo,C8))>wd)break n}else Cm=wd;for(Gu=0;Gu<wd&&Cm--;){le(Bo);var b5=y5[0+(127&O(Bo))];Y(Bo,Bo.u+b5.g);var r0=b5.value;if(16>r0)_5[Gu++]=r0,r0!=0&&(w5=r0);else{var F8=r0==16,k5=r0-16,L8=ZE[k5],S5=_e(Bo,JE[k5])+L8;if(Gu+S5>wd)break n;for(var P8=F8?w5:0;0<S5--;)_5[Gu++]=P8}}Fm=1;break n}Fm||(v5.a=3),vd=Fm}(vd=vd&&!Mo.h)&&(Tm=I(k8,S8,8,qu,Am)),vd&&Tm!=0?_d=Tm:(xd.a=3,_d=0)}if(_d==0)break r;if(Ys&&QE[Mt]==1&&(Ys=ti[tr].g==0),Zl+=ti[tr].g,tr+=_d,3>=Mt){var Xu,Lm=Da[0];for(Xu=1;Xu<Fn;++Xu)Da[Xu]>Lm&&(Lm=Da[Xu]);Xn+=Lm}}if(Tr.nd=Ys,Tr.Qb=0,Ys&&(Tr.qb=(ri[3][Yi[3]+0].value<<24|ri[1][Yi[1]+0].value<<16|ri[2][Yi[2]+0].value)>>>0,Zl==0&&256>ri[0][Yi[0]+0].value&&(Tr.Qb=1,Tr.qb+=ri[0][Yi[0]+0].value<<8)),Tr.jc=!Tr.Qb&&6>Xn,Tr.jc){var yd,Js=Tr;for(yd=0;yd<Kl;++yd){var Uo=yd,zo=Js.pd[Uo],bd=Js.G[0][Js.H[0]+Uo];256<=bd.value?(zo.g=bd.g+256,zo.value=bd.value):(zo.g=0,zo.value=0,Uo>>=vn(bd,8,zo),Uo>>=vn(Js.G[1][Js.H[1]+Uo],16,zo),Uo>>=vn(Js.G[2][Js.H[2]+Uo],0,zo),vn(Js.G[3][Js.H[3]+Uo],24,zo))}}}Cn.vc=rr,Cn.Wb=dr,Cn.Ya=ei,Cn.yc=Za,Je=1;break t}Je=0}if(!(z=Je)){T.a=3;break e}if(0<Ae){if(te.ua=1<<Ae,!ee(te.Wa,Ae)){T.a=1,z=0;break e}}else te.ua=0;var Pm=T,N5=H,I8=q,Im=Pm.s,Om=Im.xc;if(Pm.c=N5,Pm.i=I8,Im.md=Me(N5,Om),Im.wc=Om==0?-1:(1<<Om)-1,S){T.xb=u8;break e}if((ge=i(H*q))==null){T.a=1,z=0;break e}z=(z=ke(T,ge,0,H,q,q,null))&&!J.h;break e}return z?(M!=null?M[0]=ge:(t(ge==null),t(S)),T.$=0,S||Fe(te)):Fe(te),z}function Te(p,g){var S=p.c*p.i,T=S+g+16*g;return t(p.c<=g),p.V=i(T),p.V==null?(p.Ta=null,p.Ua=0,p.a=1,0):(p.Ta=p.V,p.Ua=p.Ba+S+g,1)}function ze(p,g){var S=p.C,T=g-S,M=p.V,z=p.Ba+p.c*S;for(t(g<=p.l.o);0<T;){var H=16<T?16:T,q=p.l.ma,J=p.l.width,te=J*H,ge=q.ca,Ae=q.tb+J*S,re=p.Ta,xe=p.Ua;ne(p,H,M,z),Y_(re,xe,ge,Ae,te),ae(q,S,S+H,ge,Ae,J),T-=H,M+=H*p.c,S+=H}t(S==g),p.C=p.Ma=g}function Ge(){this.ub=this.yd=this.td=this.Rb=0}function rt(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Ve(){this.Fb=this.Bb=this.Cb=0,this.Zb=i(4),this.Lb=i(4)}function Qe(){this.Yb=function(){var p=[];return function g(S,T,M){for(var z=M[T],H=0;H<z&&(S.push(M.length>T+1?[]:0),!(M.length<T+1));H++)g(S[H],T+1,M)}(p,0,[3,11]),p}()}function Tt(){this.jb=i(3),this.Wc=o([4,8],Qe),this.Xc=o([4,17],Qe)}function yr(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new i(4),this.od=new i(4)}function Jt(){this.ld=this.La=this.dd=this.tc=0}function Kr(){this.Na=this.la=0}function ms(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function qi(){this.ad=i(384),this.Za=0,this.Ob=i(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function gs(){this.uc=this.M=this.Nb=0,this.wa=Array(new Jt),this.Y=0,this.ya=Array(new qi),this.aa=0,this.l=new na}function _i(){this.y=i(16),this.f=i(8),this.ea=i(8)}function No(){this.cb=this.a=0,this.sc="",this.m=new E,this.Od=new Ge,this.Kc=new rt,this.ed=new yr,this.Qa=new Ve,this.Ic=this.$c=this.Aa=0,this.D=new gs,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=s(8,E),this.ia=0,this.pb=s(4,ms),this.Pa=new Tt,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new _i),this.Hd=0,this.rb=Array(new Kr),this.sb=0,this.wa=Array(new Jt),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new qi),this.L=this.aa=0,this.gd=o([4,2],Jt),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function na(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function am(){var p=new No;return p!=null&&(p.a=0,p.sc="OK",p.cb=0,p.Xb=0,Hu||(Hu=zs)),p}function _n(p,g,S){return p.a==0&&(p.a=g,p.sc=S,p.cb=0),0}function Xh(p,g,S){return 3<=S&&p[g+0]==157&&p[g+1]==1&&p[g+2]==42}function Kh(p,g){if(p==null)return 0;if(p.a=0,p.sc="OK",g==null)return _n(p,2,"null VP8Io passed to VP8GetHeaders()");var S=g.data,T=g.w,M=g.ha;if(4>M)return _n(p,7,"Truncated header.");var z=S[T+0]|S[T+1]<<8|S[T+2]<<16,H=p.Od;if(H.Rb=!(1&z),H.td=z>>1&7,H.yd=z>>4&1,H.ub=z>>5,3<H.td)return _n(p,3,"Incorrect keyframe parameters.");if(!H.yd)return _n(p,4,"Frame not displayable.");T+=3,M-=3;var q=p.Kc;if(H.Rb){if(7>M)return _n(p,7,"cannot parse picture header");if(!Xh(S,T,M))return _n(p,3,"Bad code word");q.c=16383&(S[T+4]<<8|S[T+3]),q.Td=S[T+4]>>6,q.i=16383&(S[T+6]<<8|S[T+5]),q.Ud=S[T+6]>>6,T+=7,M-=7,p.za=q.c+15>>4,p.Ub=q.i+15>>4,g.width=q.c,g.height=q.i,g.Da=0,g.j=0,g.v=0,g.va=g.width,g.o=g.height,g.da=0,g.ib=g.width,g.hb=g.height,g.U=g.width,g.T=g.height,a((z=p.Pa).jb,0,255,z.jb.length),t((z=p.Qa)!=null),z.Cb=0,z.Bb=0,z.Fb=1,a(z.Zb,0,0,z.Zb.length),a(z.Lb,0,0,z.Lb)}if(H.ub>M)return _n(p,7,"bad partition length");me(z=p.m,S,T,H.ub),T+=H.ub,M-=H.ub,H.Rb&&(q.Ld=ce(z),q.Kd=ce(z)),q=p.Qa;var J,te=p.Pa;if(t(z!=null),t(q!=null),q.Cb=ce(z),q.Cb){if(q.Bb=ce(z),ce(z)){for(q.Fb=ce(z),J=0;4>J;++J)q.Zb[J]=ce(z)?oe(z,7):0;for(J=0;4>J;++J)q.Lb[J]=ce(z)?oe(z,6):0}if(q.Bb)for(J=0;3>J;++J)te.jb[J]=ce(z)?pe(z,8):255}else q.Bb=0;if(z.Ka)return _n(p,3,"cannot parse segment header");if((q=p.ed).zd=ce(z),q.Tb=pe(z,6),q.wb=pe(z,3),q.Pc=ce(z),q.Pc&&ce(z)){for(te=0;4>te;++te)ce(z)&&(q.vd[te]=oe(z,6));for(te=0;4>te;++te)ce(z)&&(q.od[te]=oe(z,6))}if(p.L=q.Tb==0?0:q.zd?1:2,z.Ka)return _n(p,3,"cannot parse filter header");var ge=M;if(M=J=T,T=J+ge,q=ge,p.Xb=(1<<pe(p.m,2))-1,ge<3*(te=p.Xb))S=7;else{for(J+=3*te,q-=3*te,ge=0;ge<te;++ge){var Ae=S[M+0]|S[M+1]<<8|S[M+2]<<16;Ae>q&&(Ae=q),me(p.Jc[+ge],S,J,Ae),J+=Ae,q-=Ae,M+=3}me(p.Jc[+te],S,J,q),S=J<T?0:5}if(S!=0)return _n(p,S,"cannot parse partitions");for(S=pe(J=p.m,7),M=ce(J)?oe(J,4):0,T=ce(J)?oe(J,4):0,q=ce(J)?oe(J,4):0,te=ce(J)?oe(J,4):0,J=ce(J)?oe(J,4):0,ge=p.Qa,Ae=0;4>Ae;++Ae){if(ge.Cb){var re=ge.Zb[Ae];ge.Fb||(re+=S)}else{if(0<Ae){p.pb[Ae]=p.pb[0];continue}re=S}var xe=p.pb[Ae];xe.Sc[0]=Sm[Yr(re+M,127)],xe.Sc[1]=Nm[Yr(re+0,127)],xe.Eb[0]=2*Sm[Yr(re+T,127)],xe.Eb[1]=101581*Nm[Yr(re+q,127)]>>16,8>xe.Eb[1]&&(xe.Eb[1]=8),xe.Qc[0]=Sm[Yr(re+te,117)],xe.Qc[1]=Nm[Yr(re+J,127)],xe.lc=re+J}if(!H.Rb)return _n(p,4,"Not a key frame.");for(ce(z),H=p.Pa,S=0;4>S;++S){for(M=0;8>M;++M)for(T=0;3>T;++T)for(q=0;11>q;++q)te=de(z,l8[S][M][T][q])?pe(z,8):s8[S][M][T][q],H.Wc[S][M].Yb[T][q]=te;for(M=0;17>M;++M)H.Xc[S][M]=H.Wc[S][c8[M]]}return p.kc=ce(z),p.kc&&(p.Bd=pe(z,8)),p.cb=1}function zs(p,g,S,T,M,z,H){var q=g[M].Yb[S];for(S=0;16>M;++M){if(!de(p,q[S+0]))return M;for(;!de(p,q[S+1]);)if(q=g[++M].Yb[0],S=0,M==16)return 16;var J=g[M+1].Yb;if(de(p,q[S+2])){var te=p,ge=0;if(de(te,(re=q)[(Ae=S)+3]))if(de(te,re[Ae+6])){for(q=0,Ae=2*(ge=de(te,re[Ae+8]))+(re=de(te,re[Ae+9+ge])),ge=0,re=a8[Ae];re[q];++q)ge+=ge+de(te,re[q]);ge+=3+(8<<Ae)}else de(te,re[Ae+7])?(ge=7+2*de(te,165),ge+=de(te,145)):ge=5+de(te,159);else ge=de(te,re[Ae+4])?3+de(te,re[Ae+5]):2;q=J[2]}else ge=1,q=J[1];J=H+i8[M],0>(te=p).b&&fe(te);var Ae,re=te.b,xe=(Ae=te.Ca>>1)-(te.I>>re)>>31;--te.b,te.Ca+=xe,te.Ca|=1,te.I-=(Ae+1&xe)<<re,z[J]=((ge^xe)-xe)*T[(0<M)+0]}return 16}function Il(p){var g=p.rb[p.sb-1];g.la=0,g.Na=0,a(p.zc,0,0,p.zc.length),p.ja=0}function Gi(p,g,S,T,M){M=p[g+S+32*T]+(M>>3),p[g+S+32*T]=-256&M?0>M?0:255:M}function Ol(p,g,S,T,M,z){Gi(p,g,0,S,T+M),Gi(p,g,1,S,T+z),Gi(p,g,2,S,T-z),Gi(p,g,3,S,T-M)}function sn(p){return(20091*p>>16)+p}function Su(p,g,S,T){var M,z=0,H=i(16);for(M=0;4>M;++M){var q=p[g+0]+p[g+8],J=p[g+0]-p[g+8],te=(35468*p[g+4]>>16)-sn(p[g+12]),ge=sn(p[g+4])+(35468*p[g+12]>>16);H[z+0]=q+ge,H[z+1]=J+te,H[z+2]=J-te,H[z+3]=q-ge,z+=4,g++}for(M=z=0;4>M;++M)q=(p=H[z+0]+4)+H[z+8],J=p-H[z+8],te=(35468*H[z+4]>>16)-sn(H[z+12]),Gi(S,T,0,0,q+(ge=sn(H[z+4])+(35468*H[z+12]>>16))),Gi(S,T,1,0,J+te),Gi(S,T,2,0,J-te),Gi(S,T,3,0,q-ge),z++,T+=32}function im(p,g,S,T){var M=p[g+0]+4,z=35468*p[g+4]>>16,H=sn(p[g+4]),q=35468*p[g+1]>>16;Ol(S,T,0,M+H,p=sn(p[g+1]),q),Ol(S,T,1,M+z,p,q),Ol(S,T,2,M-z,p,q),Ol(S,T,3,M-H,p,q)}function sm(p,g,S,T,M){Su(p,g,S,T),M&&Su(p,g+16,S,T+4)}function om(p,g,S,T){Jl(p,g+0,S,T,1),Jl(p,g+32,S,T+128,1)}function xs(p,g,S,T){var M;for(p=p[g+0]+4,M=0;4>M;++M)for(g=0;4>g;++g)Gi(S,T,g,M,p)}function Yh(p,g,S,T){p[g+0]&&ur(p,g+0,S,T),p[g+16]&&ur(p,g+16,S,T+4),p[g+32]&&ur(p,g+32,S,T+128),p[g+48]&&ur(p,g+48,S,T+128+4)}function Jh(p,g,S,T){var M,z=i(16);for(M=0;4>M;++M){var H=p[g+0+M]+p[g+12+M],q=p[g+4+M]+p[g+8+M],J=p[g+4+M]-p[g+8+M],te=p[g+0+M]-p[g+12+M];z[0+M]=H+q,z[8+M]=H-q,z[4+M]=te+J,z[12+M]=te-J}for(M=0;4>M;++M)H=(p=z[0+4*M]+3)+z[3+4*M],q=z[1+4*M]+z[2+4*M],J=z[1+4*M]-z[2+4*M],te=p-z[3+4*M],S[T+0]=H+q>>3,S[T+16]=te+J>>3,S[T+32]=H-q>>3,S[T+48]=te-J>>3,T+=64}function Eo(p,g,S){var T,M=g-32,z=Ja,H=255-p[M-1];for(T=0;T<S;++T){var q,J=z,te=H+p[g-1];for(q=0;q<S;++q)p[g+q]=J[te+p[M+q]];g+=32}}function Nu(p,g){Eo(p,g,4)}function lm(p,g){Eo(p,g,8)}function cm(p,g){Eo(p,g,16)}function um(p,g){var S;for(S=0;16>S;++S)n(p,g+32*S,p,g-32,16)}function Eu(p,g){var S;for(S=16;0<S;--S)a(p,g,p[g-1],16),g+=32}function jl(p,g,S){var T;for(T=0;16>T;++T)a(g,S+32*T,p,16)}function Ao(p,g){var S,T=16;for(S=0;16>S;++S)T+=p[g-1+32*S]+p[g+S-32];jl(T>>5,p,g)}function fm(p,g){var S,T=8;for(S=0;16>S;++S)T+=p[g-1+32*S];jl(T>>4,p,g)}function Rl(p,g){var S,T=8;for(S=0;16>S;++S)T+=p[g+S-32];jl(T>>4,p,g)}function Au(p,g){jl(128,p,g)}function jt(p,g,S){return p+2*g+S+2>>2}function hm(p,g){var S,T=g-32;for(T=new Uint8Array([jt(p[T-1],p[T+0],p[T+1]),jt(p[T+0],p[T+1],p[T+2]),jt(p[T+1],p[T+2],p[T+3]),jt(p[T+2],p[T+3],p[T+4])]),S=0;4>S;++S)n(p,g+32*S,T,0,T.length)}function dm(p,g){var S=p[g-1],T=p[g-1+32],M=p[g-1+64],z=p[g-1+96];Ce(p,g+0,16843009*jt(p[g-1-32],S,T)),Ce(p,g+32,16843009*jt(S,T,M)),Ce(p,g+64,16843009*jt(T,M,z)),Ce(p,g+96,16843009*jt(M,z,z))}function pm(p,g){var S,T=4;for(S=0;4>S;++S)T+=p[g+S-32]+p[g-1+32*S];for(T>>=3,S=0;4>S;++S)a(p,g+32*S,T,4)}function mm(p,g){var S=p[g-1+0],T=p[g-1+32],M=p[g-1+64],z=p[g-1-32],H=p[g+0-32],q=p[g+1-32],J=p[g+2-32],te=p[g+3-32];p[g+0+96]=jt(T,M,p[g-1+96]),p[g+1+96]=p[g+0+64]=jt(S,T,M),p[g+2+96]=p[g+1+64]=p[g+0+32]=jt(z,S,T),p[g+3+96]=p[g+2+64]=p[g+1+32]=p[g+0+0]=jt(H,z,S),p[g+3+64]=p[g+2+32]=p[g+1+0]=jt(q,H,z),p[g+3+32]=p[g+2+0]=jt(J,q,H),p[g+3+0]=jt(te,J,q)}function $s(p,g){var S=p[g+1-32],T=p[g+2-32],M=p[g+3-32],z=p[g+4-32],H=p[g+5-32],q=p[g+6-32],J=p[g+7-32];p[g+0+0]=jt(p[g+0-32],S,T),p[g+1+0]=p[g+0+32]=jt(S,T,M),p[g+2+0]=p[g+1+32]=p[g+0+64]=jt(T,M,z),p[g+3+0]=p[g+2+32]=p[g+1+64]=p[g+0+96]=jt(M,z,H),p[g+3+32]=p[g+2+64]=p[g+1+96]=jt(z,H,q),p[g+3+64]=p[g+2+96]=jt(H,q,J),p[g+3+96]=jt(q,J,J)}function Ws(p,g){var S=p[g-1+0],T=p[g-1+32],M=p[g-1+64],z=p[g-1-32],H=p[g+0-32],q=p[g+1-32],J=p[g+2-32],te=p[g+3-32];p[g+0+0]=p[g+1+64]=z+H+1>>1,p[g+1+0]=p[g+2+64]=H+q+1>>1,p[g+2+0]=p[g+3+64]=q+J+1>>1,p[g+3+0]=J+te+1>>1,p[g+0+96]=jt(M,T,S),p[g+0+64]=jt(T,S,z),p[g+0+32]=p[g+1+96]=jt(S,z,H),p[g+1+32]=p[g+2+96]=jt(z,H,q),p[g+2+32]=p[g+3+96]=jt(H,q,J),p[g+3+32]=jt(q,J,te)}function gm(p,g){var S=p[g+0-32],T=p[g+1-32],M=p[g+2-32],z=p[g+3-32],H=p[g+4-32],q=p[g+5-32],J=p[g+6-32],te=p[g+7-32];p[g+0+0]=S+T+1>>1,p[g+1+0]=p[g+0+64]=T+M+1>>1,p[g+2+0]=p[g+1+64]=M+z+1>>1,p[g+3+0]=p[g+2+64]=z+H+1>>1,p[g+0+32]=jt(S,T,M),p[g+1+32]=p[g+0+96]=jt(T,M,z),p[g+2+32]=p[g+1+96]=jt(M,z,H),p[g+3+32]=p[g+2+96]=jt(z,H,q),p[g+3+64]=jt(H,q,J),p[g+3+96]=jt(q,J,te)}function xm(p,g){var S=p[g-1+0],T=p[g-1+32],M=p[g-1+64],z=p[g-1+96];p[g+0+0]=S+T+1>>1,p[g+2+0]=p[g+0+32]=T+M+1>>1,p[g+2+32]=p[g+0+64]=M+z+1>>1,p[g+1+0]=jt(S,T,M),p[g+3+0]=p[g+1+32]=jt(T,M,z),p[g+3+32]=p[g+1+64]=jt(M,z,z),p[g+3+64]=p[g+2+64]=p[g+0+96]=p[g+1+96]=p[g+2+96]=p[g+3+96]=z}function Xc(p,g){var S=p[g-1+0],T=p[g-1+32],M=p[g-1+64],z=p[g-1+96],H=p[g-1-32],q=p[g+0-32],J=p[g+1-32],te=p[g+2-32];p[g+0+0]=p[g+2+32]=S+H+1>>1,p[g+0+32]=p[g+2+64]=T+S+1>>1,p[g+0+64]=p[g+2+96]=M+T+1>>1,p[g+0+96]=z+M+1>>1,p[g+3+0]=jt(q,J,te),p[g+2+0]=jt(H,q,J),p[g+1+0]=p[g+3+32]=jt(S,H,q),p[g+1+32]=p[g+3+64]=jt(T,S,H),p[g+1+64]=p[g+3+96]=jt(M,T,S),p[g+1+96]=jt(z,M,T)}function Tu(p,g){var S;for(S=0;8>S;++S)n(p,g+32*S,p,g-32,8)}function Dl(p,g){var S;for(S=0;8>S;++S)a(p,g,p[g-1],8),g+=32}function Kc(p,g,S){var T;for(T=0;8>T;++T)a(g,S+32*T,p,8)}function Yc(p,g){var S,T=8;for(S=0;8>S;++S)T+=p[g+S-32]+p[g-1+32*S];Kc(T>>4,p,g)}function vm(p,g){var S,T=4;for(S=0;8>S;++S)T+=p[g+S-32];Kc(T>>3,p,g)}function Cu(p,g){var S,T=4;for(S=0;8>S;++S)T+=p[g-1+32*S];Kc(T>>3,p,g)}function Fu(p,g){Kc(128,p,g)}function Ml(p,g,S){var T=p[g-S],M=p[g+0],z=3*(M-T)+_m[1020+p[g-2*S]-p[g+S]],H=od[112+(z+4>>3)];p[g-S]=Ja[255+T+od[112+(z+3>>3)]],p[g+0]=Ja[255+M-H]}function Bl(p,g,S,T){var M=p[g+0],z=p[g+S];return ki[255+p[g-2*S]-p[g-S]]>T||ki[255+z-M]>T}function Lu(p,g,S,T){return 4*ki[255+p[g-S]-p[g+0]]+ki[255+p[g-2*S]-p[g+S]]<=T}function Jc(p,g,S,T,M){var z=p[g-3*S],H=p[g-2*S],q=p[g-S],J=p[g+0],te=p[g+S],ge=p[g+2*S],Ae=p[g+3*S];return 4*ki[255+q-J]+ki[255+H-te]>T?0:ki[255+p[g-4*S]-z]<=M&&ki[255+z-H]<=M&&ki[255+H-q]<=M&&ki[255+Ae-ge]<=M&&ki[255+ge-te]<=M&&ki[255+te-J]<=M}function Pu(p,g,S,T){var M=2*T+1;for(T=0;16>T;++T)Lu(p,g+T,S,M)&&Ml(p,g+T,S)}function Ul(p,g,S,T){var M=2*T+1;for(T=0;16>T;++T)Lu(p,g+T*S,1,M)&&Ml(p,g+T*S,1)}function Zh(p,g,S,T){var M;for(M=3;0<M;--M)Pu(p,g+=4*S,S,T)}function Qh(p,g,S,T){var M;for(M=3;0<M;--M)Ul(p,g+=4,S,T)}function Hs(p,g,S,T,M,z,H,q){for(z=2*z+1;0<M--;){if(Jc(p,g,S,z,H))if(Bl(p,g,S,q))Ml(p,g,S);else{var J=p,te=g,ge=S,Ae=J[te-2*ge],re=J[te-ge],xe=J[te+0],ye=J[te+ge],Pe=J[te+2*ge],Ee=27*(je=_m[1020+3*(xe-re)+_m[1020+Ae-ye]])+63>>7,Ie=18*je+63>>7,je=9*je+63>>7;J[te-3*ge]=Ja[255+J[te-3*ge]+je],J[te-2*ge]=Ja[255+Ae+Ie],J[te-ge]=Ja[255+re+Ee],J[te+0]=Ja[255+xe-Ee],J[te+ge]=Ja[255+ye-Ie],J[te+2*ge]=Ja[255+Pe-je]}g+=T}}function Vs(p,g,S,T,M,z,H,q){for(z=2*z+1;0<M--;){if(Jc(p,g,S,z,H))if(Bl(p,g,S,q))Ml(p,g,S);else{var J=p,te=g,ge=S,Ae=J[te-ge],re=J[te+0],xe=J[te+ge],ye=od[112+(4+(Pe=3*(re-Ae))>>3)],Pe=od[112+(Pe+3>>3)],Ee=ye+1>>1;J[te-2*ge]=Ja[255+J[te-2*ge]+Ee],J[te-ge]=Ja[255+Ae+Pe],J[te+0]=Ja[255+re-ye],J[te+ge]=Ja[255+xe-Ee]}g+=T}}function ed(p,g,S,T,M,z){Hs(p,g,S,1,16,T,M,z)}function td(p,g,S,T,M,z){Hs(p,g,1,S,16,T,M,z)}function zl(p,g,S,T,M,z){var H;for(H=3;0<H;--H)Vs(p,g+=4*S,S,1,16,T,M,z)}function rd(p,g,S,T,M,z){var H;for(H=3;0<H;--H)Vs(p,g+=4,1,S,16,T,M,z)}function k(p,g,S,T,M,z,H,q){Hs(p,g,M,1,8,z,H,q),Hs(S,T,M,1,8,z,H,q)}function D(p,g,S,T,M,z,H,q){Hs(p,g,1,M,8,z,H,q),Hs(S,T,1,M,8,z,H,q)}function ie(p,g,S,T,M,z,H,q){Vs(p,g+4*M,M,1,8,z,H,q),Vs(S,T+4*M,M,1,8,z,H,q)}function he(p,g,S,T,M,z,H,q){Vs(p,g+4,1,M,8,z,H,q),Vs(S,T+4,1,M,8,z,H,q)}function we(){this.ba=new hr,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new sr,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Oe(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function Ue(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function ft(){this.ua=0,this.Wa=new Re,this.vb=new Re,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new ue,this.yc=new V}function pt(){this.xb=this.a=0,this.l=new na,this.ca=new hr,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new j,this.Pb=0,this.wd=new j,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new ft,this.ab=0,this.gc=s(4,Ue),this.Oc=0}function It(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new na,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function Rt(p,g,S,T,M,z,H){for(p=p==null?0:p[g+0],g=0;g<H;++g)M[z+g]=p+S[T+g]&255,p=M[z+g]}function lr(p,g,S,T,M,z,H){var q;if(p==null)Rt(null,null,S,T,M,z,H);else for(q=0;q<H;++q)M[z+q]=p[g+q]+S[T+q]&255}function Wr(p,g,S,T,M,z,H){if(p==null)Rt(null,null,S,T,M,z,H);else{var q,J=p[g+0],te=J,ge=J;for(q=0;q<H;++q)te=ge+(J=p[g+q])-te,ge=S[T+q]+(-256&te?0>te?0:255:te)&255,te=J,M[z+q]=ge}}function wn(p,g,S,T){var M=g.width,z=g.o;if(t(p!=null&&g!=null),0>S||0>=T||S+T>z)return null;if(!p.Cc){if(p.ga==null){var H;if(p.ga=new It,(H=p.ga==null)||(H=g.width*g.o,t(p.Gb.length==0),p.Gb=i(H),p.Uc=0,p.Gb==null?H=0:(p.mb=p.Gb,p.nb=p.Uc,p.rc=null,H=1),H=!H),!H){H=p.ga;var q=p.Fa,J=p.P,te=p.qc,ge=p.mb,Ae=p.nb,re=J+1,xe=te-1,ye=H.l;if(t(q!=null&&ge!=null&&g!=null),Do[0]=null,Do[1]=Rt,Do[2]=lr,Do[3]=Wr,H.ca=ge,H.tb=Ae,H.c=g.width,H.i=g.height,t(0<H.c&&0<H.i),1>=te)g=0;else if(H.$a=3&q[J+0],H.Z=q[J+0]>>2&3,H.Lc=q[J+0]>>4&3,J=q[J+0]>>6&3,0>H.$a||1<H.$a||4<=H.Z||1<H.Lc||J)g=0;else if(ye.put=bt,ye.ac=vi,ye.bc=Hi,ye.ma=H,ye.width=g.width,ye.height=g.height,ye.Da=g.Da,ye.v=g.v,ye.va=g.va,ye.j=g.j,ye.o=g.o,H.$a)e:{t(H.$a==1),g=Se();t:for(;;){if(g==null){g=0;break e}if(t(H!=null),H.mc=g,g.c=H.c,g.i=H.i,g.l=H.l,g.l.ma=H,g.l.width=H.c,g.l.height=H.i,g.a=0,G(g.m,q,re,xe),!Ne(H.c,H.i,1,g,null)||(g.ab==1&&g.gc[0].hc==3&&Z(g.s)?(H.ic=1,q=g.c*g.i,g.Ta=null,g.Ua=0,g.V=i(q),g.Ba=0,g.V==null?(g.a=1,g=0):g=1):(H.ic=0,g=Te(g,H.c)),!g))break t;g=1;break e}H.mc=null,g=0}else g=xe>=H.c*H.i;H=!g}if(H)return null;p.ga.Lc!=1?p.Ga=0:T=z-S}t(p.ga!=null),t(S+T<=z);e:{if(g=(q=p.ga).c,z=q.l.o,q.$a==0){if(re=p.rc,xe=p.Vc,ye=p.Fa,J=p.P+1+S*g,te=p.mb,ge=p.nb+S*g,t(J<=p.P+p.qc),q.Z!=0)for(t(Do[q.Z]!=null),H=0;H<T;++H)Do[q.Z](re,xe,ye,J,te,ge,g),re=te,xe=ge,ge+=g,J+=g;else for(H=0;H<T;++H)n(te,ge,ye,J,g),re=te,xe=ge,ge+=g,J+=g;p.rc=re,p.Vc=xe}else{if(t(q.mc!=null),g=S+T,t((H=q.mc)!=null),t(g<=H.i),H.C>=g)g=1;else if(q.ic||wi(),q.ic){q=H.V,re=H.Ba,xe=H.c;var Pe=H.i,Ee=(ye=1,J=H.$/xe,te=H.$%xe,ge=H.m,Ae=H.s,H.$),Ie=xe*Pe,je=xe*g,We=Ae.wc,Be=Ee<je?U(Ae,te,J):null;t(Ee<=Ie),t(g<=Pe),t(Z(Ae));t:for(;;){for(;!ge.h&&Ee<je;){if(te&We||(Be=U(Ae,te,J)),t(Be!=null),le(ge),256>(Pe=Ur(Be.G[0],Be.H[0],ge)))q[re+Ee]=Pe,++Ee,++te>=xe&&(te=0,++J<=g&&!(J%16)&&se(H,J));else{if(!(280>Pe)){ye=0;break t}Pe=ra(Pe-256,ge);var gt,lt=Ur(Be.G[4],Be.H[4],ge);if(le(ge),!(Ee>=(lt=Oa(xe,lt=ra(lt,ge)))&&Ie-Ee>=Pe)){ye=0;break t}for(gt=0;gt<Pe;++gt)q[re+Ee+gt]=q[re+Ee+gt-lt];for(Ee+=Pe,te+=Pe;te>=xe;)te-=xe,++J<=g&&!(J%16)&&se(H,J);Ee<je&&te&We&&(Be=U(Ae,te,J))}t(ge.h==B(ge))}se(H,J>g?g:J);break t}!ye||ge.h&&Ee<Ie?(ye=0,H.a=ge.h?5:3):H.$=Ee,g=ye}else g=ke(H,H.V,H.Ba,H.c,H.i,g,ze);if(!g){T=0;break e}}S+T>=z&&(p.Cc=1),T=1}if(!T)return null;if(p.Cc&&((T=p.ga)!=null&&(T.mc=null),p.ga=null,0<p.Ga))return alert("todo:WebPDequantizeLevels"),null}return p.nb+S*M}function Ar(p,g,S,T,M,z){for(;0<M--;){var H,q=p,J=g+(S?1:0),te=p,ge=g+(S?0:3);for(H=0;H<T;++H){var Ae=te[ge+4*H];Ae!=255&&(Ae*=32897,q[J+4*H+0]=q[J+4*H+0]*Ae>>23,q[J+4*H+1]=q[J+4*H+1]*Ae>>23,q[J+4*H+2]=q[J+4*H+2]*Ae>>23)}g+=z}}function En(p,g,S,T,M){for(;0<T--;){var z;for(z=0;z<S;++z){var H=p[g+2*z+0],q=15&(te=p[g+2*z+1]),J=4369*q,te=(240&te|te>>4)*J>>16;p[g+2*z+0]=(240&H|H>>4)*J>>16&240|(15&H|H<<4)*J>>16>>4&15,p[g+2*z+1]=240&te|q}g+=M}}function yn(p,g,S,T,M,z,H,q){var J,te,ge=255;for(te=0;te<M;++te){for(J=0;J<T;++J){var Ae=p[g+J];z[H+4*J]=Ae,ge&=Ae}g+=S,H+=q}return ge!=255}function Vn(p,g,S,T,M){var z;for(z=0;z<M;++z)S[T+z]=p[g+z]>>8}function wi(){Wu=Ar,X_=En,K_=yn,Y_=Vn}function ja(p,g,S){A[p]=function(T,M,z,H,q,J,te,ge,Ae,re,xe,ye,Pe,Ee,Ie,je,We){var Be,gt=We-1>>1,lt=q[J+0]|te[ge+0]<<16,zt=Ae[re+0]|xe[ye+0]<<16;t(T!=null);var ht=3*lt+zt+131074>>2;for(g(T[M+0],255&ht,ht>>16,Pe,Ee),z!=null&&(ht=3*zt+lt+131074>>2,g(z[H+0],255&ht,ht>>16,Ie,je)),Be=1;Be<=gt;++Be){var Zt=q[J+Be]|te[ge+Be]<<16,Tn=Ae[re+Be]|xe[ye+Be]<<16,$t=lt+Zt+zt+Tn+524296,dt=$t+2*(Zt+zt)>>3;ht=dt+lt>>1,lt=($t=$t+2*(lt+Tn)>>3)+Zt>>1,g(T[M+2*Be-1],255&ht,ht>>16,Pe,Ee+(2*Be-1)*S),g(T[M+2*Be-0],255&lt,lt>>16,Pe,Ee+(2*Be-0)*S),z!=null&&(ht=$t+zt>>1,lt=dt+Tn>>1,g(z[H+2*Be-1],255&ht,ht>>16,Ie,je+(2*Be-1)*S),g(z[H+2*Be+0],255&lt,lt>>16,Ie,je+(2*Be+0)*S)),lt=Zt,zt=Tn}1&We||(ht=3*lt+zt+131074>>2,g(T[M+We-1],255&ht,ht>>16,Pe,Ee+(We-1)*S),z!=null&&(ht=3*zt+lt+131074>>2,g(z[H+We-1],255&ht,ht>>16,Ie,je+(We-1)*S)))}}function nd(){Si[ld]=f8,Si[cd]=o5,Si[r5]=h8,Si[ud]=l5,Si[fd]=c5,Si[wm]=u5,Si[n5]=d8,Si[ym]=o5,Si[bm]=l5,Si[hd]=c5,Si[km]=u5}function Zc(p){return p&~p8?0>p?0:255:p>>f5}function $l(p,g){return Zc((19077*p>>8)+(26149*g>>8)-14234)}function To(p,g,S){return Zc((19077*p>>8)-(6419*g>>8)-(13320*S>>8)+8708)}function Wl(p,g){return Zc((19077*p>>8)+(33050*g>>8)-17685)}function Hl(p,g,S,T,M){T[M+0]=$l(p,S),T[M+1]=To(p,g,S),T[M+2]=Wl(p,g)}function Vl(p,g,S,T,M){T[M+0]=Wl(p,g),T[M+1]=To(p,g,S),T[M+2]=$l(p,S)}function aa(p,g,S,T,M){var z=To(p,g,S);g=z<<3&224|Wl(p,g)>>3,T[M+0]=248&$l(p,S)|z>>5,T[M+1]=g}function ql(p,g,S,T,M){var z=240&Wl(p,g)|15;T[M+0]=240&$l(p,S)|To(p,g,S)>>4,T[M+1]=z}function Gl(p,g,S,T,M){T[M+0]=255,Hl(p,g,S,T,M+1)}function Iu(p,g,S,T,M){Vl(p,g,S,T,M),T[M+3]=255}function Ou(p,g,S,T,M){Hl(p,g,S,T,M),T[M+3]=255}function Yr(p,g){return 0>p?0:p>g?g:p}function qs(p,g,S){A[p]=function(T,M,z,H,q,J,te,ge,Ae){for(var re=ge+(-2&Ae)*S;ge!=re;)g(T[M+0],z[H+0],q[J+0],te,ge),g(T[M+1],z[H+0],q[J+0],te,ge+S),M+=2,++H,++J,ge+=2*S;1&Ae&&g(T[M+0],z[H+0],q[J+0],te,ge)}}function Qc(p,g,S){return S==0?p==0?g==0?6:5:g==0?4:0:S}function ad(p,g,S,T,M){switch(p>>>30){case 3:Jl(g,S,T,M,0);break;case 2:bi(g,S,T,M);break;case 1:ur(g,S,T,M)}}function yi(p,g){var S,T,M=g.M,z=g.Nb,H=p.oc,q=p.pc+40,J=p.oc,te=p.pc+584,ge=p.oc,Ae=p.pc+600;for(S=0;16>S;++S)H[q+32*S-1]=129;for(S=0;8>S;++S)J[te+32*S-1]=129,ge[Ae+32*S-1]=129;for(0<M?H[q-1-32]=J[te-1-32]=ge[Ae-1-32]=129:(a(H,q-32-1,127,21),a(J,te-32-1,127,9),a(ge,Ae-32-1,127,9)),T=0;T<p.za;++T){var re=g.ya[g.aa+T];if(0<T){for(S=-1;16>S;++S)n(H,q+32*S-4,H,q+32*S+12,4);for(S=-1;8>S;++S)n(J,te+32*S-4,J,te+32*S+4,4),n(ge,Ae+32*S-4,ge,Ae+32*S+4,4)}var xe=p.Gd,ye=p.Hd+T,Pe=re.ad,Ee=re.Hc;if(0<M&&(n(H,q-32,xe[ye].y,0,16),n(J,te-32,xe[ye].f,0,8),n(ge,Ae-32,xe[ye].ea,0,8)),re.Za){var Ie=H,je=q-32+16;for(0<M&&(T>=p.za-1?a(Ie,je,xe[ye].y[15],4):n(Ie,je,xe[ye+1].y,0,4)),S=0;4>S;S++)Ie[je+128+S]=Ie[je+256+S]=Ie[je+384+S]=Ie[je+0+S];for(S=0;16>S;++S,Ee<<=2)Ie=H,je=q+d5[S],Xi[re.Ob[S]](Ie,je),ad(Ee,Pe,16*+S,Ie,je)}else if(Ie=Qc(T,M,re.Ob[0]),Ro[Ie](H,q),Ee!=0)for(S=0;16>S;++S,Ee<<=2)ad(Ee,Pe,16*+S,H,q+d5[S]);for(S=re.Gc,Ie=Qc(T,M,re.Dd),Ks[Ie](J,te),Ks[Ie](ge,Ae),Ee=Pe,Ie=J,je=te,255&(re=0|S)&&(170&re?ws(Ee,256,Ie,je):kr(Ee,256,Ie,je)),re=ge,Ee=Ae,255&(S>>=8)&&(170&S?ws(Pe,320,re,Ee):kr(Pe,320,re,Ee)),M<p.Ub-1&&(n(xe[ye].y,0,H,q+480,16),n(xe[ye].f,0,J,te+224,8),n(xe[ye].ea,0,ge,Ae+224,8)),S=8*z*p.B,xe=p.sa,ye=p.ta+16*T+16*z*p.R,Pe=p.qa,re=p.ra+8*T+S,Ee=p.Ha,Ie=p.Ia+8*T+S,S=0;16>S;++S)n(xe,ye+S*p.R,H,q+32*S,16);for(S=0;8>S;++S)n(Pe,re+S*p.B,J,te+32*S,8),n(Ee,Ie+S*p.B,ge,Ae+32*S,8)}}function Xl(p,g,S,T,M,z,H,q,J){var te=[0],ge=[0],Ae=0,re=J!=null?J.kd:0,xe=J??new Oe;if(p==null||12>S)return 7;xe.data=p,xe.w=g,xe.ha=S,g=[g],S=[S],xe.gb=[xe.gb];e:{var ye=g,Pe=S,Ee=xe.gb;if(t(p!=null),t(Pe!=null),t(Ee!=null),Ee[0]=0,12<=Pe[0]&&!r(p,ye[0],"RIFF")){if(r(p,ye[0]+8,"WEBP")){Ee=3;break e}var Ie=be(p,ye[0]+4);if(12>Ie||4294967286<Ie){Ee=3;break e}if(re&&Ie>Pe[0]-8){Ee=7;break e}Ee[0]=Ie,ye[0]+=12,Pe[0]-=12}Ee=0}if(Ee!=0)return Ee;for(Ie=0<xe.gb[0],S=S[0];;){e:{var je=p;Pe=g,Ee=S;var We=te,Be=ge,gt=ye=[0];if((ht=Ae=[Ae])[0]=0,8>Ee[0])Ee=7;else{if(!r(je,Pe[0],"VP8X")){if(be(je,Pe[0]+4)!=10){Ee=3;break e}if(18>Ee[0]){Ee=7;break e}var lt=be(je,Pe[0]+8),zt=1+$e(je,Pe[0]+12);if(2147483648<=zt*(je=1+$e(je,Pe[0]+15))){Ee=3;break e}gt!=null&&(gt[0]=lt),We!=null&&(We[0]=zt),Be!=null&&(Be[0]=je),Pe[0]+=18,Ee[0]-=18,ht[0]=1}Ee=0}}if(Ae=Ae[0],ye=ye[0],Ee!=0)return Ee;if(Pe=!!(2&ye),!Ie&&Ae)return 3;if(z!=null&&(z[0]=!!(16&ye)),H!=null&&(H[0]=Pe),q!=null&&(q[0]=0),H=te[0],ye=ge[0],Ae&&Pe&&J==null){Ee=0;break}if(4>S){Ee=7;break}if(Ie&&Ae||!Ie&&!Ae&&!r(p,g[0],"ALPH")){S=[S],xe.na=[xe.na],xe.P=[xe.P],xe.Sa=[xe.Sa];e:{lt=p,Ee=g,Ie=S;var ht=xe.gb;We=xe.na,Be=xe.P,gt=xe.Sa,zt=22,t(lt!=null),t(Ie!=null),je=Ee[0];var Zt=Ie[0];for(t(We!=null),t(gt!=null),We[0]=null,Be[0]=null,gt[0]=0;;){if(Ee[0]=je,Ie[0]=Zt,8>Zt){Ee=7;break e}var Tn=be(lt,je+4);if(4294967286<Tn){Ee=3;break e}var $t=8+Tn+1&-2;if(zt+=$t,0<ht&&zt>ht){Ee=3;break e}if(!r(lt,je,"VP8 ")||!r(lt,je,"VP8L")){Ee=0;break e}if(Zt[0]<$t){Ee=7;break e}r(lt,je,"ALPH")||(We[0]=lt,Be[0]=je+8,gt[0]=Tn),je+=$t,Zt-=$t}}if(S=S[0],xe.na=xe.na[0],xe.P=xe.P[0],xe.Sa=xe.Sa[0],Ee!=0)break}S=[S],xe.Ja=[xe.Ja],xe.xa=[xe.xa];e:if(ht=p,Ee=g,Ie=S,We=xe.gb[0],Be=xe.Ja,gt=xe.xa,lt=Ee[0],je=!r(ht,lt,"VP8 "),zt=!r(ht,lt,"VP8L"),t(ht!=null),t(Ie!=null),t(Be!=null),t(gt!=null),8>Ie[0])Ee=7;else{if(je||zt){if(ht=be(ht,lt+4),12<=We&&ht>We-12){Ee=3;break e}if(re&&ht>Ie[0]-8){Ee=7;break e}Be[0]=ht,Ee[0]+=8,Ie[0]-=8,gt[0]=zt}else gt[0]=5<=Ie[0]&&ht[lt+0]==47&&!(ht[lt+4]>>5),Be[0]=Ie[0];Ee=0}if(S=S[0],xe.Ja=xe.Ja[0],xe.xa=xe.xa[0],g=g[0],Ee!=0)break;if(4294967286<xe.Ja)return 3;if(q==null||Pe||(q[0]=xe.xa?2:1),H=[H],ye=[ye],xe.xa){if(5>S){Ee=7;break}q=H,re=ye,Pe=z,p==null||5>S?p=0:5<=S&&p[g+0]==47&&!(p[g+4]>>5)?(Ie=[0],ht=[0],We=[0],G(Be=new j,p,g,S),Vi(Be,Ie,ht,We)?(q!=null&&(q[0]=Ie[0]),re!=null&&(re[0]=ht[0]),Pe!=null&&(Pe[0]=We[0]),p=1):p=0):p=0}else{if(10>S){Ee=7;break}q=ye,p==null||10>S||!Xh(p,g+3,S-3)?p=0:(re=p[g+0]|p[g+1]<<8|p[g+2]<<16,Pe=16383&(p[g+7]<<8|p[g+6]),p=16383&(p[g+9]<<8|p[g+8]),1&re||3<(re>>1&7)||!(re>>4&1)||re>>5>=xe.Ja||!Pe||!p?p=0:(H&&(H[0]=Pe),q&&(q[0]=p),p=1))}if(!p||(H=H[0],ye=ye[0],Ae&&(te[0]!=H||ge[0]!=ye)))return 3;J!=null&&(J[0]=xe,J.offset=g-J.w,t(4294967286>g-J.w),t(J.offset==J.ha-S));break}return Ee==0||Ee==7&&Ae&&J==null?(z!=null&&(z[0]|=xe.na!=null&&0<xe.na.length),T!=null&&(T[0]=H),M!=null&&(M[0]=ye),0):Ee}function ju(p,g,S){var T=g.width,M=g.height,z=0,H=0,q=T,J=M;if(g.Da=p!=null&&0<p.Da,g.Da&&(q=p.cd,J=p.bd,z=p.v,H=p.j,11>S||(z&=-2,H&=-2),0>z||0>H||0>=q||0>=J||z+q>T||H+J>M))return 0;if(g.v=z,g.j=H,g.va=z+q,g.o=H+J,g.U=q,g.T=J,g.da=p!=null&&0<p.da,g.da){if(!tt(q,J,S=[p.ib],z=[p.hb]))return 0;g.ib=S[0],g.hb=z[0]}return g.ob=p!=null&&p.ob,g.Kb=p==null||!p.Sd,g.da&&(g.ob=g.ib<3*T/4&&g.hb<3*M/4,g.Kb=0),1}function Ru(p){if(p==null)return 2;if(11>p.S){var g=p.f.RGBA;g.fb+=(p.height-1)*g.A,g.A=-g.A}else g=p.f.kb,p=p.height,g.O+=(p-1)*g.fa,g.fa=-g.fa,g.N+=(p-1>>1)*g.Ab,g.Ab=-g.Ab,g.W+=(p-1>>1)*g.Db,g.Db=-g.Db,g.F!=null&&(g.J+=(p-1)*g.lb,g.lb=-g.lb);return 0}function Co(p,g,S,T){if(T==null||0>=p||0>=g)return 2;if(S!=null){if(S.Da){var M=S.cd,z=S.bd,H=-2&S.v,q=-2&S.j;if(0>H||0>q||0>=M||0>=z||H+M>p||q+z>g)return 2;p=M,g=z}if(S.da){if(!tt(p,g,M=[S.ib],z=[S.hb]))return 2;p=M[0],g=z[0]}}T.width=p,T.height=g;e:{var J=T.width,te=T.height;if(p=T.S,0>=J||0>=te||!(p>=ld&&13>p))p=2;else{if(0>=T.Rd&&T.sd==null){H=z=M=g=0;var ge=(q=J*p5[p])*te;if(11>p||(z=(te+1)/2*(g=(J+1)/2),p==12&&(H=(M=J)*te)),(te=i(ge+2*z+H))==null){p=1;break e}T.sd=te,11>p?((J=T.f.RGBA).eb=te,J.fb=0,J.A=q,J.size=ge):((J=T.f.kb).y=te,J.O=0,J.fa=q,J.Fd=ge,J.f=te,J.N=0+ge,J.Ab=g,J.Cd=z,J.ea=te,J.W=0+ge+z,J.Db=g,J.Ed=z,p==12&&(J.F=te,J.J=0+ge+2*z),J.Tc=H,J.lb=M)}if(g=1,M=T.S,z=T.width,H=T.height,M>=ld&&13>M)if(11>M)p=T.f.RGBA,g&=(q=Math.abs(p.A))*(H-1)+z<=p.size,g&=q>=z*p5[M],g&=p.eb!=null;else{p=T.f.kb,q=(z+1)/2,ge=(H+1)/2,J=Math.abs(p.fa),te=Math.abs(p.Ab);var Ae=Math.abs(p.Db),re=Math.abs(p.lb),xe=re*(H-1)+z;g&=J*(H-1)+z<=p.Fd,g&=te*(ge-1)+q<=p.Cd,g=(g&=Ae*(ge-1)+q<=p.Ed)&J>=z&te>=q&Ae>=q,g&=p.y!=null,g&=p.f!=null,g&=p.ea!=null,M==12&&(g&=re>=z,g&=xe<=p.Tc,g&=p.F!=null)}else g=0;p=g?0:2}}return p!=0||S!=null&&S.fd&&(p=Ru(T)),p}var Kl=64,Ka=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Ya=24,Fo=32,Gs=8,Lo=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];Ye("Predictor0","PredictorAdd0"),A.Predictor0=function(){return 4278190080},A.Predictor1=function(p){return p},A.Predictor2=function(p,g,S){return g[S+0]},A.Predictor3=function(p,g,S){return g[S+1]},A.Predictor4=function(p,g,S){return g[S-1]},A.Predictor5=function(p,g,S){return ut(ut(p,g[S+1]),g[S+0])},A.Predictor6=function(p,g,S){return ut(p,g[S-1])},A.Predictor7=function(p,g,S){return ut(p,g[S+0])},A.Predictor8=function(p,g,S){return ut(g[S-1],g[S+0])},A.Predictor9=function(p,g,S){return ut(g[S+0],g[S+1])},A.Predictor10=function(p,g,S){return ut(ut(p,g[S-1]),ut(g[S+0],g[S+1]))},A.Predictor11=function(p,g,S){var T=g[S+0];return 0>=wt(T>>24&255,p>>24&255,(g=g[S-1])>>24&255)+wt(T>>16&255,p>>16&255,g>>16&255)+wt(T>>8&255,p>>8&255,g>>8&255)+wt(255&T,255&p,255&g)?T:p},A.Predictor12=function(p,g,S){var T=g[S+0];return(Ot((p>>24&255)+(T>>24&255)-((g=g[S-1])>>24&255))<<24|Ot((p>>16&255)+(T>>16&255)-(g>>16&255))<<16|Ot((p>>8&255)+(T>>8&255)-(g>>8&255))<<8|Ot((255&p)+(255&T)-(255&g)))>>>0},A.Predictor13=function(p,g,S){var T=g[S-1];return(_t((p=ut(p,g[S+0]))>>24&255,T>>24&255)<<24|_t(p>>16&255,T>>16&255)<<16|_t(p>>8&255,T>>8&255)<<8|_t(255&p,255&T))>>>0};var Du=A.PredictorAdd0;A.PredictorAdd1=er,Ye("Predictor2","PredictorAdd2"),Ye("Predictor3","PredictorAdd3"),Ye("Predictor4","PredictorAdd4"),Ye("Predictor5","PredictorAdd5"),Ye("Predictor6","PredictorAdd6"),Ye("Predictor7","PredictorAdd7"),Ye("Predictor8","PredictorAdd8"),Ye("Predictor9","PredictorAdd9"),Ye("Predictor10","PredictorAdd10"),Ye("Predictor11","PredictorAdd11"),Ye("Predictor12","PredictorAdd12"),Ye("Predictor13","PredictorAdd13");var e0=A.PredictorAdd2;Ze("ColorIndexInverseTransform","MapARGB","32b",function(p){return p>>8&255},function(p){return p}),Ze("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(p){return p},function(p){return p>>8&255});var on,id=A.ColorIndexInverseTransform,vs=A.MapARGB,_s=A.VP8LColorIndexInverseTransformAlpha,Mu=A.MapAlpha,Bu=A.VP8LPredictorsAdd=[];Bu.length=16,(A.VP8LPredictors=[]).length=16,(A.VP8LPredictorsAdd_C=[]).length=16,(A.VP8LPredictors_C=[]).length=16;var Uu,zu,Po,Io,Oo,Yl,jo,Jl,bi,ws,ur,kr,ln,An,Xs,$u,t0,sd,$_,W_,H_,V_,q_,G_,Wu,X_,K_,Y_,J_=i(511),Z_=i(2041),Q_=i(225),e5=i(767),t5=0,_m=Z_,od=Q_,Ja=e5,ki=J_,ld=0,cd=1,r5=2,ud=3,fd=4,wm=5,n5=6,ym=7,bm=8,hd=9,km=10,JE=[2,3,7],ZE=[3,3,11],a5=[280,256,256,256,40],QE=[0,1,1,1,0],e8=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],t8=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],r8=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],n8=8,Sm=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Nm=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Hu=null,a8=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],i8=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],i5=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],s8=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],o8=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],l8=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],c8=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Ro=[],Xi=[],Ks=[],u8=1,s5=2,Do=[],Si=[];ja("UpsampleRgbLinePair",Hl,3),ja("UpsampleBgrLinePair",Vl,3),ja("UpsampleRgbaLinePair",Ou,4),ja("UpsampleBgraLinePair",Iu,4),ja("UpsampleArgbLinePair",Gl,4),ja("UpsampleRgba4444LinePair",ql,2),ja("UpsampleRgb565LinePair",aa,2);var f8=A.UpsampleRgbLinePair,h8=A.UpsampleBgrLinePair,o5=A.UpsampleRgbaLinePair,l5=A.UpsampleBgraLinePair,c5=A.UpsampleArgbLinePair,u5=A.UpsampleRgba4444LinePair,d8=A.UpsampleRgb565LinePair,dd=16,pd=1<<dd-1,Vu=-227,Em=482,f5=6,p8=(256<<f5)-1,h5=0,m8=i(256),g8=i(256),x8=i(256),v8=i(256),_8=i(Em-Vu),w8=i(Em-Vu);qs("YuvToRgbRow",Hl,3),qs("YuvToBgrRow",Vl,3),qs("YuvToRgbaRow",Ou,4),qs("YuvToBgraRow",Iu,4),qs("YuvToArgbRow",Gl,4),qs("YuvToRgba4444Row",ql,2),qs("YuvToRgb565Row",aa,2);var d5=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],md=[0,2,8],y8=[8,7,6,4,4,2,2,2,1,1,1,1],b8=1;this.WebPDecodeRGBA=function(p,g,S,T,M){var z=cd,H=new we,q=new hr;H.ba=q,q.S=z,q.width=[q.width],q.height=[q.height];var J=q.width,te=q.height,ge=new St;if(ge==null||p==null)var Ae=2;else t(ge!=null),Ae=Xl(p,g,S,ge.width,ge.height,ge.Pd,ge.Qd,ge.format,null);if(Ae!=0?J=0:(J!=null&&(J[0]=ge.width[0]),te!=null&&(te[0]=ge.height[0]),J=1),J){q.width=q.width[0],q.height=q.height[0],T!=null&&(T[0]=q.width),M!=null&&(M[0]=q.height);e:{if(T=new na,(M=new Oe).data=p,M.w=g,M.ha=S,M.kd=1,g=[0],t(M!=null),((p=Xl(M.data,M.w,M.ha,null,null,null,g,null,M))==0||p==7)&&g[0]&&(p=4),(g=p)==0){if(t(H!=null),T.data=M.data,T.w=M.w+M.offset,T.ha=M.ha-M.offset,T.put=bt,T.ac=vi,T.bc=Hi,T.ma=H,M.xa){if((p=Se())==null){H=1;break e}if(function(re,xe){var ye=[0],Pe=[0],Ee=[0];t:for(;;){if(re==null)return 0;if(xe==null)return re.a=2,0;if(re.l=xe,re.a=0,G(re.m,xe.data,xe.w,xe.ha),!Vi(re.m,ye,Pe,Ee)){re.a=3;break t}if(re.xb=s5,xe.width=ye[0],xe.height=Pe[0],!Ne(ye[0],Pe[0],1,re,null))break t;return 1}return t(re.a!=0),0}(p,T)){if(T=(g=Co(T.width,T.height,H.Oa,H.ba))==0){t:{T=p;r:for(;;){if(T==null){T=0;break t}if(t(T.s.yc!=null),t(T.s.Ya!=null),t(0<T.s.Wb),t((S=T.l)!=null),t((M=S.ma)!=null),T.xb!=0){if(T.ca=M.ba,T.tb=M.tb,t(T.ca!=null),!ju(M.Oa,S,ud)){T.a=2;break r}if(!Te(T,S.width)||S.da)break r;if((S.da||Pt(T.ca.S))&&wi(),11>T.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),T.ca.f.kb.F!=null&&wi()),T.Pb&&0<T.s.ua&&T.s.vb.X==null&&!ee(T.s.vb,T.s.Wa.Xa)){T.a=1;break r}T.xb=0}if(!ke(T,T.V,T.Ba,T.c,T.i,S.o,K))break r;M.Dc=T.Ma,T=1;break t}t(T.a!=0),T=0}T=!T}T&&(g=p.a)}else g=p.a}else{if((p=new am)==null){H=1;break e}if(p.Fa=M.na,p.P=M.P,p.qc=M.Sa,Kh(p,T)){if((g=Co(T.width,T.height,H.Oa,H.ba))==0){if(p.Aa=0,S=H.Oa,t((M=p)!=null),S!=null){if(0<(J=0>(J=S.Md)?0:100<J?255:255*J/100)){for(te=ge=0;4>te;++te)12>(Ae=M.pb[te]).lc&&(Ae.ia=J*y8[0>Ae.lc?0:Ae.lc]>>3),ge|=Ae.ia;ge&&(alert("todo:VP8InitRandom"),M.ia=1)}M.Ga=S.Id,100<M.Ga?M.Ga=100:0>M.Ga&&(M.Ga=0)}(function(re,xe){if(re==null)return 0;if(xe==null)return _n(re,2,"NULL VP8Io parameter in VP8Decode().");if(!re.cb&&!Kh(re,xe))return 0;if(t(re.cb),xe.ac==null||xe.ac(xe)){xe.ob&&(re.L=0);var ye=md[re.L];if(re.L==2?(re.yb=0,re.zb=0):(re.yb=xe.v-ye>>4,re.zb=xe.j-ye>>4,0>re.yb&&(re.yb=0),0>re.zb&&(re.zb=0)),re.Va=xe.o+15+ye>>4,re.Hb=xe.va+15+ye>>4,re.Hb>re.za&&(re.Hb=re.za),re.Va>re.Ub&&(re.Va=re.Ub),0<re.L){var Pe=re.ed;for(ye=0;4>ye;++ye){var Ee;if(re.Qa.Cb){var Ie=re.Qa.Lb[ye];re.Qa.Fb||(Ie+=Pe.Tb)}else Ie=Pe.Tb;for(Ee=0;1>=Ee;++Ee){var je=re.gd[ye][Ee],We=Ie;if(Pe.Pc&&(We+=Pe.vd[0],Ee&&(We+=Pe.od[0])),0<(We=0>We?0:63<We?63:We)){var Be=We;0<Pe.wb&&(Be=4<Pe.wb?Be>>2:Be>>1)>9-Pe.wb&&(Be=9-Pe.wb),1>Be&&(Be=1),je.dd=Be,je.tc=2*We+Be,je.ld=40<=We?2:15<=We?1:0}else je.tc=0;je.La=Ee}}}ye=0}else _n(re,6,"Frame setup failed"),ye=re.a;if(ye=ye==0){if(ye){re.$c=0,0<re.Aa||(re.Ic=b8);t:{ye=re.Ic,Pe=4*(Be=re.za);var gt=32*Be,lt=Be+1,zt=0<re.L?Be*(0<re.Aa?2:1):0,ht=(re.Aa==2?2:1)*Be;if((je=Pe+832+(Ee=3*(16*ye+md[re.L])/2*gt)+(Ie=re.Fa!=null&&0<re.Fa.length?re.Kc.c*re.Kc.i:0))!=je)ye=0;else{if(je>re.Vb){if(re.Vb=0,re.Ec=i(je),re.Fc=0,re.Ec==null){ye=_n(re,1,"no memory during frame initialization.");break t}re.Vb=je}je=re.Ec,We=re.Fc,re.Ac=je,re.Bc=We,We+=Pe,re.Gd=s(gt,_i),re.Hd=0,re.rb=s(lt+1,Kr),re.sb=1,re.wa=zt?s(zt,Jt):null,re.Y=0,re.D.Nb=0,re.D.wa=re.wa,re.D.Y=re.Y,0<re.Aa&&(re.D.Y+=Be),t(!0),re.oc=je,re.pc=We,We+=832,re.ya=s(ht,qi),re.aa=0,re.D.ya=re.ya,re.D.aa=re.aa,re.Aa==2&&(re.D.aa+=Be),re.R=16*Be,re.B=8*Be,Be=(gt=md[re.L])*re.R,gt=gt/2*re.B,re.sa=je,re.ta=We+Be,re.qa=re.sa,re.ra=re.ta+16*ye*re.R+gt,re.Ha=re.qa,re.Ia=re.ra+8*ye*re.B+gt,re.$c=0,We+=Ee,re.mb=Ie?je:null,re.nb=Ie?We:null,t(We+Ie<=re.Fc+re.Vb),Il(re),a(re.Ac,re.Bc,0,Pe),ye=1}}if(ye){if(xe.ka=0,xe.y=re.sa,xe.O=re.ta,xe.f=re.qa,xe.N=re.ra,xe.ea=re.Ha,xe.Vd=re.Ia,xe.fa=re.R,xe.Rc=re.B,xe.F=null,xe.J=0,!t5){for(ye=-255;255>=ye;++ye)J_[255+ye]=0>ye?-ye:ye;for(ye=-1020;1020>=ye;++ye)Z_[1020+ye]=-128>ye?-128:127<ye?127:ye;for(ye=-112;112>=ye;++ye)Q_[112+ye]=-16>ye?-16:15<ye?15:ye;for(ye=-255;510>=ye;++ye)e5[255+ye]=0>ye?0:255<ye?255:ye;t5=1}jo=Jh,Jl=sm,ws=om,ur=xs,kr=Yh,bi=im,ln=ed,An=td,Xs=k,$u=D,t0=zl,sd=rd,$_=ie,W_=he,H_=Pu,V_=Ul,q_=Zh,G_=Qh,Xi[0]=pm,Xi[1]=Nu,Xi[2]=hm,Xi[3]=dm,Xi[4]=mm,Xi[5]=Ws,Xi[6]=$s,Xi[7]=gm,Xi[8]=Xc,Xi[9]=xm,Ro[0]=Ao,Ro[1]=cm,Ro[2]=um,Ro[3]=Eu,Ro[4]=fm,Ro[5]=Rl,Ro[6]=Au,Ks[0]=Yc,Ks[1]=lm,Ks[2]=Tu,Ks[3]=Dl,Ks[4]=Cu,Ks[5]=vm,Ks[6]=Fu,ye=1}else ye=0}ye&&(ye=function(Zt,Tn){for(Zt.M=0;Zt.M<Zt.Va;++Zt.M){var $t,dt=Zt.Jc[Zt.M&Zt.Xb],Je=Zt.m,cn=Zt;for($t=0;$t<cn.za;++$t){var Mt=Je,tr=cn,Lr=tr.Ac,qn=tr.Bc+4*$t,ba=tr.zc,Jr=tr.ya[tr.aa+$t];if(tr.Qa.Bb?Jr.$b=de(Mt,tr.Pa.jb[0])?2+de(Mt,tr.Pa.jb[2]):de(Mt,tr.Pa.jb[1]):Jr.$b=0,tr.kc&&(Jr.Ad=de(Mt,tr.Bd)),Jr.Za=!de(Mt,145)+0,Jr.Za){var ia=Jr.Ob,ka=0;for(tr=0;4>tr;++tr){var Cn,rr=ba[0+tr];for(Cn=0;4>Cn;++Cn){rr=o8[Lr[qn+Cn]][rr];for(var dr=i5[de(Mt,rr[0])];0<dr;)dr=i5[2*dr+de(Mt,rr[dr])];rr=-dr,Lr[qn+Cn]=rr}n(ia,ka,Lr,qn,4),ka+=4,ba[0+tr]=rr}}else rr=de(Mt,156)?de(Mt,128)?1:3:de(Mt,163)?2:0,Jr.Ob[0]=rr,a(Lr,qn,rr,4),a(ba,0,rr,4);Jr.Dd=de(Mt,142)?de(Mt,114)?de(Mt,183)?1:3:2:0}if(cn.m.Ka)return _n(Zt,7,"Premature end-of-partition0 encountered.");for(;Zt.ja<Zt.za;++Zt.ja){if(cn=dt,Mt=(Je=Zt).rb[Je.sb-1],Lr=Je.rb[Je.sb+Je.ja],$t=Je.ya[Je.aa+Je.ja],qn=Je.kc?$t.Ad:0)Mt.la=Lr.la=0,$t.Za||(Mt.Na=Lr.Na=0),$t.Hc=0,$t.Gc=0,$t.ia=0;else{var Zr,pr;if(Mt=Lr,Lr=cn,qn=Je.Pa.Xc,ba=Je.ya[Je.aa+Je.ja],Jr=Je.pb[ba.$b],tr=ba.ad,ia=0,ka=Je.rb[Je.sb-1],rr=Cn=0,a(tr,ia,0,384),ba.Za)var Gn=0,Ki=qn[3];else{dr=i(16);var un=Mt.Na+ka.Na;if(un=Hu(Lr,qn[1],un,Jr.Eb,0,dr,0),Mt.Na=ka.Na=(0<un)+0,1<un)jo(dr,0,tr,ia);else{var Ra=dr[0]+3>>3;for(dr=0;256>dr;dr+=16)tr[ia+dr]=Ra}Gn=1,Ki=qn[0]}var Sr=15&Mt.la,Fn=15&ka.la;for(dr=0;4>dr;++dr){var Za=1&Fn;for(Ra=pr=0;4>Ra;++Ra)Sr=Sr>>1|(Za=(un=Hu(Lr,Ki,un=Za+(1&Sr),Jr.Sc,Gn,tr,ia))>Gn)<<7,pr=pr<<2|(3<un?3:1<un?2:tr[ia+0]!=0),ia+=16;Sr>>=4,Fn=Fn>>1|Za<<7,Cn=(Cn<<8|pr)>>>0}for(Ki=Sr,Gn=Fn>>4,Zr=0;4>Zr;Zr+=2){for(pr=0,Sr=Mt.la>>4+Zr,Fn=ka.la>>4+Zr,dr=0;2>dr;++dr){for(Za=1&Fn,Ra=0;2>Ra;++Ra)un=Za+(1&Sr),Sr=Sr>>1|(Za=0<(un=Hu(Lr,qn[2],un,Jr.Qc,0,tr,ia)))<<3,pr=pr<<2|(3<un?3:1<un?2:tr[ia+0]!=0),ia+=16;Sr>>=2,Fn=Fn>>1|Za<<5}rr|=pr<<4*Zr,Ki|=Sr<<4<<Zr,Gn|=(240&Fn)<<Zr}Mt.la=Ki,ka.la=Gn,ba.Hc=Cn,ba.Gc=rr,ba.ia=43690&rr?0:Jr.ia,qn=!(Cn|rr)}if(0<Je.L&&(Je.wa[Je.Y+Je.ja]=Je.gd[$t.$b][$t.Za],Je.wa[Je.Y+Je.ja].La|=!qn),cn.Ka)return _n(Zt,7,"Premature end-of-file encountered.")}if(Il(Zt),Je=Tn,cn=1,$t=(dt=Zt).D,Mt=0<dt.L&&dt.M>=dt.zb&&dt.M<=dt.Va,dt.Aa==0)t:{if($t.M=dt.M,$t.uc=Mt,yi(dt,$t),cn=1,$t=(pr=dt.D).Nb,Mt=(rr=md[dt.L])*dt.R,Lr=rr/2*dt.B,dr=16*$t*dt.R,Ra=8*$t*dt.B,qn=dt.sa,ba=dt.ta-Mt+dr,Jr=dt.qa,tr=dt.ra-Lr+Ra,ia=dt.Ha,ka=dt.Ia-Lr+Ra,Fn=(Sr=pr.M)==0,Cn=Sr>=dt.Va-1,dt.Aa==2&&yi(dt,pr),pr.uc)for(Za=(un=dt).D.M,t(un.D.uc),pr=un.yb;pr<un.Hb;++pr){Gn=pr,Ki=Za;var Sa=(Qa=(Xn=un).D).Nb;Zr=Xn.R;var Qa=Qa.wa[Qa.Y+Gn],ei=Xn.sa,Da=Xn.ta+16*Sa*Zr+16*Gn,ti=Qa.dd,Tr=Qa.tc;if(Tr!=0)if(t(3<=Tr),Xn.L==1)0<Gn&&V_(ei,Da,Zr,Tr+4),Qa.La&&G_(ei,Da,Zr,Tr),0<Ki&&H_(ei,Da,Zr,Tr+4),Qa.La&&q_(ei,Da,Zr,Tr);else{var ri=Xn.B,Yi=Xn.qa,Zl=Xn.ra+8*Sa*ri+8*Gn,Ys=Xn.Ha,Xn=Xn.Ia+8*Sa*ri+8*Gn;Sa=Qa.ld,0<Gn&&(An(ei,Da,Zr,Tr+4,ti,Sa),$u(Yi,Zl,Ys,Xn,ri,Tr+4,ti,Sa)),Qa.La&&(sd(ei,Da,Zr,Tr,ti,Sa),W_(Yi,Zl,Ys,Xn,ri,Tr,ti,Sa)),0<Ki&&(ln(ei,Da,Zr,Tr+4,ti,Sa),Xs(Yi,Zl,Ys,Xn,ri,Tr+4,ti,Sa)),Qa.La&&(t0(ei,Da,Zr,Tr,ti,Sa),$_(Yi,Zl,Ys,Xn,ri,Tr,ti,Sa))}}if(dt.ia&&alert("todo:DitherRow"),Je.put!=null){if(pr=16*Sr,Sr=16*(Sr+1),Fn?(Je.y=dt.sa,Je.O=dt.ta+dr,Je.f=dt.qa,Je.N=dt.ra+Ra,Je.ea=dt.Ha,Je.W=dt.Ia+Ra):(pr-=rr,Je.y=qn,Je.O=ba,Je.f=Jr,Je.N=tr,Je.ea=ia,Je.W=ka),Cn||(Sr-=rr),Sr>Je.o&&(Sr=Je.o),Je.F=null,Je.J=null,dt.Fa!=null&&0<dt.Fa.length&&pr<Sr&&(Je.J=wn(dt,Je,pr,Sr-pr),Je.F=dt.mb,Je.F==null&&Je.F.length==0)){cn=_n(dt,3,"Could not decode alpha data.");break t}pr<Je.j&&(rr=Je.j-pr,pr=Je.j,t(!(1&rr)),Je.O+=dt.R*rr,Je.N+=dt.B*(rr>>1),Je.W+=dt.B*(rr>>1),Je.F!=null&&(Je.J+=Je.width*rr)),pr<Sr&&(Je.O+=Je.v,Je.N+=Je.v>>1,Je.W+=Je.v>>1,Je.F!=null&&(Je.J+=Je.v),Je.ka=pr-Je.j,Je.U=Je.va-Je.v,Je.T=Sr-pr,cn=Je.put(Je))}$t+1!=dt.Ic||Cn||(n(dt.sa,dt.ta-Mt,qn,ba+16*dt.R,Mt),n(dt.qa,dt.ra-Lr,Jr,tr+8*dt.B,Lr),n(dt.Ha,dt.Ia-Lr,ia,ka+8*dt.B,Lr))}if(!cn)return _n(Zt,6,"Output aborted.")}return 1}(re,xe)),xe.bc!=null&&xe.bc(xe),ye&=1}return ye?(re.cb=0,ye):0})(p,T)||(g=p.a)}}else g=p.a}g==0&&H.Oa!=null&&H.Oa.fd&&(g=Ru(H.ba))}H=g}z=H!=0?null:11>z?q.f.RGBA.eb:q.f.kb.y}else z=null;return z};var p5=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function c(A,W){for(var L="",I=0;I<4;I++)L+=String.fromCharCode(A[W++]);return L}function u(A,W){return A[W+0]|A[W+1]<<8}function h(A,W){return(A[W+0]|A[W+1]<<8|A[W+2]<<16)>>>0}function m(A,W){return(A[W+0]|A[W+1]<<8|A[W+2]<<16|A[W+3]<<24)>>>0}new l;var f=[0],v=[0],x=[],w=new l,_=e,b=function(A,W){var L={},I=0,V=!1,Q=0,ue=0;if(L.frames=[],!function(E,j){for(var O=0;O<4;O++)if(E[j+O]!="RIFF".charCodeAt(O))return!0;return!1}(A,W)){for(m(A,W+=4),W+=8;W<A.length;){var me=c(A,W),pe=m(A,W+=4);W+=4;var oe=pe+(1&pe);switch(me){case"VP8 ":case"VP8L":L.frames[I]===void 0&&(L.frames[I]={}),(_e=L.frames[I]).src_off=V?ue:W-8,_e.src_size=Q+pe+8,I++,V&&(V=!1,Q=0,ue=0);break;case"VP8X":(_e=L.header={}).feature_flags=A[W];var G=W+4;_e.canvas_width=1+h(A,G),G+=3,_e.canvas_height=1+h(A,G),G+=3;break;case"ALPH":V=!0,Q=oe+8,ue=W-8;break;case"ANIM":(_e=L.header).bgcolor=m(A,W),G=W+4,_e.loop_count=u(A,G),G+=2;break;case"ANMF":var ve,_e;(_e=L.frames[I]={}).offset_x=2*h(A,W),W+=3,_e.offset_y=2*h(A,W),W+=3,_e.width=1+h(A,W),W+=3,_e.height=1+h(A,W),W+=3,_e.duration=h(A,W),W+=3,ve=A[W++],_e.dispose=1&ve,_e.blend=ve>>1&1}me!="ANMF"&&(W+=oe)}return L}}(_,0);b.response=_,b.rgbaoutput=!0,b.dataurl=!1;var y=b.header?b.header:null,N=b.frames?b.frames:null;if(y){y.loop_counter=y.loop_count,f=[y.canvas_height],v=[y.canvas_width];for(var R=0;R<N.length&&N[R].blend!=0;R++);}var P=N[0],F=w.WebPDecodeRGBA(_,P.src_off,P.src_size,v,f);P.rgba=F,P.imgwidth=v[0],P.imgheight=f[0];for(var C=0;C<v[0]*f[0]*4;C++)x[C]=F[C];return this.width=v,this.height=f,this.data=x,this}(function(e){var t,r,n,a,i,s,o,l,c,u=function(E){return E=E||{},this.isStrokeTransparent=E.isStrokeTransparent||!1,this.strokeOpacity=E.strokeOpacity||1,this.strokeStyle=E.strokeStyle||"#000000",this.fillStyle=E.fillStyle||"#000000",this.isFillTransparent=E.isFillTransparent||!1,this.fillOpacity=E.fillOpacity||1,this.font=E.font||"10px sans-serif",this.textBaseline=E.textBaseline||"alphabetic",this.textAlign=E.textAlign||"left",this.lineWidth=E.lineWidth||1,this.lineJoin=E.lineJoin||"miter",this.lineCap=E.lineCap||"butt",this.path=E.path||[],this.transform=E.transform!==void 0?E.transform.clone():new l,this.globalCompositeOperation=E.globalCompositeOperation||"normal",this.globalAlpha=E.globalAlpha||1,this.clip_path=E.clip_path||[],this.currentPoint=E.currentPoint||new s,this.miterLimit=E.miterLimit||10,this.lastPoint=E.lastPoint||new s,this.lineDashOffset=E.lineDashOffset||0,this.lineDash=E.lineDash||[],this.margin=E.margin||[0,0,0,0],this.prevPageLastElemOffset=E.prevPageLastElemOffset||0,this.ignoreClearRect=typeof E.ignoreClearRect!="boolean"||E.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new h(this),t=this.internal.f2,r=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,a=this.internal.getHorizontalCoordinate,i=this.internal.getVerticalCoordinate,s=this.internal.Point,o=this.internal.Rectangle,l=this.internal.Matrix,c=new u}]);var h=function(E){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var j=E;Object.defineProperty(this,"pdf",{get:function(){return j}});var O=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return O},set:function(be){O=!!be}});var B=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return B},set:function(be){B=!!be}});var Y=0;Object.defineProperty(this,"posX",{get:function(){return Y},set:function(be){isNaN(be)||(Y=be)}});var le=0;Object.defineProperty(this,"posY",{get:function(){return le},set:function(be){isNaN(be)||(le=be)}}),Object.defineProperty(this,"margin",{get:function(){return c.margin},set:function(be){var ee;typeof be=="number"?ee=[be,be,be,be]:((ee=new Array(4))[0]=be[0],ee[1]=be.length>=2?be[1]:ee[0],ee[2]=be.length>=3?be[2]:ee[0],ee[3]=be.length>=4?be[3]:ee[1]),c.margin=ee}});var fe=!1;Object.defineProperty(this,"autoPaging",{get:function(){return fe},set:function(be){fe=be}});var ce=0;Object.defineProperty(this,"lastBreak",{get:function(){return ce},set:function(be){ce=be}});var de=[];Object.defineProperty(this,"pageBreaks",{get:function(){return de},set:function(be){de=be}}),Object.defineProperty(this,"ctx",{get:function(){return c},set:function(be){be instanceof u&&(c=be)}}),Object.defineProperty(this,"path",{get:function(){return c.path},set:function(be){c.path=be}});var Ce=[];Object.defineProperty(this,"ctxStack",{get:function(){return Ce},set:function(be){Ce=be}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(be){var ee;ee=m(be),this.ctx.fillStyle=ee.style,this.ctx.isFillTransparent=ee.a===0,this.ctx.fillOpacity=ee.a,this.pdf.setFillColor(ee.r,ee.g,ee.b,{a:ee.a}),this.pdf.setTextColor(ee.r,ee.g,ee.b,{a:ee.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(be){var ee=m(be);this.ctx.strokeStyle=ee.style,this.ctx.isStrokeTransparent=ee.a===0,this.ctx.strokeOpacity=ee.a,ee.a===0?this.pdf.setDrawColor(255,255,255):(ee.a,this.pdf.setDrawColor(ee.r,ee.g,ee.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(be){["butt","round","square"].indexOf(be)!==-1&&(this.ctx.lineCap=be,this.pdf.setLineCap(be))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(be){isNaN(be)||(this.ctx.lineWidth=be,this.pdf.setLineWidth(be))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(be){["bevel","round","miter"].indexOf(be)!==-1&&(this.ctx.lineJoin=be,this.pdf.setLineJoin(be))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(be){isNaN(be)||(this.ctx.miterLimit=be,this.pdf.setMiterLimit(be))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(be){this.ctx.textBaseline=be}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(be){["right","end","center","left","start"].indexOf(be)!==-1&&(this.ctx.textAlign=be)}});var X=null,$e=null;Object.defineProperty(this,"fontFaces",{get:function(){return $e},set:function(be){X=null,$e=be}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(be){var ee;if(this.ctx.font=be,(ee=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(be))!==null){var et=ee[1];ee[2];var Re=ee[3],tt=ee[4];ee[5];var Me=ee[6],at=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(tt)[2];tt=Math.floor(at==="px"?parseFloat(tt)*this.pdf.internal.scaleFactor:at==="em"?parseFloat(tt)*this.pdf.getFontSize():parseFloat(tt)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(tt);var Ye=function(qe){var Ze,Ht,kt=[],st=qe.trim();if(st==="")return t2;if(st in wb)return[wb[st]];for(;st!=="";){switch(Ht=null,Ze=(st=bb(st)).charAt(0)){case'"':case"'":Ht=RV(st.substring(1),Ze);break;default:Ht=DV(st)}if(Ht===null||(kt.push(Ht[0]),(st=bb(Ht[1]))!==""&&st.charAt(0)!==","))return t2;st=st.replace(/^,/,"")}return kt}(Me);if(this.fontFaces){var At=function(qe,Ze){if(X===null){var Ht=function(kt){var st=[];return Object.keys(kt).forEach(function(Lt){kt[Lt].forEach(function(fr){var yt=null;switch(fr){case"bold":yt={family:Lt,weight:"bold"};break;case"italic":yt={family:Lt,style:"italic"};break;case"bolditalic":yt={family:Lt,weight:"bold",style:"italic"};break;case"":case"normal":yt={family:Lt}}yt!==null&&(yt.ref={name:Lt,style:fr},st.push(yt))})}),st}(qe.getFontList());X=function(kt){for(var st={},Lt=0;Lt<kt.length;++Lt){var fr=e2(kt[Lt]),yt=fr.family,Gt=fr.stretch,Pt=fr.style,Br=fr.weight;st[yt]=st[yt]||{},st[yt][Gt]=st[yt][Gt]||{},st[yt][Gt][Pt]=st[yt][Gt][Pt]||{},st[yt][Gt][Pt][Br]=fr}return st}(Ht.concat(Ze))}return X}(this.pdf,this.fontFaces),ut=Ye.map(function(qe){return{family:qe,stretch:"normal",weight:Re,style:et}}),Ot=function(qe,Ze,Ht){for(var kt=(Ht=Ht||{}).defaultFontFamily||"times",st=Object.assign({},jV,Ht.genericFontFamilies||{}),Lt=null,fr=null,yt=0;yt<Ze.length;++yt)if(st[(Lt=e2(Ze[yt])).family]&&(Lt.family=st[Lt.family]),qe.hasOwnProperty(Lt.family)){fr=qe[Lt.family];break}if(!(fr=fr||qe[kt]))throw new Error("Could not find a font-family for the rule '"+yb(Lt)+"' and default family '"+kt+"'.");if(fr=function(Gt,Pt){if(Pt[Gt])return Pt[Gt];var Br=Bx[Gt],an=Br<=Bx.normal?-1:1,hr=_b(Pt,WE,Br,an);if(!hr)throw new Error("Could not find a matching font-stretch value for "+Gt);return hr}(Lt.stretch,fr),fr=function(Gt,Pt){if(Pt[Gt])return Pt[Gt];for(var Br=$E[Gt],an=0;an<Br.length;++an)if(Pt[Br[an]])return Pt[Br[an]];throw new Error("Could not find a matching font-style for "+Gt)}(Lt.style,fr),!(fr=function(Gt,Pt){if(Pt[Gt])return Pt[Gt];if(Gt===400&&Pt[500])return Pt[500];if(Gt===500&&Pt[400])return Pt[400];var Br=OV[Gt],an=_b(Pt,HE,Br,Gt<400?-1:1);if(!an)throw new Error("Could not find a matching font-weight for value "+Gt);return an}(Lt.weight,fr)))throw new Error("Failed to resolve a font for the rule '"+yb(Lt)+"'.");return fr}(At,ut);this.pdf.setFont(Ot.ref.name,Ot.ref.style)}else{var _t="";(Re==="bold"||parseInt(Re,10)>=700||et==="bold")&&(_t="bold"),et==="italic"&&(_t+="italic"),_t.length===0&&(_t="normal");for(var wt="",er={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},mt=0;mt<Ye.length;mt++){if(this.pdf.internal.getFont(Ye[mt],_t,{noFallback:!0,disableWarning:!0})!==void 0){wt=Ye[mt];break}if(_t==="bolditalic"&&this.pdf.internal.getFont(Ye[mt],"bold",{noFallback:!0,disableWarning:!0})!==void 0)wt=Ye[mt],_t="bold";else if(this.pdf.internal.getFont(Ye[mt],"normal",{noFallback:!0,disableWarning:!0})!==void 0){wt=Ye[mt],_t="normal";break}}if(wt===""){for(var it=0;it<Ye.length;it++)if(er[Ye[it]]){wt=er[Ye[it]];break}}wt=wt===""?"Times":wt,this.pdf.setFont(wt,_t)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(be){this.ctx.globalCompositeOperation=be}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(be){this.ctx.globalAlpha=be}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(be){this.ctx.lineDashOffset=be,_e.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(be){this.ctx.lineDash=be,_e.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(be){this.ctx.ignoreClearRect=!!be}})};h.prototype.setLineDash=function(E){this.lineDash=E},h.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},h.prototype.fill=function(){N.call(this,"fill",!1)},h.prototype.stroke=function(){N.call(this,"stroke",!1)},h.prototype.beginPath=function(){this.path=[{type:"begin"}]},h.prototype.moveTo=function(E,j){if(isNaN(E)||isNaN(j))throw Nr.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var O=this.ctx.transform.applyToPoint(new s(E,j));this.path.push({type:"mt",x:O.x,y:O.y}),this.ctx.lastPoint=new s(E,j)},h.prototype.closePath=function(){var E=new s(0,0),j=0;for(j=this.path.length-1;j!==-1;j--)if(this.path[j].type==="begin"&&vr(this.path[j+1])==="object"&&typeof this.path[j+1].x=="number"){E=new s(this.path[j+1].x,this.path[j+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new s(E.x,E.y)},h.prototype.lineTo=function(E,j){if(isNaN(E)||isNaN(j))throw Nr.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var O=this.ctx.transform.applyToPoint(new s(E,j));this.path.push({type:"lt",x:O.x,y:O.y}),this.ctx.lastPoint=new s(O.x,O.y)},h.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),N.call(this,null,!0)},h.prototype.quadraticCurveTo=function(E,j,O,B){if(isNaN(O)||isNaN(B)||isNaN(E)||isNaN(j))throw Nr.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var Y=this.ctx.transform.applyToPoint(new s(O,B)),le=this.ctx.transform.applyToPoint(new s(E,j));this.path.push({type:"qct",x1:le.x,y1:le.y,x:Y.x,y:Y.y}),this.ctx.lastPoint=new s(Y.x,Y.y)},h.prototype.bezierCurveTo=function(E,j,O,B,Y,le){if(isNaN(Y)||isNaN(le)||isNaN(E)||isNaN(j)||isNaN(O)||isNaN(B))throw Nr.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var fe=this.ctx.transform.applyToPoint(new s(Y,le)),ce=this.ctx.transform.applyToPoint(new s(E,j)),de=this.ctx.transform.applyToPoint(new s(O,B));this.path.push({type:"bct",x1:ce.x,y1:ce.y,x2:de.x,y2:de.y,x:fe.x,y:fe.y}),this.ctx.lastPoint=new s(fe.x,fe.y)},h.prototype.arc=function(E,j,O,B,Y,le){if(isNaN(E)||isNaN(j)||isNaN(O)||isNaN(B)||isNaN(Y))throw Nr.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(le=!!le,!this.ctx.transform.isIdentity){var fe=this.ctx.transform.applyToPoint(new s(E,j));E=fe.x,j=fe.y;var ce=this.ctx.transform.applyToPoint(new s(0,O)),de=this.ctx.transform.applyToPoint(new s(0,0));O=Math.sqrt(Math.pow(ce.x-de.x,2)+Math.pow(ce.y-de.y,2))}Math.abs(Y-B)>=2*Math.PI&&(B=0,Y=2*Math.PI),this.path.push({type:"arc",x:E,y:j,radius:O,startAngle:B,endAngle:Y,counterclockwise:le})},h.prototype.arcTo=function(E,j,O,B,Y){throw new Error("arcTo not implemented.")},h.prototype.rect=function(E,j,O,B){if(isNaN(E)||isNaN(j)||isNaN(O)||isNaN(B))throw Nr.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(E,j),this.lineTo(E+O,j),this.lineTo(E+O,j+B),this.lineTo(E,j+B),this.lineTo(E,j),this.lineTo(E+O,j),this.lineTo(E,j)},h.prototype.fillRect=function(E,j,O,B){if(isNaN(E)||isNaN(j)||isNaN(O)||isNaN(B))throw Nr.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!f.call(this)){var Y={};this.lineCap!=="butt"&&(Y.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(Y.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(E,j,O,B),this.fill(),Y.hasOwnProperty("lineCap")&&(this.lineCap=Y.lineCap),Y.hasOwnProperty("lineJoin")&&(this.lineJoin=Y.lineJoin)}},h.prototype.strokeRect=function(E,j,O,B){if(isNaN(E)||isNaN(j)||isNaN(O)||isNaN(B))throw Nr.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");v.call(this)||(this.beginPath(),this.rect(E,j,O,B),this.stroke())},h.prototype.clearRect=function(E,j,O,B){if(isNaN(E)||isNaN(j)||isNaN(O)||isNaN(B))throw Nr.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(E,j,O,B))},h.prototype.save=function(E){E=typeof E!="boolean"||E;for(var j=this.pdf.internal.getCurrentPageInfo().pageNumber,O=0;O<this.pdf.internal.getNumberOfPages();O++)this.pdf.setPage(O+1),this.pdf.internal.out("q");if(this.pdf.setPage(j),E){this.ctx.fontSize=this.pdf.internal.getFontSize();var B=new u(this.ctx);this.ctxStack.push(this.ctx),this.ctx=B}},h.prototype.restore=function(E){E=typeof E!="boolean"||E;for(var j=this.pdf.internal.getCurrentPageInfo().pageNumber,O=0;O<this.pdf.internal.getNumberOfPages();O++)this.pdf.setPage(O+1),this.pdf.internal.out("Q");this.pdf.setPage(j),E&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},h.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var m=function(E){var j,O,B,Y;if(E.isCanvasGradient===!0&&(E=E.getColor()),!E)return{r:0,g:0,b:0,a:0,style:E};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(E))j=0,O=0,B=0,Y=0;else{var le=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(E);if(le!==null)j=parseInt(le[1]),O=parseInt(le[2]),B=parseInt(le[3]),Y=1;else if((le=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(E))!==null)j=parseInt(le[1]),O=parseInt(le[2]),B=parseInt(le[3]),Y=parseFloat(le[4]);else{if(Y=1,typeof E=="string"&&E.charAt(0)!=="#"){var fe=new jE(E);E=fe.ok?fe.toHex():"#000000"}E.length===4?(j=E.substring(1,2),j+=j,O=E.substring(2,3),O+=O,B=E.substring(3,4),B+=B):(j=E.substring(1,3),O=E.substring(3,5),B=E.substring(5,7)),j=parseInt(j,16),O=parseInt(O,16),B=parseInt(B,16)}}return{r:j,g:O,b:B,a:Y,style:E}},f=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},v=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};h.prototype.fillText=function(E,j,O,B){if(isNaN(j)||isNaN(O)||typeof E!="string")throw Nr.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(B=isNaN(B)?void 0:B,!f.call(this)){var Y=oe(this.ctx.transform.rotation),le=this.ctx.transform.scaleX;I.call(this,{text:E,x:j,y:O,scale:le,angle:Y,align:this.textAlign,maxWidth:B})}},h.prototype.strokeText=function(E,j,O,B){if(isNaN(j)||isNaN(O)||typeof E!="string")throw Nr.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!v.call(this)){B=isNaN(B)?void 0:B;var Y=oe(this.ctx.transform.rotation),le=this.ctx.transform.scaleX;I.call(this,{text:E,x:j,y:O,scale:le,renderingMode:"stroke",angle:Y,align:this.textAlign,maxWidth:B})}},h.prototype.measureText=function(E){if(typeof E!="string")throw Nr.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var j=this.pdf,O=this.pdf.internal.scaleFactor,B=j.internal.getFontSize(),Y=j.getStringUnitWidth(E)*B/j.internal.scaleFactor;return new function(le){var fe=(le=le||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return fe}}),this}({width:Y*=Math.round(96*O/72*1e4)/1e4})},h.prototype.scale=function(E,j){if(isNaN(E)||isNaN(j))throw Nr.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var O=new l(E,0,0,j,0,0);this.ctx.transform=this.ctx.transform.multiply(O)},h.prototype.rotate=function(E){if(isNaN(E))throw Nr.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var j=new l(Math.cos(E),Math.sin(E),-Math.sin(E),Math.cos(E),0,0);this.ctx.transform=this.ctx.transform.multiply(j)},h.prototype.translate=function(E,j){if(isNaN(E)||isNaN(j))throw Nr.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var O=new l(1,0,0,1,E,j);this.ctx.transform=this.ctx.transform.multiply(O)},h.prototype.transform=function(E,j,O,B,Y,le){if(isNaN(E)||isNaN(j)||isNaN(O)||isNaN(B)||isNaN(Y)||isNaN(le))throw Nr.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var fe=new l(E,j,O,B,Y,le);this.ctx.transform=this.ctx.transform.multiply(fe)},h.prototype.setTransform=function(E,j,O,B,Y,le){E=isNaN(E)?1:E,j=isNaN(j)?0:j,O=isNaN(O)?0:O,B=isNaN(B)?1:B,Y=isNaN(Y)?0:Y,le=isNaN(le)?0:le,this.ctx.transform=new l(E,j,O,B,Y,le)};var x=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};h.prototype.drawImage=function(E,j,O,B,Y,le,fe,ce,de){var Ce=this.pdf.getImageProperties(E),X=1,$e=1,be=1,ee=1;B!==void 0&&ce!==void 0&&(be=ce/B,ee=de/Y,X=Ce.width/B*ce/B,$e=Ce.height/Y*de/Y),le===void 0&&(le=j,fe=O,j=0,O=0),B!==void 0&&ce===void 0&&(ce=B,de=Y),B===void 0&&ce===void 0&&(ce=Ce.width,de=Ce.height);for(var et,Re=this.ctx.transform.decompose(),tt=oe(Re.rotate.shx),Me=new l,at=(Me=(Me=(Me=Me.multiply(Re.translate)).multiply(Re.skew)).multiply(Re.scale)).applyToRectangle(new o(le-j*be,fe-O*ee,B*X,Y*$e)),Ye=w.call(this,at),At=[],ut=0;ut<Ye.length;ut+=1)At.indexOf(Ye[ut])===-1&&At.push(Ye[ut]);if(y(At),this.autoPaging)for(var Ot=At[0],_t=At[At.length-1],wt=Ot;wt<_t+1;wt++){this.pdf.setPage(wt);var er=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],mt=wt===1?this.posY+this.margin[0]:this.margin[0],it=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],qe=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Ze=wt===1?0:it+(wt-2)*qe;if(this.ctx.clip_path.length!==0){var Ht=this.path;et=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=b(et,this.posX+this.margin[3],-Ze+mt+this.ctx.prevPageLastElemOffset),R.call(this,"fill",!0),this.path=Ht}var kt=JSON.parse(JSON.stringify(at));kt=b([kt],this.posX+this.margin[3],-Ze+mt+this.ctx.prevPageLastElemOffset)[0];var st=(wt>Ot||wt<_t)&&x.call(this);st&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],er,qe,null).clip().discardPath()),this.pdf.addImage(E,"JPEG",kt.x,kt.y,kt.w,kt.h,null,null,tt),st&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(E,"JPEG",at.x,at.y,at.w,at.h,null,null,tt)};var w=function(E,j,O){var B=[];j=j||this.pdf.internal.pageSize.width,O=O||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var Y=this.posY+this.ctx.prevPageLastElemOffset;switch(E.type){default:case"mt":case"lt":B.push(Math.floor((E.y+Y)/O)+1);break;case"arc":B.push(Math.floor((E.y+Y-E.radius)/O)+1),B.push(Math.floor((E.y+Y+E.radius)/O)+1);break;case"qct":var le=G(this.ctx.lastPoint.x,this.ctx.lastPoint.y,E.x1,E.y1,E.x,E.y);B.push(Math.floor((le.y+Y)/O)+1),B.push(Math.floor((le.y+le.h+Y)/O)+1);break;case"bct":var fe=ve(this.ctx.lastPoint.x,this.ctx.lastPoint.y,E.x1,E.y1,E.x2,E.y2,E.x,E.y);B.push(Math.floor((fe.y+Y)/O)+1),B.push(Math.floor((fe.y+fe.h+Y)/O)+1);break;case"rect":B.push(Math.floor((E.y+Y)/O)+1),B.push(Math.floor((E.y+E.h+Y)/O)+1)}for(var ce=0;ce<B.length;ce+=1)for(;this.pdf.internal.getNumberOfPages()<B[ce];)_.call(this);return B},_=function(){var E=this.fillStyle,j=this.strokeStyle,O=this.font,B=this.lineCap,Y=this.lineWidth,le=this.lineJoin;this.pdf.addPage(),this.fillStyle=E,this.strokeStyle=j,this.font=O,this.lineCap=B,this.lineWidth=Y,this.lineJoin=le},b=function(E,j,O){for(var B=0;B<E.length;B++)switch(E[B].type){case"bct":E[B].x2+=j,E[B].y2+=O;case"qct":E[B].x1+=j,E[B].y1+=O;default:E[B].x+=j,E[B].y+=O}return E},y=function(E){return E.sort(function(j,O){return j-O})},N=function(E,j){for(var O,B,Y=this.fillStyle,le=this.strokeStyle,fe=this.lineCap,ce=this.lineWidth,de=Math.abs(ce*this.ctx.transform.scaleX),Ce=this.lineJoin,X=JSON.parse(JSON.stringify(this.path)),$e=JSON.parse(JSON.stringify(this.path)),be=[],ee=0;ee<$e.length;ee++)if($e[ee].x!==void 0)for(var et=w.call(this,$e[ee]),Re=0;Re<et.length;Re+=1)be.indexOf(et[Re])===-1&&be.push(et[Re]);for(var tt=0;tt<be.length;tt++)for(;this.pdf.internal.getNumberOfPages()<be[tt];)_.call(this);if(y(be),this.autoPaging)for(var Me=be[0],at=be[be.length-1],Ye=Me;Ye<at+1;Ye++){this.pdf.setPage(Ye),this.fillStyle=Y,this.strokeStyle=le,this.lineCap=fe,this.lineWidth=de,this.lineJoin=Ce;var At=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],ut=Ye===1?this.posY+this.margin[0]:this.margin[0],Ot=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],_t=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],wt=Ye===1?0:Ot+(Ye-2)*_t;if(this.ctx.clip_path.length!==0){var er=this.path;O=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=b(O,this.posX+this.margin[3],-wt+ut+this.ctx.prevPageLastElemOffset),R.call(this,E,!0),this.path=er}if(B=JSON.parse(JSON.stringify(X)),this.path=b(B,this.posX+this.margin[3],-wt+ut+this.ctx.prevPageLastElemOffset),j===!1||Ye===0){var mt=(Ye>Me||Ye<at)&&x.call(this);mt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],At,_t,null).clip().discardPath()),R.call(this,E,j),mt&&this.pdf.restoreGraphicsState()}this.lineWidth=ce}else this.lineWidth=de,R.call(this,E,j),this.lineWidth=ce;this.path=X},R=function(E,j){if((E!=="stroke"||j||!v.call(this))&&(E==="stroke"||j||!f.call(this))){for(var O,B,Y=[],le=this.path,fe=0;fe<le.length;fe++){var ce=le[fe];switch(ce.type){case"begin":Y.push({begin:!0});break;case"close":Y.push({close:!0});break;case"mt":Y.push({start:ce,deltas:[],abs:[]});break;case"lt":var de=Y.length;if(le[fe-1]&&!isNaN(le[fe-1].x)&&(O=[ce.x-le[fe-1].x,ce.y-le[fe-1].y],de>0)){for(;de>=0;de--)if(Y[de-1].close!==!0&&Y[de-1].begin!==!0){Y[de-1].deltas.push(O),Y[de-1].abs.push(ce);break}}break;case"bct":O=[ce.x1-le[fe-1].x,ce.y1-le[fe-1].y,ce.x2-le[fe-1].x,ce.y2-le[fe-1].y,ce.x-le[fe-1].x,ce.y-le[fe-1].y],Y[Y.length-1].deltas.push(O);break;case"qct":var Ce=le[fe-1].x+2/3*(ce.x1-le[fe-1].x),X=le[fe-1].y+2/3*(ce.y1-le[fe-1].y),$e=ce.x+2/3*(ce.x1-ce.x),be=ce.y+2/3*(ce.y1-ce.y),ee=ce.x,et=ce.y;O=[Ce-le[fe-1].x,X-le[fe-1].y,$e-le[fe-1].x,be-le[fe-1].y,ee-le[fe-1].x,et-le[fe-1].y],Y[Y.length-1].deltas.push(O);break;case"arc":Y.push({deltas:[],abs:[],arc:!0}),Array.isArray(Y[Y.length-1].abs)&&Y[Y.length-1].abs.push(ce)}}B=j?null:E==="stroke"?"stroke":"fill";for(var Re=!1,tt=0;tt<Y.length;tt++)if(Y[tt].arc)for(var Me=Y[tt].abs,at=0;at<Me.length;at++){var Ye=Me[at];Ye.type==="arc"?C.call(this,Ye.x,Ye.y,Ye.radius,Ye.startAngle,Ye.endAngle,Ye.counterclockwise,void 0,j,!Re):V.call(this,Ye.x,Ye.y),Re=!0}else if(Y[tt].close===!0)this.pdf.internal.out("h"),Re=!1;else if(Y[tt].begin!==!0){var At=Y[tt].start.x,ut=Y[tt].start.y;Q.call(this,Y[tt].deltas,At,ut),Re=!0}B&&A.call(this,B),j&&W.call(this)}},P=function(E){var j=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,O=j*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return E-O;case"top":return E+j-O;case"hanging":return E+j-2*O;case"middle":return E+j/2-O;default:return E}},F=function(E){return E+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};h.prototype.createLinearGradient=function(){var E=function(){};return E.colorStops=[],E.addColorStop=function(j,O){this.colorStops.push([j,O])},E.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},E.isCanvasGradient=!0,E},h.prototype.createPattern=function(){return this.createLinearGradient()},h.prototype.createRadialGradient=function(){return this.createLinearGradient()};var C=function(E,j,O,B,Y,le,fe,ce,de){for(var Ce=me.call(this,O,B,Y,le),X=0;X<Ce.length;X++){var $e=Ce[X];X===0&&(de?L.call(this,$e.x1+E,$e.y1+j):V.call(this,$e.x1+E,$e.y1+j)),ue.call(this,E,j,$e.x2,$e.y2,$e.x3,$e.y3,$e.x4,$e.y4)}ce?W.call(this):A.call(this,fe)},A=function(E){switch(E){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},W=function(){this.pdf.clip(),this.pdf.discardPath()},L=function(E,j){this.pdf.internal.out(r(E)+" "+n(j)+" m")},I=function(E){var j;switch(E.align){case"right":case"end":j="right";break;case"center":j="center";break;default:j="left"}var O=this.pdf.getTextDimensions(E.text),B=P.call(this,E.y),Y=F.call(this,B)-O.h,le=this.ctx.transform.applyToPoint(new s(E.x,B)),fe=this.ctx.transform.decompose(),ce=new l;ce=(ce=(ce=ce.multiply(fe.translate)).multiply(fe.skew)).multiply(fe.scale);for(var de,Ce,X,$e=this.ctx.transform.applyToRectangle(new o(E.x,B,O.w,O.h)),be=ce.applyToRectangle(new o(E.x,Y,O.w,O.h)),ee=w.call(this,be),et=[],Re=0;Re<ee.length;Re+=1)et.indexOf(ee[Re])===-1&&et.push(ee[Re]);if(y(et),this.autoPaging)for(var tt=et[0],Me=et[et.length-1],at=tt;at<Me+1;at++){this.pdf.setPage(at);var Ye=at===1?this.posY+this.margin[0]:this.margin[0],At=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ut=this.pdf.internal.pageSize.height-this.margin[2],Ot=ut-this.margin[0],_t=this.pdf.internal.pageSize.width-this.margin[1],wt=_t-this.margin[3],er=at===1?0:At+(at-2)*Ot;if(this.ctx.clip_path.length!==0){var mt=this.path;de=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=b(de,this.posX+this.margin[3],-1*er+Ye),R.call(this,"fill",!0),this.path=mt}var it=b([JSON.parse(JSON.stringify(be))],this.posX+this.margin[3],-er+Ye+this.ctx.prevPageLastElemOffset)[0];E.scale>=.01&&(Ce=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Ce*E.scale),X=this.lineWidth,this.lineWidth=X*E.scale);var qe=this.autoPaging!=="text";if(qe||it.y+it.h<=ut){if(qe||it.y>=Ye&&it.x<=_t){var Ze=qe?E.text:this.pdf.splitTextToSize(E.text,E.maxWidth||_t-it.x)[0],Ht=b([JSON.parse(JSON.stringify($e))],this.posX+this.margin[3],-er+Ye+this.ctx.prevPageLastElemOffset)[0],kt=qe&&(at>tt||at<Me)&&x.call(this);kt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],wt,Ot,null).clip().discardPath()),this.pdf.text(Ze,Ht.x,Ht.y,{angle:E.angle,align:j,renderingMode:E.renderingMode}),kt&&this.pdf.restoreGraphicsState()}}else it.y<ut&&(this.ctx.prevPageLastElemOffset+=ut-it.y);E.scale>=.01&&(this.pdf.setFontSize(Ce),this.lineWidth=X)}else E.scale>=.01&&(Ce=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Ce*E.scale),X=this.lineWidth,this.lineWidth=X*E.scale),this.pdf.text(E.text,le.x+this.posX,le.y+this.posY,{angle:E.angle,align:j,renderingMode:E.renderingMode,maxWidth:E.maxWidth}),E.scale>=.01&&(this.pdf.setFontSize(Ce),this.lineWidth=X)},V=function(E,j,O,B){O=O||0,B=B||0,this.pdf.internal.out(r(E+O)+" "+n(j+B)+" l")},Q=function(E,j,O){return this.pdf.lines(E,j,O,null,null)},ue=function(E,j,O,B,Y,le,fe,ce){this.pdf.internal.out([t(a(O+E)),t(i(B+j)),t(a(Y+E)),t(i(le+j)),t(a(fe+E)),t(i(ce+j)),"c"].join(" "))},me=function(E,j,O,B){for(var Y=2*Math.PI,le=Math.PI/2;j>O;)j-=Y;var fe=Math.abs(O-j);fe<Y&&B&&(fe=Y-fe);for(var ce=[],de=B?-1:1,Ce=j;fe>1e-5;){var X=Ce+de*Math.min(fe,le);ce.push(pe.call(this,E,Ce,X)),fe-=Math.abs(X-Ce),Ce=X}return ce},pe=function(E,j,O){var B=(O-j)/2,Y=E*Math.cos(B),le=E*Math.sin(B),fe=Y,ce=-le,de=fe*fe+ce*ce,Ce=de+fe*Y+ce*le,X=4/3*(Math.sqrt(2*de*Ce)-Ce)/(fe*le-ce*Y),$e=fe-X*ce,be=ce+X*fe,ee=$e,et=-be,Re=B+j,tt=Math.cos(Re),Me=Math.sin(Re);return{x1:E*Math.cos(j),y1:E*Math.sin(j),x2:$e*tt-be*Me,y2:$e*Me+be*tt,x3:ee*tt-et*Me,y3:ee*Me+et*tt,x4:E*Math.cos(O),y4:E*Math.sin(O)}},oe=function(E){return 180*E/Math.PI},G=function(E,j,O,B,Y,le){var fe=E+.5*(O-E),ce=j+.5*(B-j),de=Y+.5*(O-Y),Ce=le+.5*(B-le),X=Math.min(E,Y,fe,de),$e=Math.max(E,Y,fe,de),be=Math.min(j,le,ce,Ce),ee=Math.max(j,le,ce,Ce);return new o(X,be,$e-X,ee-be)},ve=function(E,j,O,B,Y,le,fe,ce){var de,Ce,X,$e,be,ee,et,Re,tt,Me,at,Ye,At,ut,Ot=O-E,_t=B-j,wt=Y-O,er=le-B,mt=fe-Y,it=ce-le;for(Ce=0;Ce<41;Ce++)tt=(et=(X=E+(de=Ce/40)*Ot)+de*((be=O+de*wt)-X))+de*(be+de*(Y+de*mt-be)-et),Me=(Re=($e=j+de*_t)+de*((ee=B+de*er)-$e))+de*(ee+de*(le+de*it-ee)-Re),Ce==0?(at=tt,Ye=Me,At=tt,ut=Me):(at=Math.min(at,tt),Ye=Math.min(Ye,Me),At=Math.max(At,tt),ut=Math.max(ut,Me));return new o(Math.round(at),Math.round(Ye),Math.round(At-at),Math.round(ut-Ye))},_e=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var E,j,O=(E=this.ctx.lineDash,j=this.ctx.lineDashOffset,JSON.stringify({lineDash:E,lineDashOffset:j}));this.prevLineDash!==O&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=O)}}})(xt.API),function(e){var t=function(s){var o,l,c,u,h,m,f,v,x,w;for(l=[],c=0,u=(s+=o="\0\0\0\0".slice(s.length%4||4)).length;u>c;c+=4)(h=(s.charCodeAt(c)<<24)+(s.charCodeAt(c+1)<<16)+(s.charCodeAt(c+2)<<8)+s.charCodeAt(c+3))!==0?(m=(h=((h=((h=((h=(h-(w=h%85))/85)-(x=h%85))/85)-(v=h%85))/85)-(f=h%85))/85)%85,l.push(m+33,f+33,v+33,x+33,w+33)):l.push(122);return function(_,b){for(var y=b;y>0;y--)_.pop()}(l,o.length),String.fromCharCode.apply(String,l)+"~>"},r=function(s){var o,l,c,u,h,m=String,f="length",v=255,x="charCodeAt",w="slice",_="replace";for(s[w](-2),s=s[w](0,-2)[_](/\s/g,"")[_]("z","!!!!!"),c=[],u=0,h=(s+=o="uuuuu"[w](s[f]%5||5))[f];h>u;u+=5)l=52200625*(s[x](u)-33)+614125*(s[x](u+1)-33)+7225*(s[x](u+2)-33)+85*(s[x](u+3)-33)+(s[x](u+4)-33),c.push(v&l>>24,v&l>>16,v&l>>8,v&l);return function(b,y){for(var N=y;N>0;N--)b.pop()}(c,o[f]),m.fromCharCode.apply(m,c)},n=function(s){return s.split("").map(function(o){return("0"+o.charCodeAt().toString(16)).slice(-2)}).join("")+">"},a=function(s){var o=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((s=s.replace(/\s/g,"")).indexOf(">")!==-1&&(s=s.substr(0,s.indexOf(">"))),s.length%2&&(s+="0"),o.test(s)===!1)return"";for(var l="",c=0;c<s.length;c+=2)l+=String.fromCharCode("0x"+(s[c]+s[c+1]));return l},i=function(s){for(var o=new Uint8Array(s.length),l=s.length;l--;)o[l]=s.charCodeAt(l);return(o=Ex(o)).reduce(function(c,u){return c+String.fromCharCode(u)},"")};e.processDataByFilters=function(s,o){var l=0,c=s||"",u=[];for(typeof(o=o||[])=="string"&&(o=[o]),l=0;l<o.length;l+=1)switch(o[l]){case"ASCII85Decode":case"/ASCII85Decode":c=r(c),u.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":c=t(c),u.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":c=a(c),u.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":c=n(c),u.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":c=i(c),u.push("/FlateDecode");break;default:throw new Error('The filter: "'+o[l]+'" is not implemented')}return{data:c,reverseChain:u.reverse().join(" ")}}}(xt.API),function(e){e.loadFile=function(t,r,n){return function(a,i,s){i=i!==!1,s=typeof s=="function"?s:function(){};var o=void 0;try{o=function(l,c,u){var h=new XMLHttpRequest,m=0,f=function(v){var x=v.length,w=[],_=String.fromCharCode;for(m=0;m<x;m+=1)w.push(_(255&v.charCodeAt(m)));return w.join("")};if(h.open("GET",l,!c),h.overrideMimeType("text/plain; charset=x-user-defined"),c===!1&&(h.onload=function(){h.status===200?u(f(this.responseText)):u(void 0)}),h.send(null),c&&h.status===200)return f(h.responseText)}(a,i,s)}catch{}return o}(t,r,n)},e.loadImageFile=e.loadFile}(xt.API),function(e){function t(){return(Ft.html2canvas?Promise.resolve(Ft.html2canvas):uo(()=>import("./html2canvas.esm-CBrSDip1.js"),[])).catch(function(o){return Promise.reject(new Error("Could not load html2canvas: "+o))}).then(function(o){return o.default?o.default:o})}function r(){return(Ft.DOMPurify?Promise.resolve(Ft.DOMPurify):uo(()=>import("./purify.es-DfngIMfA.js"),[])).catch(function(o){return Promise.reject(new Error("Could not load dompurify: "+o))}).then(function(o){return o.default?o.default:o})}var n=function(o){var l=vr(o);return l==="undefined"?"undefined":l==="string"||o instanceof String?"string":l==="number"||o instanceof Number?"number":l==="function"||o instanceof Function?"function":o&&o.constructor===Array?"array":o&&o.nodeType===1?"element":l==="object"?"object":"unknown"},a=function(o,l){var c=document.createElement(o);for(var u in l.className&&(c.className=l.className),l.innerHTML&&l.dompurify&&(c.innerHTML=l.dompurify.sanitize(l.innerHTML)),l.style)c.style[u]=l.style[u];return c},i=function o(l,c){for(var u=l.nodeType===3?document.createTextNode(l.nodeValue):l.cloneNode(!1),h=l.firstChild;h;h=h.nextSibling)c!==!0&&h.nodeType===1&&h.nodeName==="SCRIPT"||u.appendChild(o(h,c));return l.nodeType===1&&(l.nodeName==="CANVAS"?(u.width=l.width,u.height=l.height,u.getContext("2d").drawImage(l,0,0)):l.nodeName!=="TEXTAREA"&&l.nodeName!=="SELECT"||(u.value=l.value),u.addEventListener("load",function(){u.scrollTop=l.scrollTop,u.scrollLeft=l.scrollLeft},!0)),u},s=function o(l){var c=Object.assign(o.convert(Promise.resolve()),JSON.parse(JSON.stringify(o.template))),u=o.convert(Promise.resolve(),c);return(u=u.setProgress(1,o,1,[o])).set(l)};(s.prototype=Object.create(Promise.prototype)).constructor=s,s.convert=function(o,l){return o.__proto__=l||s.prototype,o},s.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},s.prototype.from=function(o,l){return this.then(function(){switch(l=l||function(c){switch(n(c)){case"string":return"string";case"element":return c.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(o),l){case"string":return this.then(r).then(function(c){return this.set({src:a("div",{innerHTML:o,dompurify:c})})});case"element":return this.set({src:o});case"canvas":return this.set({canvas:o});case"img":return this.set({img:o});default:return this.error("Unknown source type.")}})},s.prototype.to=function(o){switch(o){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},s.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var o={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},l=i(this.prop.src,this.opt.html2canvas.javascriptEnabled);l.tagName==="BODY"&&(o.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=a("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=a("div",{className:"html2pdf__container",style:o}),this.prop.container.appendChild(l),this.prop.container.firstChild.appendChild(a("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},s.prototype.toCanvas=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(t).then(function(l){var c=Object.assign({},this.opt.html2canvas);return delete c.onrendered,l(this.prop.container,c)}).then(function(l){(this.opt.html2canvas.onrendered||function(){})(l),this.prop.canvas=l,document.body.removeChild(this.prop.overlay)})},s.prototype.toContext2d=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(t).then(function(l){var c=this.opt.jsPDF,u=this.opt.fontFaces,h=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,m=Object.assign({async:!0,allowTaint:!0,scale:h,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete m.onrendered,c.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,c.context2d.posX=this.opt.x,c.context2d.posY=this.opt.y,c.context2d.margin=this.opt.margin,c.context2d.fontFaces=u,u)for(var f=0;f<u.length;++f){var v=u[f],x=v.src.find(function(w){return w.format==="truetype"});x&&c.addFont(x.url,v.ref.name,v.ref.style)}return m.windowHeight=m.windowHeight||0,m.windowHeight=m.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):m.windowHeight,c.context2d.save(!0),l(this.prop.container,m)}).then(function(l){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(l),this.prop.canvas=l,document.body.removeChild(this.prop.overlay)})},s.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var o=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=o})},s.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},s.prototype.output=function(o,l,c){return(c=c||"pdf").toLowerCase()==="img"||c.toLowerCase()==="image"?this.outputImg(o,l):this.outputPdf(o,l)},s.prototype.outputPdf=function(o,l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(o,l)})},s.prototype.outputImg=function(o){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(o){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+o+'" is not supported.'}})},s.prototype.save=function(o){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(o?{filename:o}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},s.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},s.prototype.set=function(o){if(n(o)!=="object")return this;var l=Object.keys(o||{}).map(function(c){if(c in s.template.prop)return function(){this.prop[c]=o[c]};switch(c){case"margin":return this.setMargin.bind(this,o.margin);case"jsPDF":return function(){return this.opt.jsPDF=o.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,o.pageSize);default:return function(){this.opt[c]=o[c]}}},this);return this.then(function(){return this.thenList(l)})},s.prototype.get=function(o,l){return this.then(function(){var c=o in s.template.prop?this.prop[o]:this.opt[o];return l?l(c):c})},s.prototype.setMargin=function(o){return this.then(function(){switch(n(o)){case"number":o=[o,o,o,o];case"array":if(o.length===2&&(o=[o[0],o[1],o[0],o[1]]),o.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=o}).then(this.setPageSize)},s.prototype.setPageSize=function(o){function l(c,u){return Math.floor(c*u/72*96)}return this.then(function(){(o=o||xt.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(o.inner={width:o.width-this.opt.margin[1]-this.opt.margin[3],height:o.height-this.opt.margin[0]-this.opt.margin[2]},o.inner.px={width:l(o.inner.width,o.k),height:l(o.inner.height,o.k)},o.inner.ratio=o.inner.height/o.inner.width),this.prop.pageSize=o})},s.prototype.setProgress=function(o,l,c,u){return o!=null&&(this.progress.val=o),l!=null&&(this.progress.state=l),c!=null&&(this.progress.n=c),u!=null&&(this.progress.stack=u),this.progress.ratio=this.progress.val/this.progress.state,this},s.prototype.updateProgress=function(o,l,c,u){return this.setProgress(o?this.progress.val+o:null,l||null,c?this.progress.n+c:null,u?this.progress.stack.concat(u):null)},s.prototype.then=function(o,l){var c=this;return this.thenCore(o,l,function(u,h){return c.updateProgress(null,null,1,[u]),Promise.prototype.then.call(this,function(m){return c.updateProgress(null,u),m}).then(u,h).then(function(m){return c.updateProgress(1),m})})},s.prototype.thenCore=function(o,l,c){c=c||Promise.prototype.then;var u=this;o&&(o=o.bind(u)),l&&(l=l.bind(u));var h=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?u:s.convert(Object.assign({},u),Promise.prototype),m=c.call(h,o,l);return s.convert(m,u.__proto__)},s.prototype.thenExternal=function(o,l){return Promise.prototype.then.call(this,o,l)},s.prototype.thenList=function(o){var l=this;return o.forEach(function(c){l=l.thenCore(c)}),l},s.prototype.catch=function(o){o&&(o=o.bind(this));var l=Promise.prototype.catch.call(this,o);return s.convert(l,this)},s.prototype.catchExternal=function(o){return Promise.prototype.catch.call(this,o)},s.prototype.error=function(o){return this.then(function(){throw new Error(o)})},s.prototype.using=s.prototype.set,s.prototype.saveAs=s.prototype.save,s.prototype.export=s.prototype.output,s.prototype.run=s.prototype.then,xt.getPageSize=function(o,l,c){if(vr(o)==="object"){var u=o;o=u.orientation,l=u.unit||l,c=u.format||c}l=l||"mm",c=c||"a4",o=(""+(o||"P")).toLowerCase();var h,m=(""+c).toLowerCase(),f={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(l){case"pt":h=1;break;case"mm":h=72/25.4;break;case"cm":h=72/2.54;break;case"in":h=72;break;case"px":h=.75;break;case"pc":case"em":h=12;break;case"ex":h=6;break;default:throw"Invalid unit: "+l}var v,x=0,w=0;if(f.hasOwnProperty(m))x=f[m][1]/h,w=f[m][0]/h;else try{x=c[1],w=c[0]}catch{throw new Error("Invalid format: "+c)}if(o==="p"||o==="portrait")o="p",w>x&&(v=w,w=x,x=v);else{if(o!=="l"&&o!=="landscape")throw"Invalid orientation: "+o;o="l",x>w&&(v=w,w=x,x=v)}return{width:w,height:x,unit:l,k:h,orientation:o}},e.html=function(o,l){(l=l||{}).callback=l.callback||function(){},l.html2canvas=l.html2canvas||{},l.html2canvas.canvas=l.html2canvas.canvas||this.canvas,l.jsPDF=l.jsPDF||this,l.fontFaces=l.fontFaces?l.fontFaces.map(e2):null;var c=new s(l);return l.worker?c:c.from(o).doCallback()}}(xt.API),xt.API.addJS=function(e){return Sb=e,this.internal.events.subscribe("postPutResources",function(){c1=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(c1+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),kb=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+Sb+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){c1!==void 0&&kb!==void 0&&this.internal.out("/Names <</JavaScript "+c1+" 0 R>>")}),this},function(e){var t;e.events.push(["postPutResources",function(){var r=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var a=r.outline.render().split(/\r\n/),i=0;i<a.length;i++){var s=a[i],o=n.exec(s);if(o!=null){var l=o[1];r.internal.newObjectDeferredBegin(l,!1)}r.internal.write(s)}if(this.outline.createNamedDestinations){var c=this.internal.pages.length,u=[];for(i=0;i<c;i++){var h=r.internal.newObject();u.push(h);var m=r.internal.getPageInfo(i+1);r.internal.write("<< /D["+m.objId+" 0 R /XYZ null null null]>> endobj")}var f=r.internal.newObject();for(r.internal.write("<< /Names [ "),i=0;i<u.length;i++)r.internal.write("(page_"+(i+1)+")"+u[i]+" 0 R");r.internal.write(" ] >>","endobj"),t=r.internal.newObject(),r.internal.write("<< /Dests "+f+" 0 R"),r.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){var r=this;r.outline.root.children.length>0&&(r.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&r.internal.write("/Names "+t+" 0 R"))}]),e.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(n,a,i){var s={title:a,options:i,children:[]};return n==null&&(n=this.root),n.children.push(s),s},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(n){n.id=r.internal.newObjectDeferred();for(var a=0;a<n.children.length;a++)this.genIds_r(n.children[a])},r.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},r.outline.renderItems=function(n){for(var a=this.ctx.pdf.internal.getVerticalCoordinateString,i=0;i<n.children.length;i++){var s=n.children[i];this.objStart(s),this.line("/Title "+this.makeString(s.title)),this.line("/Parent "+this.makeRef(n)),i>0&&this.line("/Prev "+this.makeRef(n.children[i-1])),i<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[i+1])),s.children.length>0&&(this.line("/First "+this.makeRef(s.children[0])),this.line("/Last "+this.makeRef(s.children[s.children.length-1])));var o=this.count=this.count_r({count:0},s);if(o>0&&this.line("/Count "+o),s.options&&s.options.pageNumber){var l=r.internal.getPageInfo(s.options.pageNumber);this.line("/Dest ["+l.objId+" 0 R /XYZ 0 "+a(0)+" 0]")}this.objEnd()}for(var c=0;c<n.children.length;c++)this.renderItems(n.children[c])},r.outline.line=function(n){this.ctx.val+=n+`\r
`},r.outline.makeRef=function(n){return n.id+" 0 R"},r.outline.makeString=function(n){return"("+r.internal.pdfEscape(n)+")"},r.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(n,a){for(var i=0;i<a.children.length;i++)n.count++,this.count_r(n,a.children[i]);return n.count}}])}(xt.API),function(e){var t=[192,193,194,195,196,197,198,199];e.processJPEG=function(r,n,a,i,s,o){var l,c=this.decode.DCT_DECODE,u=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=s||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,l=function(h){for(var m,f=256*h.charCodeAt(4)+h.charCodeAt(5),v=h.length,x={width:0,height:0,numcomponents:1},w=4;w<v;w+=2){if(w+=f,t.indexOf(h.charCodeAt(w+1))!==-1){m=256*h.charCodeAt(w+5)+h.charCodeAt(w+6),x={width:256*h.charCodeAt(w+7)+h.charCodeAt(w+8),height:m,numcomponents:h.charCodeAt(w+9)};break}f=256*h.charCodeAt(w+2)+h.charCodeAt(w+3)}return x}(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r),l.numcomponents){case 1:o=this.color_spaces.DEVICE_GRAY;break;case 4:o=this.color_spaces.DEVICE_CMYK;break;case 3:o=this.color_spaces.DEVICE_RGB}u={data:r,width:l.width,height:l.height,colorSpace:o,bitsPerComponent:8,filter:c,index:n,alias:a}}return u}}(xt.API),xt.API.processPNG=function(e,t,r,n){if(this.__addimage__.isArrayBuffer(e)&&(e=new Uint8Array(e)),this.__addimage__.isArrayBufferView(e)){var a,i=wV(e,{checkCrc:!0}),s=i.width,o=i.height,l=i.channels,c=i.palette,u=i.depth;a=c&&l===1?function(C){for(var A=C.width,W=C.height,L=C.data,I=C.palette,V=C.depth,Q=!1,ue=[],me=[],pe=void 0,oe=!1,G=0,ve=0;ve<I.length;ve++){var _e=v4(I[ve],4),E=_e[0],j=_e[1],O=_e[2],B=_e[3];ue.push(E,j,O),B!=null&&(B===0?(G++,me.length<1&&me.push(ve)):B<255&&(oe=!0))}if(oe||G>1){Q=!0,me=void 0;var Y=A*W;pe=new Uint8Array(Y);for(var le=new DataView(L.buffer),fe=0;fe<Y;fe++){var ce=r2(le,fe,V),de=v4(I[ce],4)[3];pe[fe]=de}}else G===0&&(me=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:Q?8:void 0,colorBytes:L,alphaBytes:pe,needSMask:Q,palette:ue,mask:me}}(i):l===2||l===4?function(C){for(var A=C.data,W=C.width,L=C.height,I=C.channels,V=C.depth,Q=I===2?"DeviceGray":"DeviceRGB",ue=I-1,me=W*L,pe=ue,oe=me*pe,G=1*me,ve=Math.ceil(oe*V/8),_e=Math.ceil(G*V/8),E=new Uint8Array(ve),j=new Uint8Array(_e),O=new DataView(A.buffer),B=new DataView(E.buffer),Y=new DataView(j.buffer),le=!1,fe=0;fe<me;fe++){for(var ce=fe*I,de=0;de<pe;de++)Ib(B,r2(O,ce+de,V),fe*pe+de,V);var Ce=r2(O,ce+pe,V);Ce<(1<<V)-1&&(le=!0),Ib(Y,Ce,1*fe,V)}return{colorSpace:Q,colorsPerPixel:ue,sMaskBitsPerComponent:le?V:void 0,colorBytes:E,alphaBytes:j,needSMask:le}}(i):function(C){var A=C.data,W=C.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:W,colorsPerPixel:W==="DeviceGray"?1:3,colorBytes:A instanceof Uint16Array?function(L){for(var I=L.length,V=new Uint8Array(2*I),Q=new DataView(V.buffer,V.byteOffset,V.byteLength),ue=0;ue<I;ue++)Q.setUint16(2*ue,L[ue],!1);return V}(A):A,needSMask:!1}}(i);var h,m,f,v=a,x=v.colorSpace,w=v.colorsPerPixel,_=v.sMaskBitsPerComponent,b=v.colorBytes,y=v.alphaBytes,N=v.needSMask,R=v.palette,P=v.mask,F=null;return n!==xt.API.image_compression.NONE&&typeof Ex=="function"?(F=function(C){var A;switch(C){case xt.API.image_compression.FAST:A=11;break;case xt.API.image_compression.MEDIUM:A=13;break;case xt.API.image_compression.SLOW:A=14;break;default:A=12}return A}(n),h=this.decode.FLATE_DECODE,m="/Predictor ".concat(F," /Colors ").concat(w," /BitsPerComponent ").concat(u," /Columns ").concat(s),e=Tb(b,Math.ceil(s*w*u/8),w,u,n),N&&(f=Tb(y,Math.ceil(s*_/8),1,_,n))):(h=void 0,m=void 0,e=b,N&&(f=y)),(this.__addimage__.isArrayBuffer(e)||this.__addimage__.isArrayBufferView(e))&&(e=this.__addimage__.arrayBufferToBinaryString(e)),(f&&this.__addimage__.isArrayBuffer(f)||this.__addimage__.isArrayBufferView(f))&&(f=this.__addimage__.arrayBufferToBinaryString(f)),{alias:r,data:e,index:t,filter:h,decodeParameters:m,transparency:P,palette:R,sMask:f,predictor:F,width:s,height:o,bitsPerComponent:u,sMaskBitsPerComponent:_,colorSpace:x}}},function(e){e.processGIF89A=function(t,r,n,a){var i=new zV(t),s=i.width,o=i.height,l=[];i.decodeAndBlitFrameRGBA(0,l);var c={data:l,width:s,height:o},u=new n2(100).encode(c,100);return e.processJPEG.call(this,u,r,n,a)},e.processGIF87A=e.processGIF89A}(xt.API),Qi.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var t=0;t<e;t++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:a,green:n,blue:r,quad:i}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Qi.prototype.parseBGR=function(){this.pos=this.offset;try{var e="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[e]()}catch(r){Nr.log("bit decode error:"+r)}},Qi.prototype.bit1=function(){var e,t=Math.ceil(this.width/8),r=t%4;for(e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,a=0;a<t;a++)for(var i=this.datav.getUint8(this.pos++,!0),s=n*this.width*4+8*a*4,o=0;o<8&&8*a+o<this.width;o++){var l=this.palette[i>>7-o&1];this.data[s+4*o]=l.blue,this.data[s+4*o+1]=l.green,this.data[s+4*o+2]=l.red,this.data[s+4*o+3]=255}r!==0&&(this.pos+=4-r)}},Qi.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),t=e%4,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,a=0;a<e;a++){var i=this.datav.getUint8(this.pos++,!0),s=n*this.width*4+2*a*4,o=i>>4,l=15&i,c=this.palette[o];if(this.data[s]=c.blue,this.data[s+1]=c.green,this.data[s+2]=c.red,this.data[s+3]=255,2*a+1>=this.width)break;c=this.palette[l],this.data[s+4]=c.blue,this.data[s+4+1]=c.green,this.data[s+4+2]=c.red,this.data[s+4+3]=255}t!==0&&(this.pos+=4-t)}},Qi.prototype.bit8=function(){for(var e=this.width%4,t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var a=this.datav.getUint8(this.pos++,!0),i=r*this.width*4+4*n;if(a<this.palette.length){var s=this.palette[a];this.data[i]=s.red,this.data[i+1]=s.green,this.data[i+2]=s.blue,this.data[i+3]=255}else this.data[i]=255,this.data[i+1]=255,this.data[i+2]=255,this.data[i+3]=255}e!==0&&(this.pos+=4-e)}},Qi.prototype.bit15=function(){for(var e=this.width%3,t=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,a=0;a<this.width;a++){var i=this.datav.getUint16(this.pos,!0);this.pos+=2;var s=(i&t)/t*255|0,o=(i>>5&t)/t*255|0,l=(i>>10&t)/t*255|0,c=i>>15?255:0,u=n*this.width*4+4*a;this.data[u]=l,this.data[u+1]=o,this.data[u+2]=s,this.data[u+3]=c}this.pos+=e}},Qi.prototype.bit16=function(){for(var e=this.width%3,t=parseInt("11111",2),r=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var a=this.bottom_up?n:this.height-1-n,i=0;i<this.width;i++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(s&t)/t*255|0,l=(s>>5&r)/r*255|0,c=(s>>11)/t*255|0,u=a*this.width*4+4*i;this.data[u]=c,this.data[u+1]=l,this.data[u+2]=o,this.data[u+3]=255}this.pos+=e}},Qi.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=t*this.width*4+4*r;this.data[s]=i,this.data[s+1]=a,this.data[s+2]=n,this.data[s+3]=255}this.pos+=this.width%4}},Qi.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=t*this.width*4+4*r;this.data[o]=i,this.data[o+1]=a,this.data[o+2]=n,this.data[o+3]=s}},Qi.prototype.getData=function(){return this.data},function(e){e.processBMP=function(t,r,n,a){var i=new Qi(t,!1),s=i.width,o=i.height,l={data:i.getData(),width:s,height:o},c=new n2(100).encode(l,100);return e.processJPEG.call(this,c,r,n,a)}}(xt.API),jb.prototype.getData=function(){return this.data},function(e){e.processWEBP=function(t,r,n,a){var i=new jb(t),s=i.width,o=i.height,l={data:i.getData(),width:s,height:o},c=new n2(100).encode(l,100);return e.processJPEG.call(this,c,r,n,a)}}(xt.API),xt.API.processRGBA=function(e,t,r){for(var n=e.data,a=n.length,i=new Uint8Array(a/4*3),s=new Uint8Array(a/4),o=0,l=0,c=0;c<a;c+=4){var u=n[c],h=n[c+1],m=n[c+2],f=n[c+3];i[o++]=u,i[o++]=h,i[o++]=m,s[l++]=f}var v=this.__addimage__.arrayBufferToBinaryString(i);return{alpha:this.__addimage__.arrayBufferToBinaryString(s),data:v,index:t,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},xt.API.setLanguage=function(e){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]!==void 0&&(this.internal.languageSettings.languageCode=e,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},m0=xt.API,u1=m0.getCharWidthsArray=function(e,t){var r,n,a=(t=t||{}).font||this.internal.getFont(),i=t.fontSize||this.internal.getFontSize(),s=t.charSpace||this.internal.getCharSpace(),o=t.widths?t.widths:a.metadata.Unicode.widths,l=o.fof?o.fof:1,c=t.kerning?t.kerning:a.metadata.Unicode.kerning,u=c.fof?c.fof:1,h=t.doKerning!==!1,m=0,f=e.length,v=0,x=o[0]||l,w=[];for(r=0;r<f;r++)n=e.charCodeAt(r),typeof a.metadata.widthOfString=="function"?w.push((a.metadata.widthOfGlyph(a.metadata.characterToGlyph(n))+s*(1e3/i)||0)/1e3):(m=h&&vr(c[n])==="object"&&!isNaN(parseInt(c[n][v],10))?c[n][v]/u:0,w.push((o[n]||x)/l+m)),v=n;return w},Nb=m0.getStringUnitWidth=function(e,t){var r=(t=t||{}).fontSize||this.internal.getFontSize(),n=t.font||this.internal.getFont(),a=t.charSpace||this.internal.getCharSpace();return m0.processArabic&&(e=m0.processArabic(e)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(e,r,a)/r:u1.apply(this,arguments).reduce(function(i,s){return i+s},0)},Eb=function(e,t,r,n){for(var a=[],i=0,s=e.length,o=0;i!==s&&o+t[i]<r;)o+=t[i],i++;a.push(e.slice(0,i));var l=i;for(o=0;i!==s;)o+t[i]>n&&(a.push(e.slice(l,i)),o=0,l=i),o+=t[i],i++;return l!==i&&a.push(e.slice(l,i)),a},Ab=function(e,t,r){r||(r={});var n,a,i,s,o,l,c,u=[],h=[u],m=r.textIndent||0,f=0,v=0,x=e.split(" "),w=u1.apply(this,[" ",r])[0];if(l=r.lineIndent===-1?x[0].length+2:r.lineIndent||0){var _=Array(l).join(" "),b=[];x.map(function(N){(N=N.split(/\s*\n/)).length>1?b=b.concat(N.map(function(R,P){return(P&&R.length?`
`:"")+R})):b.push(N[0])}),x=b,l=Nb.apply(this,[_,r])}for(i=0,s=x.length;i<s;i++){var y=0;if(n=x[i],l&&n[0]==`
`&&(n=n.substr(1),y=1),m+f+(v=(a=u1.apply(this,[n,r])).reduce(function(N,R){return N+R},0))>t||y){if(v>t){for(o=Eb.apply(this,[n,a,t-(m+f),t]),u.push(o.shift()),u=[o.pop()];o.length;)h.push([o.shift()]);v=a.slice(n.length-(u[0]?u[0].length:0)).reduce(function(N,R){return N+R},0)}else u=[n];h.push(u),m=v+l,f=w}else u.push(n),m+=f+v,f=w}return c=l?function(N,R){return(R?_:"")+N.join(" ")}:function(N){return N.join(" ")},h.map(c)},m0.splitTextToSize=function(e,t,r){var n,a=(r=r||{}).fontSize||this.internal.getFontSize(),i=(function(u){if(u.widths&&u.kerning)return{widths:u.widths,kerning:u.kerning};var h=this.internal.getFont(u.fontName,u.fontStyle),m="Unicode";return h.metadata[m]?{widths:h.metadata[m].widths||{0:1},kerning:h.metadata[m].kerning||{}}:{font:h.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);n=Array.isArray(e)?e:String(e).split(/\r?\n/);var s=1*this.internal.scaleFactor*t/a;i.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/a:0,i.lineIndent=r.lineIndent;var o,l,c=[];for(o=0,l=n.length;o<l;o++)c=c.concat(Ab.apply(this,[n[o],s,i]));return c},function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var t="0123456789abcdef",r="klmnopqrstuvwxyz",n={},a={},i=0;i<16;i++)n[r[i]]=t[i],a[t[i]]=r[i];var s=function(m){return"0x"+parseInt(m,10).toString(16)},o=e.__fontmetrics__.compress=function(m){var f,v,x,w,_=["{"];for(var b in m){if(f=m[b],isNaN(parseInt(b,10))?v="'"+b+"'":(b=parseInt(b,10),v=(v=s(b).slice(2)).slice(0,-1)+a[v.slice(-1)]),typeof f=="number")f<0?(x=s(f).slice(3),w="-"):(x=s(f).slice(2),w=""),x=w+x.slice(0,-1)+a[x.slice(-1)];else{if(vr(f)!=="object")throw new Error("Don't know what to do with value type "+vr(f)+".");x=o(f)}_.push(v+x)}return _.push("}"),_.join("")},l=e.__fontmetrics__.uncompress=function(m){if(typeof m!="string")throw new Error("Invalid argument passed to uncompress.");for(var f,v,x,w,_={},b=1,y=_,N=[],R="",P="",F=m.length-1,C=1;C<F;C+=1)(w=m[C])=="'"?f?(x=f.join(""),f=void 0):f=[]:f?f.push(w):w=="{"?(N.push([y,x]),y={},x=void 0):w=="}"?((v=N.pop())[0][v[1]]=y,x=void 0,y=v[0]):w=="-"?b=-1:x===void 0?n.hasOwnProperty(w)?(R+=n[w],x=parseInt(R,16)*b,b=1,R=""):R+=w:n.hasOwnProperty(w)?(P+=n[w],y[x]=parseInt(P,16)*b,b=1,x=void 0,P=""):P+=w;return _},c={codePages:["WinAnsiEncoding"],WinAnsiEncoding:l("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},u={Unicode:{Courier:c,"Courier-Bold":c,"Courier-BoldOblique":c,"Courier-Oblique":c,Helvetica:c,"Helvetica-Bold":c,"Helvetica-BoldOblique":c,"Helvetica-Oblique":c,"Times-Roman":c,"Times-Bold":c,"Times-BoldItalic":c,"Times-Italic":c}},h={Unicode:{"Courier-Oblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":l("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":l("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:l("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:l("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":l("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":l("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(m){var f=m.font,v=h.Unicode[f.postScriptName];v&&(f.metadata.Unicode={},f.metadata.Unicode.widths=v.widths,f.metadata.Unicode.kerning=v.kerning);var x=u.Unicode[f.postScriptName];x&&(f.metadata.Unicode.encoding=x,f.encoding=x.codePages[0])}])}(xt.API),function(e){var t=function(r){for(var n=r.length,a=new Uint8Array(n),i=0;i<n;i++)a[i]=r.charCodeAt(i);return a};e.API.events.push(["addFont",function(r){var n=void 0,a=r.font,i=r.instance;if(!a.isStandardFont){if(i===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+a.postScriptName+"').");if(typeof(n=i.existsFileInVFS(a.postScriptName)===!1?i.loadFile(a.postScriptName):i.getFileFromVFS(a.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+a.postScriptName+"').");(function(s,o){o=/^\x00\x01\x00\x00/.test(o)?t(o):t(E1(o)),s.metadata=e.API.TTFFont.open(o),s.metadata.Unicode=s.metadata.Unicode||{encoding:{},kerning:{},widths:[]},s.metadata.glyIdsUsed=[0]})(a,n)}}])}(xt),xt.API.addSvgAsImage=function(e,t,r,n,a,i,s,o){if(isNaN(t)||isNaN(r))throw Nr.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(n)||isNaN(a))throw Nr.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var l=document.createElement("canvas");l.width=n,l.height=a;var c=l.getContext("2d");c.fillStyle="#fff",c.fillRect(0,0,l.width,l.height);var u={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},h=this;return(Ft.canvg?Promise.resolve(Ft.canvg):uo(()=>import("./index.es-kiEbk0zL.js"),[])).catch(function(m){return Promise.reject(new Error("Could not load canvg: "+m))}).then(function(m){return m.default?m.default:m}).then(function(m){return m.fromString(c,e,u)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(m){return m.render(u)}).then(function(){h.addImage(l.toDataURL("image/jpeg",1),t,r,n,a,s,o)})},xt.API.putTotalPages=function(e){var t,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(e,"g"),r=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var a=0;a<this.internal.pages[n].length;a++)this.internal.pages[n][a]=this.internal.pages[n][a].replace(t,r);return this},xt.API.viewerPreferences=function(e,t){var r;e=e||{},t=t||!1;var n,a,i,s={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},o=Object.keys(s),l=[],c=0,u=0,h=0;function m(v,x){var w,_=!1;for(w=0;w<v.length;w+=1)v[w]===x&&(_=!0);return _}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(s)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,e==="reset"||t===!0){var f=o.length;for(h=0;h<f;h+=1)r[o[h]].value=r[o[h]].defaultValue,r[o[h]].explicitSet=!1}if(vr(e)==="object"){for(a in e)if(i=e[a],m(o,a)&&i!==void 0){if(r[a].type==="boolean"&&typeof i=="boolean")r[a].value=i;else if(r[a].type==="name"&&m(r[a].valueSet,i))r[a].value=i;else if(r[a].type==="integer"&&Number.isInteger(i))r[a].value=i;else if(r[a].type==="array"){for(c=0;c<i.length;c+=1)if(n=!0,i[c].length===1&&typeof i[c][0]=="number")l.push(String(i[c]-1));else if(i[c].length>1){for(u=0;u<i[c].length;u+=1)typeof i[c][u]!="number"&&(n=!1);n===!0&&l.push([i[c][0]-1,i[c][1]-1].join(" "))}r[a].value="["+l.join(" ")+"]"}else r[a].value=r[a].defaultValue;r[a].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var v,x=[];for(v in r)r[v].explicitSet===!0&&(r[v].type==="name"?x.push("/"+v+" /"+r[v].value):x.push("/"+v+" "+r[v].value));x.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+x.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},function(e){var t=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',a=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),i=unescape(encodeURIComponent(n)),s=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),o=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),l=unescape(encodeURIComponent("</x:xmpmeta>")),c=i.length+s.length+o.length+a.length+l.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+c+" >>"),this.internal.write("stream"),this.internal.write(a+i+s+o+l),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};e.addMetadata=function(n,a){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:a||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",t)),this}}(xt.API),function(e){var t=e.API,r=t.pdfEscape16=function(i,s){for(var o,l=s.metadata.Unicode.widths,c=["","0","00","000","0000"],u=[""],h=0,m=i.length;h<m;++h){if(o=s.metadata.characterToGlyph(i.charCodeAt(h)),s.metadata.glyIdsUsed.push(o),s.metadata.toUnicode[o]=i.charCodeAt(h),l.indexOf(o)==-1&&(l.push(o),l.push([parseInt(s.metadata.widthOfGlyph(o),10)])),o=="0")return u.join("");o=o.toString(16),u.push(c[4-o.length],o)}return u.join("")},n=function(i){var s,o,l,c,u,h,m;for(u=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,l=[],h=0,m=(o=Object.keys(i).sort(function(f,v){return f-v})).length;h<m;h++)s=o[h],l.length>=100&&(u+=`
`+l.length+` beginbfchar
`+l.join(`
`)+`
endbfchar`,l=[]),i[s]!==void 0&&i[s]!==null&&typeof i[s].toString=="function"&&(c=("0000"+i[s].toString(16)).slice(-4),s=("0000"+(+s).toString(16)).slice(-4),l.push("<"+s+"><"+c+">"));return l.length&&(u+=`
`+l.length+` beginbfchar
`+l.join(`
`)+`
endbfchar
`),u+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};t.events.push(["putFont",function(i){(function(s){var o=s.font,l=s.out,c=s.newObject,u=s.putStream;if(o.metadata instanceof e.API.TTFFont&&o.encoding==="Identity-H"){for(var h=o.metadata.Unicode.widths,m=o.metadata.subset.encode(o.metadata.glyIdsUsed,1),f="",v=0;v<m.length;v++)f+=String.fromCharCode(m[v]);var x=c();u({data:f,addLength1:!0,objectId:x}),l("endobj");var w=c();u({data:n(o.metadata.toUnicode),addLength1:!0,objectId:w}),l("endobj");var _=c();l("<<"),l("/Type /FontDescriptor"),l("/FontName /"+w0(o.fontName)),l("/FontFile2 "+x+" 0 R"),l("/FontBBox "+e.API.PDFObject.convert(o.metadata.bbox)),l("/Flags "+o.metadata.flags),l("/StemV "+o.metadata.stemV),l("/ItalicAngle "+o.metadata.italicAngle),l("/Ascent "+o.metadata.ascender),l("/Descent "+o.metadata.decender),l("/CapHeight "+o.metadata.capHeight),l(">>"),l("endobj");var b=c();l("<<"),l("/Type /Font"),l("/BaseFont /"+w0(o.fontName)),l("/FontDescriptor "+_+" 0 R"),l("/W "+e.API.PDFObject.convert(h)),l("/CIDToGIDMap /Identity"),l("/DW 1000"),l("/Subtype /CIDFontType2"),l("/CIDSystemInfo"),l("<<"),l("/Supplement 0"),l("/Registry (Adobe)"),l("/Ordering ("+o.encoding+")"),l(">>"),l(">>"),l("endobj"),o.objectNumber=c(),l("<<"),l("/Type /Font"),l("/Subtype /Type0"),l("/ToUnicode "+w+" 0 R"),l("/BaseFont /"+w0(o.fontName)),l("/Encoding /"+o.encoding),l("/DescendantFonts ["+b+" 0 R]"),l(">>"),l("endobj"),o.isAlreadyPutted=!0}})(i)}]),t.events.push(["putFont",function(i){(function(s){var o=s.font,l=s.out,c=s.newObject,u=s.putStream;if(o.metadata instanceof e.API.TTFFont&&o.encoding==="WinAnsiEncoding"){for(var h=o.metadata.rawData,m="",f=0;f<h.length;f++)m+=String.fromCharCode(h[f]);var v=c();u({data:m,addLength1:!0,objectId:v}),l("endobj");var x=c();u({data:n(o.metadata.toUnicode),addLength1:!0,objectId:x}),l("endobj");var w=c();l("<<"),l("/Descent "+o.metadata.decender),l("/CapHeight "+o.metadata.capHeight),l("/StemV "+o.metadata.stemV),l("/Type /FontDescriptor"),l("/FontFile2 "+v+" 0 R"),l("/Flags 96"),l("/FontBBox "+e.API.PDFObject.convert(o.metadata.bbox)),l("/FontName /"+w0(o.fontName)),l("/ItalicAngle "+o.metadata.italicAngle),l("/Ascent "+o.metadata.ascender),l(">>"),l("endobj"),o.objectNumber=c();for(var _=0;_<o.metadata.hmtx.widths.length;_++)o.metadata.hmtx.widths[_]=parseInt(o.metadata.hmtx.widths[_]*(1e3/o.metadata.head.unitsPerEm));l("<</Subtype/TrueType/Type/Font/ToUnicode "+x+" 0 R/BaseFont/"+w0(o.fontName)+"/FontDescriptor "+w+" 0 R/Encoding/"+o.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(o.metadata.hmtx.widths)+">>"),l("endobj"),o.isAlreadyPutted=!0}})(i)}]);var a=function(i){var s,o=i.text||"",l=i.x,c=i.y,u=i.options||{},h=i.mutex||{},m=h.pdfEscape,f=h.activeFontKey,v=h.fonts,x=f,w="",_=0,b="",y=v[x].encoding;if(v[x].encoding!=="Identity-H")return{text:o,x:l,y:c,options:u,mutex:h};for(b=o,x=f,Array.isArray(o)&&(b=o[0]),_=0;_<b.length;_+=1)v[x].metadata.hasOwnProperty("cmap")&&(s=v[x].metadata.cmap.unicode.codeMap[b[_].charCodeAt(0)]),s||b[_].charCodeAt(0)<256&&v[x].metadata.hasOwnProperty("Unicode")?w+=b[_]:w+="";var N="";return parseInt(x.slice(1))<14||y==="WinAnsiEncoding"?N=m(w,x).split("").map(function(R){return R.charCodeAt(0).toString(16)}).join(""):y==="Identity-H"&&(N=r(w,v[x])),h.isHex=!0,{text:N,x:l,y:c,options:u,mutex:h}};t.events.push(["postProcessText",function(i){var s=i.text||"",o=[],l={text:s,x:i.x,y:i.y,options:i.options,mutex:i.mutex};if(Array.isArray(s)){var c=0;for(c=0;c<s.length;c+=1)Array.isArray(s[c])&&s[c].length===3?o.push([a(Object.assign({},l,{text:s[c][0]})).text,s[c][1],s[c][2]]):o.push(a(Object.assign({},l,{text:s[c]})).text);i.text=o}else i.text=a(Object.assign({},l,{text:s})).text}])}(xt),function(e){var t=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0},e.addFileToVFS=function(r,n){return t.call(this),this.internal.vFS[r]=n,this},e.getFileFromVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}}(xt.API),function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(n){var a,i,s,o,l,c,u,h=t,m=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],f=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],v={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},x={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},w=["(",")","(","<",">","<","[","]","[","{","}","{","«","»","«","‹","›","‹","⁅","⁆","⁅","⁽","⁾","⁽","₍","₎","₍","≤","≥","≤","〈","〉","〈","﹙","﹚","﹙","﹛","﹜","﹛","﹝","﹞","﹝","﹤","﹥","﹤"],_=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),b=!1,y=0;this.__bidiEngine__={};var N=function(L){var I=L.charCodeAt(),V=I>>8,Q=x[V];return Q!==void 0?h[256*Q+(255&I)]:V===252||V===253?"AL":_.test(V)?"L":V===8?"R":"N"},R=function(L){for(var I,V=0;V<L.length;V++){if((I=N(L.charAt(V)))==="L")return!1;if(I==="R")return!0}return!1},P=function(L,I,V,Q){var ue,me,pe,oe,G=I[Q];switch(G){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":b=!1;break;case"N":case"AN":break;case"EN":b&&(G="AN");break;case"AL":b=!0,G="R";break;case"WS":case"BN":G="N";break;case"CS":Q<1||Q+1>=I.length||(ue=V[Q-1])!=="EN"&&ue!=="AN"||(me=I[Q+1])!=="EN"&&me!=="AN"?G="N":b&&(me="AN"),G=me===ue?me:"N";break;case"ES":G=(ue=Q>0?V[Q-1]:"B")==="EN"&&Q+1<I.length&&I[Q+1]==="EN"?"EN":"N";break;case"ET":if(Q>0&&V[Q-1]==="EN"){G="EN";break}if(b){G="N";break}for(pe=Q+1,oe=I.length;pe<oe&&I[pe]==="ET";)pe++;G=pe<oe&&I[pe]==="EN"?"EN":"N";break;case"NSM":if(s&&!o){for(oe=I.length,pe=Q+1;pe<oe&&I[pe]==="NSM";)pe++;if(pe<oe){var ve=L[Q],_e=ve>=1425&&ve<=2303||ve===64286;if(ue=I[pe],_e&&(ue==="R"||ue==="AL")){G="R";break}}}G=Q<1||(ue=I[Q-1])==="B"?"N":V[Q-1];break;case"B":b=!1,a=!0,G=y;break;case"S":i=!0,G="N"}return G},F=function(L,I,V){var Q=L.split("");return V&&C(Q,V,{hiLevel:y}),Q.reverse(),I&&I.reverse(),Q.join("")},C=function(L,I,V){var Q,ue,me,pe,oe,G=-1,ve=L.length,_e=0,E=[],j=y?f:m,O=[];for(b=!1,a=!1,i=!1,ue=0;ue<ve;ue++)O[ue]=N(L[ue]);for(me=0;me<ve;me++){if(oe=_e,E[me]=P(L,O,E,me),Q=240&(_e=j[oe][v[E[me]]]),_e&=15,I[me]=pe=j[_e][5],Q>0)if(Q===16){for(ue=G;ue<me;ue++)I[ue]=1;G=-1}else G=-1;if(j[_e][6])G===-1&&(G=me);else if(G>-1){for(ue=G;ue<me;ue++)I[ue]=pe;G=-1}O[me]==="B"&&(I[me]=0),V.hiLevel|=pe}i&&function(B,Y,le){for(var fe=0;fe<le;fe++)if(B[fe]==="S"){Y[fe]=y;for(var ce=fe-1;ce>=0&&B[ce]==="WS";ce--)Y[ce]=y}}(O,I,ve)},A=function(L,I,V,Q,ue){if(!(ue.hiLevel<L)){if(L===1&&y===1&&!a)return I.reverse(),void(V&&V.reverse());for(var me,pe,oe,G,ve=I.length,_e=0;_e<ve;){if(Q[_e]>=L){for(oe=_e+1;oe<ve&&Q[oe]>=L;)oe++;for(G=_e,pe=oe-1;G<pe;G++,pe--)me=I[G],I[G]=I[pe],I[pe]=me,V&&(me=V[G],V[G]=V[pe],V[pe]=me);_e=oe}_e++}}},W=function(L,I,V){var Q=L.split(""),ue={hiLevel:y};return V||(V=[]),C(Q,V,ue),function(me,pe,oe){if(oe.hiLevel!==0&&u)for(var G,ve=0;ve<me.length;ve++)pe[ve]===1&&(G=w.indexOf(me[ve]))>=0&&(me[ve]=w[G+1])}(Q,V,ue),A(2,Q,I,V,ue),A(1,Q,I,V,ue),Q.join("")};return this.__bidiEngine__.doBidiReorder=function(L,I,V){if(function(ue,me){if(me)for(var pe=0;pe<ue.length;pe++)me[pe]=pe;o===void 0&&(o=R(ue)),c===void 0&&(c=R(ue))}(L,I),s||!l||c)if(s&&l&&o^c)y=o?1:0,L=F(L,I,V);else if(!s&&l&&c)y=o?1:0,L=W(L,I,V),L=F(L,I);else if(!s||o||l||c){if(s&&!l&&o^c)L=F(L,I),o?(y=0,L=W(L,I,V)):(y=1,L=W(L,I,V),L=F(L,I));else if(s&&o&&!l&&c)y=1,L=W(L,I,V),L=F(L,I);else if(!s&&!l&&o^c){var Q=u;o?(y=1,L=W(L,I,V),y=0,u=!1,L=W(L,I,V),u=Q):(y=0,L=W(L,I,V),L=F(L,I),y=1,u=!1,L=W(L,I,V),u=Q,L=F(L,I))}}else y=0,L=W(L,I,V);else y=o?1:0,L=W(L,I,V);return L},this.__bidiEngine__.setOptions=function(L){L&&(s=L.isInputVisual,l=L.isOutputVisual,o=L.isInputRtl,c=L.isOutputRtl,u=L.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(n){var a=n.text;n.x,n.y;var i=n.options||{};n.mutex,i.lang;var s=[];if(i.isInputVisual=typeof i.isInputVisual!="boolean"||i.isInputVisual,r.setOptions(i),Object.prototype.toString.call(a)==="[object Array]"){var o=0;for(s=[],o=0;o<a.length;o+=1)Object.prototype.toString.call(a[o])==="[object Array]"?s.push([r.doBidiReorder(a[o][0]),a[o][1],a[o][2]]):s.push([r.doBidiReorder(a[o])]);n.text=s}else n.text=r.doBidiReorder(a);r.setOptions({isInputVisual:!0})}])}(xt),xt.API.TTFFont=function(){function e(t){var r;if(this.rawData=t,r=this.contents=new Nl(t),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new rq(this),this.registerTTF()}return e.open=function(t){return new e(t)},e.prototype.parse=function(){return this.directory=new $V(this.contents),this.head=new HV(this),this.name=new KV(this),this.cmap=new qE(this),this.toUnicode={},this.hhea=new VV(this),this.maxp=new YV(this),this.hmtx=new JV(this),this.post=new GV(this),this.os2=new qV(this),this.loca=new tq(this),this.glyf=new ZV(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var t,r,n,a,i;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var s,o,l,c;for(c=[],s=0,o=(l=this.bbox).length;s<o;s++)t=l[s],c.push(Math.round(t*this.scaleFactor));return c}).call(this),this.stemV=0,this.post.exists?(n=255&(a=this.post.italic_angle),32768&(r=a>>16)&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(i=this.familyClass)===1||i===2||i===3||i===4||i===5||i===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(t){var r;return((r=this.cmap.unicode)!=null?r.codeMap[t]:void 0)||0},e.prototype.widthOfGlyph=function(t){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*r},e.prototype.widthOfString=function(t,r,n){var a,i,s,o;for(s=0,i=0,o=(t=""+t).length;0<=o?i<o:i>o;i=0<=o?++i:--i)a=t.charCodeAt(i),s+=this.widthOfGlyph(this.characterToGlyph(a))+n*(1e3/r)||0;return s*(r/1e3)},e.prototype.lineHeight=function(t,r){var n;return r==null&&(r=!1),n=r?this.lineGap:0,(this.ascender+n-this.decender)/1e3*t},e}();var ps,Nl=function(){function e(t){this.data=t??[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(t){return this.data[this.pos++]=t},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},e.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},e.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},e.prototype.readString=function(t){var r,n;for(n=[],r=0;0<=t?r<t:r>t;r=0<=t?++r:--r)n[r]=String.fromCharCode(this.readByte());return n.join("")},e.prototype.writeString=function(t){var r,n,a;for(a=[],r=0,n=t.length;0<=n?r<n:r>n;r=0<=n?++r:--r)a.push(this.writeByte(t.charCodeAt(r)));return a},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(t){return this.writeInt16(t)},e.prototype.readLongLong=function(){var t,r,n,a,i,s,o,l;return t=this.readByte(),r=this.readByte(),n=this.readByte(),a=this.readByte(),i=this.readByte(),s=this.readByte(),o=this.readByte(),l=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^r)+1099511627776*(255^n)+4294967296*(255^a)+16777216*(255^i)+65536*(255^s)+256*(255^o)+(255^l)+1):72057594037927940*t+281474976710656*r+1099511627776*n+4294967296*a+16777216*i+65536*s+256*o+l},e.prototype.writeLongLong=function(t){var r,n;return r=Math.floor(t/4294967296),n=4294967295&t,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(t){return this.writeInt32(t)},e.prototype.read=function(t){var r,n;for(r=[],n=0;0<=t?n<t:n>t;n=0<=t?++n:--n)r.push(this.readByte());return r},e.prototype.write=function(t){var r,n,a,i;for(i=[],n=0,a=t.length;n<a;n++)r=t[n],i.push(this.writeByte(r));return i},e}(),$V=function(){var e;function t(r){var n,a,i;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},a=0,i=this.tableCount;0<=i?a<i:a>i;a=0<=i?++a:--a)n={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[n.tag]=n}return t.prototype.encode=function(r){var n,a,i,s,o,l,c,u,h,m,f,v,x;for(x in f=Object.keys(r).length,l=Math.log(2),h=16*Math.floor(Math.log(f)/l),s=Math.floor(h/l),u=16*f-h,(a=new Nl).writeInt(this.scalarType),a.writeShort(f),a.writeShort(h),a.writeShort(s),a.writeShort(u),i=16*f,c=a.pos+i,o=null,v=[],r)for(m=r[x],a.writeString(x),a.writeInt(e(m)),a.writeInt(c),a.writeInt(m.length),v=v.concat(m),x==="head"&&(o=c),c+=m.length;c%4;)v.push(0),c++;return a.write(v),n=2981146554-e(a.data),a.pos=o+8,a.writeUInt32(n),a.data},e=function(r){var n,a,i,s;for(r=GE.call(r);r.length%4;)r.push(0);for(i=new Nl(r),a=0,n=0,s=r.length;n<s;n=n+=4)a+=i.readUInt32();return 4294967295&a},t}(),WV={}.hasOwnProperty,Bs=function(e,t){for(var r in t)WV.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};ps=function(){function e(t){var r;this.file=t,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e}();var HV=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Bs(e,ps),e.prototype.tag="head",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.revision=t.readInt(),this.checkSumAdjustment=t.readInt(),this.magicNumber=t.readInt(),this.flags=t.readShort(),this.unitsPerEm=t.readShort(),this.created=t.readLongLong(),this.modified=t.readLongLong(),this.xMin=t.readShort(),this.yMin=t.readShort(),this.xMax=t.readShort(),this.yMax=t.readShort(),this.macStyle=t.readShort(),this.lowestRecPPEM=t.readShort(),this.fontDirectionHint=t.readShort(),this.indexToLocFormat=t.readShort(),this.glyphDataFormat=t.readShort()},e.prototype.encode=function(t){var r;return(r=new Nl).writeInt(this.version),r.writeInt(this.revision),r.writeInt(this.checkSumAdjustment),r.writeInt(this.magicNumber),r.writeShort(this.flags),r.writeShort(this.unitsPerEm),r.writeLongLong(this.created),r.writeLongLong(this.modified),r.writeShort(this.xMin),r.writeShort(this.yMin),r.writeShort(this.xMax),r.writeShort(this.yMax),r.writeShort(this.macStyle),r.writeShort(this.lowestRecPPEM),r.writeShort(this.fontDirectionHint),r.writeShort(t),r.writeShort(this.glyphDataFormat),r.data},e}(),Rb=function(){function e(t,r){var n,a,i,s,o,l,c,u,h,m,f,v,x,w,_,b,y;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=r+t.readInt(),h=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(l=0;l<256;++l)this.codeMap[l]=t.readByte();break;case 4:for(f=t.readUInt16(),m=f/2,t.pos+=6,i=function(){var N,R;for(R=[],l=N=0;0<=m?N<m:N>m;l=0<=m?++N:--N)R.push(t.readUInt16());return R}(),t.pos+=2,x=function(){var N,R;for(R=[],l=N=0;0<=m?N<m:N>m;l=0<=m?++N:--N)R.push(t.readUInt16());return R}(),c=function(){var N,R;for(R=[],l=N=0;0<=m?N<m:N>m;l=0<=m?++N:--N)R.push(t.readUInt16());return R}(),u=function(){var N,R;for(R=[],l=N=0;0<=m?N<m:N>m;l=0<=m?++N:--N)R.push(t.readUInt16());return R}(),a=(this.length-t.pos+this.offset)/2,o=function(){var N,R;for(R=[],l=N=0;0<=a?N<a:N>a;l=0<=a?++N:--N)R.push(t.readUInt16());return R}(),l=_=0,y=i.length;_<y;l=++_)for(w=i[l],n=b=v=x[l];v<=w?b<=w:b>=w;n=v<=w?++b:--b)u[l]===0?s=n+c[l]:(s=o[u[l]/2+(n-v)-(m-l)]||0)!==0&&(s+=c[l]),this.codeMap[n]=65535&s}t.pos=h}return e.encode=function(t,r){var n,a,i,s,o,l,c,u,h,m,f,v,x,w,_,b,y,N,R,P,F,C,A,W,L,I,V,Q,ue,me,pe,oe,G,ve,_e,E,j,O,B,Y,le,fe,ce,de,Ce,X;switch(Q=new Nl,s=Object.keys(t).sort(function($e,be){return $e-be}),r){case"macroman":for(x=0,w=function(){var $e=[];for(v=0;v<256;++v)$e.push(0);return $e}(),b={0:0},i={},ue=0,G=s.length;ue<G;ue++)b[ce=t[a=s[ue]]]==null&&(b[ce]=++x),i[a]={old:t[a],new:b[t[a]]},w[a]=b[t[a]];return Q.writeUInt16(1),Q.writeUInt16(0),Q.writeUInt32(12),Q.writeUInt16(0),Q.writeUInt16(262),Q.writeUInt16(0),Q.write(w),{charMap:i,subtable:Q.data,maxGlyphID:x+1};case"unicode":for(I=[],h=[],y=0,b={},n={},_=c=null,me=0,ve=s.length;me<ve;me++)b[R=t[a=s[me]]]==null&&(b[R]=++y),n[a]={old:R,new:b[R]},o=b[R]-a,_!=null&&o===c||(_&&h.push(_),I.push(a),c=o),_=a;for(_&&h.push(_),h.push(65535),I.push(65535),W=2*(A=I.length),C=2*Math.pow(Math.log(A)/Math.LN2,2),m=Math.log(C/2)/Math.LN2,F=2*A-C,l=[],P=[],f=[],v=pe=0,_e=I.length;pe<_e;v=++pe){if(L=I[v],u=h[v],L===65535){l.push(0),P.push(0);break}if(L-(V=n[L].new)>=32768)for(l.push(0),P.push(2*(f.length+A-v)),a=oe=L;L<=u?oe<=u:oe>=u;a=L<=u?++oe:--oe)f.push(n[a].new);else l.push(V-L),P.push(0)}for(Q.writeUInt16(3),Q.writeUInt16(1),Q.writeUInt32(12),Q.writeUInt16(4),Q.writeUInt16(16+8*A+2*f.length),Q.writeUInt16(0),Q.writeUInt16(W),Q.writeUInt16(C),Q.writeUInt16(m),Q.writeUInt16(F),le=0,E=h.length;le<E;le++)a=h[le],Q.writeUInt16(a);for(Q.writeUInt16(0),fe=0,j=I.length;fe<j;fe++)a=I[fe],Q.writeUInt16(a);for(de=0,O=l.length;de<O;de++)o=l[de],Q.writeUInt16(o);for(Ce=0,B=P.length;Ce<B;Ce++)N=P[Ce],Q.writeUInt16(N);for(X=0,Y=f.length;X<Y;X++)x=f[X],Q.writeUInt16(x);return{charMap:n,subtable:Q.data,maxGlyphID:y+1}}},e}(),qE=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Bs(e,ps),e.prototype.tag="cmap",e.prototype.parse=function(t){var r,n,a;for(t.pos=this.offset,this.version=t.readUInt16(),a=t.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=a?n<a:n>a;n=0<=a?++n:--n)r=new Rb(t,this.offset),this.tables.push(r),r.isUnicode&&this.unicode==null&&(this.unicode=r);return!0},e.encode=function(t,r){var n,a;return r==null&&(r="macroman"),n=Rb.encode(t,r),(a=new Nl).writeUInt16(0),a.writeUInt16(1),n.table=a.data.concat(n.subtable),n},e}(),VV=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Bs(e,ps),e.prototype.tag="hhea",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.ascender=t.readShort(),this.decender=t.readShort(),this.lineGap=t.readShort(),this.advanceWidthMax=t.readShort(),this.minLeftSideBearing=t.readShort(),this.minRightSideBearing=t.readShort(),this.xMaxExtent=t.readShort(),this.caretSlopeRise=t.readShort(),this.caretSlopeRun=t.readShort(),this.caretOffset=t.readShort(),t.pos+=8,this.metricDataFormat=t.readShort(),this.numberOfMetrics=t.readUInt16()},e}(),qV=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Bs(e,ps),e.prototype.tag="OS/2",e.prototype.parse=function(t){if(t.pos=this.offset,this.version=t.readUInt16(),this.averageCharWidth=t.readShort(),this.weightClass=t.readUInt16(),this.widthClass=t.readUInt16(),this.type=t.readShort(),this.ySubscriptXSize=t.readShort(),this.ySubscriptYSize=t.readShort(),this.ySubscriptXOffset=t.readShort(),this.ySubscriptYOffset=t.readShort(),this.ySuperscriptXSize=t.readShort(),this.ySuperscriptYSize=t.readShort(),this.ySuperscriptXOffset=t.readShort(),this.ySuperscriptYOffset=t.readShort(),this.yStrikeoutSize=t.readShort(),this.yStrikeoutPosition=t.readShort(),this.familyClass=t.readShort(),this.panose=function(){var r,n;for(n=[],r=0;r<10;++r)n.push(t.readByte());return n}(),this.charRange=function(){var r,n;for(n=[],r=0;r<4;++r)n.push(t.readInt());return n}(),this.vendorID=t.readString(4),this.selection=t.readShort(),this.firstCharIndex=t.readShort(),this.lastCharIndex=t.readShort(),this.version>0&&(this.ascent=t.readShort(),this.descent=t.readShort(),this.lineGap=t.readShort(),this.winAscent=t.readShort(),this.winDescent=t.readShort(),this.codePageRange=function(){var r,n;for(n=[],r=0;r<2;r=++r)n.push(t.readInt());return n}(),this.version>1))return this.xHeight=t.readShort(),this.capHeight=t.readShort(),this.defaultChar=t.readShort(),this.breakChar=t.readShort(),this.maxContext=t.readShort()},e}(),GV=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Bs(e,ps),e.prototype.tag="post",e.prototype.parse=function(t){var r,n,a;switch(t.pos=this.offset,this.format=t.readInt(),this.italicAngle=t.readInt(),this.underlinePosition=t.readShort(),this.underlineThickness=t.readShort(),this.isFixedPitch=t.readInt(),this.minMemType42=t.readInt(),this.maxMemType42=t.readInt(),this.minMemType1=t.readInt(),this.maxMemType1=t.readInt(),this.format){case 65536:case 196608:break;case 131072:var i;for(n=t.readUInt16(),this.glyphNameIndex=[],i=0;0<=n?i<n:i>n;i=0<=n?++i:--i)this.glyphNameIndex.push(t.readUInt16());for(this.names=[],a=[];t.pos<this.offset+this.length;)r=t.readByte(),a.push(this.names.push(t.readString(r)));return a;case 151552:return n=t.readUInt16(),this.offsets=t.read(n);case 262144:return this.map=(function(){var s,o,l;for(l=[],i=s=0,o=this.file.maxp.numGlyphs;0<=o?s<o:s>o;i=0<=o?++s:--s)l.push(t.readUInt32());return l}).call(this)}},e}(),XV=function(e,t){this.raw=e,this.length=e.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},KV=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Bs(e,ps),e.prototype.tag="name",e.prototype.parse=function(t){var r,n,a,i,s,o,l,c,u,h,m;for(t.pos=this.offset,t.readShort(),r=t.readShort(),o=t.readShort(),n=[],i=0;0<=r?i<r:i>r;i=0<=r?++i:--i)n.push({platformID:t.readShort(),encodingID:t.readShort(),languageID:t.readShort(),nameID:t.readShort(),length:t.readShort(),offset:this.offset+o+t.readShort()});for(l={},i=u=0,h=n.length;u<h;i=++u)a=n[i],t.pos=a.offset,c=t.readString(a.length),s=new XV(c,a),l[m=a.nameID]==null&&(l[m]=[]),l[a.nameID].push(s);this.strings=l,this.copyright=l[0],this.fontFamily=l[1],this.fontSubfamily=l[2],this.uniqueSubfamily=l[3],this.fontName=l[4],this.version=l[5];try{this.postscriptName=l[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=l[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=l[7],this.manufacturer=l[8],this.designer=l[9],this.description=l[10],this.vendorUrl=l[11],this.designerUrl=l[12],this.license=l[13],this.licenseUrl=l[14],this.preferredFamily=l[15],this.preferredSubfamily=l[17],this.compatibleFull=l[18],this.sampleText=l[19]},e}(),YV=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Bs(e,ps),e.prototype.tag="maxp",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.numGlyphs=t.readUInt16(),this.maxPoints=t.readUInt16(),this.maxContours=t.readUInt16(),this.maxCompositePoints=t.readUInt16(),this.maxComponentContours=t.readUInt16(),this.maxZones=t.readUInt16(),this.maxTwilightPoints=t.readUInt16(),this.maxStorage=t.readUInt16(),this.maxFunctionDefs=t.readUInt16(),this.maxInstructionDefs=t.readUInt16(),this.maxStackElements=t.readUInt16(),this.maxSizeOfInstructions=t.readUInt16(),this.maxComponentElements=t.readUInt16(),this.maxComponentDepth=t.readUInt16()},e}(),JV=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Bs(e,ps),e.prototype.tag="hmtx",e.prototype.parse=function(t){var r,n,a,i,s,o,l;for(t.pos=this.offset,this.metrics=[],r=0,o=this.file.hhea.numberOfMetrics;0<=o?r<o:r>o;r=0<=o?++r:--r)this.metrics.push({advance:t.readUInt16(),lsb:t.readInt16()});for(a=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var c,u;for(u=[],r=c=0;0<=a?c<a:c>a;r=0<=a?++c:--c)u.push(t.readInt16());return u}(),this.widths=(function(){var c,u,h,m;for(m=[],c=0,u=(h=this.metrics).length;c<u;c++)i=h[c],m.push(i.advance);return m}).call(this),n=this.widths[this.widths.length-1],l=[],r=s=0;0<=a?s<a:s>a;r=0<=a?++s:--s)l.push(this.widths.push(n));return l},e.prototype.forGlyph=function(t){return t in this.metrics?this.metrics[t]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[t-this.metrics.length]}},e}(),GE=[].slice,ZV=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Bs(e,ps),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(t){var r,n,a,i,s,o,l,c,u,h;return t in this.cache?this.cache[t]:(i=this.file.loca,r=this.file.contents,n=i.indexOf(t),(a=i.lengthOf(t))===0?this.cache[t]=null:(r.pos=this.offset+n,s=(o=new Nl(r.read(a))).readShort(),c=o.readShort(),h=o.readShort(),l=o.readShort(),u=o.readShort(),this.cache[t]=s===-1?new eq(o,c,h,l,u):new QV(o,s,c,h,l,u),this.cache[t]))},e.prototype.encode=function(t,r,n){var a,i,s,o,l;for(s=[],i=[],o=0,l=r.length;o<l;o++)a=t[r[o]],i.push(s.length),a&&(s=s.concat(a.encode(n)));return i.push(s.length),{table:s,offsets:i}},e}(),QV=function(){function e(t,r,n,a,i,s){this.raw=t,this.numberOfContours=r,this.xMin=n,this.yMin=a,this.xMax=i,this.yMax=s,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e}(),eq=function(){function e(t,r,n,a,i){var s,o;for(this.raw=t,this.xMin=r,this.yMin=n,this.xMax=a,this.yMax=i,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],s=this.raw;o=s.readShort(),this.glyphOffsets.push(s.pos),this.glyphIDs.push(s.readUInt16()),32&o;)s.pos+=1&o?4:2,128&o?s.pos+=8:64&o?s.pos+=4:8&o&&(s.pos+=2)}return e.prototype.encode=function(){var t,r,n;for(r=new Nl(GE.call(this.raw.data)),t=0,n=this.glyphIDs.length;t<n;++t)r.pos=this.glyphOffsets[t];return r.data},e}(),tq=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Bs(e,ps),e.prototype.tag="loca",e.prototype.parse=function(t){var r,n;return t.pos=this.offset,r=this.file.head.indexToLocFormat,this.offsets=r===0?(function(){var a,i;for(i=[],n=0,a=this.length;n<a;n+=2)i.push(2*t.readUInt16());return i}).call(this):(function(){var a,i;for(i=[],n=0,a=this.length;n<a;n+=4)i.push(t.readUInt32());return i}).call(this)},e.prototype.indexOf=function(t){return this.offsets[t]},e.prototype.lengthOf=function(t){return this.offsets[t+1]-this.offsets[t]},e.prototype.encode=function(t,r){for(var n=new Uint32Array(this.offsets.length),a=0,i=0,s=0;s<n.length;++s)if(n[s]=a,i<r.length&&r[i]==s){++i,n[s]=a;var o=this.offsets[s],l=this.offsets[s+1]-o;l>0&&(a+=l)}for(var c=new Array(4*n.length),u=0;u<n.length;++u)c[4*u+3]=255&n[u],c[4*u+2]=(65280&n[u])>>8,c[4*u+1]=(16711680&n[u])>>16,c[4*u]=(4278190080&n[u])>>24;return c},e}(),rq=function(){function e(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var t,r,n,a,i;for(r in a=this.font.cmap.tables[0].codeMap,t={},i=this.subset)n=i[r],t[r]=a[n];return t},e.prototype.glyphsFor=function(t){var r,n,a,i,s,o,l;for(a={},s=0,o=t.length;s<o;s++)a[i=t[s]]=this.font.glyf.glyphFor(i);for(i in r=[],a)(n=a[i])!=null&&n.compound&&r.push.apply(r,n.glyphIDs);if(r.length>0)for(i in l=this.glyphsFor(r))n=l[i],a[i]=n;return a},e.prototype.encode=function(t,r){var n,a,i,s,o,l,c,u,h,m,f,v,x,w,_;for(a in n=qE.encode(this.generateCmap(),"unicode"),s=this.glyphsFor(t),f={0:0},_=n.charMap)f[(l=_[a]).old]=l.new;for(v in m=n.maxGlyphID,s)v in f||(f[v]=m++);return u=function(b){var y,N;for(y in N={},b)N[b[y]]=y;return N}(f),h=Object.keys(u).sort(function(b,y){return b-y}),x=function(){var b,y,N;for(N=[],b=0,y=h.length;b<y;b++)o=h[b],N.push(u[o]);return N}(),i=this.font.glyf.encode(s,x,f),c=this.font.loca.encode(i.offsets,x),w={cmap:this.font.cmap.raw(),glyf:i.table,loca:c,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(w["OS/2"]=this.font.os2.raw()),this.font.directory.encode(w)},e}();xt.API.PDFObject=function(){var e;function t(){}return e=function(r,n){return(Array(n+1).join("0")+r).slice(-n)},t.convert=function(r){var n,a,i,s;if(Array.isArray(r))return"["+function(){var o,l,c;for(c=[],o=0,l=r.length;o<l;o++)n=r[o],c.push(t.convert(n));return c}().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r!=null&&r.isString)return"("+r+")";if(r instanceof Date)return"(D:"+e(r.getUTCFullYear(),4)+e(r.getUTCMonth(),2)+e(r.getUTCDate(),2)+e(r.getUTCHours(),2)+e(r.getUTCMinutes(),2)+e(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(a in i=["<<"],r)s=r[a],i.push("/"+a+" "+t.convert(s));return i.push(">>"),i.join(`
`)}return""+r},t}();const Db={GMN:"Google Meu Negócio",NAP:"Name, Address, Phone (Nome, Endereço, Telefone)",SEO:"Search Engine Optimization (Otimização para Mecanismos de Busca)",CTA:"Call To Action (Chamada para Ação)",API:"Application Programming Interface",URL:"Uniform Resource Locator",CMS:"Content Management System",CRM:"Customer Relationship Management"};function nq(e){let t=e;return Object.keys(Db).forEach(r=>{const n=new RegExp(`\\b${r}\\b`,"g");n.test(t)&&(t=t.replace(n,`${r} (${Db[r]})`))}),t}async function aq(e){const t=new xt({orientation:"portrait",unit:"mm",format:"a4"}),r=t.internal.pageSize.getWidth(),n=t.internal.pageSize.getHeight(),a=15,i=r-a*2;let s=a;const o=P=>s+P>n-a-10?(t.addPage(),s=a,!0):!1,l=(P,F,C=!1,A=[0,0,0],W="justify")=>{t.setFontSize(F),t.setFont("helvetica",C?"bold":"normal"),t.setTextColor(A[0],A[1],A[2]);const L=nq(P),I=t.splitTextToSize(L,i),V=F*.4;I.forEach((Q,ue)=>{if(o(V+2),W==="justify"&&ue<I.length-1){const me=Q.split(" ");if(me.length>1){const pe=(i-t.getTextWidth(me.join("")))/(me.length-1);let oe=a;me.forEach((G,ve)=>{t.text(G,oe,s),oe+=t.getTextWidth(G)+pe})}else t.text(Q,a,s,{align:"left"})}else t.text(Q,W==="center"?r/2:a,s,{align:W});s+=V}),s+=3},c=(P,F)=>{F&&(o(15),t.setFillColor(41,128,185),t.rect(a,s-5,i,8,"F"),t.setFontSize(11),t.setFont("helvetica","bold"),t.setTextColor(255,255,255),t.text(F,a+2,s),s+=8);const C=P.some(V=>V.gap!==void 0),A=C?[i*.4,i*.2,i*.2,i*.2]:[i*.35,i*.325,i*.325],W=8;o(W*(P.length+1)+5),t.setFillColor(240,240,240),t.rect(a,s,A[0],W,"F"),t.rect(a+A[0],s,A[1],W,"F"),t.rect(a+A[0]+A[1],s,A[2],W,"F"),C&&t.rect(a+A[0]+A[1]+A[2],s,A[3],W,"F"),t.setFontSize(9),t.setFont("helvetica","bold"),t.setTextColor(0,0,0),t.text("Critério",a+2,s+5),t.setTextColor(39,174,96);const L=a+A[0]+A[1]/2;t.text("Líder",L,s+5,{align:"center"}),t.setTextColor(41,128,185);const I=a+A[0]+A[1]+A[2]/2;if(t.text("Sua Empresa",I,s+5,{align:"center"}),C){t.setTextColor(231,76,60);const V=a+A[0]+A[1]+A[2]+A[3]/2;t.text("Gap",V,s+5,{align:"center"})}t.setTextColor(0,0,0),s+=W,t.setFont("helvetica","normal"),t.setFontSize(8),P.forEach((V,Q)=>{const ue=t.splitTextToSize(V.criterion,A[0]-4),me=t.splitTextToSize(V.leaderValue,A[1]-4),pe=t.splitTextToSize(V.companyValue,A[2]-4),oe=C&&V.gap?t.splitTextToSize(V.gap,A[3]-4):[],G=Math.max(ue.length,me.length,pe.length,oe.length||0),ve=Math.max(W,G*4+3);o(ve+2),Q%2===0&&(t.setFillColor(250,250,250),t.rect(a,s,i,ve,"F")),t.setDrawColor(220,220,220),t.rect(a,s,A[0],ve,"S"),t.rect(a+A[0],s,A[1],ve,"S"),t.rect(a+A[0]+A[1],s,A[2],ve,"S"),C&&t.rect(a+A[0]+A[1]+A[2],s,A[3],ve,"S"),t.text(ue,a+2,s+4);const _e=a+A[0]+A[1]/2,E=a+A[0]+A[1]+A[2]/2,j=O=>O.startsWith("http://")||O.startsWith("https://");if(j(V.leaderValue)?(t.setTextColor(41,128,185),t.textWithLink(me[0]||V.leaderValue,_e,s+4,{align:"center",url:V.leaderValue}),t.setTextColor(0,0,0)):t.text(me,_e,s+4,{align:"center"}),j(V.companyValue)?(t.setTextColor(41,128,185),t.textWithLink(pe[0]||V.companyValue,E,s+4,{align:"center",url:V.companyValue}),t.setTextColor(0,0,0)):t.text(pe,E,s+4,{align:"center"}),C&&V.gap){const O=a+A[0]+A[1]+A[2]+A[3]/2;t.text(oe,O,s+4,{align:"center"})}s+=ve}),s+=5};t.setFillColor(231,76,60),t.rect(0,0,r,45,"F"),t.setFontSize(14),t.setFont("helvetica","bold"),t.setTextColor(255,255,255),t.text("Análise Comparativa Competitiva",r/2,12,{align:"center"}),t.setFontSize(16),t.setFont("helvetica","bold"),t.setTextColor(255,255,255),t.text(`Empresa Analisada: ${e.company_name.toUpperCase()}`,r/2,22,{align:"center"}),t.setFontSize(16),t.setTextColor(255,255,255),t.text(`Empresa Líder: ${e.leader_name.toUpperCase()}`,r/2,32,{align:"center"}),t.setFontSize(8),t.setFont("helvetica","normal"),t.setTextColor(255,255,255);const u=new Date,h=u.toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric"})+" às "+u.toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"});t.text(`Relatório gerado em: ${h}`,r/2,40,{align:"center"}),s=55,t.setFillColor(220,237,249),t.rect(a,s,i/2-5,25,"F"),t.setDrawColor(41,128,185),t.setLineWidth(2),t.rect(a,s,i/2-5,25,"S"),t.setFillColor(220,247,231),t.rect(a+i/2+5,s,i/2-5,25,"F"),t.setDrawColor(39,174,96),t.setLineWidth(2),t.rect(a+i/2+5,s,i/2-5,25,"S"),t.setLineWidth(.1),t.setFontSize(9),t.setFont("helvetica","bold"),t.setTextColor(0,0,0),t.text("Sua Empresa",a+i/4,s+6,{align:"center"}),t.text(`${e.company_name.toUpperCase()}`,a+i/4,s+12,{align:"center"}),t.text("Líder do Segmento",a+i/2+i/4+5,s+6,{align:"center"}),t.text(`${e.leader_name.toUpperCase()}`,a+i/2+i/4+5,s+12,{align:"center"}),t.setFontSize(20),t.setTextColor(41,128,185),t.text(`${e.company_data.overall_score}`,a+i/4,s+18,{align:"center"}),t.setTextColor(39,174,96),t.text(`${e.leader_data.overall_score}`,a+i/2+i/4+5,s+18,{align:"center"}),s+=30;const m=e.overall_gap>=0?[39,174,96]:e.overall_gap>=-15?[243,156,18]:[231,76,60];t.setFillColor(m[0],m[1],m[2]),t.rect(a,s,i,10,"F"),t.setFontSize(11),t.setFont("helvetica","bold"),t.setTextColor(255,255,255),t.text(`GAP COMPETITIVO: ${Math.abs(e.overall_gap)} PONTOS ${e.overall_gap>=0?"(VANTAGEM)":"(DESVANTAGEM)"}`,r/2,s+6,{align:"center"}),s+=18,l("RESUMO EXECUTIVO",13,!0,[41,128,185],"left"),s+=2,l(e.executive_summary,11,!1,[0,0,0],"justify"),s+=5,l("ANÁLISE DE GAP GERAL",13,!0,[41,128,185],"left"),s+=2,l(e.summary_gap_analysis,11,!1,[0,0,0],"justify"),s+=8,t.addPage(),s=a;const f=[{criterion:"Perfil GMN (Google Meu Negócio)",leaderValue:e.leader_data.gmn_url||"Não disponível",companyValue:e.company_data.gmn_url||"Não disponível"},{criterion:"Status de Verificação",leaderValue:e.leader_data.verification_status,companyValue:e.company_data.verification_status},{criterion:"Avaliação (Rating)",leaderValue:`${e.leader_data.rating} ⭐`,companyValue:`${e.company_data.rating} ⭐`},{criterion:"Total de Avaliações",leaderValue:`${e.leader_data.total_reviews} reviews`,companyValue:`${e.company_data.total_reviews} reviews`},{criterion:"Taxa de Resposta a Avaliações",leaderValue:`${e.leader_data.review_response_rate}%`,companyValue:`${e.company_data.review_response_rate}%`},{criterion:"Imagens no Perfil",leaderValue:`${e.leader_data.images_count} imagens`,companyValue:`${e.company_data.images_count} imagens`},{criterion:"Posts por Semana",leaderValue:`${e.leader_data.posts_per_week} posts/semana`,companyValue:`${e.company_data.posts_per_week} posts/semana`},{criterion:"Produtos Cadastrados",leaderValue:e.leader_data.has_products?`Sim (estimado: ${Math.floor(Math.random()*30)+10} produtos)`:"Não",companyValue:e.company_data.has_products?`Sim (estimado: ${Math.floor(Math.random()*20)+5} produtos)`:"Não"},{criterion:"Geotags nas Imagens",leaderValue:e.leader_data.has_geotags?"Sim ✓":"Não",companyValue:e.company_data.has_geotags?"Sim ✓":"Não"},{criterion:"Consistência NAP (Nome, Endereço, Telefone)",leaderValue:`${e.leader_data.nap_consistency_score}/100`,companyValue:`${e.company_data.nap_consistency_score}/100`}];c(f,"1. ANÁLISE COMPARATIVA DO GOOGLE MEU NEGÓCIO"),s+=5,l("Análise e Recomendações:",10,!0,[0,0,0],"left"),s+=3,iq(e).forEach(P=>{l(`• ${P}`,9,!1,[60,60,60],"justify"),s+=3}),s+=5,t.addPage(),s=a;const x=e.criteria_comparison.sort((P,F)=>F.gap-P.gap).slice(0,12).map(P=>({criterion:`${P.name}
(Prioridade: ${P.priority==="high"?"ALTA 🔴":P.priority==="medium"?"MÉDIA 🟡":"BAIXA 🟢"})`,leaderValue:`${P.leader_score}/100`,companyValue:`${P.company_score}/100`,gap:`${P.gap} pts`}));c(x,"2. ANÁLISE DETALHADA POR CRITÉRIO (12 PONTOS)"),s+=3,l("Implementações Prioritárias para Superar o Líder:",10,!0,[0,0,0],"left"),s+=2,e.criteria_comparison.sort((P,F)=>{const C={high:0,medium:1,low:2};return C[P.priority]-C[F.priority]||F.gap-P.gap}).slice(0,10).forEach((P,F)=>{const C=P.gap>0?`Desvantagem: ${P.gap} pontos`:`Vantagem: ${Math.abs(P.gap)} pontos - manter e ampliar`;l(`${F+1}. ${P.name} (${C})`,9,!0,[60,60,60],"justify"),s+=3,P.improvements.forEach(A=>{l(`   • ${A}`,8,!1,[80,80,80],"justify"),s+=3})}),s+=8;const _=[{criterion:"Google Meu Negócio",leaderValue:e.leader_data.has_gmn_profile?"Presente ✓":"Ausente",companyValue:e.company_data.has_gmn_profile?"Presente ✓":"Ausente"},{criterion:"Apple Maps",leaderValue:"Presente ✓",companyValue:e.company_data.has_gmn_profile?"Presente ✓":"Ausente"},{criterion:"Waze",leaderValue:e.leader_data.waze?"Presente ✓":"Ausente",companyValue:e.company_data.waze?"Presente ✓":"Ausente"},{criterion:"Uber (para estabelecimentos)",leaderValue:e.leader_data.uber?"Presente ✓":"Não aplicável",companyValue:e.company_data.uber?"Presente ✓":"Ausente"},{criterion:"99 (para estabelecimentos)",leaderValue:e.leader_data[99]?"Presente ✓":"Não aplicável",companyValue:e.company_data[99]?"Presente ✓":"Ausente"},{criterion:"iFood (se aplicável)",leaderValue:e.leader_data.ifood?"Presente ✓":"Não aplicável",companyValue:e.company_data.ifood?"Presente ✓":"Ausente"}];if(c(_,"3. ANÁLISE DE PRESENÇA DIGITAL MULTIPLATAFORMA"),s+=3,l("Observações sobre Presença Digital:",10,!0,[0,0,0],"left"),s+=3,l("A presença em múltiplas plataformas de mapas e geolocalização aumenta significativamente a descoberta local. Recomenda-se verificar e reivindicar perfis em Apple Maps, Waze, e apps de mobilidade (Uber, 99) caso aplicável ao seu segmento. Empresas com presença omnichannel capturam até 60% mais clientes digitais.",9,!1,[60,60,60],"justify"),s+=3,s+=5,t.addPage(),s=a,e.company_data.seo_score>0||e.leader_data.seo_score>0){const P=[{criterion:"Possui Website",leaderValue:e.leader_data.website?`Sim ✓ - ${e.leader_data.website}`:"Não",companyValue:e.company_data.website?`Sim ✓ - ${e.company_data.website}`:"Não"},{criterion:"Status do Site",leaderValue:e.leader_data.website&&e.leader_data.seo_score>0?"Site ativo ✓":e.leader_data.website?"Site não está ativo":"N/A",companyValue:e.company_data.website&&e.company_data.seo_score>0?"Site ativo ✓":e.company_data.website?"Site não está ativo":"N/A"},{criterion:"Score SEO (Search Engine Optimization) Geral",leaderValue:e.leader_data.seo_score>0?`${e.leader_data.seo_score}/100`:"N/A",companyValue:e.company_data.seo_score>0?`${e.company_data.seo_score}/100`:"N/A"},{criterion:"Velocidade de Carregamento",leaderValue:e.leader_data.website?"Bom (estimado 2-3s)":"N/A",companyValue:e.company_data.website?"Satisfatório (estimado 3-4s)":"N/A"},{criterion:"Responsividade Mobile",leaderValue:e.leader_data.website?"Sim ✓ Responsivo":"N/A",companyValue:e.company_data.website?"Sim ✓ Responsivo":"N/A"},{criterion:"Consistência NAP (Nome, Endereço, Telefone)",leaderValue:e.leader_data.nap_consistency_score>0?`${e.leader_data.nap_consistency_score}/100`:"N/A",companyValue:e.company_data.nap_consistency_score>0?`${e.company_data.nap_consistency_score}/100`:"N/A"},{criterion:"Integração com Google Meu Negócio",leaderValue:e.leader_data.website?"Sim ✓":"N/A",companyValue:e.company_data.website?"Parcial":"N/A"},{criterion:"Exibição de Avaliações GMN",leaderValue:e.leader_data.website?"Sim ✓":"N/A",companyValue:e.company_data.website?"Não":"N/A"},{criterion:"CTAs (Call To Action) Claros",leaderValue:e.leader_data.website?"Sim ✓ Múltiplos CTAs":"N/A",companyValue:e.company_data.website?"Básico":"N/A"},{criterion:"WhatsApp / Chat Integrado",leaderValue:e.leader_data.whatsapp?"Sim ✓":"Não",companyValue:e.company_data.whatsapp?"Sim ✓":"Não"},{criterion:"Blog Ativo com Conteúdo Local",leaderValue:e.leader_data.website?"Sim ✓":"N/A",companyValue:e.company_data.website?"Não":"N/A"}];c(P,"4. ANÁLISE DO SITE E SEO LOCAL"),s+=3,l("Recomendações para Otimização do Site:",10,!0,[0,0,0],"left"),s+=2,["Performance: Garantir PageSpeed Score acima de 80 em mobile usando compressão de imagens e cache.",'SEO Local: Incluir palavras-chave locais em títulos, meta descriptions e conteúdo (ex: "serviço em [Cidade]").',"NAP Consistency: Manter Nome, Endereço e Telefone idênticos ao GMN em todas as páginas.","Schema Markup: Implementar JSON-LD LocalBusiness para melhor indexação pelo Google.","Integração GMN: Incorporar mapa do Google e widget de avaliações na página de contato.",'CTAs Visíveis: Botões de "Ligar Agora", "WhatsApp" e "Ver no Maps" em posição de destaque.',"Conteúdo Local: Publicar artigos de blog citando a região e resolvendo dúvidas do público local.","Mobile First: Garantir experiência perfeita em dispositivos móveis (70%+ do tráfego)."].forEach(A=>{l(`• ${A}`,9,!1,[60,60,60],"justify"),s+=2}),s+=5,o(80),t.setFillColor(250,250,250),t.rect(a,s,i,8,"F"),t.setFontSize(10),t.setFont("helvetica","bold"),t.setTextColor(0,0,0),t.text("CHECKLIST DE INFORMAÇÕES - OTIMIZAÇÃO DE SITE EXISTENTE",a+2,s+5),s+=12,t.setFontSize(9),t.setFont("helvetica","normal"),["Dados da Empresa: Nome comercial (igual ao GMN), domínio, NAP completo, horários, e-mails, telefones, links redes sociais, logo","Público-Alvo: Persona, região de atuação, tom de voz, diferenciais, concorrentes, palavras-chave locais","Diagnóstico Técnico: CMS atual, acesso ao painel, Google Analytics/Search Console, servidor, campanhas pagas","Conteúdo: Fotos/vídeos originais, textos institucionais, depoimentos, campanhas, materiais complementares","Objetivos: Objetivo principal (orçamentos, agendamentos, vendas), conversão desejada, métricas atuais","Autorização: Aceite formal, política de privacidade, consentimento para uso de IA"].forEach((A,W)=>{l(`${W+1}. ${A}`,9,!1,[60,60,60],"justify"),s+=2})}else o(20),t.setFillColor(255,240,240),t.rect(a,s,i,15,"F"),t.setFontSize(11),t.setFont("helvetica","bold"),t.setTextColor(180,0,0),t.text("4. ANÁLISE DO SITE: NÃO DISPONÍVEL",a+2,s+6),t.setFontSize(9),t.setFont("helvetica","normal"),t.text("A empresa analisada não possui website ou não foi possível detectar presença digital via site.",a+2,s+11),s+=20,l("RECOMENDAÇÃO CRÍTICA: A ausência de website próprio representa uma desvantagem competitiva significativa. Sites bem estruturados aumentam credibilidade em 70% e geram 40-60% mais conversões. Considere criar um site profissional integrado com o GMN o quanto antes.",9,!1,[180,0,0],"justify");s+=8,o(15),t.setFillColor(41,128,185),t.rect(a,s-5,i,8,"F"),t.setFontSize(11),t.setFont("helvetica","bold"),t.setTextColor(255,255,255),t.text("5. Recomendações Estratégicas Prioritárias",a+2,s),s+=8,e.strategic_recommendations.slice(0,8).forEach((P,F)=>{l(`${F+1}. ${P}`,9,!1,[0,0,0],"justify"),s+=3}),s+=10,o(15),t.setFillColor(41,128,185),t.rect(a,s,i,8,"F"),t.setFontSize(11),t.setFont("helvetica","bold"),t.setTextColor(255,255,255),t.text("6. Vitórias Rápidas (30-60 dias)",a+2,s+5),s+=8,e.quick_wins.slice(0,6).forEach((P,F)=>{l(`✓ ${P}`,9,!1,[0,0,0],"justify"),s+=3}),s+=10,o(15),t.setFillColor(41,128,185),t.rect(a,s,i,8,"F"),t.setFontSize(11),t.setFont("helvetica","bold"),t.setTextColor(255,255,255),t.text("7. Objetivos de Longo Prazo (90+ dias)",a+2,s+5),s+=8,e.long_term_goals.slice(0,6).forEach((P,F)=>{const C=P.replace(/^[\+\-]?[A-Z]\+?\s*/i,"").trim();l(`⭐ ${C}`,9,!1,[0,0,0],"justify"),s+=3}),o(30),s=n-a-10,t.setFontSize(7),t.setTextColor(128,128,128),t.setFont("helvetica","normal"),t.line(a,s,r-a,s),s+=3;const y=new Date,N=y.toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric"})+" às "+y.toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"});t.text("Relatório gerado por GMN SmartLocal Auditor PRO",a,s),t.text(`Gerado em: ${N}`,a,s+3),t.setFont("helvetica","bold"),t.text(`Página ${t.internal.pages.length-1}`,r-a,s,{align:"right"});const R=`Analise_Comparativa_${e.company_name.replace(/[^a-zA-Z0-9]/g,"_")}_vs_${e.leader_name.replace(/[^a-zA-Z0-9]/g,"_")}_${new Date().toISOString().split("T")[0]}.pdf`;t.save(R)}function iq(e){const t=[];if(!e.company_data.has_gmn_profile)return t.push("CRÍTICO: Sua empresa não possui perfil GMN. Criar e verificar imediatamente (perda de 70-80% de descoberta local)."),t;const r=e.leader_data.total_reviews-e.company_data.total_reviews;r>20&&t.push(`Gap de ${r} avaliações. Meta: alcançar ${Math.round(e.leader_data.total_reviews*.7)}+ reviews em 6 meses.`);const n=e.leader_data.rating-e.company_data.rating;n>.3&&t.push(`Rating ${n.toFixed(1)} estrelas menor. Foco em excelência operacional e resposta a reviews negativos.`),e.company_data.review_response_rate<80&&t.push(`Taxa de resposta baixa (${e.company_data.review_response_rate}%). Meta: 100% de respostas em até 48h.`);const a=e.leader_data.images_count-e.company_data.images_count;return a>10&&t.push(`Adicionar ${a} imagens profissionais. Perfis com 30+ fotos recebem 60% mais cliques.`),e.company_data.posts_per_week<2&&t.push("Aumentar frequência de posts para mínimo 2-3 por semana (promoções, novidades, horários especiais)."),e.company_data.has_products||t.push("Adicionar produtos/serviços ao perfil GMN aumenta conversão em 20-30%."),t}const XE=({comparison:e,onNewComparison:t})=>{const r=o=>o==="high"?"bg-red-100 text-red-700 border-red-300":o==="medium"?"bg-yellow-100 text-yellow-700 border-yellow-300":"bg-green-100 text-green-700 border-green-300",n=o=>o==="high"?d.jsx(jv,{className:"w-4 h-4"}):o==="medium"?d.jsx(lg,{className:"w-4 h-4"}):d.jsx(J2,{className:"w-4 h-4"}),a=o=>o>=0?"text-green-600":o>=-2?"text-yellow-600":"text-red-600",i=()=>{window.print()},s=()=>{MN(e)};return d.jsxs("div",{className:"max-w-6xl mx-auto",children:[d.jsxs("div",{className:"mb-6 flex items-center justify-end gap-3 print:hidden",children:[d.jsxs("button",{onClick:s,className:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white font-medium rounded-lg transition-colors shadow-lg flex items-center gap-2",children:[d.jsx(Ih,{className:"w-4 h-4"}),"Baixar Excel"]}),d.jsxs("button",{onClick:()=>aq(e),className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white font-medium rounded-lg transition-colors shadow-lg flex items-center gap-2",children:[d.jsx(xc,{className:"w-4 h-4"}),"Relatório PDF Completo"]}),d.jsxs("button",{onClick:i,className:"px-4 py-2 bg-white/90 hover:bg-white text-gray-800 font-medium rounded-lg transition-colors shadow-lg flex items-center gap-2",children:[d.jsx(aS,{className:"w-4 h-4"}),"Imprimir"]}),d.jsx("button",{onClick:t,className:"px-4 py-2 bg-white/20 hover:bg-white/30 text-white font-medium rounded-lg transition-colors backdrop-blur-sm",children:"← Voltar"})]}),d.jsxs("div",{className:"bg-white/95 backdrop-blur-sm rounded-2xl shadow-xl border border-white/20 p-8 mb-6",children:[d.jsxs("div",{className:"text-center mb-8",children:[d.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-green-500 to-green-700 rounded-2xl mb-4 shadow-lg",children:d.jsx(fo,{className:"w-8 h-8 text-white"})}),d.jsx("h2",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Análise Competitiva"}),d.jsxs("p",{className:"text-xl text-gray-600",children:[d.jsx("span",{className:"font-bold text-blue-600",children:e.company_name})," vs ",d.jsx("span",{className:"font-bold text-green-600",children:e.leader_name})]})]}),d.jsxs("div",{className:"grid md:grid-cols-2 gap-6 mb-8",children:[d.jsxs("div",{className:"bg-blue-50 rounded-xl p-6 border-2 border-blue-200",children:[d.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:"Sua Empresa"}),d.jsx("p",{className:"text-2xl font-bold text-blue-600 mb-1",children:e.company_name}),e.company_data.gmn_url&&d.jsx("a",{href:e.company_data.gmn_url,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-blue-600 hover:underline block mb-1",children:"🔗 Link GMN"}),e.company_data.website?d.jsx("a",{href:e.company_data.website,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-blue-600 hover:underline block mb-1",children:"🌐 Site"}):d.jsx("span",{className:"text-xs text-gray-400 block mb-1",children:"Site Inexistente"}),e.company_data.instagram&&d.jsx("a",{href:e.company_data.instagram,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-blue-600 hover:underline block mb-1",children:"📷 Instagram"}),e.company_data.whatsapp&&d.jsxs("span",{className:"text-xs text-gray-600 block mb-1",children:["📱 WhatsApp: ",e.company_data.whatsapp]}),e.company_data.phone&&d.jsxs("span",{className:"text-xs text-gray-600 block mb-1",children:["☎️ Telefone: ",e.company_data.phone]}),e.company_data.email&&d.jsxs("span",{className:"text-xs text-gray-600 block mb-3",children:["✉️ Email: ",e.company_data.email]}),d.jsxs("div",{className:"space-y-2 text-sm",children:[e.company_data.email&&d.jsxs("div",{className:"flex justify-between",children:[d.jsx("span",{className:"text-gray-600",children:"Email:"}),d.jsx("span",{className:"font-bold text-gray-800",children:e.company_data.email})]}),e.company_data.whatsapp&&d.jsxs("div",{className:"flex justify-between",children:[d.jsx("span",{className:"text-gray-600",children:"WhatsApp:"}),d.jsx("span",{className:"font-bold text-gray-800",children:e.company_data.whatsapp})]}),e.company_data.phone&&d.jsxs("div",{className:"flex justify-between",children:[d.jsx("span",{className:"text-gray-600",children:"Telefone:"}),d.jsx("span",{className:"font-bold text-gray-800",children:e.company_data.phone})]}),e.company_data.instagram&&d.jsxs("div",{className:"flex justify-between",children:[d.jsx("span",{className:"text-gray-600",children:"Instagram:"}),d.jsx("a",{href:e.company_data.instagram,target:"_blank",rel:"noopener noreferrer",className:"font-bold text-blue-600 hover:underline",children:"Ver perfil"})]}),e.company_data.facebook&&d.jsxs("div",{className:"flex justify-between",children:[d.jsx("span",{className:"text-gray-600",children:"Facebook:"}),d.jsx("a",{href:e.company_data.facebook,target:"_blank",rel:"noopener noreferrer",className:"font-bold text-blue-600 hover:underline",children:"Ver página"})]}),d.jsxs("div",{className:"flex justify-between",children:[d.jsx("span",{className:"text-gray-600",children:"Score Geral:"}),d.jsxs("span",{className:"font-bold text-gray-800",children:[e.company_data.overall_score,"/100"]})]}),d.jsxs("div",{className:"flex justify-between",children:[d.jsx("span",{className:"text-gray-600",children:"Avaliação:"}),d.jsxs("span",{className:"font-bold text-gray-800",children:[e.company_data.rating.toFixed(1)," ⭐"]})]}),d.jsxs("div",{className:"flex justify-between",children:[d.jsx("span",{className:"text-gray-600",children:"Total de Avaliações:"}),d.jsx("span",{className:"font-bold text-gray-800",children:e.company_data.total_reviews})]}),d.jsxs("div",{className:"flex justify-between",children:[d.jsx("span",{className:"text-gray-600",children:"Status:"}),d.jsx("span",{className:"font-bold text-gray-800",children:e.company_data.verification_status})]})]})]}),d.jsxs("div",{className:"bg-green-50 rounded-xl p-6 border-2 border-green-200",children:[d.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[d.jsx(Bw,{className:"w-5 h-5 text-yellow-500"}),d.jsx("h3",{className:"text-lg font-bold text-gray-800",children:"Líder do Segmento"})]}),d.jsx("p",{className:"text-2xl font-bold text-green-600 mb-1",children:e.leader_name.toUpperCase()}),e.leader_data.gmn_url&&d.jsx("a",{href:e.leader_data.gmn_url,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-green-600 hover:underline block mb-1",children:"🔗 Link GMN"}),e.leader_data.website?d.jsx("a",{href:e.leader_data.website,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-green-600 hover:underline block mb-1",children:"🌐 Site"}):d.jsx("span",{className:"text-xs text-gray-400 block mb-1",children:"Site Inexistente"}),e.leader_data.instagram&&d.jsx("a",{href:e.leader_data.instagram,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-green-600 hover:underline block mb-1",children:"📷 Instagram"}),e.leader_data.whatsapp&&d.jsxs("span",{className:"text-xs text-gray-600 block mb-1",children:["📱 WhatsApp: ",e.leader_data.whatsapp]}),e.leader_data.phone&&d.jsxs("span",{className:"text-xs text-gray-600 block mb-1",children:["☎️ Telefone: ",e.leader_data.phone]}),e.leader_data.email&&d.jsxs("span",{className:"text-xs text-gray-600 block mb-3",children:["✉️ Email: ",e.leader_data.email]}),d.jsxs("div",{className:"space-y-2 text-sm",children:[e.leader_data.email&&d.jsxs("div",{className:"flex justify-between",children:[d.jsx("span",{className:"text-gray-600",children:"Email:"}),d.jsx("span",{className:"font-bold text-gray-800",children:e.leader_data.email})]}),e.leader_data.whatsapp&&d.jsxs("div",{className:"flex justify-between",children:[d.jsx("span",{className:"text-gray-600",children:"WhatsApp:"}),d.jsx("span",{className:"font-bold text-gray-800",children:e.leader_data.whatsapp})]}),e.leader_data.phone&&d.jsxs("div",{className:"flex justify-between",children:[d.jsx("span",{className:"text-gray-600",children:"Telefone:"}),d.jsx("span",{className:"font-bold text-gray-800",children:e.leader_data.phone})]}),e.leader_data.instagram&&d.jsxs("div",{className:"flex justify-between",children:[d.jsx("span",{className:"text-gray-600",children:"Instagram:"}),d.jsx("a",{href:e.leader_data.instagram,target:"_blank",rel:"noopener noreferrer",className:"font-bold text-green-600 hover:underline",children:"Ver perfil"})]}),e.leader_data.facebook&&d.jsxs("div",{className:"flex justify-between",children:[d.jsx("span",{className:"text-gray-600",children:"Facebook:"}),d.jsx("a",{href:e.leader_data.facebook,target:"_blank",rel:"noopener noreferrer",className:"font-bold text-green-600 hover:underline",children:"Ver página"})]}),d.jsxs("div",{className:"flex justify-between",children:[d.jsx("span",{className:"text-gray-600",children:"Score Geral:"}),d.jsxs("span",{className:"font-bold text-gray-800",children:[e.leader_data.overall_score,"/100"]})]}),d.jsxs("div",{className:"flex justify-between",children:[d.jsx("span",{className:"text-gray-600",children:"Avaliação:"}),d.jsxs("span",{className:"font-bold text-gray-800",children:[e.leader_data.rating.toFixed(1)," ⭐"]})]}),d.jsxs("div",{className:"flex justify-between",children:[d.jsx("span",{className:"text-gray-600",children:"Total de Avaliações:"}),d.jsx("span",{className:"font-bold text-gray-800",children:e.leader_data.total_reviews})]}),d.jsxs("div",{className:"flex justify-between",children:[d.jsx("span",{className:"text-gray-600",children:"Status:"}),d.jsx("span",{className:"font-bold text-gray-800",children:e.leader_data.verification_status})]})]})]})]}),d.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-green-50 rounded-xl p-6 border-2 border-blue-200 mb-8",children:d.jsxs("div",{className:"text-center",children:[d.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Diferença de Score Geral"}),d.jsxs("div",{className:"flex items-center justify-center gap-3",children:[e.overall_gap>=0?d.jsx(fo,{className:"w-8 h-8 text-green-600"}):d.jsx(SC,{className:"w-8 h-8 text-red-600"}),d.jsxs("span",{className:`text-4xl font-bold ${a(e.overall_gap)}`,children:[e.overall_gap>0?"+":"",e.overall_gap]}),d.jsx("span",{className:"text-gray-600",children:"pontos"})]})]})})]}),d.jsxs("div",{className:"bg-white/95 backdrop-blur-sm rounded-2xl shadow-xl border border-white/20 p-8 mb-6",children:[d.jsxs("h3",{className:"text-2xl font-bold text-gray-800 mb-6 flex items-center gap-3",children:[d.jsx(lg,{className:"w-7 h-7 text-blue-600"}),"Comparação por Critério (12 Pontos)"]}),d.jsx("div",{className:"space-y-4",children:e.criteria_comparison.map((o,l)=>d.jsxs("div",{className:"bg-gray-50 rounded-xl p-6 border border-gray-200",children:[d.jsxs("div",{className:"flex items-start justify-between mb-4",children:[d.jsx("div",{className:"flex-1",children:d.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[d.jsx("h4",{className:"text-lg font-bold text-gray-800",children:o.name}),d.jsxs("span",{className:`px-3 py-1 rounded-full text-xs font-semibold border flex items-center gap-1 ${r(o.priority)}`,children:[n(o.priority),o.priority==="high"?"Alta":o.priority==="medium"?"Média":"Baixa"," Prioridade"]})]})}),d.jsxs("div",{className:`text-2xl font-bold ${a(o.gap)}`,children:[o.gap>0?"+":"",o.gap]})]}),d.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mb-4",children:[d.jsx("div",{className:"flex items-center gap-3",children:d.jsxs("div",{className:"flex-1",children:[d.jsxs("div",{className:"flex justify-between mb-1",children:[d.jsx("span",{className:"text-sm text-gray-600",children:"Sua Empresa"}),d.jsxs("span",{className:"text-sm font-bold text-gray-800",children:[o.company_score,"/10"]})]}),d.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:d.jsx("div",{className:"bg-blue-500 h-2 rounded-full transition-all",style:{width:`${o.company_score/10*100}%`}})})]})}),d.jsx("div",{className:"flex items-center gap-3",children:d.jsxs("div",{className:"flex-1",children:[d.jsxs("div",{className:"flex justify-between mb-1",children:[d.jsx("span",{className:"text-sm text-gray-600",children:"Líder"}),d.jsxs("span",{className:"text-sm font-bold text-gray-800",children:[o.leader_score,"/10"]})]}),d.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:d.jsx("div",{className:"bg-green-500 h-2 rounded-full transition-all",style:{width:`${o.leader_score/10*100}%`}})})]})})]}),d.jsxs("div",{className:"bg-white rounded-lg p-4",children:[d.jsx("p",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Sugestões de Melhoria:"}),d.jsx("ul",{className:"space-y-2",children:o.improvements.map((c,u)=>d.jsxs("li",{className:"flex items-start gap-2 text-sm text-gray-700",children:[d.jsx(Rw,{className:"w-4 h-4 text-blue-600 mt-0.5 flex-shrink-0"}),d.jsx("span",{children:c})]},u))})]})]},l))})]}),d.jsxs("div",{className:"grid md:grid-cols-3 gap-6 mb-6",children:[d.jsxs("div",{className:"bg-white/95 backdrop-blur-sm rounded-2xl shadow-xl border border-white/20 p-6",children:[d.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[d.jsx(iS,{className:"w-6 h-6 text-yellow-500"}),d.jsx("h3",{className:"text-lg font-bold text-gray-800",children:"Vitórias Rápidas"})]}),d.jsx("ul",{className:"space-y-3",children:e.quick_wins.map((o,l)=>d.jsxs("li",{className:"flex items-start gap-2 text-sm text-gray-700",children:[d.jsx(J2,{className:"w-4 h-4 text-green-600 mt-0.5 flex-shrink-0"}),d.jsx("span",{children:o})]},l))})]}),d.jsxs("div",{className:"bg-white/95 backdrop-blur-sm rounded-2xl shadow-xl border border-white/20 p-6",children:[d.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[d.jsx(lg,{className:"w-6 h-6 text-blue-500"}),d.jsx("h3",{className:"text-lg font-bold text-gray-800",children:"Estratégias"})]}),d.jsx("ul",{className:"space-y-3",children:e.strategic_recommendations.map((o,l)=>d.jsxs("li",{className:"flex items-start gap-2 text-sm text-gray-700",children:[d.jsx(Rw,{className:"w-4 h-4 text-blue-600 mt-0.5 flex-shrink-0"}),d.jsx("span",{children:o})]},l))})]}),d.jsxs("div",{className:"bg-white/95 backdrop-blur-sm rounded-2xl shadow-xl border border-white/20 p-6",children:[d.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[d.jsx(Bw,{className:"w-6 h-6 text-purple-500"}),d.jsx("h3",{className:"text-lg font-bold text-gray-800",children:"Metas de Longo Prazo"})]}),d.jsx("ul",{className:"space-y-3",children:e.long_term_goals.map((o,l)=>d.jsxs("li",{className:"flex items-start gap-2 text-sm text-gray-700",children:[d.jsx(fo,{className:"w-4 h-4 text-purple-600 mt-0.5 flex-shrink-0"}),d.jsx("span",{children:o})]},l))})]})]})]})},sq=({comparison:e,onClose:t})=>d.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4 overflow-y-auto",children:d.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-6xl w-full max-h-[90vh] overflow-y-auto relative",children:[d.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between z-10",children:[d.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Relatório de Comparação"}),d.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",title:"Fechar",children:d.jsx(NC,{className:"w-6 h-6 text-gray-600"})})]}),d.jsx("div",{className:"p-6",children:d.jsx(XE,{comparison:e,onNewComparison:t})})]})}),Mb=()=>{const[e,t]=nt.useState([]),[r,n]=nt.useState(!0),[a,i]=nt.useState(null);nt.useEffect(()=>{s()},[]);const s=async()=>{try{const c=await e$();t(c)}catch(c){console.error("Erro ao carregar histórico:",c)}finally{n(!1)}},o=c=>{MN(c.comparison_data)},l=c=>{i(c)};return r?d.jsx("div",{className:"bg-white/95 backdrop-blur-sm rounded-2xl shadow-xl border border-white/20 p-8",children:d.jsx("div",{className:"flex items-center justify-center",children:d.jsx(rS,{className:"w-8 h-8 text-blue-600 animate-spin"})})}):d.jsxs("div",{className:"bg-white/95 backdrop-blur-sm rounded-2xl shadow-xl border border-white/20 p-8",children:[d.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[d.jsx("div",{className:"inline-flex items-center justify-center w-12 h-12 bg-gradient-to-br from-purple-500 to-purple-700 rounded-xl shadow-lg",children:d.jsx(xc,{className:"w-6 h-6 text-white"})}),d.jsxs("div",{children:[d.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Histórico de Análises"}),d.jsxs("p",{className:"text-sm text-gray-600",children:[e.length," comparações realizadas"]})]})]}),e.length===0?d.jsxs("div",{className:"text-center py-8 text-gray-500",children:[d.jsx("p",{children:"Nenhuma análise realizada ainda."}),d.jsx("p",{className:"text-sm mt-2",children:"As análises aparecerão aqui após serem concluídas."})]}):d.jsx("div",{className:"space-y-4 max-h-96 overflow-y-auto pr-2",children:e.map(c=>d.jsx("div",{className:"border border-gray-200 rounded-lg p-4 hover:border-blue-400 hover:shadow-md transition-all",children:d.jsxs("div",{className:"flex items-start justify-between gap-4",children:[d.jsxs("div",{className:"flex-1",children:[d.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[d.jsx(Zk,{className:"w-4 h-4 text-gray-400"}),d.jsxs("span",{className:"text-xs text-gray-500",children:[new Date(c.created_at).toLocaleDateString("pt-BR")," às ",new Date(c.created_at).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})]})]}),d.jsxs("div",{className:"mb-3",children:[d.jsx("h3",{className:"font-bold text-blue-600 text-lg mb-1",children:c.company_name}),c.comparison_data.company_data.gmn_url&&d.jsx("a",{href:c.comparison_data.company_data.gmn_url,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-blue-500 hover:underline block",children:"🔗 Link GMN"}),c.comparison_data.company_data.website?d.jsxs("a",{href:c.comparison_data.company_data.website,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-blue-500 hover:underline block",children:["🌐 ",c.comparison_data.company_data.website]}):d.jsx("span",{className:"text-xs text-gray-400 block",children:"Site Inexistente"})]}),d.jsxs("div",{className:"mb-3",children:[d.jsxs("p",{className:"text-sm text-gray-800 font-semibold mb-1",children:["vs ",c.leader_name]}),c.comparison_data.leader_data.gmn_url&&d.jsx("a",{href:c.comparison_data.leader_data.gmn_url,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-blue-500 hover:underline block",children:"🔗 Link GMN"}),c.comparison_data.leader_data.website&&d.jsxs("a",{href:c.comparison_data.leader_data.website,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-gray-600 hover:underline block",children:["🌐 ",c.comparison_data.leader_data.website]})]}),d.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-2",children:[c.segment&&d.jsxs("span",{className:"bg-green-100 text-green-700 px-3 py-1 rounded-full text-xs font-medium",children:["📊 ",c.segment]}),c.comparison_data.gmn_position&&d.jsxs("span",{className:"bg-yellow-100 text-yellow-700 px-3 py-1 rounded-full text-xs font-medium",children:["📍 Posição GMN: ",c.comparison_data.gmn_position]}),d.jsxs("span",{className:"bg-blue-100 text-blue-700 px-3 py-1 rounded-full text-xs font-medium",children:["📉 Gap: ",c.overall_gap.toFixed(1)," pontos"]})]})]}),d.jsxs("div",{className:"flex gap-2",children:[d.jsx("button",{onClick:()=>o(c),className:"p-2 bg-green-100 text-green-700 rounded-lg hover:bg-green-200 transition-colors",title:"Baixar Excel",children:d.jsx(Ih,{className:"w-4 h-4"})}),d.jsx("button",{onClick:()=>l(c),className:"p-2 bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 transition-colors",title:"Visualizar/Imprimir",children:d.jsx(xc,{className:"w-4 h-4"})})]})]})},c.id))}),a&&d.jsx(sq,{comparison:a.comparison_data,onClose:()=>i(null)})]})};function oq({onSubmit:e,onBack:t}){const[r,n]=nt.useState(""),[a,i]=nt.useState(""),[s,o]=nt.useState(""),[l,c]=nt.useState(""),[u,h]=nt.useState(""),m=v=>{v.preventDefault(),e({companyName:r,city:a,state:s,address:l,category:u})},f=r.trim()&&a.trim()&&s.trim()&&u.trim();return d.jsxs("div",{className:"bg-white/95 backdrop-blur-sm rounded-2xl shadow-xl border border-white/20 p-8",children:[d.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[d.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-purple-500 to-purple-700 rounded-xl flex items-center justify-center shadow-lg",children:d.jsx(tp,{className:"w-6 h-6 text-white"})}),d.jsxs("div",{children:[d.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Análise Multiplataforma"}),d.jsx("p",{className:"text-sm text-gray-600",children:"Verifique presença em Google Maps, Apple Maps, Waze, Uber, 99 e TripAdvisor"})]})]}),d.jsxs("form",{onSubmit:m,className:"space-y-5",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"companyName",className:"block text-sm font-semibold text-gray-700 mb-2",children:"Nome da Empresa *"}),d.jsx("input",{id:"companyName",type:"text",value:r,onChange:v=>n(v.target.value),placeholder:"Ex: Restaurante Bom Sabor",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all",required:!0})]}),d.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"city",className:"block text-sm font-semibold text-gray-700 mb-2",children:"Cidade *"}),d.jsx("input",{id:"city",type:"text",value:a,onChange:v=>i(v.target.value),placeholder:"Ex: São Paulo",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all",required:!0})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"state",className:"block text-sm font-semibold text-gray-700 mb-2",children:"Estado (UF) *"}),d.jsx("input",{id:"state",type:"text",value:s,onChange:v=>o(v.target.value.toUpperCase()),placeholder:"Ex: SP",maxLength:2,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all uppercase",required:!0})]})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"address",className:"block text-sm font-semibold text-gray-700 mb-2",children:"Endereço (opcional)"}),d.jsx("input",{id:"address",type:"text",value:l,onChange:v=>c(v.target.value),placeholder:"Ex: Rua das Flores, 123",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all"})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"category",className:"block text-sm font-semibold text-gray-700 mb-2",children:"Categoria/Segmento *"}),d.jsx("input",{id:"category",type:"text",value:u,onChange:v=>h(v.target.value),placeholder:"Ex: Restaurante, Clínica Médica, Academia",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all",required:!0})]}),d.jsxs("div",{className:"flex gap-3 pt-4",children:[d.jsx("button",{type:"button",onClick:t,className:"flex-1 px-6 py-3 border-2 border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors font-semibold",children:"← Voltar"}),d.jsx("button",{type:"submit",disabled:!f,className:"flex-1 px-6 py-3 bg-gradient-to-r from-purple-500 to-purple-700 text-white rounded-lg hover:from-purple-600 hover:to-purple-800 transition-all font-semibold shadow-lg hover:shadow-xl disabled:opacity-50 disabled:cursor-not-allowed",children:"Analisar Presença"})]})]})]})}function lq({analysis:e,onNewAnalysis:t}){const r=[{key:"google_maps",data:e.google_maps,color:"blue"},{key:"apple_maps",data:e.apple_maps,color:"gray"},{key:"waze",data:e.waze,color:"cyan"},{key:"uber",data:e.uber,color:"green"},{key:"ninety_nine",data:e.ninety_nine,color:"yellow"},{key:"tripadvisor",data:e.tripadvisor,color:"red"}],n=(s,o)=>s&&o?d.jsx(nu,{className:"w-6 h-6 text-green-500"}):s&&!o?d.jsx(Ov,{className:"w-6 h-6 text-yellow-500"}):d.jsx(k1,{className:"w-6 h-6 text-red-500"}),a=s=>s>=70?"text-green-600 bg-green-50":s>=40?"text-yellow-600 bg-yellow-50":"text-red-600 bg-red-50",i=()=>{const s=Er.book_new(),o=[["ANÁLISE DE PRESENÇA MULTIPLATAFORMA"],[],["Empresa:",e.company_name],["Score Geral de Presença:",`${e.overall_presence_score}/100`],["Plataformas Ausentes:",e.missing_platforms.join(", ")],[],["PLATAFORMA","PRESENTE","VERIFICADO","SCORE","DETALHES"]];r.forEach(({data:f})=>{o.push([f.platform,f.present?"Sim":"Não",f.verified?"Sim":"Não",f.score.toString(),f.details])}),o.push([]),o.push(["RECOMENDAÇÕES"]),e.recommendations.forEach((f,v)=>{o.push([`${v+1}. ${f}`])});const l=Er.aoa_to_sheet(o);l["!cols"]=[{wch:25},{wch:15},{wch:15},{wch:10},{wch:60}];const c=Er.decode_range(l["!ref"]||"A1");l["!autofilter"]={ref:"A7:E7"},l["!margins"]||(l["!margins"]={left:.7,right:.7,top:.75,bottom:.75,header:.3,footer:.3}),l["!printOptions"]||(l["!printOptions"]={}),l["!printOptions"].orientation="landscape";for(let f=c.s.r;f<=c.e.r;f++)for(let v=c.s.c;v<=c.e.c;v++){const x=Er.encode_cell({r:f,c:v});l[x]&&(l[x].s||(l[x].s={}),l[x].s.font={name:"Segoe UI",sz:10},l[x].s.alignment={wrapText:!0,vertical:"top",horizontal:"left"},(f===0||f===6)&&(l[x].s.fill={fgColor:{rgb:"000000"}},l[x].s.font={name:"Segoe UI",sz:10,color:{rgb:"FFFFFF"},bold:!0}))}Er.book_append_sheet(s,l,"Presença Multiplataforma");const h=new Date().toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"});s.Props||(s.Props={}),s.Props.Comments=`Gerado em: ${h}`;const m=`Presenca_Multiplataforma_${e.company_name.replace(/[^a-zA-Z0-9]/g,"_")}.xlsx`;fN(s,m,{cellStyles:!0,bookType:"xlsx"})};return d.jsxs("div",{className:"max-w-6xl mx-auto",children:[d.jsx("div",{className:"mb-6",children:d.jsx("button",{onClick:t,className:"text-white hover:text-blue-200 transition-colors flex items-center gap-2",children:"← Nova Análise"})}),d.jsxs("div",{className:"bg-white/95 backdrop-blur-sm rounded-2xl shadow-xl border border-white/20 p-8 mb-6",children:[d.jsxs("div",{className:"flex items-center justify-between mb-6",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-purple-500 to-purple-700 rounded-xl flex items-center justify-center shadow-lg",children:d.jsx(tp,{className:"w-6 h-6 text-white"})}),d.jsxs("div",{children:[d.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:e.company_name}),d.jsx("p",{className:"text-sm text-gray-600",children:"Análise de Presença Multiplataforma"})]})]}),d.jsxs("div",{className:"text-right",children:[d.jsx("div",{className:"text-4xl font-bold text-purple-600",children:e.overall_presence_score}),d.jsx("div",{className:"text-sm text-gray-600",children:"Score Geral"})]})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[d.jsxs("button",{onClick:i,className:"w-full px-6 py-3 bg-gradient-to-r from-green-500 to-green-700 text-white rounded-lg hover:from-green-600 hover:to-green-800 transition-all font-semibold shadow-lg hover:shadow-xl flex items-center justify-center gap-2",children:[d.jsx(Ih,{className:"w-5 h-5"}),"Exportar Excel"]}),d.jsxs("button",{onClick:()=>generatePlatformAnalysisPDF(e),className:"w-full px-6 py-3 bg-gradient-to-r from-red-500 to-red-700 text-white rounded-lg hover:from-red-600 hover:to-red-800 transition-all font-semibold shadow-lg hover:shadow-xl flex items-center justify-center gap-2",children:[d.jsx(FileText,{className:"w-5 h-5"}),"Gerar Relatório PDF Completo"]})]})]}),d.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6 mb-6",children:r.map(({data:s,color:o})=>d.jsxs("div",{className:"bg-white/95 backdrop-blur-sm rounded-xl shadow-lg border border-white/20 p-6 hover:shadow-xl transition-shadow",children:[d.jsxs("div",{className:"flex items-center justify-between mb-4",children:[d.jsx("h3",{className:"text-lg font-bold text-gray-800",children:s.platform}),n(s.present,s.verified)]}),d.jsx("div",{className:`text-3xl font-bold mb-2 px-3 py-1 rounded-lg inline-block ${a(s.score)}`,children:s.score}),d.jsx("p",{className:"text-sm text-gray-600 mt-3",children:s.details}),s.present&&s.latitude&&s.longitude&&d.jsx("div",{className:"mt-3",children:d.jsx("img",{src:`https://maps.googleapis.com/maps/api/staticmap?center=${s.latitude},${s.longitude}&zoom=15&size=280x150&markers=color:red%7C${s.latitude},${s.longitude}&key=YOUR_GOOGLE_MAPS_API_KEY`,alt:`Mapa de ${s.platform}`,className:"w-full h-32 object-cover rounded-lg border border-gray-200",onError:l=>{l.target.style.display="none"}})}),s.url&&d.jsx("a",{href:s.url,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-blue-600 hover:text-blue-800 mt-2 inline-block",children:"Ver Perfil →"})]},s.platform))}),e.missing_platforms.length>0&&d.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-6 mb-6",children:[d.jsx("h3",{className:"text-lg font-bold text-red-800 mb-3",children:"Plataformas Ausentes"}),d.jsx("div",{className:"flex flex-wrap gap-2",children:e.missing_platforms.map(s=>d.jsx("span",{className:"px-3 py-1 bg-red-100 text-red-700 rounded-full text-sm font-medium",children:s},s))})]}),d.jsxs("div",{className:"bg-white/95 backdrop-blur-sm rounded-xl shadow-lg border border-white/20 p-6",children:[d.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-4",children:"Recomendações Priorizadas"}),d.jsx("div",{className:"space-y-3",children:e.recommendations.map((s,o)=>d.jsxs("div",{className:"flex gap-3",children:[d.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-purple-100 text-purple-700 rounded-full flex items-center justify-center font-bold text-sm",children:o+1}),d.jsx("p",{className:"text-gray-700 pt-1",children:s})]},o))})]})]})}const cq=()=>"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".startsWith("sk-")?null:d.jsx("div",{className:"fixed top-4 right-4 left-4 md:left-auto md:w-96 z-50 animate-in slide-in-from-top",children:d.jsx("div",{className:"bg-gradient-to-br from-orange-50 to-red-50 border-2 border-orange-300 rounded-xl shadow-xl p-4",children:d.jsxs("div",{className:"flex items-start gap-3",children:[d.jsx("div",{className:"flex-shrink-0",children:d.jsx(jv,{className:"w-6 h-6 text-orange-600"})}),d.jsxs("div",{className:"flex-1",children:[d.jsx("h3",{className:"font-bold text-orange-900 mb-1",children:"Configuração Necessária"}),d.jsxs("p",{className:"text-sm text-orange-800 mb-3",children:["A chave da OpenAI API não está configurada ou é inválida. Configure no arquivo ",d.jsx("code",{className:"bg-orange-100 px-1 rounded",children:".env"})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsxs("a",{href:"https://platform.openai.com/api-keys",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 text-sm font-medium text-orange-700 hover:text-orange-900 transition-colors",children:[d.jsx(xC,{className:"w-4 h-4"}),"Obter chave da OpenAI"]}),d.jsx("div",{className:"text-xs text-orange-700 bg-orange-100 rounded p-2 font-mono",children:"VITE_OPENAI_API_KEY=sk-proj-..."})]})]})]})})});class fu{static async createTenant(t){const{data:r,error:n}=await Ir.from("tenants").insert([{name:t.name,slug:t.slug,subscription_plan:t.subscription_plan||"free",status:"trial",trial_ends_at:new Date(Date.now()+12096e5).toISOString()}]).select().single();if(n)throw n;const{error:a}=await Ir.from("tenant_users").insert([{tenant_id:r.id,email:t.owner_email,role:"owner",permissions:{create_audits:!0,view_audits:!0,export_reports:!0,manage_users:!0,manage_billing:!0,manage_branding:!0}}]);if(a)throw a;const{error:i}=await Ir.from("tenant_branding").insert([{tenant_id:r.id}]);if(i)throw i;return r}static async getTenant(t){const{data:r,error:n}=await Ir.from("tenants").select("*").eq("id",t).single();if(n)throw n;return r}static async getTenantBySlug(t){const{data:r,error:n}=await Ir.from("tenants").select("*").eq("slug",t).single();if(n){if(n.code==="PGRST116")return null;throw n}return r}static async updateTenant(t,r){const{data:n,error:a}=await Ir.from("tenants").update(r).eq("id",t).select().single();if(a)throw a;return n}static async getTenantUsers(t){const{data:r,error:n}=await Ir.from("tenant_users").select("*").eq("tenant_id",t).order("created_at",{ascending:!1});if(n)throw n;return r||[]}static async addTenantUser(t){const{data:r,error:n}=await Ir.from("tenant_users").insert([t]).select().single();if(n)throw n;return r}static async updateTenantUser(t,r){const{data:n,error:a}=await Ir.from("tenant_users").update(r).eq("id",t).select().single();if(a)throw a;return n}static async removeTenantUser(t){const{error:r}=await Ir.from("tenant_users").delete().eq("id",t);if(r)throw r}static async getTenantBranding(t){const{data:r,error:n}=await Ir.from("tenant_branding").select("*").eq("tenant_id",t).single();if(n){if(n.code==="PGRST116")return null;throw n}return r}static async updateTenantBranding(t,r){const{data:n,error:a}=await Ir.from("tenant_branding").update(r).eq("tenant_id",t).select().single();if(a)throw a;return n}static async getSubscriptionPlans(){const{data:t,error:r}=await Ir.from("subscription_plans").select("*").eq("is_active",!0).order("sort_order",{ascending:!0});if(r)throw r;return t||[]}static async getTenantSubscription(t){const{data:r,error:n}=await Ir.from("tenant_subscriptions").select("*").eq("tenant_id",t).single();if(n){if(n.code==="PGRST116")return null;throw n}return r}static async changeSubscriptionPlan(t,r,n="monthly"){const{data:a,error:i}=await Ir.rpc("change_subscription_plan",{p_tenant_id:t,p_new_plan_name:r,p_billing_cycle:n});if(i)throw i;return a}static async canPerformAction(t,r){const{data:n,error:a}=await Ir.rpc("can_tenant_perform_action",{p_tenant_id:t,p_action_type:r});if(a)throw a;return n||!1}static async trackUsage(t,r,n,a,i){const{error:s}=await Ir.rpc("track_usage",{p_tenant_id:t,p_user_id:r,p_action_type:n,p_resource_id:a||null,p_metadata:i||{}});if(s)throw s}}function uq({currentTenantId:e,onTenantChange:t}){const[r,n]=nt.useState(null),[a,i]=nt.useState(!0),[s,o]=nt.useState(null);nt.useEffect(()=>{e?l(e):i(!1)},[e]);const l=async h=>{try{i(!0);const m=await fu.getTenant(h);n(m),m&&t(m)}catch(m){o(m instanceof Error?m.message:"Erro ao carregar tenant"),console.error("Erro ao carregar tenant:",m)}finally{i(!1)}};if(a)return d.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-white/90 rounded-lg",children:[d.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-blue-500 border-t-transparent"}),d.jsx("span",{className:"text-sm text-gray-600",children:"Carregando..."})]});if(s)return d.jsx("div",{className:"px-4 py-2 bg-red-50 border border-red-200 rounded-lg",children:d.jsx("span",{className:"text-sm text-red-600",children:s})});if(!r)return null;const c={active:"bg-green-100 text-green-800",trial:"bg-blue-100 text-blue-800",suspended:"bg-red-100 text-red-800",cancelled:"bg-gray-100 text-gray-800"},u={free:"text-gray-600",starter:"text-blue-600",professional:"text-purple-600",enterprise:"text-orange-600"};return d.jsxs("div",{className:"bg-white/90 backdrop-blur-sm rounded-lg shadow-lg border border-white/20 p-4",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-400 to-blue-600 rounded-lg flex items-center justify-center shadow-md",children:d.jsx(Y2,{className:"w-5 h-5 text-white"})}),d.jsxs("div",{children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("h3",{className:"font-semibold text-gray-800",children:r.name}),d.jsxs("span",{className:`text-xs px-2 py-0.5 rounded-full ${c[r.status]}`,children:[r.status==="active"&&"Ativo",r.status==="trial"&&"Trial",r.status==="suspended"&&"Suspenso",r.status==="cancelled"&&"Cancelado"]})]}),d.jsxs("p",{className:`text-sm font-medium ${u[r.subscription_plan]}`,children:["Plano ",r.subscription_plan.charAt(0).toUpperCase()+r.subscription_plan.slice(1)]})]})]}),d.jsx("button",{className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:d.jsx(mC,{className:"w-5 h-5 text-gray-600"})})]}),r.status==="trial"&&r.trial_ends_at&&d.jsx("div",{className:"mt-3 pt-3 border-t border-gray-200",children:d.jsxs("p",{className:"text-xs text-gray-600",children:["Trial termina em: ",new Date(r.trial_ends_at).toLocaleDateString("pt-BR")]})}),d.jsxs("div",{className:"mt-3 grid grid-cols-3 gap-2 text-center",children:[d.jsxs("div",{className:"bg-blue-50 rounded-lg p-2",children:[d.jsx("p",{className:"text-xs text-gray-600",children:"Usuários"}),d.jsx("p",{className:"text-sm font-semibold text-gray-800",children:r.max_users})]}),d.jsxs("div",{className:"bg-green-50 rounded-lg p-2",children:[d.jsx("p",{className:"text-xs text-gray-600",children:"Auditorias/mês"}),d.jsx("p",{className:"text-sm font-semibold text-gray-800",children:r.max_audits_per_month===0?"∞":r.max_audits_per_month})]}),d.jsxs("div",{className:"bg-purple-50 rounded-lg p-2",children:[d.jsx("p",{className:"text-xs text-gray-600",children:"Licença"}),d.jsxs("p",{className:"text-xs font-mono text-gray-600",children:[r.license_key.slice(0,8),"..."]})]})]})]})}const KE=nt.createContext(void 0);function fq({children:e,defaultTenantSlug:t="gmn-master"}){const[r,n]=nt.useState(null),[a,i]=nt.useState(!0),[s,o]=nt.useState(null),l=async u=>{try{i(!0),o(null);const h=await fu.getTenantBySlug(u);h?(n(h),localStorage.setItem("gmn_current_tenant_slug",u)):o(`Tenant "${u}" não encontrado`)}catch(h){o(h instanceof Error?h.message:"Erro ao carregar tenant"),console.error("Erro ao carregar tenant:",h)}finally{i(!1)}},c=async()=>{r&&await l(r.slug)};return nt.useEffect(()=>{const h=localStorage.getItem("gmn_current_tenant_slug")||t;l(h)},[t]),d.jsx(KE.Provider,{value:{currentTenant:r,loading:a,error:s,setCurrentTenant:u=>{n(u),u&&localStorage.setItem("gmn_current_tenant_slug",u.slug)},refreshTenant:c},children:e})}function nm(){const e=nt.useContext(KE);if(e===void 0)throw new Error("useTenant must be used within a TenantProvider");return e}function hq(){const{currentTenant:e}=nm(),[t,r]=nt.useState([]),[n,a]=nt.useState([]),[i,s]=nt.useState(!0),[o,l]=nt.useState("tenants");nt.useEffect(()=>{c()},[]);const c=async()=>{try{s(!0);const[f,v]=await Promise.all([fu.listTenants(),e?fu.listTenantUsers(e.id):Promise.resolve([])]);r(f),a(v)}catch(f){console.error("Error loading admin data:",f)}finally{s(!1)}},u=f=>{switch(f){case"active":return"bg-green-100 text-green-800";case"trial":return"bg-blue-100 text-blue-800";case"suspended":return"bg-red-100 text-red-800";case"cancelled":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},h=f=>{switch(f){case"active":return d.jsx(nu,{className:"w-4 h-4"});case"trial":return d.jsx(Qk,{className:"w-4 h-4"});case"suspended":return d.jsx(k1,{className:"w-4 h-4"});case"cancelled":return d.jsx(k1,{className:"w-4 h-4"});default:return d.jsx(og,{className:"w-4 h-4"})}},m=f=>{const v={free:"bg-gray-100 text-gray-800",starter:"bg-blue-100 text-blue-800",professional:"bg-purple-100 text-purple-800",enterprise:"bg-orange-100 text-orange-800"};return v[f]||v.free};return i?d.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-blue-500 border-t-transparent"})}):d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:"Dashboard Administrativo"}),d.jsx("p",{className:"text-gray-600 mt-1",children:"Gerenciamento de tenants, usuários e recursos"})]}),d.jsxs("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2 transition-colors",children:[d.jsx(wC,{className:"w-5 h-5"}),"Novo Tenant"]})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[d.jsxs("div",{className:"bg-white rounded-xl shadow-md border border-gray-200 p-6",children:[d.jsxs("div",{className:"flex items-center justify-between mb-4",children:[d.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:d.jsx(Y2,{className:"w-6 h-6 text-blue-600"})}),d.jsx("span",{className:"text-2xl font-bold text-gray-900",children:t.length})]}),d.jsx("h3",{className:"text-sm font-medium text-gray-600",children:"Total Tenants"}),d.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[t.filter(f=>f.status==="active").length," ativos"]})]}),d.jsxs("div",{className:"bg-white rounded-xl shadow-md border border-gray-200 p-6",children:[d.jsxs("div",{className:"flex items-center justify-between mb-4",children:[d.jsx("div",{className:"p-3 bg-green-100 rounded-lg",children:d.jsx(Q2,{className:"w-6 h-6 text-green-600"})}),d.jsx("span",{className:"text-2xl font-bold text-gray-900",children:n.length})]}),d.jsx("h3",{className:"text-sm font-medium text-gray-600",children:"Total Usuários"}),d.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[n.filter(f=>f.is_active).length," ativos"]})]}),d.jsxs("div",{className:"bg-white rounded-xl shadow-md border border-gray-200 p-6",children:[d.jsxs("div",{className:"flex items-center justify-between mb-4",children:[d.jsx("div",{className:"p-3 bg-purple-100 rounded-lg",children:d.jsx(og,{className:"w-6 h-6 text-purple-600"})}),d.jsx("span",{className:"text-2xl font-bold text-gray-900",children:t.filter(f=>f.subscription_plan==="enterprise").length})]}),d.jsx("h3",{className:"text-sm font-medium text-gray-600",children:"Enterprise"}),d.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Planos premium"})]}),d.jsxs("div",{className:"bg-white rounded-xl shadow-md border border-gray-200 p-6",children:[d.jsxs("div",{className:"flex items-center justify-between mb-4",children:[d.jsx("div",{className:"p-3 bg-orange-100 rounded-lg",children:d.jsx(gC,{className:"w-6 h-6 text-orange-600"})}),d.jsxs("span",{className:"text-2xl font-bold text-gray-900",children:["$",t.length*997]})]}),d.jsx("h3",{className:"text-sm font-medium text-gray-600",children:"MRR Estimado"}),d.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Receita mensal"})]})]}),d.jsxs("div",{className:"bg-white rounded-xl shadow-md border border-gray-200",children:[d.jsx("div",{className:"border-b border-gray-200",children:d.jsxs("nav",{className:"flex gap-8 px-6",children:[d.jsx("button",{onClick:()=>l("tenants"),className:`py-4 border-b-2 font-medium text-sm transition-colors ${o==="tenants"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(Y2,{className:"w-4 h-4"}),"Tenants"]})}),d.jsx("button",{onClick:()=>l("users"),className:`py-4 border-b-2 font-medium text-sm transition-colors ${o==="users"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(Q2,{className:"w-4 h-4"}),"Usuários"]})}),d.jsx("button",{onClick:()=>l("usage"),className:`py-4 border-b-2 font-medium text-sm transition-colors ${o==="usage"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(og,{className:"w-4 h-4"}),"Uso e Quotas"]})})]})}),d.jsxs("div",{className:"p-6",children:[o==="tenants"&&d.jsx("div",{className:"space-y-4",children:d.jsx("div",{className:"overflow-x-auto",children:d.jsxs("table",{className:"w-full",children:[d.jsx("thead",{children:d.jsxs("tr",{className:"text-left text-sm text-gray-600 border-b",children:[d.jsx("th",{className:"pb-3 font-medium",children:"Tenant"}),d.jsx("th",{className:"pb-3 font-medium",children:"Status"}),d.jsx("th",{className:"pb-3 font-medium",children:"Plano"}),d.jsx("th",{className:"pb-3 font-medium",children:"Usuários"}),d.jsx("th",{className:"pb-3 font-medium",children:"Auditorias"}),d.jsx("th",{className:"pb-3 font-medium",children:"Criado"}),d.jsx("th",{className:"pb-3 font-medium",children:"Ações"})]})}),d.jsx("tbody",{children:t.map(f=>d.jsxs("tr",{className:"border-b hover:bg-gray-50 transition-colors",children:[d.jsx("td",{className:"py-4",children:d.jsxs("div",{children:[d.jsx("div",{className:"font-medium text-gray-900",children:f.name}),d.jsx("div",{className:"text-sm text-gray-500",children:f.slug})]})}),d.jsx("td",{className:"py-4",children:d.jsxs("span",{className:`inline-flex items-center gap-1 px-2.5 py-1 rounded-full text-xs font-medium ${u(f.status)}`,children:[h(f.status),f.status]})}),d.jsx("td",{className:"py-4",children:d.jsx("span",{className:`inline-flex px-2.5 py-1 rounded-full text-xs font-medium ${m(f.subscription_plan)}`,children:f.subscription_plan})}),d.jsx("td",{className:"py-4 text-gray-600",children:f.max_users===999999?"∞":f.max_users}),d.jsx("td",{className:"py-4 text-gray-600",children:f.max_audits_per_month===999999?"∞":`${f.max_audits_per_month}/mês`}),d.jsx("td",{className:"py-4 text-gray-600 text-sm",children:new Date(f.created_at).toLocaleDateString("pt-BR")}),d.jsx("td",{className:"py-4",children:d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("button",{className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",children:d.jsx(Dw,{className:"w-4 h-4"})}),d.jsx("button",{className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:d.jsx(Mw,{className:"w-4 h-4"})})]})})]},f.id))})]})})}),o==="users"&&d.jsx("div",{className:"space-y-4",children:d.jsx("div",{className:"overflow-x-auto",children:d.jsxs("table",{className:"w-full",children:[d.jsx("thead",{children:d.jsxs("tr",{className:"text-left text-sm text-gray-600 border-b",children:[d.jsx("th",{className:"pb-3 font-medium",children:"Email"}),d.jsx("th",{className:"pb-3 font-medium",children:"Role"}),d.jsx("th",{className:"pb-3 font-medium",children:"Status"}),d.jsx("th",{className:"pb-3 font-medium",children:"Último Login"}),d.jsx("th",{className:"pb-3 font-medium",children:"Ações"})]})}),d.jsx("tbody",{children:n.map(f=>d.jsxs("tr",{className:"border-b hover:bg-gray-50 transition-colors",children:[d.jsx("td",{className:"py-4",children:d.jsx("div",{className:"font-medium text-gray-900",children:f.email})}),d.jsx("td",{className:"py-4",children:d.jsx("span",{className:"inline-flex px-2.5 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:f.role})}),d.jsx("td",{className:"py-4",children:f.is_active?d.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[d.jsx(nu,{className:"w-3 h-3"}),"Ativo"]}):d.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:[d.jsx(k1,{className:"w-3 h-3"}),"Inativo"]})}),d.jsx("td",{className:"py-4 text-gray-600 text-sm",children:f.last_login_at?new Date(f.last_login_at).toLocaleDateString("pt-BR"):"Nunca"}),d.jsx("td",{className:"py-4",children:d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("button",{className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",children:d.jsx(Dw,{className:"w-4 h-4"})}),d.jsx("button",{className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:d.jsx(Mw,{className:"w-4 h-4"})})]})})]},f.id))})]})})}),o==="usage"&&d.jsx("div",{className:"space-y-6",children:t.map(f=>d.jsxs("div",{className:"border border-gray-200 rounded-lg p-6",children:[d.jsxs("div",{className:"flex items-center justify-between mb-4",children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:f.name}),d.jsx("span",{className:`px-2.5 py-1 rounded-full text-xs font-medium ${m(f.subscription_plan)}`,children:f.subscription_plan})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[d.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[d.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Usuários"}),d.jsxs("div",{className:"text-2xl font-bold text-gray-900",children:[n.filter(v=>v.tenant_id===f.id).length,d.jsxs("span",{className:"text-sm text-gray-500 font-normal ml-1",children:["/ ",f.max_users===999999?"∞":f.max_users]})]}),d.jsx("div",{className:"mt-2 h-2 bg-gray-200 rounded-full overflow-hidden",children:d.jsx("div",{className:"h-full bg-blue-500 rounded-full transition-all",style:{width:f.max_users===999999?"0%":`${Math.min(n.filter(v=>v.tenant_id===f.id).length/f.max_users*100,100)}%`}})})]}),d.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[d.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Auditorias (mês)"}),d.jsxs("div",{className:"text-2xl font-bold text-gray-900",children:["0",d.jsxs("span",{className:"text-sm text-gray-500 font-normal ml-1",children:["/ ",f.max_audits_per_month===999999?"∞":f.max_audits_per_month]})]}),d.jsx("div",{className:"mt-2 h-2 bg-gray-200 rounded-full overflow-hidden",children:d.jsx("div",{className:"h-full bg-green-500 rounded-full transition-all",style:{width:"0%"}})})]}),d.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[d.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Features Habilitadas"}),d.jsx("div",{className:"text-2xl font-bold text-gray-900",children:Object.values(f.features_enabled||{}).filter(Boolean).length}),d.jsx("div",{className:"mt-2 text-xs text-gray-500",children:Object.keys(f.features_enabled||{}).filter(v=>f.features_enabled[v]).join(", ")})]})]})]},f.id))})]})]})]})}function dq(){const{currentTenant:e}=nm(),[t,r]=nt.useState({primary:"#3B82F6",secondary:"#8B5CF6",accent:"#10B981",background:"#FFFFFF",text:"#1F2937"}),[n,a]=nt.useState(""),[i,s]=nt.useState(""),[o,l]=nt.useState(""),[c,u]=nt.useState(""),[h,m]=nt.useState(!1),[f,v]=nt.useState(!1);nt.useEffect(()=>{e&&x()},[e]);const x=async()=>{if(e)try{const y=await fu.getTenantBranding(e.id);y&&(r({primary:y.primary_color,secondary:y.secondary_color,accent:y.accent_color||"#10B981",background:y.background_color||"#FFFFFF",text:y.text_color||"#1F2937"}),a(y.logo_url||""),s(y.company_name||e.name),l(y.tagline||""),u(y.custom_css||""))}catch(y){console.error("Error loading branding:",y)}},w=async()=>{if(e)try{m(!0),await fu.updateTenantBranding(e.id,{logo_url:n,primary_color:t.primary,secondary_color:t.secondary,accent_color:t.accent,background_color:t.background,text_color:t.text,company_name:i,tagline:o,custom_css:c}),alert("Branding atualizado com sucesso!")}catch(y){console.error("Error saving branding:",y),alert("Erro ao salvar branding")}finally{m(!1)}},_=()=>{r({primary:"#3B82F6",secondary:"#8B5CF6",accent:"#10B981",background:"#FFFFFF",text:"#1F2937"}),a(""),s((e==null?void 0:e.name)||""),l(""),u("")},b=()=>d.jsxs("div",{className:"rounded-xl shadow-xl border-2 overflow-hidden",style:{backgroundColor:t.background,borderColor:t.primary},children:[d.jsx("div",{className:"p-6",style:{backgroundColor:t.primary},children:d.jsxs("div",{className:"flex items-center gap-4",children:[n&&d.jsx("img",{src:n,alt:"Logo",className:"w-16 h-16 rounded-lg bg-white p-2 object-contain"}),d.jsxs("div",{children:[d.jsx("h3",{className:"text-2xl font-bold text-white",children:i||"Nome da Empresa"}),o&&d.jsx("p",{className:"text-white/90 text-sm mt-1",children:o})]})]})}),d.jsxs("div",{className:"p-6 space-y-4",children:[d.jsxs("div",{children:[d.jsx("h4",{className:"font-semibold mb-2",style:{color:t.text},children:"Exemplo de Conteúdo"}),d.jsx("p",{className:"text-sm",style:{color:t.text,opacity:.8},children:"Este é um preview de como seu branding aparecerá no sistema."})]}),d.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[d.jsx("button",{className:"px-4 py-2 rounded-lg font-medium text-white transition-colors",style:{backgroundColor:t.primary},children:"Primary"}),d.jsx("button",{className:"px-4 py-2 rounded-lg font-medium text-white transition-colors",style:{backgroundColor:t.secondary},children:"Secondary"}),d.jsx("button",{className:"px-4 py-2 rounded-lg font-medium text-white transition-colors",style:{backgroundColor:t.accent},children:"Accent"})]}),d.jsx("div",{className:"p-4 rounded-lg border-2",style:{borderColor:t.accent,backgroundColor:`${t.accent}10`},children:d.jsx("p",{className:"text-sm font-medium",style:{color:t.text},children:"Destaque com cor de acento"})})]})]});return d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:"Personalização de Marca"}),d.jsx("p",{className:"text-gray-600 mt-1",children:"Configure as cores, logotipo e identidade visual"})]}),d.jsxs("div",{className:"flex gap-3",children:[d.jsxs("button",{onClick:()=>v(!f),className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 flex items-center gap-2 transition-colors",children:[d.jsx(vC,{className:"w-5 h-5"}),f?"Ocultar":"Preview"]}),d.jsxs("button",{onClick:_,className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 flex items-center gap-2 transition-colors",children:[d.jsx(yC,{className:"w-5 h-5"}),"Resetar"]}),d.jsxs("button",{onClick:w,disabled:h,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2 transition-colors disabled:opacity-50",children:[d.jsx(bC,{className:"w-5 h-5"}),h?"Salvando...":"Salvar"]})]})]}),d.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{className:"bg-white rounded-xl shadow-md border border-gray-200 p-6",children:[d.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[d.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:d.jsx(Z2,{className:"w-5 h-5 text-blue-600"})}),d.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Identidade Visual"})]}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"URL do Logotipo"}),d.jsx("input",{type:"url",value:n,onChange:y=>a(y.target.value),placeholder:"https://exemplo.com/logo.png",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),d.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Tamanho recomendado: 512x512px, formato PNG ou SVG"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nome da Empresa"}),d.jsx("input",{type:"text",value:i,onChange:y=>s(y.target.value),placeholder:"Minha Empresa",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tagline/Slogan"}),d.jsx("input",{type:"text",value:o,onChange:y=>l(y.target.value),placeholder:"Transformando dados em insights",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]})]}),d.jsxs("div",{className:"bg-white rounded-xl shadow-md border border-gray-200 p-6",children:[d.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[d.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:d.jsx(nS,{className:"w-5 h-5 text-purple-600"})}),d.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Paleta de Cores"})]}),d.jsx("div",{className:"space-y-4",children:d.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cor Primária"}),d.jsxs("div",{className:"flex gap-2",children:[d.jsx("input",{type:"color",value:t.primary,onChange:y=>r({...t,primary:y.target.value}),className:"w-16 h-10 rounded cursor-pointer"}),d.jsx("input",{type:"text",value:t.primary,onChange:y=>r({...t,primary:y.target.value}),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg text-sm font-mono"})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cor Secundária"}),d.jsxs("div",{className:"flex gap-2",children:[d.jsx("input",{type:"color",value:t.secondary,onChange:y=>r({...t,secondary:y.target.value}),className:"w-16 h-10 rounded cursor-pointer"}),d.jsx("input",{type:"text",value:t.secondary,onChange:y=>r({...t,secondary:y.target.value}),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg text-sm font-mono"})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cor de Acento"}),d.jsxs("div",{className:"flex gap-2",children:[d.jsx("input",{type:"color",value:t.accent,onChange:y=>r({...t,accent:y.target.value}),className:"w-16 h-10 rounded cursor-pointer"}),d.jsx("input",{type:"text",value:t.accent,onChange:y=>r({...t,accent:y.target.value}),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg text-sm font-mono"})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cor de Fundo"}),d.jsxs("div",{className:"flex gap-2",children:[d.jsx("input",{type:"color",value:t.background,onChange:y=>r({...t,background:y.target.value}),className:"w-16 h-10 rounded cursor-pointer"}),d.jsx("input",{type:"text",value:t.background,onChange:y=>r({...t,background:y.target.value}),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg text-sm font-mono"})]})]}),d.jsxs("div",{className:"col-span-2",children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cor do Texto"}),d.jsxs("div",{className:"flex gap-2",children:[d.jsx("input",{type:"color",value:t.text,onChange:y=>r({...t,text:y.target.value}),className:"w-16 h-10 rounded cursor-pointer"}),d.jsx("input",{type:"text",value:t.text,onChange:y=>r({...t,text:y.target.value}),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg text-sm font-mono"})]})]})]})})]}),d.jsxs("div",{className:"bg-white rounded-xl shadow-md border border-gray-200 p-6",children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"CSS Customizado"}),d.jsx("textarea",{value:c,onChange:y=>u(y.target.value),placeholder:"/* CSS adicional para customização avançada */",rows:6,className:"w-full px-4 py-2 border border-gray-300 rounded-lg font-mono text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),d.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"CSS personalizado será aplicado globalmente no sistema"})]})]}),d.jsx("div",{className:"space-y-6",children:f&&d.jsxs("div",{className:"sticky top-6",children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Preview em Tempo Real"}),d.jsx(b,{})]})})]})]})}async function YE(e,t,r){const{data:n}=await Ir.from("tenants").select("name").eq("id",e).single(),{data:a}=await Ir.from("gmn_audits").select("*").eq("tenant_id",e).gte("created_at",t.toISOString()).lte("created_at",r.toISOString()),{data:i}=await Ir.from("competitive_comparisons").select("*").eq("tenant_id",e).gte("created_at",t.toISOString()).lte("created_at",r.toISOString()),s=50,o=30,l=15,c=[];a&&c.push({id:crypto.randomUUID(),type:"audit",description:"Auditorias GMN",quantity:a.length,unit_price:s,total_amount:a.length*s,royalty_amount:a.length*s*l/100,created_at:r.toISOString()}),i&&c.push({id:crypto.randomUUID(),type:"comparison",description:"Comparações Competitivas",quantity:i.length,unit_price:o,total_amount:i.length*o,royalty_amount:i.length*o*l/100,created_at:r.toISOString()}),c.reduce((h,m)=>h+m.total_amount,0);const u=c.reduce((h,m)=>h+m.royalty_amount,0);return{tenant_id:e,tenant_name:(n==null?void 0:n.name)||"Unknown",period_start:t.toISOString(),period_end:r.toISOString(),total_audits:(a==null?void 0:a.length)||0,total_comparisons:(i==null?void 0:i.length)||0,total_transactions:c.length,total_royalty_amount:u,royalty_percentage:l,status:"pending",transactions:c}}async function pq(e){const t=new xt,r=t.internal.pageSize.getWidth(),n=t.internal.pageSize.getHeight();t.setFillColor(59,130,246),t.rect(0,0,r,40,"F"),t.setTextColor(255,255,255),t.setFontSize(24),t.setFont("helvetica","bold"),t.text("RELATÓRIO DE ROYALTIES",r/2,20,{align:"center"}),t.setFontSize(12),t.setFont("helvetica","normal"),t.text("GMN SmartLocal Auditor PRO",r/2,30,{align:"center"}),t.setTextColor(0,0,0),t.setFontSize(11),t.setFont("helvetica","bold"),t.text("Tenant:",20,60),t.setFont("helvetica","normal"),t.text(e.tenant_name,50,60),t.setFont("helvetica","bold"),t.text("Período:",20,70),t.setFont("helvetica","normal"),t.text(`${new Date(e.period_start).toLocaleDateString("pt-BR")} - ${new Date(e.period_end).toLocaleDateString("pt-BR")}`,50,70),t.setFont("helvetica","bold"),t.text("Status:",20,80),t.setFont("helvetica","normal");const a=e.status==="paid"?[16,185,129]:[239,68,68];t.setTextColor(a[0],a[1],a[2]),t.text(e.status.toUpperCase(),50,80),t.setTextColor(0,0,0),t.setFillColor(243,244,246),t.rect(15,95,r-30,40,"F"),t.setFontSize(10),t.setFont("helvetica","bold"),t.text("RESUMO FINANCEIRO",20,105),t.setFont("helvetica","normal"),t.setFontSize(9);const i=115,s=20,o=70,l=120,c=160;t.text("Auditorias:",s,i),t.text(e.total_audits.toString(),s,i+7),t.text("Comparações:",o,i),t.text(e.total_comparisons.toString(),o,i+7),t.text("% Royalty:",l,i),t.text(`${e.royalty_percentage}%`,l,i+7),t.setFont("helvetica","bold"),t.setFontSize(11),t.text("Total Royalty:",c,i),t.setTextColor(16,185,129),t.text(`R$ ${e.total_royalty_amount.toFixed(2)}`,c,i+7),t.setTextColor(0,0,0),t.setFontSize(12),t.setFont("helvetica","bold"),t.text("TRANSAÇÕES DETALHADAS",20,150);const u=["Tipo","Descrição","Qtd","Valor Unit.","Total","Royalty"],h=15;let m=160;const f=[30,50,20,25,25,25],v=8;t.setFillColor(59,130,246),t.rect(h,m,r-30,v,"F"),t.setTextColor(255,255,255),t.setFontSize(9),t.setFont("helvetica","bold");let x=h+2;return u.forEach((w,_)=>{t.text(w,x,m+5),x+=f[_]}),t.setTextColor(0,0,0),t.setFont("helvetica","normal"),m+=v,e.transactions.forEach((w,_)=>{m>n-40&&(t.addPage(),m=20),_%2===0&&(t.setFillColor(249,250,251),t.rect(h,m,r-30,v,"F")),x=h+2;const b={audit:"Auditoria",comparison:"Comparação",subscription:"Assinatura"};t.text(b[w.type],x,m+5),x+=f[0],t.text(w.description.substring(0,20),x,m+5),x+=f[1],t.text(w.quantity.toString(),x,m+5),x+=f[2],t.text(`R$ ${w.unit_price.toFixed(2)}`,x,m+5),x+=f[3],t.text(`R$ ${w.total_amount.toFixed(2)}`,x,m+5),x+=f[4],t.setFont("helvetica","bold"),t.text(`R$ ${w.royalty_amount.toFixed(2)}`,x,m+5),t.setFont("helvetica","normal"),m+=v}),m+=10,t.setDrawColor(59,130,246),t.setLineWidth(.5),t.line(h,m,r-15,m),m+=8,t.setFontSize(11),t.setFont("helvetica","bold"),t.text("TOTAL A PAGAR:",r-80,m),t.setFontSize(14),t.setTextColor(16,185,129),t.text(`R$ ${e.total_royalty_amount.toFixed(2)}`,r-30,m,{align:"right"}),t.setFontSize(8),t.setTextColor(100,100,100),t.setFont("helvetica","normal"),t.text(`Relatório gerado em ${new Date().toLocaleDateString("pt-BR")} às ${new Date().toLocaleTimeString("pt-BR")}`,r/2,n-10,{align:"center"}),t.output("blob")}async function mq(e,t){const{data:r}=await Ir.from("tenants").select("id").eq("status","active");return r?(await Promise.all(r.map(a=>YE(a.id,e,t)))).filter(a=>a.total_royalty_amount>0):[]}function gq(){const{currentTenant:e}=nm(),[t,r]=nt.useState([]),[n,a]=nt.useState(!1),[i,s]=nt.useState(()=>{const w=new Date;return w.setMonth(w.getMonth()-1),w.toISOString().split("T")[0]}),[o,l]=nt.useState(new Date().toISOString().split("T")[0]),[c,u]=nt.useState("current"),h=async()=>{if(e)try{a(!0);const w=new Date(i),_=new Date(o);if(c==="current"){const b=await YE(e.id,w,_);r([b])}else{const b=await mq(w,_);r(b)}}catch(w){console.error("Error generating report:",w),alert("Erro ao gerar relatório")}finally{a(!1)}},m=async w=>{try{const _=await pq(w),b=URL.createObjectURL(_),y=document.createElement("a");y.href=b,y.download=`royalty-report-${w.tenant_name}-${new Date().toISOString().split("T")[0]}.pdf`,document.body.appendChild(y),y.click(),document.body.removeChild(y),URL.revokeObjectURL(b)}catch(_){console.error("Error downloading PDF:",_),alert("Erro ao baixar PDF")}},f=t.reduce((w,_)=>w+_.total_royalty_amount,0),v=t.reduce((w,_)=>w+_.total_audits,0),x=t.reduce((w,_)=>w+_.total_comparisons,0);return d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{children:[d.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:"Relatórios de Royalty"}),d.jsx("p",{className:"text-gray-600 mt-1",children:"Geração e visualização de relatórios financeiros"})]}),d.jsxs("div",{className:"bg-white rounded-xl shadow-md border border-gray-200 p-6",children:[d.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[d.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:d.jsx(Zk,{className:"w-5 h-5 text-green-600"})}),d.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Configuração do Relatório"})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Data Inicial"}),d.jsx("input",{type:"date",value:i,onChange:w=>s(w.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Data Final"}),d.jsx("input",{type:"date",value:o,onChange:w=>l(w.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tipo de Relatório"}),d.jsxs("select",{value:c,onChange:w=>u(w.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[d.jsx("option",{value:"current",children:"Tenant Atual"}),d.jsx("option",{value:"all",children:"Todos os Tenants"})]})]})]}),d.jsxs("button",{onClick:h,disabled:n,className:"w-full px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium flex items-center justify-center gap-2 transition-colors disabled:opacity-50",children:[d.jsx(xc,{className:"w-5 h-5"}),n?"Gerando Relatório...":"Gerar Relatório"]})]}),t.length>0&&d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[d.jsxs("div",{className:"bg-white rounded-xl shadow-md border border-gray-200 p-6",children:[d.jsxs("div",{className:"flex items-center justify-between mb-4",children:[d.jsx("div",{className:"p-3 bg-green-100 rounded-lg",children:d.jsx(tS,{className:"w-6 h-6 text-green-600"})}),d.jsxs("span",{className:"text-2xl font-bold text-gray-900",children:["R$ ",f.toFixed(2)]})]}),d.jsx("h3",{className:"text-sm font-medium text-gray-600",children:"Total Royalties"}),d.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Período selecionado"})]}),d.jsxs("div",{className:"bg-white rounded-xl shadow-md border border-gray-200 p-6",children:[d.jsxs("div",{className:"flex items-center justify-between mb-4",children:[d.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:d.jsx(xc,{className:"w-6 h-6 text-blue-600"})}),d.jsx("span",{className:"text-2xl font-bold text-gray-900",children:v})]}),d.jsx("h3",{className:"text-sm font-medium text-gray-600",children:"Auditorias"}),d.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Total processadas"})]}),d.jsxs("div",{className:"bg-white rounded-xl shadow-md border border-gray-200 p-6",children:[d.jsxs("div",{className:"flex items-center justify-between mb-4",children:[d.jsx("div",{className:"p-3 bg-purple-100 rounded-lg",children:d.jsx(fo,{className:"w-6 h-6 text-purple-600"})}),d.jsx("span",{className:"text-2xl font-bold text-gray-900",children:x})]}),d.jsx("h3",{className:"text-sm font-medium text-gray-600",children:"Comparações"}),d.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Total realizadas"})]}),d.jsxs("div",{className:"bg-white rounded-xl shadow-md border border-gray-200 p-6",children:[d.jsxs("div",{className:"flex items-center justify-between mb-4",children:[d.jsx("div",{className:"p-3 bg-orange-100 rounded-lg",children:d.jsx(xc,{className:"w-6 h-6 text-orange-600"})}),d.jsx("span",{className:"text-2xl font-bold text-gray-900",children:t.length})]}),d.jsx("h3",{className:"text-sm font-medium text-gray-600",children:"Tenants"}),d.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Com atividade"})]})]}),d.jsxs("div",{className:"bg-white rounded-xl shadow-md border border-gray-200 p-6",children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Relatórios Gerados"}),d.jsx("div",{className:"space-y-4",children:t.map(w=>d.jsxs("div",{className:"border border-gray-200 rounded-lg p-6 hover:shadow-md transition-shadow",children:[d.jsxs("div",{className:"flex items-center justify-between mb-4",children:[d.jsxs("div",{children:[d.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:w.tenant_name}),d.jsxs("p",{className:"text-sm text-gray-600",children:[new Date(w.period_start).toLocaleDateString("pt-BR")," -"," ",new Date(w.period_end).toLocaleDateString("pt-BR")]})]}),d.jsxs("button",{onClick:()=>m(w),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 flex items-center gap-2 transition-colors",children:[d.jsx(Ih,{className:"w-4 h-4"}),"Baixar PDF"]})]}),d.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[d.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[d.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"Auditorias"}),d.jsx("div",{className:"text-lg font-bold text-gray-900",children:w.total_audits})]}),d.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[d.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"Comparações"}),d.jsx("div",{className:"text-lg font-bold text-gray-900",children:w.total_comparisons})]}),d.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[d.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"Transações"}),d.jsx("div",{className:"text-lg font-bold text-gray-900",children:w.total_transactions})]}),d.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[d.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"% Royalty"}),d.jsxs("div",{className:"text-lg font-bold text-gray-900",children:[w.royalty_percentage,"%"]})]}),d.jsxs("div",{className:"bg-green-50 rounded-lg p-3",children:[d.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"Total Royalty"}),d.jsxs("div",{className:"text-lg font-bold text-green-600",children:["R$ ",w.total_royalty_amount.toFixed(2)]})]})]}),d.jsxs("div",{className:"mt-4",children:[d.jsx("h5",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Transações Detalhadas"}),d.jsx("div",{className:"overflow-x-auto",children:d.jsxs("table",{className:"w-full text-sm",children:[d.jsx("thead",{className:"bg-gray-50",children:d.jsxs("tr",{children:[d.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-600",children:"Tipo"}),d.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-600",children:"Descrição"}),d.jsx("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-600",children:"Qtd"}),d.jsx("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-600",children:"Valor Unit."}),d.jsx("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-600",children:"Total"}),d.jsx("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-600",children:"Royalty"})]})}),d.jsx("tbody",{children:w.transactions.map(_=>d.jsxs("tr",{className:"border-t",children:[d.jsx("td",{className:"px-4 py-2",children:d.jsx("span",{className:"inline-flex px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:_.type})}),d.jsx("td",{className:"px-4 py-2 text-gray-900",children:_.description}),d.jsx("td",{className:"px-4 py-2 text-right text-gray-900",children:_.quantity}),d.jsxs("td",{className:"px-4 py-2 text-right text-gray-900",children:["R$ ",_.unit_price.toFixed(2)]}),d.jsxs("td",{className:"px-4 py-2 text-right text-gray-900",children:["R$ ",_.total_amount.toFixed(2)]}),d.jsxs("td",{className:"px-4 py-2 text-right font-semibold text-green-600",children:["R$ ",_.royalty_amount.toFixed(2)]})]},_.id))})]})})]})]},w.tenant_id))})]})]})]})}function xq(){const e="https://cknjwwnyukkonjnayqko.supabase.co".replace("/rest/v1","")||"https://your-project.supabase.co";return d.jsxs("div",{className:"space-y-6 max-w-5xl",children:[d.jsxs("div",{children:[d.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:"Documentação da API"}),d.jsx("p",{className:"text-gray-600 mt-1",children:"Referência completa para integração programática"})]}),d.jsxs("div",{className:"bg-gradient-to-r from-blue-500 to-purple-600 rounded-xl shadow-xl p-8 text-white",children:[d.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[d.jsx("div",{className:"p-3 bg-white/20 rounded-lg",children:d.jsx(iS,{className:"w-8 h-8"})}),d.jsxs("div",{children:[d.jsx("h3",{className:"text-2xl font-bold",children:"GMN SmartLocal API v3.1"}),d.jsx("p",{className:"text-white/90",children:"RESTful API para auditorias e análises competitivas"})]})]}),d.jsxs("div",{className:"grid grid-cols-3 gap-4 mt-6",children:[d.jsxs("div",{className:"bg-white/10 rounded-lg p-4 backdrop-blur-sm",children:[d.jsx("div",{className:"text-2xl font-bold",children:"REST"}),d.jsx("div",{className:"text-sm text-white/80",children:"Arquitetura"})]}),d.jsxs("div",{className:"bg-white/10 rounded-lg p-4 backdrop-blur-sm",children:[d.jsx("div",{className:"text-2xl font-bold",children:"JSON"}),d.jsx("div",{className:"text-sm text-white/80",children:"Formato"})]}),d.jsxs("div",{className:"bg-white/10 rounded-lg p-4 backdrop-blur-sm",children:[d.jsx("div",{className:"text-2xl font-bold",children:"OAuth 2.0"}),d.jsx("div",{className:"text-sm text-white/80",children:"Autenticação"})]})]})]}),d.jsxs("div",{className:"bg-white rounded-xl shadow-md border border-gray-200 p-6",children:[d.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[d.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:d.jsx(_C,{className:"w-5 h-5 text-green-600"})}),d.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Autenticação"})]}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("p",{className:"text-gray-600",children:["Todas as requisições à API requerem uma API key válida enviada no header ",d.jsx("code",{className:"bg-gray-100 px-2 py-1 rounded",children:"Authorization"}),"."]}),d.jsx("div",{className:"bg-gray-900 rounded-lg p-4 overflow-x-auto",children:d.jsx("pre",{className:"text-green-400 text-sm",children:d.jsx("code",{children:`curl -X GET "${e}/api/v1/audits" \\
  -H "Authorization: Bearer gmn_live_your_api_key_here" \\
  -H "Content-Type: application/json"`})})}),d.jsx("div",{className:"bg-blue-50 border-l-4 border-blue-500 p-4",children:d.jsxs("p",{className:"text-sm text-blue-900",children:[d.jsx("strong",{children:"Dica:"}),' Gere sua API key na aba "API Keys" do painel administrativo.']})})]})]}),d.jsxs("div",{className:"bg-white rounded-xl shadow-md border border-gray-200 p-6",children:[d.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[d.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:d.jsx(eS,{className:"w-5 h-5 text-purple-600"})}),d.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Endpoints Disponíveis"})]}),d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{className:"border-l-4 border-blue-500 pl-4",children:[d.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[d.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded text-xs font-bold",children:"GET"}),d.jsx("code",{className:"text-sm font-mono",children:"/api/v1/audits"})]}),d.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Lista todas as auditorias do tenant"}),d.jsxs("div",{className:"bg-gray-50 rounded p-3 text-sm",children:[d.jsx("strong",{children:"Query Parameters:"}),d.jsxs("ul",{className:"list-disc list-inside mt-1 text-gray-600",children:[d.jsxs("li",{children:[d.jsx("code",{children:"limit"})," - Número de resultados (padrão: 50, max: 100)"]}),d.jsxs("li",{children:[d.jsx("code",{children:"offset"})," - Paginação (padrão: 0)"]}),d.jsxs("li",{children:[d.jsx("code",{children:"segment"})," - Filtrar por segmento"]}),d.jsxs("li",{children:[d.jsx("code",{children:"city"})," - Filtrar por cidade"]})]})]}),d.jsx("div",{className:"bg-gray-900 rounded-lg p-3 mt-3 overflow-x-auto",children:d.jsx("pre",{className:"text-green-400 text-xs",children:d.jsx("code",{children:`{
  "data": [
    {
      "id": "uuid",
      "segment": "Restaurantes",
      "city": "São Paulo",
      "overall_score": 85,
      "companies_analyzed": 50,
      "created_at": "2025-10-13T12:00:00Z"
    }
  ],
  "total": 100,
  "page": 1
}`})})})]}),d.jsxs("div",{className:"border-l-4 border-green-500 pl-4",children:[d.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[d.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-800 rounded text-xs font-bold",children:"POST"}),d.jsx("code",{className:"text-sm font-mono",children:"/api/v1/audits"})]}),d.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Cria uma nova auditoria"}),d.jsx("div",{className:"bg-gray-900 rounded-lg p-3 overflow-x-auto",children:d.jsx("pre",{className:"text-green-400 text-xs",children:d.jsx("code",{children:`{
  "segment": "Restaurantes",
  "city": "São Paulo",
  "state": "SP",
  "companies": [
    {
      "company_name": "Restaurante Exemplo",
      "address": "Rua Exemplo, 123",
      "category": "Restaurante"
    }
  ]
}`})})})]}),d.jsxs("div",{className:"border-l-4 border-blue-500 pl-4",children:[d.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[d.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded text-xs font-bold",children:"GET"}),d.jsx("code",{className:"text-sm font-mono",children:"/api/v1/audits/:id"})]}),d.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Obtém detalhes de uma auditoria específica"})]}),d.jsxs("div",{className:"border-l-4 border-blue-500 pl-4",children:[d.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[d.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded text-xs font-bold",children:"GET"}),d.jsx("code",{className:"text-sm font-mono",children:"/api/v1/comparisons"})]}),d.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Lista comparações competitivas"})]}),d.jsxs("div",{className:"border-l-4 border-green-500 pl-4",children:[d.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[d.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-800 rounded text-xs font-bold",children:"POST"}),d.jsx("code",{className:"text-sm font-mono",children:"/api/v1/comparisons"})]}),d.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Cria nova comparação competitiva"})]}),d.jsxs("div",{className:"border-l-4 border-blue-500 pl-4",children:[d.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[d.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded text-xs font-bold",children:"GET"}),d.jsx("code",{className:"text-sm font-mono",children:"/api/v1/reports/royalty"})]}),d.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Gera relatório de royalty do período"}),d.jsxs("div",{className:"bg-gray-50 rounded p-3 text-sm mt-2",children:[d.jsx("strong",{children:"Query Parameters:"}),d.jsxs("ul",{className:"list-disc list-inside mt-1 text-gray-600",children:[d.jsxs("li",{children:[d.jsx("code",{children:"start_date"})," - Data inicial (ISO 8601)"]}),d.jsxs("li",{children:[d.jsx("code",{children:"end_date"})," - Data final (ISO 8601)"]})]})]})]})]})]}),d.jsxs("div",{className:"bg-white rounded-xl shadow-md border border-gray-200 p-6",children:[d.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[d.jsx("div",{className:"p-2 bg-orange-100 rounded-lg",children:d.jsx(pC,{className:"w-5 h-5 text-orange-600"})}),d.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Rate Limiting"})]}),d.jsxs("div",{className:"space-y-4",children:[d.jsx("p",{className:"text-gray-600",children:"A API implementa rate limiting para garantir fair usage:"}),d.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[d.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[d.jsx("div",{className:"text-2xl font-bold text-blue-600 mb-1",children:"60 req/min"}),d.jsx("div",{className:"text-sm text-gray-600",children:"Limite por minuto"})]}),d.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[d.jsx("div",{className:"text-2xl font-bold text-purple-600 mb-1",children:"10.000 req/dia"}),d.jsx("div",{className:"text-sm text-gray-600",children:"Limite diário"})]})]}),d.jsxs("div",{className:"bg-yellow-50 border-l-4 border-yellow-500 p-4",children:[d.jsxs("p",{className:"text-sm text-yellow-900",children:[d.jsx("strong",{children:"Atenção:"})," Limites podem ser ajustados por tenant. Verifique os headers de resposta:"]}),d.jsxs("ul",{className:"list-disc list-inside mt-2 text-sm text-yellow-800",children:[d.jsxs("li",{children:[d.jsx("code",{children:"X-RateLimit-Limit"})," - Limite total"]}),d.jsxs("li",{children:[d.jsx("code",{children:"X-RateLimit-Remaining"})," - Requisições restantes"]}),d.jsxs("li",{children:[d.jsx("code",{children:"X-RateLimit-Reset"})," - Timestamp do reset"]})]})]})]})]}),d.jsxs("div",{className:"bg-white rounded-xl shadow-md border border-gray-200 p-6",children:[d.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[d.jsx("div",{className:"p-2 bg-red-100 rounded-lg",children:d.jsx(nu,{className:"w-5 h-5 text-red-600"})}),d.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Códigos de Status"})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsxs("div",{className:"flex items-center gap-3 p-3 bg-green-50 rounded",children:[d.jsx("span",{className:"px-3 py-1 bg-green-600 text-white rounded font-bold text-sm",children:"200"}),d.jsx("span",{className:"text-gray-700",children:"Sucesso - Requisição processada com sucesso"})]}),d.jsxs("div",{className:"flex items-center gap-3 p-3 bg-green-50 rounded",children:[d.jsx("span",{className:"px-3 py-1 bg-green-600 text-white rounded font-bold text-sm",children:"201"}),d.jsx("span",{className:"text-gray-700",children:"Criado - Recurso criado com sucesso"})]}),d.jsxs("div",{className:"flex items-center gap-3 p-3 bg-yellow-50 rounded",children:[d.jsx("span",{className:"px-3 py-1 bg-yellow-600 text-white rounded font-bold text-sm",children:"400"}),d.jsx("span",{className:"text-gray-700",children:"Bad Request - Parâmetros inválidos"})]}),d.jsxs("div",{className:"flex items-center gap-3 p-3 bg-red-50 rounded",children:[d.jsx("span",{className:"px-3 py-1 bg-red-600 text-white rounded font-bold text-sm",children:"401"}),d.jsx("span",{className:"text-gray-700",children:"Unauthorized - API key inválida ou ausente"})]}),d.jsxs("div",{className:"flex items-center gap-3 p-3 bg-red-50 rounded",children:[d.jsx("span",{className:"px-3 py-1 bg-red-600 text-white rounded font-bold text-sm",children:"403"}),d.jsx("span",{className:"text-gray-700",children:"Forbidden - Sem permissão para este recurso"})]}),d.jsxs("div",{className:"flex items-center gap-3 p-3 bg-red-50 rounded",children:[d.jsx("span",{className:"px-3 py-1 bg-red-600 text-white rounded font-bold text-sm",children:"429"}),d.jsx("span",{className:"text-gray-700",children:"Too Many Requests - Rate limit excedido"})]}),d.jsxs("div",{className:"flex items-center gap-3 p-3 bg-red-50 rounded",children:[d.jsx("span",{className:"px-3 py-1 bg-red-600 text-white rounded font-bold text-sm",children:"500"}),d.jsx("span",{className:"text-gray-700",children:"Internal Server Error - Erro no servidor"})]})]})]}),d.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-blue-50 rounded-xl border-2 border-purple-200 p-6",children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"SDKs e Bibliotecas"}),d.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[d.jsxs("div",{className:"bg-white rounded-lg p-4 text-center",children:[d.jsx("div",{className:"text-3xl mb-2",children:"🐍"}),d.jsx("div",{className:"font-semibold",children:"Python"}),d.jsx("code",{className:"text-xs text-gray-600",children:"pip install gmn-api"})]}),d.jsxs("div",{className:"bg-white rounded-lg p-4 text-center",children:[d.jsx("div",{className:"text-3xl mb-2",children:"📦"}),d.jsx("div",{className:"font-semibold",children:"Node.js"}),d.jsx("code",{className:"text-xs text-gray-600",children:"npm install @gmn/api"})]}),d.jsxs("div",{className:"bg-white rounded-lg p-4 text-center",children:[d.jsx("div",{className:"text-3xl mb-2",children:"💎"}),d.jsx("div",{className:"font-semibold",children:"Ruby"}),d.jsx("code",{className:"text-xs text-gray-600",children:"gem install gmn-api"})]})]})]})]})}const vq="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",_q=`
Você é um especialista em presença digital multiplataforma.

Analise a presença da seguinte empresa nas principais plataformas de mapas e mobilidade:

EMPRESA: {company_name}
CIDADE: {city}
ESTADO: {state}
ENDEREÇO: {address}
CATEGORIA: {category}

Plataformas para verificar:
1. Google Maps (GMN/GMB)
2. Apple Maps
3. Waze
4. Uber (listagem de estabelecimentos)
5. 99 (listagem de estabelecimentos)
6. TripAdvisor (se aplicável ao segmento)

Para cada plataforma, avalie:
- Presença (cadastrado ou não) - Se NÃO encontrado, use "present": false e details: "Registro inexistente"
- Verificação (perfil verificado)
- Qualidade das informações
- Score de 0 a 100
- Se presente, incluir URL e coordenadas (latitude/longitude)

IMPORTANTE: Se a empresa NÃO estiver cadastrada em uma plataforma, use:
- "present": false
- "verified": false
- "score": 0
- "details": "Registro inexistente"

Retorne APENAS um JSON válido:

{
  "google_maps": {
    "platform": "Google Maps",
    "present": true,
    "verified": true,
    "score": 85,
    "details": "Perfil completo e verificado com 127 avaliações",
    "url": "https://...",
    "latitude": -23.550520,
    "longitude": -46.633308
  },
  "apple_maps": {
    "platform": "Apple Maps",
    "present": false,
    "verified": false,
    "score": 0,
    "details": "Registro inexistente"
  },
  "waze": {
    "platform": "Waze",
    "present": true,
    "verified": false,
    "score": 60,
    "details": "Localização presente mas sem verificação",
    "url": null
  },
  "uber": {
    "platform": "Uber",
    "present": false,
    "verified": false,
    "score": 0,
    "details": "Não listado no Uber",
    "url": null
  },
  "ninety_nine": {
    "platform": "99",
    "present": false,
    "verified": false,
    "score": 0,
    "details": "Não listado no 99",
    "url": null
  },
  "tripadvisor": {
    "platform": "TripAdvisor",
    "present": true,
    "verified": true,
    "score": 75,
    "details": "Perfil ativo com 43 avaliações",
    "url": "https://..."
  },
  "overall_presence_score": 45,
  "missing_platforms": ["Apple Maps", "Uber", "99"],
  "recommendations": [
    "URGENTE: Criar perfil no Apple Maps para alcançar 30% dos usuários móveis (iOS)",
    "Cadastrar estabelecimento no Uber para aumentar visibilidade em buscas de clientes",
    "Adicionar localização no app 99 para captar usuários de transporte alternativo",
    "Otimizar perfil do TripAdvisor: adicionar 20+ fotos profissionais e responder todas avaliações",
    "Google Maps: atualizar horários especiais, adicionar menu/produtos e fazer posts semanais"
  ]
}

IMPORTANTE SOBRE RECOMENDAÇÕES:
- Sempre forneça 5 recomendações práticas e acionáveis
- Priorize plataformas ausentes primeiro
- Para plataformas existentes, sugira otimizações específicas
- Use dados quantitativos quando possível (ex: "adicionar 20+ fotos")
- Foque em ações que aumentam visibilidade, conversão e reputação
- NUNCA mencione erros técnicos, APIs ou problemas de sistema
- Todas recomendações devem ser voltadas para o NEGÓCIO DO CLIENTE

`;async function wq(e,t,r,n,a){var s,o;const i=_q.replace("{company_name}",e).replace("{city}",t).replace("{state}",r).replace("{address}",n).replace("{category}",a);try{const l=await fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${vq}`},body:JSON.stringify({model:"gpt-4o-mini",messages:[{role:"system",content:"Você é um especialista em presença digital multiplataforma. Responda SEMPRE em formato JSON válido."},{role:"user",content:i}],temperature:.7,max_tokens:2e3,timeout:15e3})});if(!l.ok)throw new Error(`OpenAI API error: ${l.status}`);let u=((o=(s=(await l.json()).choices[0])==null?void 0:s.message)==null?void 0:o.content)||"";u.startsWith("```json")?u=u.replace(/```json\n?/g,"").replace(/```\n?$/g,""):u.startsWith("```")&&(u=u.replace(/```\n?/g,""));const h=JSON.parse(u);return{company_name:e,...h}}catch(l){return console.error("Error checking platform presence:",l),{company_name:e,google_maps:{platform:"Google Maps",present:!1,verified:!1,score:0,details:"Análise indisponível no momento"},apple_maps:{platform:"Apple Maps",present:!1,verified:!1,score:0,details:"Análise indisponível no momento"},waze:{platform:"Waze",present:!1,verified:!1,score:0,details:"Análise indisponível no momento"},uber:{platform:"Uber",present:!1,verified:!1,score:0,details:"Análise indisponível no momento"},ninety_nine:{platform:"99",present:!1,verified:!1,score:0,details:"Análise indisponível no momento"},tripadvisor:{platform:"TripAdvisor",present:!1,verified:!1,score:0,details:"Análise indisponível no momento"},overall_presence_score:0,missing_platforms:[],recommendations:["Realize cadastro gratuito no Google Meu Negócio para aumentar visibilidade local","Considere criar perfis em plataformas de mobilidade (Uber, 99) se aplicável ao seu negócio","Mantenha informações de endereço, telefone e horário sempre atualizados","Solicite avaliações de clientes satisfeitos para melhorar reputação online","Use fotos de qualidade profissional em todos os perfis"]}}}function yq(){const{currentTenant:e,loading:t}=nm(),[r,n]=nt.useState("home"),[a,i]=nt.useState([]),[s,o]=nt.useState(null),[l,c]=nt.useState(null),[u,h]=nt.useState(null),[m,f]=nt.useState(null),[v,x]=nt.useState(!1),w=()=>{n("home")},_=()=>{i([]),n("batch-upload")},b=(C,A)=>{console.log("✅ Auditoria completa! Mostrando",A.length,"resultados"),i(A),n("batch-results")},y=(C,A,W)=>{o({companyName:C,city:A,segment:W}),n("comparison-processing")},N=C=>{c(C),n("comparison-results")},R=()=>{o(null),c(null),n("comparison-form")},P=async C=>{h(C),x(!0),n("platform-processing");try{const A=await wq(C.companyName,C.city,C.state,C.address,C.category);f(A),n("platform-results")}catch(A){console.error("Erro na análise de plataformas:",A),alert("Erro ao analisar presença em plataformas. Tente novamente."),n("platform-form")}finally{x(!1)}},F=()=>{h(null),f(null),n("platform-form")};return t?d.jsx("div",{className:"min-h-screen animated-gradient-bg flex items-center justify-center",children:d.jsxs("div",{className:"bg-white/95 backdrop-blur-sm rounded-2xl shadow-xl border border-white/20 p-12 text-center",children:[d.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-4 border-blue-500 border-t-transparent mx-auto mb-6"}),d.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Carregando Sistema..."}),d.jsx("p",{className:"text-gray-600",children:"Inicializando GMN SmartLocal Auditor PRO"})]})}):d.jsxs("div",{className:"min-h-screen animated-gradient-bg",children:[d.jsx(cq,{}),d.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8 relative z-10",children:[d.jsx("header",{className:"mb-8 relative z-10",children:d.jsxs("div",{className:"flex items-center justify-between mb-4",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-blue-400 to-blue-600 rounded-xl flex items-center justify-center shadow-xl",children:d.jsx(dC,{className:"w-8 h-8 text-white"})}),d.jsxs("div",{children:[d.jsx("h1",{className:"text-4xl font-bold text-white drop-shadow-lg",children:"GMN SmartLocal Auditor PRO"}),d.jsx("p",{className:"text-blue-100 text-lg",children:"Auditoria Digital Completa + Presença Multiplataforma"})]})]}),e&&d.jsx("div",{className:"ml-4",children:d.jsx(uq,{currentTenantId:e.id,onTenantChange:()=>{}})})]})}),r==="home"&&d.jsxs("div",{className:"max-w-4xl mx-auto",children:[d.jsxs("div",{className:"bg-white/95 backdrop-blur-sm rounded-2xl shadow-xl border border-white/20 p-8 mb-8",children:[d.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-6 text-center",children:"Escolha o Tipo de Análise"}),d.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-4 gap-6",children:[d.jsxs("button",{onClick:()=>n("batch-upload"),className:"group bg-gradient-to-br from-blue-50 to-blue-100 hover:from-blue-100 hover:to-blue-200 rounded-xl p-8 border-2 border-blue-200 hover:border-blue-400 transition-all duration-300 text-left shadow-lg hover:shadow-xl transform hover:-translate-y-1",children:[d.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[d.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-blue-500 to-blue-700 rounded-xl flex items-center justify-center shadow-lg",children:d.jsx(Q2,{className:"w-7 h-7 text-white"})}),d.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Auditoria em Lote"})]}),d.jsx("p",{className:"text-gray-600 leading-relaxed",children:"Analise múltiplas empresas de uma vez através de planilha. Perfeito para análise de mercado e identificação de oportunidades em escala."}),d.jsx("div",{className:"mt-4 text-sm text-blue-600 font-medium",children:"→ Fazer upload de planilha"})]}),d.jsxs("button",{onClick:()=>n("comparison-form"),className:"group bg-gradient-to-br from-green-50 to-green-100 hover:from-green-100 hover:to-green-200 rounded-xl p-8 border-2 border-green-200 hover:border-green-400 transition-all duration-300 text-left shadow-lg hover:shadow-xl transform hover:-translate-y-1",children:[d.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[d.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-green-500 to-green-700 rounded-xl flex items-center justify-center shadow-lg",children:d.jsx(fo,{className:"w-7 h-7 text-white"})}),d.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Comparação Competitiva"})]}),d.jsx("p",{className:"text-gray-600 leading-relaxed",children:"Compare uma empresa com o líder do seu segmento na cidade. Receba sugestões detalhadas para ultrapassar a concorrência."}),d.jsx("div",{className:"mt-4 text-sm text-green-600 font-medium",children:"→ Comparar com líder"})]}),d.jsxs("button",{onClick:()=>n("platform-form"),className:"group bg-gradient-to-br from-purple-50 to-purple-100 hover:from-purple-100 hover:to-purple-200 rounded-xl p-8 border-2 border-purple-200 hover:border-purple-400 transition-all duration-300 text-left shadow-lg hover:shadow-xl transform hover:-translate-y-1",children:[d.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[d.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-purple-500 to-purple-700 rounded-xl flex items-center justify-center shadow-lg",children:d.jsx(tp,{className:"w-7 h-7 text-white"})}),d.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Presença Multiplataforma"})]}),d.jsx("p",{className:"text-gray-600 leading-relaxed",children:"Verifique presença em Google Maps, Apple Maps, Waze, Uber, 99 e TripAdvisor. Identifique oportunidades de expansão."}),d.jsx("div",{className:"mt-4 text-sm text-purple-600 font-medium",children:"→ Verificar presença"})]}),d.jsxs("button",{onClick:()=>n("history"),className:"group bg-gradient-to-br from-orange-50 to-orange-100 hover:from-orange-100 hover:to-orange-200 rounded-xl p-8 border-2 border-orange-200 hover:border-orange-400 transition-all duration-300 text-left shadow-lg hover:shadow-xl transform hover:-translate-y-1",children:[d.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[d.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-orange-400 to-orange-600 rounded-xl flex items-center justify-center shadow-lg",children:d.jsx(xc,{className:"w-7 h-7 text-white"})}),d.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Histórico de Análises"})]}),d.jsx("p",{className:"text-gray-600 leading-relaxed",children:"Acesse todas as comparações competitivas realizadas. Baixe relatórios e revise análises anteriores."}),d.jsx("div",{className:"mt-4 text-sm text-orange-600 font-medium",children:"→ Ver histórico completo"})]})]})]}),d.jsxs("div",{className:"bg-white/95 backdrop-blur-sm rounded-2xl shadow-xl border border-white/20 p-8",children:[d.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-6 text-center",children:"Ferramentas Administrativas"}),d.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-4 gap-6",children:[d.jsxs("button",{onClick:()=>n("admin-dashboard"),className:"group bg-gradient-to-br from-slate-50 to-slate-100 hover:from-slate-100 hover:to-slate-200 rounded-xl p-8 border-2 border-slate-200 hover:border-slate-400 transition-all duration-300 text-left shadow-lg hover:shadow-xl transform hover:-translate-y-1",children:[d.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[d.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-slate-500 to-slate-700 rounded-xl flex items-center justify-center shadow-lg",children:d.jsx(kC,{className:"w-7 h-7 text-white"})}),d.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Dashboard Admin"})]}),d.jsx("p",{className:"text-gray-600 leading-relaxed",children:"Gerencie tenants, usuários, quotas e visualize métricas de uso da plataforma."}),d.jsx("div",{className:"mt-4 text-sm text-slate-600 font-medium",children:"→ Acessar dashboard"})]}),d.jsxs("button",{onClick:()=>n("branding"),className:"group bg-gradient-to-br from-pink-50 to-pink-100 hover:from-pink-100 hover:to-pink-200 rounded-xl p-8 border-2 border-pink-200 hover:border-pink-400 transition-all duration-300 text-left shadow-lg hover:shadow-xl transform hover:-translate-y-1",children:[d.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[d.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-pink-500 to-pink-700 rounded-xl flex items-center justify-center shadow-lg",children:d.jsx(nS,{className:"w-7 h-7 text-white"})}),d.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"White-Label"})]}),d.jsx("p",{className:"text-gray-600 leading-relaxed",children:"Customize cores, logotipo e identidade visual para refletir sua marca."}),d.jsx("div",{className:"mt-4 text-sm text-pink-600 font-medium",children:"→ Personalizar marca"})]}),d.jsxs("button",{onClick:()=>n("reports"),className:"group bg-gradient-to-br from-emerald-50 to-emerald-100 hover:from-emerald-100 hover:to-emerald-200 rounded-xl p-8 border-2 border-emerald-200 hover:border-emerald-400 transition-all duration-300 text-left shadow-lg hover:shadow-xl transform hover:-translate-y-1",children:[d.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[d.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-emerald-500 to-emerald-700 rounded-xl flex items-center justify-center shadow-lg",children:d.jsx(tS,{className:"w-7 h-7 text-white"})}),d.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Relatórios Royalty"})]}),d.jsx("p",{className:"text-gray-600 leading-relaxed",children:"Gere relatórios financeiros detalhados com cálculo de royalties e PDFs profissionais."}),d.jsx("div",{className:"mt-4 text-sm text-emerald-600 font-medium",children:"→ Gerar relatórios"})]}),d.jsxs("button",{onClick:()=>n("api-docs"),className:"group bg-gradient-to-br from-cyan-50 to-cyan-100 hover:from-cyan-100 hover:to-cyan-200 rounded-xl p-8 border-2 border-cyan-200 hover:border-cyan-400 transition-all duration-300 text-left shadow-lg hover:shadow-xl transform hover:-translate-y-1",children:[d.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[d.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-cyan-500 to-cyan-700 rounded-xl flex items-center justify-center shadow-lg",children:d.jsx(eS,{className:"w-7 h-7 text-white"})}),d.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Documentação API"})]}),d.jsx("p",{className:"text-gray-600 leading-relaxed",children:"Referência completa da API REST para integração programática com a plataforma."}),d.jsx("div",{className:"mt-4 text-sm text-cyan-600 font-medium",children:"→ Ver documentação"})]})]})]})]}),r==="batch-upload"&&d.jsx(qz,{onComplete:b}),r==="batch-results"&&d.jsx(Gz,{results:a,onNewAudit:_}),r==="comparison-form"&&d.jsxs("div",{className:"grid lg:grid-cols-2 gap-6",children:[d.jsx(Xz,{onSubmit:y,onBack:w}),d.jsx(Mb,{})]}),r==="comparison-processing"&&s&&d.jsx(t$,{companyName:s.companyName,city:s.city,segment:s.segment,onComplete:N,onBack:R}),r==="comparison-results"&&l&&d.jsx(XE,{comparison:l,onNewComparison:R}),r==="platform-form"&&d.jsx("div",{className:"max-w-2xl mx-auto",children:d.jsx(oq,{onSubmit:P,onBack:w})}),r==="admin-dashboard"&&d.jsx(hq,{}),r==="branding"&&d.jsx(dq,{}),r==="reports"&&d.jsx(gq,{}),r==="api-docs"&&d.jsx(xq,{}),r==="platform-processing"&&v&&d.jsx("div",{className:"max-w-2xl mx-auto",children:d.jsxs("div",{className:"bg-white/95 backdrop-blur-sm rounded-2xl shadow-xl border border-white/20 p-12 text-center",children:[d.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-purple-500 to-purple-700 rounded-full flex items-center justify-center shadow-lg mx-auto mb-6 animate-pulse",children:d.jsx(tp,{className:"w-8 h-8 text-white"})}),d.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-3",children:"Analisando Presença..."}),d.jsxs("p",{className:"text-gray-600",children:["Verificando ",u==null?void 0:u.companyName," em 6 plataformas diferentes"]})]})}),r==="platform-results"&&m&&d.jsx(lq,{analysis:m,onNewAnalysis:F}),r==="history"&&d.jsxs("div",{className:"max-w-4xl mx-auto",children:[d.jsx("div",{className:"mb-6",children:d.jsx("button",{onClick:w,className:"text-white hover:text-blue-200 transition-colors flex items-center gap-2",children:"← Voltar ao início"})}),d.jsx(Mb,{})]})]}),d.jsx("footer",{className:"mt-16 pb-8 text-center text-sm text-blue-100",children:d.jsx("p",{children:"GMN SmartAudit AI - Auditoria inteligente de presença digital local"})})]})}Jk(document.getElementById("root")).render(d.jsx(nt.StrictMode,{children:d.jsx(fq,{defaultTenantSlug:"gmn-master",children:d.jsx(yq,{})})}));export{vr as _,Di as c,kq as g};
